"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[827],{83827:function(e,t,r){r.d(t,{LiveAudioVisualizer:function(){return c}});var n,a=r(2265),l={exports:{}},i={};l.exports=function(){if(n)return i;n=1;var e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,l=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u={key:!0,ref:!0,__self:!0,__source:!0};function o(t,n,a){var i,o={},s=null,c=null;for(i in void 0!==a&&(s=""+a),void 0!==n.key&&(s=""+n.key),void 0!==n.ref&&(c=n.ref),n)r.call(n,i)&&!u.hasOwnProperty(i)&&(o[i]=n[i]);if(t&&t.defaultProps)for(i in n=t.defaultProps)void 0===o[i]&&(o[i]=n[i]);return{$$typeof:e,type:t,key:s,ref:c,props:o,_owner:l.current}}return i.Fragment=t,i.jsx=o,i.jsxs=o,i}();var u=l.exports;let o=(e,t,r,n)=>{let a=t/(r+n),l=Math.floor(e.length/a);a>e.length&&(a=e.length,l=1);let i=[];for(let t=0;t<a;t++){let r=0;for(let n=0;n<l&&t*l+n<e.length;n++)r+=e[t*l+n];i.push(r/l)}return i},s=(e,t,r,n,a,l)=>{let i=t.height/2,u=t.getContext("2d");u&&(u.clearRect(0,0,t.width,t.height),"transparent"!==a&&(u.fillStyle=a,u.fillRect(0,0,t.width,t.height)),e.forEach((e,t)=>{u.fillStyle=l;let a=t*(r+n),o=i-e/2,s=e||1;u.beginPath(),u.roundRect?(u.roundRect(a,o,r,s,50),u.fill()):u.fillRect(a,o,r,s)}))},c=({mediaRecorder:e,width:t="100%",height:r="100%",barWidth:n=2,gap:l=1,backgroundColor:i="transparent",barColor:c="rgb(160, 198, 255)",fftSize:f=1024,maxDecibels:h=-10,minDecibels:d=-90,smoothingTimeConstant:m=.4})=>{let[g]=(0,a.useState)(()=>new AudioContext),[p,y]=(0,a.useState)(),b=(0,a.useRef)(null);(0,a.useEffect)(()=>{if(!e.stream)return;let t=g.createAnalyser();y(t),t.fftSize=f,t.minDecibels=d,t.maxDecibels=h,t.smoothingTimeConstant=m,g.createMediaStreamSource(e.stream).connect(t)},[e.stream]),(0,a.useEffect)(()=>{p&&"recording"===e.state&&w()},[p,e.state]);let w=(0,a.useCallback)(()=>{if(!p)return;let t=new Uint8Array(null==p?void 0:p.frequencyBinCount);"recording"===e.state?(null==p||p.getByteFrequencyData(t),x(t),requestAnimationFrame(w)):"paused"===e.state?x(t):"inactive"===e.state&&"closed"!==g.state&&g.close()},[p,g.state]),x=e=>{b.current&&s(o(e,b.current.width,n,l),b.current,n,l,i,c)};return u.jsx("canvas",{ref:b,width:t,height:r,style:{aspectRatio:"unset"}})},f=(e,t,r,n,a)=>{let l=e.getChannelData(0),i=r/(n+a),u=Math.floor(l.length/i),o=t/2,s=[],c=0;for(let t=0;t<i;t++){let r=[],n=0,a=[],i=0;for(let o=0;o<u&&t*u+o<e.length;o++){let e=l[t*u+o];e<=0&&(r.push(e),n++),e>0&&(a.push(e),i++)}let o=r.reduce((e,t)=>e+t,0)/n,f={max:a.reduce((e,t)=>e+t,0)/i,min:o};f.max>c&&(c=f.max),Math.abs(f.min)>c&&(c=Math.abs(f.min)),s.push(f)}if(.8*o>c*o){let e=.8*o/c;s=s.map(t=>({max:t.max*e,min:t.min*e}))}return s},h=(e,t,r,n,a,l,i,u=0,o=1)=>{let s=t.height/2,c=t.getContext("2d");if(!c)return;c.clearRect(0,0,t.width,t.height),"transparent"!==a&&(c.fillStyle=a,c.fillRect(0,0,t.width,t.height));let f=(u||0)/o;e.forEach((t,a)=>{let u=a/e.length;c.fillStyle=f>u&&i?i:l;let o=a*(r+n),h=s+t.min,d=s+t.max-h;c.beginPath(),c.roundRect?(c.roundRect(o,h,r,d,50),c.fill()):c.fillRect(o,h,r,d)})};(0,a.forwardRef)(({blob:e,width:t,height:r,barWidth:n=2,gap:l=1,currentTime:i,style:o,backgroundColor:s="transparent",barColor:c="rgb(184, 184, 184)",barPlayedColor:d="rgb(160, 198, 255)"},m)=>{let g=(0,a.useRef)(null),[p,y]=(0,a.useState)([]),[b,w]=(0,a.useState)(0);return(0,a.useImperativeHandle)(m,()=>g.current,[]),(0,a.useEffect)(()=>{(async()=>{if(!g.current)return;if(!e){h(Array.from({length:100},()=>({max:0,min:0})),g.current,n,l,s,c,d);return}let a=await e.arrayBuffer();await new AudioContext().decodeAudioData(a,e=>{if(!g.current)return;w(e.duration);let a=f(e,r,t,n,l);y(a),h(a,g.current,n,l,s,c,d)})})()},[e,g.current]),(0,a.useEffect)(()=>{g.current&&h(p,g.current,n,l,s,c,d,i,b)},[i,b]),u.jsx("canvas",{ref:g,width:t,height:r,style:{...o}})}).displayName="AudioVisualizer"}}]);