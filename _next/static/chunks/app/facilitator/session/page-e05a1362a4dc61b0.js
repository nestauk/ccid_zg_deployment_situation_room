(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[44],{59870:function(e,n,t){Promise.resolve().then(t.bind(t,22252))},22252:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return eN}});var i,s,r,o,a=t(57437),l=t(53622),c=t(94547),d=t(78364),u=t(2265),x=t(60182),h=t(31193),f=t(80511),p=t(96537),g=t(22960),m=t(56019),j=t(71733),v=t(79806),w=t(44228),b=t(42748),y=t(11656),Z=t(47905),S=t(86917),C=t(14595),k=t(60335),I=t(21395),E=t(24072),T=t(76396);function _(e){let n=n=>{n!==e.state&&e.onFacilitationStateChange(n)},t=n=>{n!==e.fullscreen&&e.onFullScreenChange(n)},i=()=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(b.Z,{children:[(0,a.jsx)(y.Z,{children:(0,a.jsx)(Z.Z,{inset:!0,children:(0,a.jsx)("b",{children:"Workshop facilitation"})})},"action-menu-video-heading"),[c._y.Ready,c._y.Open,c._y.Closed].map(t=>(0,a.jsxs)(y.Z,{disabled:e.stateBusy,onClick:()=>n(t),children:[e.state===t&&(0,a.jsx)(S.Z,{children:(0,a.jsx)(w.Z,{})}),(0,a.jsx)(Z.Z,{inset:e.state!==t,children:c._y[t]})]},"action-menu-item-".concat(c._y[t])))]}),(0,a.jsx)(C.Z,{}),(0,a.jsxs)(b.Z,{children:[(0,a.jsx)(y.Z,{children:(0,a.jsx)(Z.Z,{inset:!0,children:(0,a.jsx)("b",{children:"Screen mode"})})},"action-menu-screen-heading"),(0,a.jsxs)(y.Z,{disabled:e.fullscreenBusy,onClick:()=>t(!0),children:[e.fullscreen&&(0,a.jsx)(S.Z,{children:(0,a.jsx)(w.Z,{})}),(0,a.jsx)(Z.Z,{inset:!e.fullscreen,children:"Full screen"})]},"action-menu-item-screen-fullscreen"),(0,a.jsxs)(y.Z,{disabled:e.fullscreenBusy,onClick:()=>t(!1),children:[!e.fullscreen&&(0,a.jsx)(S.Z,{children:(0,a.jsx)(w.Z,{})}),(0,a.jsx)(Z.Z,{inset:e.fullscreen,children:"Windowed"})]},"action-menu-item-screen-windowed")]})]});return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(E.ZP,{variant:"popover",popupId:"facilitation-actions-popup",children:e=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(k.Z,{"aria-label":"settings",...(0,T.vW)(e),children:(0,a.jsx)("img",{src:"/icons//settings.svg"})}),(0,a.jsx)(I.Z,{...(0,T.wK)(e),children:(0,a.jsx)(i,{})})]})})})}function D(e){let[n,t]=(0,u.useState)(""),i=(0,u.useRef)();(0,u.useEffect)(()=>{if(e.startTime)return i.current=setInterval(s,1e3),()=>{clearInterval(i.current)};i.current&&(clearInterval(i.current),i.current=void 0),t("")},[e.startTime,e.duration_mins]);let s=(0,u.useCallback)(()=>{if(e.startTime){let n=new Date().getTime()-e.startTime.getTime();e.duration_mins&&(n=Math.max(6e4*e.duration_mins-n,0));let i=Math.floor(n/36e5),s=Math.floor((n-=36e5*i)/6e4),r=Math.floor((n-=6e4*s)/1e3);n-=1e3*r,t("".concat(i.toString().padStart(2,"0"),":").concat(s.toString().padStart(2,"0"),":").concat(r.toString().padStart(2,"0")))}else t("")},[e.startTime,e.duration_mins]);return(0,a.jsxs)(f.Z,{variant:"h5",children:[(0,a.jsx)("img",{src:"/icons/clock.svg",style:{height:26,verticalAlign:"middle",marginRight:12,paddingBottom:4}}),n]})}let R=async(e,n,t,i,s)=>{await e.postFacilitatorAction(n,t,{action:"fullscreen",sessionId:i,parameters:{full:s}})},F=async(e,n,t,i,s)=>{await e.postFacilitatorAction(n,t,{action:s,sessionId:i})};var P=t(58253),A=t(5085),O=t(69065),U=t(66124),N=t(7630),H=t(58433),W=t(14874),B=t(70883),L=t(10105),M=t(37570);function V(){let e=(0,u.useContext)(M.H),n=(0,u.useContext)(B.l),t=(0,W.Z)(),i=e=>"Device: ".concat(e.deviceName),s=e=>e.role===c._b.Controller?"\uD83D\uDD79ï¸":"",r=e=>e.participantName&&e.participantName.length>0?e.participantName:null,o=e=>{let{connected:n}=e;return(0,a.jsx)(h.Z,{sx:{p:1,borderRadius:4,height:42},style:{background:n?t.palette.connected.main:t.palette.disconnected.main},children:(0,a.jsx)("img",{style:{height:26,margin:0,padding:0},src:n?"/icons/device-connected.svg":"/icons/device-disconnected.svg"})})};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(f.Z,{variant:"h6",component:"h2",children:"Participants"}),(0,a.jsx)(H.ZP,{container:!0,spacing:2,sx:{mt:2},children:n.subscriptions.map(e=>(0,a.jsx)(H.ZP,{item:!0,xs:6,children:(0,a.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[(0,a.jsx)(o,{connected:e.enabled}),(0,a.jsxs)(h.Z,{sx:{ml:2},children:[(0,a.jsxs)(f.Z,{variant:"h6",children:[s(e),r(e)]}),(0,a.jsx)(f.Z,{variant:"body1",children:i(e)})]})]})},"connection-indicator-".concat(e.subscriptionId)))}),(0,a.jsx)(p.Z,{variant:"outlined",color:"buttonStandard",sx:{flexGrow:1,alignSelf:"start",mt:4},onClick:()=>{var n;null===(n=navigator)||void 0===n||n.clipboard.writeText((0,L.v)(e.session))},children:"Copy participant link"})]})}function q(){let[e,n]=(0,u.useState)(!1),t=()=>{n(!1)};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(k.Z,{"aria-label":"settings",onClick:()=>{n(!0)},children:(0,a.jsx)("img",{src:"/icons/session-participants.svg"})}),(0,a.jsx)(O.Z,{fullWidth:!0,maxWidth:"md",open:e,onClose:t,children:(0,a.jsxs)(U.Z,{children:[(0,a.jsx)(h.Z,{style:{position:"absolute",top:0,right:0},children:(0,a.jsx)(k.Z,{"aria-label":"close",onClick:t,children:(0,a.jsx)(N.Z,{})})}),(0,a.jsx)(h.Z,{sx:{p:2},display:"flex",flexDirection:"column",alignItems:"center",children:(0,a.jsx)(V,{})})]})})]})}var z=t(65301);(i=r||(r={}))[i.Ready=0]="Ready",i[i.InitError=1]="InitError",i[i.Recording=2]="Recording",i[i.Saving=3]="Saving",i[i.UploadSuccess=4]="UploadSuccess",i[i.UploadError=5]="UploadError";var G=t(4766),X=t(18502),K=t(63375),J=t(83040),Y=t(15785);let $=e=>{var n;return"".concat(null!==(n=e.recordingId)&&void 0!==n?n:"slide-"+"".concat(e.index).padStart(3,"0"))};function Q(e){let n=(0,u.useContext)(P.A),t=(0,u.useContext)(A.rZ),i=(0,u.useContext)(G.X),s=(0,u.useContext)(M.H),[r,o]=(0,u.useState)($(i.data)),[l,c]=(0,u.useState)(!1),[d,x]=(0,u.useState)(!1),[m,j]=(0,u.useState)(!1),{record:v,stop:w,isRecording:b,recordingTime:y,audioBlob:Z,filenamePart:S,filenameSuffix:C,clearRecording:k}=function(){let[e,n]=(0,u.useState)(0),[t,i]=(0,u.useState)(void 0),[s,r]=(0,u.useState)(),{startRecording:o,stopRecording:a,togglePauseResume:l,recordingBlob:c,isRecording:d,isPaused:x,recordingTime:h,mediaRecorder:f}=(0,z.I)({noiseSuppression:!0,autoGainControl:!0},e=>{n(1)},{mimeType:"audio/webm"}),p=e=>"audio-recording-".concat(e);return(0,u.useEffect)(()=>{n(d?2:0)},[d]),(0,u.useEffect)(()=>{void 0!==c&&i(c)},[c]),{record:e=>{r(p(e)),o()},stop:()=>{a()},state:e,audioBlob:t,recordingTime:h,isRecording:d,filenamePart:s,filenameSuffix:"webm",clearRecording:()=>{i(void 0),r(void 0)}}}();(0,u.useEffect)(()=>{b&&(console.debug("Stopping recording due to slide change."),w());let e=$(i.data);console.debug("New slide id: ".concat(e)),o(e)},[i.data.index]),(0,u.useEffect)(()=>{c(b),b&&j(!1)},[b]),(0,u.useEffect)(()=>{b||void 0===Z||void 0===S||I()},[Z]);let I=()=>{if(void 0===Z||void 0===S){console.debug("Audio blob or filename part empty. Skipping upload.");return}if(0===Z.size){console.debug("Audio recording is empty. Skipping upload.");return}console.debug("Initiating upload for recording: <guid>-".concat(S,"-<guid>.").concat(C)),j(!1),x(!0),_(Z,S,C).then(()=>{console.debug("Upload complete"),j(!1),k()}).catch(e=>{console.error("Upload failed",e),j(!0)}).finally(()=>{x(!1)})},_=async(e,i,r)=>{console.debug("Retrieving recording upload info...");let o=await n.getMediaUploadUrl(s.sid,t.sessionToken,t.user.access_token,"deliberation",i,r);console.debug("Uploading recording...",o),await n.putBlob(e,o.uploadUrl),console.debug("Upload recording complete.")},D=()=>{if(void 0===Z||0===Z.size){console.debug("Audio blob empty. Skipping download.");return}let e="recording-".concat(null!=S?S:"unknown",".").concat(C);console.debug("Downloading audio recording..."),function(e,n){let t=URL.createObjectURL(e),i=document.createElement("a");i.href=t,i.download=n;try{document.body.appendChild(i),i.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window}))}catch(e){console.error("Error downloading blob",e)}finally{document.body.removeChild(i)}}(Z,e)},R=(0,g.Z)();return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(E.ZP,{variant:"popover",popupId:"recording-information-popup",children:n=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(p.Z,{startIcon:(0,a.jsx)(K.Z,{htmlColor:l?R.palette.recordingEnabled.main:d?R.palette.recordingUploading.main:m?R.palette.recordingFailed.main:R.palette.recordingDisabled.main}),endIcon:(0,a.jsx)(J.Z,{color:"action"}),variant:"text",color:"buttonStandard","aria-label":"Recording information",sx:{opacity:e.enableHint?1:.3},...(0,T.LI)(n),children:["Recording: ",l?"Active":d?"Uploading...":m?"Upload error":"Inactive"]}),(0,a.jsx)(X.ZP,{...(0,T.ZW)(n),anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},children:(0,a.jsxs)(h.Z,{sx:{p:1,display:"flex",flexDirection:"column",gap:1},children:[!b&&(0,a.jsx)(p.Z,{variant:e.enableHint?"contained":"outlined",color:e.enableHint?"primary":"buttonStandard",onClick:()=>v(r),children:"Start Recording"}),b&&(0,a.jsx)(p.Z,{variant:"outlined",color:"buttonStandard",onClick:()=>w(),children:"Stop Recording"}),(0,a.jsxs)(f.Z,{variant:"body2",children:["Slide activity: ",Y.S[i.data.activity]]}),i.data.recordingId&&(0,a.jsxs)(f.Z,{variant:"body2",children:["Deliberation id: ",r,(0,a.jsx)("br",{})]}),b&&(0,a.jsxs)(f.Z,{variant:"body2",sx:{fontSize:"0.5rem"},children:["Recording: ",y]}),m&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(h.Z,{sx:{display:"flex",flexDirection:"row",gap:1,alignItems:"center"},children:[(0,a.jsx)(K.Z,{htmlColor:R.palette.recordingFailed.main}),(0,a.jsx)(f.Z,{variant:"body1",children:"Recording upload failed"})]}),(0,a.jsx)(f.Z,{variant:"body2",children:"The recording could not be uploaded."}),Z&&S&&C&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(p.Z,{variant:"outlined",color:"buttonStandard",onClick:()=>I(),children:"Retry upload"}),(0,a.jsx)(p.Z,{variant:"outlined",color:"buttonStandard",onClick:()=>D(),children:"Download audio"})]})]})]})})]})})})}function ee(e){let n=(0,u.useContext)(P.A),t=(0,u.useContext)(M.H),i=(0,u.useContext)(x.d),s=(0,u.useContext)(A.rZ),r=(0,u.useContext)(G.X),o=(0,g.Z)(),[l,d]=(0,u.useState)(i.facilitationState===c._y.Open),[p,w]=(0,u.useState)(!1),[b,y]=(0,u.useState)(!1),[Z,S]=(0,u.useState)(!1),[C,k]=(0,u.useState)(!1);(0,u.useEffect)(()=>{d(i.facilitationState===c._y.Open)},[i]),(0,u.useEffect)(()=>{S(i.facilitationState===c._y.Open&&i.inPersonRecordingEnabled&&t.session.remoteConfiguration===c.VS.InPerson&&r.data.activity===Y.S.deliberation),k(i.facilitationState===c._y.Open&&i.inPersonRecordingEnabled&&t.session.remoteConfiguration===c.VS.InPerson&&(r.data.activity===Y.S.deliberation||void 0!==r.data.recordingId))},[r.data.activity,i.inPersonRecordingEnabled,i.facilitationState,t.session.remoteConfiguration]);let I=async e=>{try{y(!0),await R(n,s.user.access_token,s.sessionToken,t.session.id,e)}catch(e){console.error(e)}finally{y(!1)}},E=async e=>{try{switch(w(!0),e){case c._y.Ready:await F(n,s.user.access_token,s.sessionToken,t.session.id,"reset");break;case c._y.Open:await F(n,s.user.access_token,s.sessionToken,t.session.id,"open");break;case c._y.Closed:await F(n,s.user.access_token,s.sessionToken,t.session.id,"close");break;default:console.warn("Unexpected facilitation switch from menu.")}}catch(e){console.error(e)}finally{w(!1)}};return(0,a.jsx)(j.Z,{position:"static",elevation:0,children:(0,a.jsx)(v.Z,{sx:{bgcolor:o.palette.headerBarBackground.main,color:"black"},children:(0,a.jsxs)(h.Z,{display:"flex",flexDirection:"row",justifyContent:"space-between",style:{width:"100%"},children:[(0,a.jsxs)(h.Z,{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",children:[(0,a.jsx)("img",{src:"/icons/home.svg",style:{height:26,verticalAlign:"middle",marginRight:12,paddingBottom:4}}),(0,a.jsx)(m.Z,{color:"primary",badgeContent:c._y[i.facilitationState],anchorOrigin:{vertical:"bottom",horizontal:"right"},children:(0,a.jsx)(f.Z,{variant:"h5",children:t.session.sessionName})})]}),l&&(0,a.jsx)(h.Z,{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",children:(0,a.jsx)(D,{startTime:i.sessionStartedAt,duration_mins:t.session.sessionDurationMins})}),i.inPersonRecordingEnabled&&(0,a.jsx)(h.Z,{display:"flex",flexDirection:"row",children:(0,a.jsx)(Q,{enableHint:Z,autoRecord:C})}),(0,a.jsxs)(h.Z,{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",children:[(0,a.jsx)(q,{}),(0,a.jsx)(_,{state:i.facilitationState,fullscreen:i.fullScreen,onFacilitationStateChange:E,onFullScreenChange:I,stateBusy:p,fullscreenBusy:b})]})]})})})}var en=t(93191);function et(e){let{notes:n}=e;return(0,a.jsx)("span",{dangerouslySetInnerHTML:{__html:n}})}var ei=t(79617),es=t(51847),er=t(33578),eo=t(35231),ea=t(50467),el=t(2842),ec=t(9542),ed=t(13971);function eu(e){let{colours:n,data:t}=e,i=e=>{let n={true:{l:!0,r:!1},false:{l:!1,r:!0}};return 0===e.true&&(n.false.l=!0),0===e.false&&(n.true.r=!0),n},[s,r]=(0,u.useState)(i(t));(0,u.useEffect)(()=>{r(i(t))},[t]);let o=e=>[e.l?16:0,e.r?16:0,e.r?16:0,e.l?16:0];return(0,a.jsx)(eo.h,{width:"100%",height:40,children:(0,a.jsxs)(ea.v,{layout:"vertical",margin:{left:0,right:0},height:40,data:[{name:"completion",complete:t.true,incomplete:t.false}],children:[(0,a.jsx)(el.K,{hide:!0,type:"number",max:t.true+t.false}),(0,a.jsx)(ec.B,{hide:!0,dataKey:"name",type:"category"}),(0,a.jsx)(ed.$,{dataKey:"complete",stackId:"completion",fill:n[0],radius:o(s.true)}),(0,a.jsx)(ed.$,{dataKey:"incomplete",stackId:"completion",fill:n[1],radius:o(s.false)})]})})}var ex=t(74382),eh=t(37552);(s=o||(o={}))[s.NotAnswered=0]="NotAnswered",s[s.Answered=1]="Answered";let ef=(e,n)=>{var t;let i=null!==(t=ep(e.answers))&&void 0!==t?t:[],s=i.length,r=n.filter(e=>e.enabled&&e.role===c._b.Client),o=r.filter(e=>!i.find(n=>n.participantId===e.deviceId));return{allAnswers:i,relevantParticipants:r,answeredCount:s,participantsWithoutAnswers:o,maxAnswers:i.length+o.length}},ep=e=>null==e?void 0:e.sort((e,n)=>new Date(e.created).getTime()-new Date(n.created).getTime()),eg=(e,n)=>{var t;return[...e.allAnswers.map((e,t)=>({description:em(e,n),answered:1})),...null!==(t=e.participantsWithoutAnswers.map(e=>({description:ej(e),answered:0})))&&void 0!==t?t:[]]},em=(e,n)=>ej(n.find(n=>n.deviceId===e.participantId)),ej=e=>{var n,t;return null!==(t=null!==(n=null==e?void 0:e.participantName)&&void 0!==n?n:null==e?void 0:e.deviceName)&&void 0!==t?t:"Unknown"};function ev(e){let n=(0,u.useContext)(ex.v1),t=(0,u.useContext)(B.l),i=()=>{var t;return{qid:e.qid,answers:null!==(t=n.allAnswers[e.qid])&&void 0!==t?t:[]}},[s,r]=(0,u.useState)(i()),[o,l]=(0,u.useState)(t.subscriptions),[c,d]=(0,u.useState)(ef(s,o)),[x,p]=(0,u.useState)([]);(0,u.useEffect)(()=>{l(t.subscriptions)},[t]),(0,u.useEffect)(()=>{r(i())},[n]),(0,u.useEffect)(()=>{d(ef(s,o))},[s,o]),(0,u.useEffect)(()=>{p(eg(c,o))},[c,o]);let g=e=>(0,a.jsxs)(h.Z,{sx:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",borderRadius:2,background:"white",border:"1px solid #EFEFEF",p:2},children:[(0,a.jsx)(f.Z,{variant:"body1",sx:{borderRight:"1px solid black",overflowX:"scroll",textWrap:"nowrap",flexGrow:1,mr:.5,pr:.5},children:e.description}),1===e.answered&&(0,a.jsx)("img",{src:"/icons/checkbox-filled.svg"}),1!==e.answered&&(0,a.jsx)("img",{src:"/icons/checkbox.svg"})]}),m=(0,W.Z)();return(0,a.jsx)("div",{children:e.qid&&(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(ei.Z,{sx:{background:"transparent"},elevation:0,children:[(0,a.jsx)(es.Z,{expandIcon:(0,a.jsx)(eh.Z,{}),sx:{p:0},children:(0,a.jsx)(eu,{colours:[m.palette.primary.main,"#ededff"],data:{true:c.answeredCount,false:c.participantsWithoutAnswers.length}})}),(0,a.jsxs)(er.Z,{sx:{p:0},children:[(0,a.jsxs)(f.Z,{variant:"body1",sx:{ml:1,mb:1},children:[(0,a.jsx)("img",{src:"/icons/busts.svg",style:{height:26,verticalAlign:"middle",marginRight:12,paddingBottom:4}}),"".concat(c.answeredCount," of ").concat(c.maxAnswers," ")," ",1!==c.answeredCount?"have":"has"," voted"]}),(0,a.jsx)(H.ZP,{container:!0,spacing:2,children:x.map((n,t)=>(0,a.jsx)(H.ZP,{item:!0,xs:12,sm:6,md:4,children:(0,a.jsx)(g,{description:n.description,answered:n.answered})},"answer-indicator-grid-item-".concat(e.qid,"-").concat(t)))})]})]})})})}var ew=t(6722),eb=t(11707);function ey(e){let{orientation:n,showLabels:t}=e,{muted:i,toggleMute:s}=(0,ew.HI)(),{tileId:r,isVideoEnabled:o,hasReachedVideoLimit:l,toggleVideo:c}=(0,ew.Onx)(),d=(0,ew.fjl)();return i?(0,a.jsx)(ew.PjE,{muted:!0}):(0,a.jsx)(ew.PjE,{}),o?(0,a.jsx)(ew.V1s,{}):(0,a.jsx)(ew.V1s,{disabled:!0}),ew.LPZ,(0,a.jsx)(eb.f6,{theme:ew.Wbj,children:(0,a.jsxs)(ew.VSr,{showLabels:t,layout:"horizontal"===n?"undocked-horizontal":"undocked-vertical",style:{boxShadow:"none"},children:[(0,a.jsx)(ew._nn,{}),(0,a.jsx)(ew.V8F,{})]})})}var eZ=t(31164),eS=t(68276),eC=t(8963),ek=t(97340),eI=t(28801);let eE=e=>{void 0!==window&&void 0!==window.localStorage&&window.localStorage.setItem("SlideTimers",JSON.stringify(e))},eT=()=>{if(void 0===window||void 0===window.localStorage)return{};{let e=window.localStorage.getItem("SlideTimers");return null!==e?JSON.parse(e):{}}},e_=e=>{let n=e%60;return"".concat(Math.floor(e/60)," mins, ").concat(n<10?"0":"").concat(n," secs")};function eD(e){let n=(0,u.useContext)(G.X),t=(0,u.useContext)(x.d),[i,s]=(0,u.useState)(),[r,o]=(0,u.useState)(),l=(0,u.useRef)();(0,u.useEffect)(()=>{s(eT())},[]),(0,u.useEffect)(()=>{void 0!==i&&eE(i)},[i]),(0,u.useEffect)(()=>{if(n.data&&n.data.secs){if(i){if(void 0===i[n.data.index]){console.debug("timer not found");let e={running:t.facilitationState===c._y.Open,startTime:n.data.secs,currentTime:n.data.secs,index:n.data.index};s({...i,[n.data.index]:e}),o(e)}else(void 0===r||r.index!==n.data.index)&&o(i[n.data.index])}}else o(void 0)},[n.data,i]),(0,u.useEffect)(()=>{void 0!==r&&(void 0!==l.current&&clearTimeout(l.current),l.current=setTimeout(d,1e3))},[r]);let d=(0,u.useCallback)(()=>{if(void 0!==l.current&&(clearTimeout(l.current),l.current=void 0),void 0!==r&&r.running&&r.currentTime>0){let e={...r,currentTime:r.currentTime-1};o(e),s({...i,[n.data.index]:e}),l.current=setTimeout(d,1e3)}},[r]);(0,u.useEffect)(()=>{t.facilitationState===c._y.Open?void 0===r||r.running||g():void 0!==r&&r.running&&m()},[t.facilitationState]);let g=()=>{if(void 0!==r){let e={...r,running:!0};o(e),s({...i,[n.data.index]:e}),void 0!==l.current&&clearTimeout(l.current),l.current=setTimeout(d,1e3)}},m=()=>{if(void 0!==r){let e={...r,running:!1};o(e),s({...i,[n.data.index]:e})}},j=()=>{if(void 0!==r){let e={...r,running:!1,currentTime:r.startTime};o(e),s({...i,[n.data.index]:e})}},v=e=>{if(void 0!==r){let t={...r,currentTime:r.currentTime+e};o(t),s({...i,[n.data.index]:t})}},w=r&&!r.running&&r.currentTime>0,b=r&&r.running&&r.currentTime>0;return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(h.Z,{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",children:[(0,a.jsxs)(h.Z,{display:"flex",flexDirection:"row",justifyContent:"start",alignItems:"center",children:[(0,a.jsx)("img",{src:"/icons/session-time.svg"}),void 0!==r&&(0,a.jsx)(f.Z,{variant:"h6",sx:{ml:1},children:e_(r.currentTime)})]}),(0,a.jsxs)(h.Z,{display:"flex",flexDirection:"row",justifyContent:"end",alignItems:"center",gap:1,children:[(0,a.jsx)(p.Z,{variant:"outlined",color:"buttonStandard",disabled:!w,onClick:()=>{g()},children:"Start"}),(0,a.jsx)(p.Z,{variant:"outlined",color:"buttonStandard",disabled:!b,onClick:()=>{m()},children:"Pause"}),(0,a.jsx)(p.Z,{variant:"outlined",color:"buttonStandard",onClick:()=>{v(60)},children:"+1 min"}),(0,a.jsx)(p.Z,{variant:"outlined",color:"buttonStandard",onClick:()=>{j()},children:"Reset"})]})]})})}var eR=t(80824);function eF(e){let n=(0,u.useContext)(x.d),t=(0,u.useContext)(M.H),[i,s]=(0,u.useState)(!1),[r,o]=(0,u.useState)(!1),[l,d]=(0,u.useState)(!1);return(0,u.useEffect)(()=>{o(n.facilitationState===c._y.Open)},[n.facilitationState]),(0,u.useEffect)(()=>{d(t.session.remoteConfiguration===c.VS.InPerson&&n.inPersonRecordingEnabled)},[n.inPersonRecordingEnabled,t.session.remoteConfiguration]),(0,u.useEffect)(()=>{s(r&&l)},[r,l]),(0,a.jsxs)(O.Z,{fullWidth:!0,maxWidth:"sm",open:i,onClose:()=>s(!1),children:[(0,a.jsxs)(eR.Z,{children:["The workshop is now open",(0,a.jsx)(h.Z,{style:{position:"absolute",top:0,right:0},children:(0,a.jsx)(k.Z,{"aria-label":"close",onClick:()=>s(!1),children:(0,a.jsx)(N.Z,{})})})]}),(0,a.jsx)(U.Z,{children:(0,a.jsxs)(h.Z,{sx:{display:"flex",flexDirection:"column",gap:2},children:[(0,a.jsxs)("ul",{children:[r&&(0,a.jsx)("li",{children:"Participants will now be able to enter the session"}),l&&(0,a.jsx)("li",{children:"Relevant sections will be automatically recorded"})]}),(0,a.jsx)(p.Z,{variant:"contained",sx:{alignSelf:"center",textTransform:"uppercase"},onClick:()=>s(!1),children:"Continue"})]})})]})}function eP(){var e,n,t;let i=(0,u.useContext)(P.A),s=(0,u.useContext)(A.rZ);(0,u.useContext)(l.p);let r=(0,u.useContext)(M.H),o=(0,u.useContext)(x.d),d=(0,u.useContext)(G.X),g=(0,u.useContext)(en.N),m=(0,u.useContext)(B.l),j=(0,u.useContext)(eS.u),v=new eC.ConsoleLogger("Zeitgeist meeting",eC.LogLevel.OFF),[w,b]=(0,u.useState)(void 0),[y,Z]=(0,u.useState)(!1),S=async e=>{try{Z(!0),await F(i,s.user.access_token,s.sessionToken,r.sid,e)}catch(e){console.error(e)}finally{Z(!1)}};(0,u.useEffect)(()=>{o.facilitationState===c._y.Ready?b((0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(h.Z,{sx:{display:"flex",flexDirection:"row",alignItems:"center"},children:[(0,a.jsx)("img",{src:"/icons/session-participants.svg"}),(0,a.jsxs)(f.Z,{variant:"body1",sx:{ml:1},children:[m.subscriptions.filter(e=>e.deviceId!==s.deviceId).length," waiting"]})]}),(0,a.jsx)(p.Z,{variant:"contained",color:"primary",onClick:()=>S("open"),disabled:y,children:"Open workshop"})]})):o.facilitationState===c._y.Open?b((0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(h.Z,{sx:{display:"flex",flexDirection:"row",alignItems:"center"},children:[(0,a.jsx)("img",{src:"/icons/session-participants.svg"}),(0,a.jsxs)(f.Z,{variant:"body1",sx:{ml:1},children:[m.subscriptions.filter(e=>e.deviceId!==s.deviceId).length," participants"]})]}),(0,a.jsx)(p.Z,{variant:"outlined",color:"buttonStandard",onClick:()=>S("close"),disabled:y,children:"Close workshop"})]})):o.facilitationState===c._y.Closed&&b((0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(h.Z,{sx:{display:"flex",flexDirection:"row",alignItems:"center"},children:[(0,a.jsx)("img",{src:"/icons/session-participants.svg"}),(0,a.jsx)(f.Z,{variant:"body1",sx:{ml:1},children:"closed"})]}),(0,a.jsx)(p.Z,{variant:"outlined",color:"primary",onClick:()=>S("reset"),disabled:y,children:"Open waiting room"})]}))},[o.facilitationState,m,y]);let C=r.session.remoteConfiguration===c.VS.RemoteWithVideoCall;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(h.Z,{sx:{display:"flex",flexDirection:"column",justifyContent:"flex-start",gap:1,p:1,width:"100vw",height:"100vh",maxWidth:"100vw",maxHeight:"100vh",overflowX:"hidden",overflowY:"hidden"},children:[(0,a.jsx)(eF,{}),(0,a.jsx)(ee,{}),(0,a.jsxs)(h.Z,{sx:{flexGrow:1,flexBasis:"100%",maxHeight:"100%",overflowY:"hidden",display:"flex",flexDirection:"row",gap:1},children:[(0,a.jsx)(h.Z,{sx:{width:"50%",height:"100%",maxHeight:"100%",display:"flex",flexDirection:"column"},children:(0,a.jsx)(ek.Z,{title:"Participant view",tools:w,sx:{flexGrow:1},children:g.presentation})}),(0,a.jsx)(h.Z,{sx:{width:"50%",display:"block",overflow:"hidden"},children:(0,a.jsxs)(h.Z,{sx:{maxHeight:"100%",height:"100%",width:"100%",maxWidth:"100%",display:"flex",flexDirection:"column",gap:1},children:[C&&(0,a.jsx)(ew.ikO,{logger:v,children:(0,a.jsx)(ew.BAg,{children:(0,a.jsx)(ew.lUb,{children:(0,a.jsx)(ek.Z,{sx:{minHeight:"40vh",flexGrow:1},children:(0,a.jsxs)(h.Z,{sx:{width:"100%",height:"100%",display:"flex",flexDirection:"row"},children:[(0,a.jsx)(ey,{orientation:"vertical",showLabels:!1}),(0,a.jsx)(eZ.Z,{role:s.role,facilitationState:o.facilitationState,sid:r.sid,sessionToken:s.sessionToken,accessToken:s.user.access_token,participantId:s.deviceId,participantName:null===(e=m.thisUser)||void 0===e?void 0:e.participantName,initialCallPreferences:j.call,sx:{flexGrow:1}})]})})})})}),(null==d?void 0:null===(n=d.data.qids)||void 0===n?void 0:n.length)>0&&(0,a.jsx)(ek.Z,{title:"Votes",scrolling:!1,children:(0,a.jsx)(h.Z,{sx:{display:"flex",flexDirection:"row",flexWrap:"wrap"},children:null===(t=d.data.qids)||void 0===t?void 0:t.map(e=>(0,a.jsx)(h.Z,{sx:{width:d.data.qids.length>1?"50%":"100%"},children:(0,a.jsx)(ev,{sid:r.sid,qid:e})},"slide-".concat(d.data.index,"-answer-monitor-").concat(e)))})}),(null==d?void 0:d.data.secs)!==void 0&&d.data.secs>0&&(0,a.jsx)(ek.Z,{scrolling:!1,children:(0,a.jsx)(eD,{data:d.data})}),(0,a.jsx)(ek.Z,{title:"Notes",scrolling:!0,sx:{flexGrow:C?void 0:1,minHeight:"25vh"},children:(0,a.jsx)(et,{notes:d.data.notes})})]})})]})]}),(0,a.jsx)(h.Z,{sx:{position:"fixed",left:4,bottom:4},children:(0,a.jsx)(eI.Z,{})})]})}var eA=t(82297);function eO(e){return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(eA.Z,{sid:e.sid,joinCode:e.joinCode,refresh:e.refresh,role:c._b.Controller,children:[(0,a.jsx)(d.Z,{}),(0,a.jsx)(eP,{})]})})}var eU=t(16463);function eN(){let e=(0,eU.useSearchParams)(),n=e.get("sid"),t=e.get("code"),i="true"===e.get("refresh");return null===n||null===t?(0,a.jsx)("p",{children:"Missing session id or join code"}):(0,a.jsx)(l.Z,{searchParams:e,children:(0,a.jsx)(eO,{sid:n,joinCode:t,refresh:i})})}},10105:function(e,n,t){"use strict";t.d(n,{k:function(){return s},v:function(){return i}});let i=e=>"".concat(window.location.href.split("/")[0],"//").concat(window.location.href.split("/")[2],"/participant/session?sid=").concat(e.id,"&code=").concat(e.joinCode),s=e=>"".concat(window.location.href.split("/")[0],"//").concat(window.location.href.split("/")[2],"/facilitator/session?sid=").concat(e.id,"&code=").concat(e.joinCode)}},function(e){e.O(0,[49,908,444,866,221,732,887,403,465,810,516,811,610,247,758,971,23,744],function(){return e(e.s=59870)}),_N_E=e.O()}]);