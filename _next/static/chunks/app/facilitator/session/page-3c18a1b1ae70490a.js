(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5044],{59870:function(e,t,n){Promise.resolve().then(n.bind(n,81661))},81661:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return eG}});var i,o,s,r,a=n(57437),l=n(53622),c=n(63858),d=n(94547),u=n(78364),x=n(11144),p=n(4766),h=n(93191),f=n(31193),m=n(2265),g=n(2215);let j={0:{columns:1,rows:1},1:{columns:1,rows:1},2:{columns:1,rows:2},3:{columns:1,rows:3},4:{columns:2,rows:2},5:{columns:2,rows:3},6:{columns:2,rows:3},7:{columns:2,rows:4},8:{columns:2,rows:4},9:{columns:3,rows:3},10:{columns:3,rows:4},11:{columns:3,rows:4},12:{columns:3,rows:4},13:{columns:4,rows:4},14:{columns:4,rows:4},15:{columns:4,rows:4},16:{columns:4,rows:4}};function v(){let{tiles:e}=(0,m.useContext)(g.fp),[t,n]=(0,m.useState)({rows:1,columns:1});return(0,m.useEffect)(()=>{let t=e.length;if(t<=16)n({rows:j[t].rows,columns:j[t].columns});else{let e=Math.ceil(Math.sqrt(t));n({rows:e,columns:Math.ceil(t/e)})}},[e]),(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(f.Z,{sx:{width:"100%",height:"100%",display:"grid",gap:1,gridTemplateRows:"repeat(".concat(t.rows,", 1fr)"),gridTemplateColumns:"repeat(".concat(t.columns,", 1fr)")},children:e})})}var w=n(43670),b=n(17882),y=n(78135),Z=n(80511);function C(e){return(0,a.jsxs)(f.Z,{sx:{display:"flex",flexDirection:"column",background:"white",borderRadius:2,p:1,...e.sx},children:[(e.title||e.tools)&&(0,a.jsxs)(f.Z,{sx:{display:"flex",flexDirection:"row",justifyContent:"space-between",mb:1},children:[e.title&&(0,a.jsx)(Z.Z,{variant:"h6",children:e.title}),e.tools]}),(0,a.jsx)(f.Z,{sx:{flexGrow:1,overflowY:"hidden"},children:(0,a.jsx)(f.Z,{sx:{width:"100%",height:"100%",overflowY:e.scrolling?"auto":"hidden"},children:e.children})})]})}var S=n(56019);let k=e=>"".concat(Math.floor(e/60).toString().padStart(2,"0"),":").concat((e%60).toString().padStart(2,"0"),":00"),I=e=>{let t=Math.floor(e/36e5),n=Math.floor((e-=36e5*t)/6e4),i=Math.floor((e-=6e4*n)/1e3);return e-=1e3*i,"".concat(t.toString().padStart(2,"0"),":").concat(n.toString().padStart(2,"0"),":").concat(i.toString().padStart(2,"0"))};function E(){let{session:e}=(0,m.useContext)(x.z),[t,n]=(0,m.useState)({}),[i,o]=(0,m.useState)(""),s=(0,m.useRef)();(0,m.useEffect)(()=>{n({startTime:function(e){if(e)return new Date(e)}(e.sessionStartedAt),duration_mins:e.sessionDurationMins})},[e]),(0,m.useEffect)(()=>(t.startTime?(s.current&&clearInterval(s.current),s.current=setInterval(r,1e3),r()):o(t.duration_mins?k(t.duration_mins):"Unknown"),()=>{s.current&&clearInterval(s.current)}),[t]);let r=(0,m.useCallback)(()=>{if(t.startTime){let e=new Date().getTime()-t.startTime.getTime();t.duration_mins&&(e=Math.max(6e4*t.duration_mins-e,0)),o(I(e))}else o(t.duration_mins?k(t.duration_mins):"Unknown")},[t]);return(0,a.jsxs)(f.Z,{sx:{display:"flex",flexDirection:"row",gap:1,alignItems:"center"},children:[(0,a.jsx)("img",{src:"/icons/clock.svg",style:{height:"1.25rem",width:"auto"}}),(0,a.jsx)(Z.Z,{variant:"body1",children:i})]})}var _=n(60658),D=n(65301);(i=s||(s={}))[i.Ready=0]="Ready",i[i.InitError=1]="InitError",i[i.Recording=2]="Recording",i[i.Saving=3]="Saving",i[i.UploadSuccess=4]="UploadSuccess",i[i.UploadError=5]="UploadError";var R=n(5085),F=n(23447),A=n(15785),P=n(83040),U=n(96537),O=n(18502),T=n(24072),N=n(76396);function q(e){let t=(0,m.useId)();return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(T.ZP,{variant:"popover",popupId:t,children:t=>{var n,i,o;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(U.Z,{startIcon:!1!==e.startIcon?e.startIcon:void 0,endIcon:null!==(n=e.endIcon)&&void 0!==n?n:(0,a.jsx)(P.Z,{color:"action"}),variant:"text",color:"buttonStandard","aria-label":e.ariaLabel,sx:e.sx,...(0,N.LI)(t),children:e.text}),(0,a.jsx)(O.ZP,{...(0,N.ZW)(t),anchorOrigin:null!==(i=e.anchorOrigin)&&void 0!==i?i:{vertical:"bottom",horizontal:"center"},transformOrigin:null!==(o=e.transformOrigin)&&void 0!==o?o:{vertical:"top",horizontal:"center"},children:(0,a.jsx)(f.Z,{sx:{p:2},children:e.children})})]})}})})}var M=n(63375),V=n(22960);let W=(e,t)=>{var n;return"".concat(null!==(n=t.recordingId)&&void 0!==n?n:"slide-"+"".concat(null!=e?e:0).padStart(3,"0"))};function z(){let{api:e,start:t}=(0,m.useContext)(F.E),{session:n}=(0,m.useContext)(x.z),i=(0,m.useContext)(R.rZ),{slideIndex:o,slideData:s}=(0,m.useContext)(p.X),[r,l]=(0,m.useState)(!1),[c,u]=(0,m.useState)(!1);(0,m.useEffect)(()=>{l(n.facilitationState===d._y.Open&&n.remoteConfiguration===d.VS.InPerson&&s.activity===A.S.deliberation),u(n.facilitationState===d._y.Open&&n.remoteConfiguration===d.VS.InPerson&&(s.activity===A.S.deliberation||void 0!==s.recordingId))},[s.activity,n.facilitationState,n.remoteConfiguration]);let[h,g]=(0,m.useState)(W(o,s)),[j,v]=(0,m.useState)(!1),[w,b]=(0,m.useState)(!1),[y,C]=(0,m.useState)(!1),{record:S,stop:k,isRecording:I,recordingTime:E,audioBlob:O,filenamePart:T,filenameSuffix:N,clearRecording:z}=function(){let[e,t]=(0,m.useState)(0),[n,i]=(0,m.useState)(void 0),[o,s]=(0,m.useState)(),{startRecording:r,stopRecording:a,togglePauseResume:l,recordingBlob:c,isRecording:d,isPaused:u,recordingTime:x,mediaRecorder:p}=(0,D.I)({noiseSuppression:!0,autoGainControl:!0},e=>{t(1)},{mimeType:"audio/webm"}),h=e=>"audio-recording-".concat(e);return(0,m.useEffect)(()=>{t(d?2:0)},[d]),(0,m.useEffect)(()=>{void 0!==c&&i(c)},[c]),{record:e=>{s(h(e)),r()},stop:()=>{a()},state:e,audioBlob:n,recordingTime:x,isRecording:d,filenamePart:o,filenameSuffix:"webm",clearRecording:()=>{i(void 0),s(void 0)}}}();(0,m.useEffect)(()=>{I&&(console.debug("Stopping recording due to slide change."),k()),g(W(o,s))},[o]),(0,m.useEffect)(()=>{v(I),I&&C(!1)},[I]),(0,m.useEffect)(()=>{I||void 0===O||void 0===T||G()},[O]);let G=()=>{if(void 0===O||void 0===T){console.debug("Audio blob or filename part empty. Skipping upload.");return}if(0===O.size){console.debug("Audio recording is empty. Skipping upload.");return}console.debug("Initiating upload for recording: <guid>-".concat(T,"-<guid>.").concat(N)),C(!1),b(!0),L(O,T,N).then(()=>{console.debug("Upload complete"),C(!1),z()}).catch(e=>{console.error("Upload failed",e),C(!0)}).finally(()=>{b(!1)})},L=async(o,s,r)=>{console.debug("Retrieving recording upload info...");let a=await t(e.getMediaUploadUrl(n.id,i.sessionToken,i.user.access_token,"deliberation",s,r));console.debug("Uploading recording...",a),await t((0,_.P)(o,a.uploadUrl,!0,"uploading recording")),console.debug("Upload recording complete.")},K=()=>{if(void 0===O||0===O.size){console.debug("Audio blob empty. Skipping download.");return}let e="recording-".concat(null!=T?T:"unknown",".").concat(N);console.debug("Downloading audio recording..."),function(e,t){let n=URL.createObjectURL(e),i=document.createElement("a");i.href=n,i.download=t;try{document.body.appendChild(i),i.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window}))}catch(e){console.error("Error downloading blob",e)}finally{document.body.removeChild(i)}}(O,e)},B=(0,V.Z)(),Y=j||w||y;return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(q,{startIcon:Y&&(0,a.jsx)(M.Z,{htmlColor:j?B.palette.recordingEnabled.main:w?B.palette.recordingUploading.main:y?B.palette.recordingFailed.main:B.palette.recordingDisabled.main}),endIcon:(0,a.jsx)(P.Z,{color:"action"}),sx:{opacity:r?1:.3},text:"Recording: ".concat(j?"Active":w?"Uploading...":y?"Upload error":"Inactive"),ariaLabel:"Recording information",children:(0,a.jsxs)(f.Z,{sx:{display:"flex",flexDirection:"column",gap:1},children:[!I&&(0,a.jsx)(U.Z,{variant:r?"contained":"outlined",color:r?"primary":"buttonStandard",onClick:()=>S(h),children:"Start Recording"}),I&&(0,a.jsx)(U.Z,{variant:"outlined",color:"buttonStandard",onClick:()=>k(),children:"Stop Recording"}),s.recordingId&&(0,a.jsxs)(Z.Z,{variant:"body2",children:["Recording id: ",h,(0,a.jsx)("br",{})]}),I&&(0,a.jsxs)(Z.Z,{variant:"body2",sx:{fontSize:"0.5rem"},children:["Recording: ",E]}),y&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(f.Z,{sx:{display:"flex",flexDirection:"row",gap:1,alignItems:"center"},children:[(0,a.jsx)(M.Z,{htmlColor:B.palette.recordingFailed.main}),(0,a.jsx)(Z.Z,{variant:"body1",children:"Recording upload failed"})]}),(0,a.jsx)(Z.Z,{variant:"body2",children:"The recording could not be uploaded."}),O&&T&&N&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(U.Z,{variant:"outlined",color:"buttonStandard",onClick:()=>G(),children:"Retry upload"}),(0,a.jsx)(U.Z,{variant:"outlined",color:"buttonStandard",onClick:()=>K(),children:"Download audio"})]})]})]})})})}var G=n(70883),L=n(44228),K=n(9646),B=n(10105),Y=n(79393);function H(e){var t;let n=e.message instanceof Error?e.message.message:e.message;return(0,a.jsx)(Y.Z,{open:e.show,autoHideDuration:null!==(t=e.autoHideDuration)&&void 0!==t?t:3e3,onClose:()=>e.setShow(!1),message:(0,a.jsxs)(f.Z,{sx:{display:"flex",flexDirection:"row",gap:1,alignItems:"center"},children:[e.icon,n]})})}function X(e){let[t,n]=(0,m.useState)(!1),i=()=>{var t;null===(t=navigator)||void 0===t||t.clipboard.writeText((0,B.v)(e.session)),n(!0)};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(K.Z,{sx:{alignSelf:"flex-end"},variant:"outlined",onClick:()=>{i()},btnText:"Copy participant link",btnKey:"copy-participant-link"}),(0,a.jsx)(H,{show:t,setShow:n,message:"Copied participant link to clipboard.",icon:(0,a.jsx)(L.Z,{})})]})}var J=n(40395),$=n(60335),Q=n(21395),ee=n(42748),et=n(11656),en=n(47905),ei=n(86917),eo=n(58433),es=n(14874),er=n(6722);function ea(){let{session:e}=(0,m.useContext)(x.z),{subscriptions:t,thisUser:n}=(0,m.useContext)(G.l),{api:i,start:o}=(0,m.useContext)(F.E),{user:s,sessionToken:r}=(0,m.useContext)(R.rZ),[l,c]=(0,m.useState)([]),[u,p]=(0,m.useState)(!1),h=(0,es.Z)(),g=async()=>{try{p(!0);let t={action:"mute",sessionId:e.id,ticks:Date.now(),parameters:{pids:["*"]}};o(i.postFacilitatorAction(s.access_token,r,t,!1))}finally{p(!1)}},j=async(t,n)=>{try{p(!0);let t={action:"mute",sessionId:e.id,ticks:Date.now(),parameters:{pids:[n.deviceId]}};o(i.postFacilitatorAction(s.access_token,r,t,!1))}catch(e){console.warn(e)}finally{p(!1)}},v=async(t,n)=>{try{p(!0);let t={action:"kick",sessionId:e.id,ticks:Date.now(),parameters:{pid:n.deviceId}};o(i.postFacilitatorAction(s.access_token,r,t,!1))}catch(e){console.warn(e)}finally{p(!1)}},w=t=>{var n,i;let{subscription:o}=t,s=I(o),r=null!==(i=null===(n=e.deviceIdBanList)||void 0===n?void 0:n.includes(o.deviceId))&&void 0!==i&&i;return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(f.Z,{sx:{width:"100%",height:"100%",display:"flex",flexDirection:"row",gap:1,alignItems:"center",opacity:r?.5:1},children:[(0,a.jsx)(k,{connected:!r&&o.enabled}),(0,a.jsxs)(Z.Z,{variant:"h6",component:"span",sx:{flexGrow:1},children:[s,r?" (banned)":void 0]})]})})},b=t=>{var n,i,o;let{subscription:s}=t,{roster:r}=(0,er.dJs)(),l=r?null===(n=Object.entries(r).find(e=>{let[t,n]=e;return n.externalUserId===s.deviceId}))||void 0===n?void 0:n[1]:void 0,c=I(s),d=null!==(o=null===(i=e.deviceIdBanList)||void 0===i?void 0:i.includes(s.deviceId))&&void 0!==o&&o;return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(f.Z,{sx:{width:"100%",height:"100%",display:"flex",flexDirection:"row",gap:1,alignItems:"center",opacity:d?.5:1},children:[(0,a.jsx)(k,{connected:!d&&s.enabled}),(0,a.jsxs)(Z.Z,{variant:"h6",component:"span",sx:{flexGrow:1},children:[c,d?" (banned)":void 0]}),l&&!d&&(0,a.jsx)(y,{attendee:l,subscription:s})]})})},y=e=>{let{attendee:t,subscription:i}=e;return(0,a.jsx)(a.Fragment,{children:i.subscriptionId!==(null==n?void 0:n.subscriptionId)&&(0,a.jsx)(C,{attendee:t,subscription:i})})},C=e=>{let{attendee:t,subscription:n}=e;return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(T.ZP,{variant:"popover",popupId:"attendee-controls-menu-items-".concat(n.subscriptionId),children:e=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)($.Z,{"aria-label":"settings",...(0,N.vW)(e),children:(0,a.jsx)("img",{src:"/icons/triple-dots-vertical.svg"})}),(0,a.jsx)(Q.Z,{...(0,N.wK)(e),children:(0,a.jsx)(S,{attendee:t,subscription:n,requestClose:e.close})})]})})})},S=e=>{let{attendee:t,subscription:n,requestClose:i}=e,[o,s]=(0,m.useState)(!1),r=(0,er.ZzJ)(t.chimeAttendeeId).muted;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(ee.Z,{children:[(0,a.jsx)(et.Z,{children:(0,a.jsx)(en.Z,{children:(0,a.jsx)("b",{children:n.participantName})})},"attendee-control-menu-header-".concat(n.subscriptionId)),(0,a.jsxs)(et.Z,{disabled:u||r,onClick:r?void 0:()=>{i(),j(t,n)},children:[(0,a.jsx)(ei.Z,{children:r?(0,a.jsx)("img",{src:"/icons/controls/participant-muted.svg"}):(0,a.jsx)("img",{src:"/icons/controls/mute-participant.svg"})}),(0,a.jsx)(en.Z,{inset:!1,children:r?"Participant muted":"Mute participant"})]},"attendee-control-menu-item-".concat(n.subscriptionId,"-mute")),(0,a.jsxs)(et.Z,{disabled:u,onClick:()=>{s(!0)},children:[(0,a.jsx)(ei.Z,{children:(0,a.jsx)("img",{src:"/icons/controls/remove-participant.svg"})}),(0,a.jsx)(en.Z,{inset:!1,children:"Remove participant"})]},"attendee-control-menu-item-".concat(n.subscriptionId,"-kick"))]}),(0,a.jsx)(J.Z,{prompt:"Remove the participant from the call?",options:[{key:"kick",text:"Remove participant",filled:!0},{key:"cancel",text:"Cancel",filled:!1}],onSelect:e=>{"kick"===e&&v(t,n)},open:o,setOpen:s,onClose:i})]})},k=e=>{let{connected:t}=e;return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(f.Z,{sx:{p:1,borderRadius:4,height:42,background:t?h.palette.connected.main:h.palette.disconnected.main},children:(0,a.jsx)("img",{style:{height:26,margin:0,padding:0},src:t?"/icons/device-connected.svg":"/icons/device-disconnected.svg"})})})},I=e=>{let t=e.subscriptionId===(null==n?void 0:n.subscriptionId)?"(You) ":"",i=e.participantName&&e.participantName.length>0?e.participantName:"Unknown";return"".concat(t).concat(i)};return(0,m.useEffect)(()=>{c([...t].sort((e,t)=>e.role===t.role?0:e.role===d._b.Controller?-1:t.role===d._b.Controller?1:e.participantName.localeCompare(t.participantName)))},[t]),(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(f.Z,{sx:{display:"flex",flexDirection:"column",gap:4},children:[(0,a.jsxs)(f.Z,{sx:{display:"flex",flexDirection:"row",gap:1,justifyContent:"flex-end"},children:[e.remoteConfiguration===d.VS.RemoteWithVideoCall&&(0,a.jsx)(K.Z,{variant:"outlined",startIcon:(0,a.jsx)("img",{src:"/icons/controls/participant-muted.svg"}),btnKey:"mute-all",btnText:"Mute all",sx:{alignSelf:"flex-end"},busy:u,onClick:e=>{g()}}),(0,a.jsx)(X,{session:e})]}),(0,a.jsx)(eo.ZP,{container:!0,spacing:2,children:l.map(t=>(0,a.jsxs)(eo.ZP,{item:!0,xs:6,children:[e.remoteConfiguration===d.VS.RemoteWithVideoCall&&(0,a.jsx)(b,{subscription:t}),e.remoteConfiguration!==d.VS.RemoteWithVideoCall&&(0,a.jsx)(w,{subscription:t})]},"participant-subscription-indicator-".concat(t.subscriptionId)))})]})})}function el(){let{subscriptions:e,thisUser:t}=(0,m.useContext)(G.l);return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(q,{startIcon:(0,a.jsx)("img",{src:"/icons/session-participants.svg",style:{height:"1.45rem",width:"auto"}}),text:"".concat(e.filter(e=>e.deviceId!==(null==t?void 0:t.deviceId)).length," participants"),children:(0,a.jsx)(f.Z,{sx:{width:"55vw"},children:(0,a.jsx)(ea,{})})})})}var ec=n(8260),ed=n(35231),eu=n(50467),ex=n(2842),ep=n(9542),eh=n(13971);function ef(e){let{colours:t,data:n}=e,i=e=>{let t={true:{l:!0,r:!1},false:{l:!1,r:!0}};return 0===e.true&&(t.false.l=!0),0===e.false&&(t.true.r=!0),t},[o,s]=(0,m.useState)(i(n));(0,m.useEffect)(()=>{s(i(n))},[n]);let r=e=>[e.l?16:0,e.r?16:0,e.r?16:0,e.l?16:0];return(0,a.jsx)(ed.h,{width:"100%",height:40,children:(0,a.jsxs)(eu.v,{layout:"vertical",margin:{left:0,right:0},height:40,data:[{name:"completion",complete:n.true,incomplete:n.false}],children:[(0,a.jsx)(ex.K,{hide:!0,type:"number",max:n.true+n.false}),(0,a.jsx)(ep.B,{hide:!0,dataKey:"name",type:"category"}),(0,a.jsx)(eh.$,{dataKey:"complete",stackId:"completion",fill:t[0],radius:r(o.true)}),(0,a.jsx)(eh.$,{dataKey:"incomplete",stackId:"completion",fill:t[1],radius:r(o.false)})]})})}var em=n(37570),eg=n(37552),ej=n(79617),ev=n(51847),ew=n(33578);(o=r||(r={}))[o.NotAnswered=0]="NotAnswered",o[o.Answered=1]="Answered";let eb=(e,t,n)=>{var i,o;let s=null!==(o=ey(null!==(i=n?null==e?void 0:e.filter(e=>e.questionId===n):e)&&void 0!==i?i:[]))&&void 0!==o?o:[],r=s.length,a=t.filter(e=>e.enabled&&e.role===d._b.Client),l=a.filter(e=>!s.find(t=>t.participantId===e.deviceId)),c=s.length+l.length;return{allAnswers:s,relevantParticipants:a,answeredCount:r,participantsWithoutAnswers:l,maxAnswers:c,complete:r===c}},ey=e=>null==e?void 0:e.sort((e,t)=>new Date(e.created).getTime()-new Date(t.created).getTime()),eZ=(e,t)=>{var n;return[...e.allAnswers.map((e,n)=>({description:eC(e,t),answered:1})),...null!==(n=e.participantsWithoutAnswers.map(e=>({description:eS(e),answered:0})))&&void 0!==n?n:[]]},eC=(e,t)=>eS(t.find(t=>t.deviceId===e.participantId)),eS=e=>{var t,n;return null!==(n=null!==(t=null==e?void 0:e.participantName)&&void 0!==t?t:null==e?void 0:e.deviceName)&&void 0!==n?n:"Unknown"};function ek(e){let{sid:t}=(0,m.useContext)(em.H),{answers:n}=(0,ec.ZP)(e.qid),i=(0,m.useContext)(G.l),[o,s]=(0,m.useState)(i.subscriptions),[r,l]=(0,m.useState)(eb(n,o,e.qid)),[c,d]=(0,m.useState)([]);(0,m.useEffect)(()=>{s(i.subscriptions)},[i]),(0,m.useEffect)(()=>{l(eb(n,o))},[n,o]),(0,m.useEffect)(()=>{d(eZ(r,o))},[r,o]);let u=e=>(0,a.jsxs)(f.Z,{sx:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",borderRadius:2,background:"white",border:"1px solid #EFEFEF",p:2},children:[(0,a.jsx)(Z.Z,{variant:"body1",sx:{borderRight:"1px solid black",overflowX:"scroll",textWrap:"nowrap",flexGrow:1,mr:.5,pr:.5},children:e.description}),1===e.answered&&(0,a.jsx)("img",{src:"/icons/checkbox-filled.svg"}),1!==e.answered&&(0,a.jsx)("img",{src:"/icons/checkbox.svg"})]}),x=(0,es.Z)();return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(f.Z,{sx:{display:"flex",flexDirection:"column",gap:1,alignItems:"stretch"},children:[e.qid&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(f.Z,{sx:{display:"flex",flexDirection:"row",gap:1,alignItems:"center"},children:[(0,a.jsx)("img",{src:"/icons/busts.svg",style:{height:"1.5rem",width:"auto"}}),(0,a.jsxs)(Z.Z,{variant:"body1",children:[e.label&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("b",{children:[e.label,":"]})," "]}),"".concat(r.answeredCount," of ").concat(r.maxAnswers," ")," ",1!==r.answeredCount?"have":"has"," voted"]})]}),(0,a.jsxs)(ej.Z,{elevation:0,disableGutters:!0,sx:{"&:before":{display:"none"}},children:[(0,a.jsxs)(ev.Z,{expandIcon:(0,a.jsx)(eg.Z,{}),sx:{p:0},children:[r.answeredCount+r.participantsWithoutAnswers.length>0&&(0,a.jsx)(ef,{colours:[x.palette.primary.main,"#ededff"],data:{true:r.answeredCount,false:r.participantsWithoutAnswers.length}}),r.answeredCount+r.participantsWithoutAnswers.length===0&&(0,a.jsx)(ef,{colours:[x.palette.primary.main,"#ededff"],data:{true:0,false:100}})]}),(0,a.jsx)(ew.Z,{sx:{p:0},children:(0,a.jsx)(eo.ZP,{container:!0,spacing:1,sx:{mb:2},children:c.map((t,n)=>(0,a.jsx)(eo.ZP,{item:!0,xs:12,sm:6,md:4,children:(0,a.jsx)(u,{description:t.description,answered:t.answered})},"answer-indicator-grid-item-".concat(e.qid,"-").concat(n)))})})]})]}),!e.qid&&(0,a.jsx)(Z.Z,{variant:"body1",children:"Not a polling slide"})]})})}function eI(){let{slideData:e}=(0,m.useContext)(p.X),{subscriptions:t}=(0,m.useContext)(G.l),{allAnswers:n}=(0,ec.ZP)(),[i,o]=(0,m.useState)(!1),[s,r]=(0,m.useState)({}),[l,c]=(0,m.useState)(!1),[d,u]=(0,m.useState)();(0,m.useEffect)(()=>{o(e.qids.length>0)},[e]),(0,m.useEffect)(()=>{r(Object.fromEntries(e.qids.map(e=>[e,eb(n[e],t,e)])))},[n,e,t]),(0,m.useEffect)(()=>{c(Object.values(s).every(e=>e.complete))},[s]);let x=(0,V.Z)();return(0,m.useEffect)(()=>{let e=l?x.palette.pollingComplete.main:x.palette.pollingInProgress.main;u(i?{icon:(0,a.jsx)(M.Z,{htmlColor:e}),text:l?"Polling complete":"Polling in progress"}:void 0)},[l,i]),(0,a.jsx)(a.Fragment,{children:i&&d&&(0,a.jsx)(q,{startIcon:d.icon,text:d.text,sx:{backgroundColor:x.palette.pollingInProgressBackground.main},children:(0,a.jsx)(f.Z,{sx:{width:"55vw",display:"flex",flexDirection:"column",gap:1},children:e.qids.map((t,n)=>{let i=e.qids.length>1?0===n?"First question":n===e.qids.length-1?"Last question":void 0:void 0;return(0,a.jsx)(ek,{qid:t,label:i},"facilitator-polling-monitor-".concat(t,"-").concat(n))})})})})}function eE(){let{sessionToken:e,user:t}=(0,m.useContext)(R.rZ),{session:n}=(0,m.useContext)(x.z),{api:i,start:o}=(0,m.useContext)(F.E),[s,r]=(0,m.useState)(!1),[l,c]=(0,m.useState)(!1),[u,p]=(0,m.useState)({key:"",text:"Please wait...",variant:"outlined"});(0,m.useEffect)(()=>{switch(n.facilitationState){case d._y.Ready:p({key:"open-session",text:"Open workshop",variant:"contained"});break;case d._y.Open:p({key:"close-session",text:"Close workshop",variant:"outlined"});break;case d._y.Closed:p({key:"open-waiting",text:"Open waiting room",variant:"contained"})}},[n]);let h=async s=>{try{r(!0);var a={action:s===d._y.Open?"open":s===d._y.Ready?"reset":"close",sessionId:n.id,ticks:Date.now()};await o(i.postFacilitatorAction(t.access_token,e,a))}catch(e){console.error(e)}finally{r(!1)}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(K.Z,{busy:s,variant:u.variant,btnKey:u.key,btnText:u.text,onClick:e=>{switch(e){case"open-waiting":h(d._y.Ready);break;case"open-session":h(d._y.Open);break;case"close-session":c(!0);break;default:console.warn("Unexpected facilitation switch from menu.")}}}),(0,a.jsx)(J.Z,{open:l,setOpen:c,prompt:"Are you sure you want to close the workshop?",onSelect:e=>{"close"===e&&h(d._y.Closed)},options:[{key:"close",text:"Close",filled:!0},{key:"cancel",text:"Cancel",filled:!1}]})]})}function e_(){let{session:e}=(0,m.useContext)(x.z);return(0,a.jsxs)(f.Z,{sx:{width:"100%",display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",background:"white",p:1,borderRadius:2},children:[(0,a.jsx)(t=>{let{showBadge:n}=t;return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(f.Z,{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",children:[(0,a.jsx)("img",{src:"/icons/home.svg",style:{height:"2rem",width:"auto",verticalAlign:"middle",marginRight:12,paddingBottom:4}}),n&&(0,a.jsx)(S.Z,{color:"primary",badgeContent:d._y[e.facilitationState],anchorOrigin:{vertical:"bottom",horizontal:"right"},children:(0,a.jsx)(Z.Z,{variant:"h5",component:"h1",children:e.sessionName})}),!n&&(0,a.jsx)(Z.Z,{variant:"h5",component:"h1",children:e.sessionName})]})})},{showBadge:!1}),(0,a.jsxs)(f.Z,{sx:{flexGrow:1,display:"flex",flexDirection:"row",justifyContent:"flex-end",alignItems:"center",gap:4},children:[(0,a.jsx)(eI,{}),(0,a.jsx)(z,{}),(0,a.jsx)(el,{}),(0,a.jsx)(E,{}),(0,a.jsx)(eE,{})]})]})}function eD(e){let{notes:t}=e;return(0,a.jsx)("div",{dangerouslySetInnerHTML:{__html:t}})}var eR=n(7630),eF=n(69065),eA=n(80824),eP=n(66124);function eU(e){let{session:t}=(0,m.useContext)(x.z),[n,i]=(0,m.useState)(!1),[o,s]=(0,m.useState)(!1),[r,l]=(0,m.useState)(!1);return(0,m.useEffect)(()=>{s(t.facilitationState===d._y.Open)},[t.facilitationState]),(0,m.useEffect)(()=>{l(t.remoteConfiguration===d.VS.InPerson)},[t.remoteConfiguration]),(0,m.useEffect)(()=>{i(o&&r)},[o,r]),(0,a.jsxs)(eF.Z,{fullWidth:!0,maxWidth:"sm",open:n,onClose:()=>i(!1),children:[(0,a.jsxs)(eA.Z,{children:["The workshop is now open",(0,a.jsx)(f.Z,{style:{position:"absolute",top:0,right:0},children:(0,a.jsx)($.Z,{"aria-label":"close",onClick:()=>i(!1),children:(0,a.jsx)(eR.Z,{})})})]}),(0,a.jsx)(eP.Z,{children:(0,a.jsxs)(f.Z,{sx:{display:"flex",flexDirection:"column",gap:2},children:[(0,a.jsxs)("ul",{children:[o&&(0,a.jsx)("li",{children:"Participants will now be able to enter the session"}),r&&(0,a.jsxs)("li",{children:["A test of the audio recording capability is available, but relevant sections will ",(0,a.jsx)("u",{children:"not"})," be automatically recorded"]})]}),(0,a.jsx)(U.Z,{variant:"contained",sx:{alignSelf:"center",textTransform:"uppercase"},onClick:()=>i(!1),children:"Continue"})]})})]})}let eO=e=>e.remoteConfiguration===d.VS.RemoteWithVideoCall?"left":"right",eT=e=>e.remoteConfiguration===d.VS.RemoteWithVideoCall,eN=e=>e.remoteConfiguration!==d.VS.RemoteWithVideoCall;function eq(){let{presentation:e,previews:t}=(0,m.useContext)(h.N),{slideData:n}=(0,m.useContext)(p.X),{session:i}=(0,m.useContext)(x.z),o=(0,m.useContext)(y.ui),[s,r]=(0,m.useState)(eN(i)),[l,c]=(0,m.useState)(eT(i)),[u,j]=(0,m.useState)(eO(i));return(0,m.useEffect)(()=>{r(eN(i)),c(eT(i)),j(eO(i))},[i]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(f.Z,{sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column",gap:1,p:1,overflow:"hidden"},children:[(0,a.jsx)(f.Z,{children:(0,a.jsx)(e_,{})}),(0,a.jsxs)(f.Z,{sx:{flexGrow:1,display:"flex",flexDirection:"row",gap:1,overflowY:"hidden"},children:[(0,a.jsxs)(f.Z,{sx:{display:"flex",flexDirection:"column",width:"50vw",gap:1,flexShrink:0},children:[(0,a.jsx)(C,{sx:{flexGrow:1,overflow:"hidden",minHeight:"50vh"},children:e}),s&&(0,a.jsx)(C,{children:t}),"left"===u&&(0,a.jsx)(f.Z,{sx:{flexGrow:1,display:"block",overflowY:"hidden"},children:(0,a.jsx)(C,{scrolling:!0,sx:{height:"100%"},children:(0,a.jsx)(eD,{notes:n.notes})})})]}),(0,a.jsxs)(f.Z,{sx:{flexGrow:1,width:"100%",height:"100%",display:"flex",flexDirection:"column",gap:1},children:[l&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(f.Z,{sx:{flexGrow:1},children:(0,a.jsx)(w.Z,{initialCallPreferences:o.call,sx:{width:"100%",height:"100%"},children:(0,a.jsx)(g.ZP,{role:d._b.Controller,children:(0,a.jsx)(v,{})})})}),(0,a.jsx)(b.Z,{orientation:"row"})]}),"right"===u&&(0,a.jsx)(f.Z,{sx:{flexGrow:1,display:"block",overflowY:"hidden"},children:(0,a.jsx)(C,{scrolling:!0,sx:{height:"100%"},children:(0,a.jsx)(eD,{notes:n.notes})})})]})]})]}),(0,a.jsx)(eU,{})]})}var eM=n(96608),eV=n(28356);function eW(e){return(0,a.jsx)(a.Fragment,{children:c.UA?(0,a.jsx)(eM.Z,{}):(0,a.jsxs)(eV.Z,{sid:e.sid,joinCode:e.joinCode,refresh:e.refresh,role:d._b.Controller,children:[(0,a.jsx)(u.Z,{}),(0,a.jsx)(eq,{})]})})}var ez=n(16463);function eG(){let e=(0,ez.useSearchParams)(),t=e.get("sid"),n=e.get("code"),i="true"===e.get("refresh");return null===t||null===n?(0,a.jsx)("p",{children:"Missing session id or join code"}):(0,a.jsx)(l.Z,{searchParams:e,children:(0,a.jsx)(eW,{sid:t,joinCode:n,refresh:i})})}},10105:function(e,t,n){"use strict";n.d(t,{k:function(){return o},v:function(){return i}});let i=e=>"".concat(window.location.href.split("/")[0],"//").concat(window.location.href.split("/")[2],"/participant/session?sid=").concat(e.id,"&code=").concat(e.joinCode),o=e=>"".concat(window.location.href.split("/")[0],"//").concat(window.location.href.split("/")[2],"/facilitator/session?sid=").concat(e.id,"&code=").concat(e.joinCode)}},function(e){e.O(0,[2908,6444,6221,1866,3732,7761,4403,7357,5591,4206,9419,5221,3367,9393,5373,3447,1957,5183,2971,7023,1744],function(){return e(e.s=59870)}),_N_E=e.O()}]);