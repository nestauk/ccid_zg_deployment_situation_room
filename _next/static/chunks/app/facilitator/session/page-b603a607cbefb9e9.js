(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5044],{59870:function(e,t,n){Promise.resolve().then(n.bind(n,81661))},81661:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return eW}});var i,o,s,r,l=n(57437),a=n(53622),c=n(94547),d=n(78364),u=n(11144),x=n(4766),p=n(93191),h=n(31193),f=n(2265),m=n(95958);let g={0:{columns:1,rows:1},1:{columns:1,rows:1},2:{columns:1,rows:2},3:{columns:1,rows:3},4:{columns:2,rows:2},5:{columns:2,rows:3},6:{columns:2,rows:3},7:{columns:2,rows:4},8:{columns:2,rows:4},9:{columns:3,rows:3},10:{columns:3,rows:4},11:{columns:3,rows:4},12:{columns:3,rows:4},13:{columns:4,rows:4},14:{columns:4,rows:4},15:{columns:4,rows:4},16:{columns:4,rows:4}};function j(){let{tiles:e}=(0,f.useContext)(m.fp),[t,n]=(0,f.useState)({rows:1,columns:1});return(0,f.useEffect)(()=>{let t=e.length;if(t<=16)n({rows:g[t].rows,columns:g[t].columns});else{let e=Math.ceil(Math.sqrt(t));n({rows:e,columns:Math.ceil(t/e)})}},[e]),(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(h.Z,{sx:{width:"100%",height:"100%",display:"grid",gap:1,gridTemplateRows:"repeat(".concat(t.rows,", 1fr)"),gridTemplateColumns:"repeat(".concat(t.columns,", 1fr)")},children:e})})}var v=n(43670),w=n(17882),b=n(69740),y=n(80511);function Z(e){return(0,l.jsxs)(h.Z,{sx:{display:"flex",flexDirection:"column",background:"white",borderRadius:2,p:1,...e.sx},children:[(e.title||e.tools)&&(0,l.jsxs)(h.Z,{sx:{display:"flex",flexDirection:"row",justifyContent:"space-between",mb:1},children:[e.title&&(0,l.jsx)(y.Z,{variant:"h6",children:e.title}),e.tools]}),(0,l.jsx)(h.Z,{sx:{flexGrow:1,overflowY:"hidden"},children:(0,l.jsx)(h.Z,{sx:{width:"100%",height:"100%",overflowY:e.scrolling?"auto":"hidden"},children:e.children})})]})}var C=n(56019);let S=e=>"".concat(Math.floor(e/60).toString().padStart(2,"0"),":").concat((e%60).toString().padStart(2,"0"),":00"),k=e=>{let t=Math.floor(e/36e5),n=Math.floor((e-=36e5*t)/6e4),i=Math.floor((e-=6e4*n)/1e3);return e-=1e3*i,"".concat(t.toString().padStart(2,"0"),":").concat(n.toString().padStart(2,"0"),":").concat(i.toString().padStart(2,"0"))};function I(){let{session:e}=(0,f.useContext)(u.z),[t,n]=(0,f.useState)({}),[i,o]=(0,f.useState)(""),s=(0,f.useRef)();(0,f.useEffect)(()=>{n({startTime:function(e){if(e)return new Date(e)}(e.sessionStartedAt),duration_mins:e.sessionDurationMins})},[e]),(0,f.useEffect)(()=>(t.startTime?(s.current&&clearInterval(s.current),s.current=setInterval(r,1e3),r()):o(t.duration_mins?S(t.duration_mins):"Unknown"),()=>{s.current&&clearInterval(s.current)}),[t]);let r=(0,f.useCallback)(()=>{if(t.startTime){let e=new Date().getTime()-t.startTime.getTime();t.duration_mins&&(e=Math.max(6e4*t.duration_mins-e,0)),o(k(e))}else o(t.duration_mins?S(t.duration_mins):"Unknown")},[t]);return(0,l.jsxs)(h.Z,{sx:{display:"flex",flexDirection:"row",gap:1,alignItems:"center"},children:[(0,l.jsx)("img",{src:"/icons/clock.svg",style:{height:"1.25rem",width:"auto"}}),(0,l.jsx)(y.Z,{variant:"body1",children:i})]})}var E=n(60658),_=n(65301);(i=s||(s={}))[i.Ready=0]="Ready",i[i.InitError=1]="InitError",i[i.Recording=2]="Recording",i[i.Saving=3]="Saving",i[i.UploadSuccess=4]="UploadSuccess",i[i.UploadError=5]="UploadError";var R=n(5085),F=n(23447),D=n(15785),P=n(83040),A=n(96537),U=n(18502),O=n(24072),T=n(76396);function N(e){let t=(0,f.useId)();return(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(O.ZP,{variant:"popover",popupId:t,children:t=>{var n,i,o;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(A.Z,{startIcon:!1!==e.startIcon?e.startIcon:void 0,endIcon:null!==(n=e.endIcon)&&void 0!==n?n:(0,l.jsx)(P.Z,{color:"action"}),variant:"text",color:"buttonStandard","aria-label":e.ariaLabel,sx:e.sx,...(0,T.LI)(t),children:e.text}),(0,l.jsx)(U.ZP,{...(0,T.ZW)(t),anchorOrigin:null!==(i=e.anchorOrigin)&&void 0!==i?i:{vertical:"bottom",horizontal:"center"},transformOrigin:null!==(o=e.transformOrigin)&&void 0!==o?o:{vertical:"top",horizontal:"center"},children:(0,l.jsx)(h.Z,{sx:{p:2},children:e.children})})]})}})})}var q=n(63375),M=n(22960);let V=(e,t)=>{var n;return"".concat(null!==(n=t.recordingId)&&void 0!==n?n:"slide-"+"".concat(null!=e?e:0).padStart(3,"0"))};function W(){let{api:e,start:t}=(0,f.useContext)(F.E),{session:n}=(0,f.useContext)(u.z),i=(0,f.useContext)(R.rZ),{slideIndex:o,slideData:s}=(0,f.useContext)(x.X),[r,a]=(0,f.useState)(!1),[d,p]=(0,f.useState)(!1);(0,f.useEffect)(()=>{a(n.facilitationState===c._y.Open&&n.remoteConfiguration===c.VS.InPerson&&s.activity===D.S.deliberation),p(n.facilitationState===c._y.Open&&n.remoteConfiguration===c.VS.InPerson&&(s.activity===D.S.deliberation||void 0!==s.recordingId))},[s.activity,n.facilitationState,n.remoteConfiguration]);let[m,g]=(0,f.useState)(V(o,s)),[j,v]=(0,f.useState)(!1),[w,b]=(0,f.useState)(!1),[Z,C]=(0,f.useState)(!1),{record:S,stop:k,isRecording:I,recordingTime:U,audioBlob:O,filenamePart:T,filenameSuffix:W,clearRecording:z}=function(){let[e,t]=(0,f.useState)(0),[n,i]=(0,f.useState)(void 0),[o,s]=(0,f.useState)(),{startRecording:r,stopRecording:l,togglePauseResume:a,recordingBlob:c,isRecording:d,isPaused:u,recordingTime:x,mediaRecorder:p}=(0,_.I)({noiseSuppression:!0,autoGainControl:!0},e=>{t(1)},{mimeType:"audio/webm"}),h=e=>"audio-recording-".concat(e);return(0,f.useEffect)(()=>{t(d?2:0)},[d]),(0,f.useEffect)(()=>{void 0!==c&&i(c)},[c]),{record:e=>{s(h(e)),r()},stop:()=>{l()},state:e,audioBlob:n,recordingTime:x,isRecording:d,filenamePart:o,filenameSuffix:"webm",clearRecording:()=>{i(void 0),s(void 0)}}}();(0,f.useEffect)(()=>{I&&(console.debug("Stopping recording due to slide change."),k()),g(V(o,s))},[o]),(0,f.useEffect)(()=>{v(I),I&&C(!1)},[I]),(0,f.useEffect)(()=>{I||void 0===O||void 0===T||G()},[O]);let G=()=>{if(void 0===O||void 0===T){console.debug("Audio blob or filename part empty. Skipping upload.");return}if(0===O.size){console.debug("Audio recording is empty. Skipping upload.");return}console.debug("Initiating upload for recording: <guid>-".concat(T,"-<guid>.").concat(W)),C(!1),b(!0),L(O,T,W).then(()=>{console.debug("Upload complete"),C(!1),z()}).catch(e=>{console.error("Upload failed",e),C(!0)}).finally(()=>{b(!1)})},L=async(o,s,r)=>{console.debug("Retrieving recording upload info...");let l=await t(e.getMediaUploadUrl(n.id,i.sessionToken,i.user.access_token,"deliberation",s,r));console.debug("Uploading recording...",l),await t((0,E.P)(o,l.uploadUrl,!0,"uploading recording")),console.debug("Upload recording complete.")},K=()=>{if(void 0===O||0===O.size){console.debug("Audio blob empty. Skipping download.");return}let e="recording-".concat(null!=T?T:"unknown",".").concat(W);console.debug("Downloading audio recording..."),function(e,t){let n=URL.createObjectURL(e),i=document.createElement("a");i.href=n,i.download=t;try{document.body.appendChild(i),i.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window}))}catch(e){console.error("Error downloading blob",e)}finally{document.body.removeChild(i)}}(O,e)},B=(0,M.Z)(),Y=j||w||Z;return(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(N,{startIcon:Y&&(0,l.jsx)(q.Z,{htmlColor:j?B.palette.recordingEnabled.main:w?B.palette.recordingUploading.main:Z?B.palette.recordingFailed.main:B.palette.recordingDisabled.main}),endIcon:(0,l.jsx)(P.Z,{color:"action"}),sx:{opacity:r?1:.3},text:"Recording: ".concat(j?"Active":w?"Uploading...":Z?"Upload error":"Inactive"),ariaLabel:"Recording information",children:(0,l.jsxs)(h.Z,{sx:{display:"flex",flexDirection:"column",gap:1},children:[!I&&(0,l.jsx)(A.Z,{variant:r?"contained":"outlined",color:r?"primary":"buttonStandard",onClick:()=>S(m),children:"Start Recording"}),I&&(0,l.jsx)(A.Z,{variant:"outlined",color:"buttonStandard",onClick:()=>k(),children:"Stop Recording"}),s.recordingId&&(0,l.jsxs)(y.Z,{variant:"body2",children:["Recording id: ",m,(0,l.jsx)("br",{})]}),I&&(0,l.jsxs)(y.Z,{variant:"body2",sx:{fontSize:"0.5rem"},children:["Recording: ",U]}),Z&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(h.Z,{sx:{display:"flex",flexDirection:"row",gap:1,alignItems:"center"},children:[(0,l.jsx)(q.Z,{htmlColor:B.palette.recordingFailed.main}),(0,l.jsx)(y.Z,{variant:"body1",children:"Recording upload failed"})]}),(0,l.jsx)(y.Z,{variant:"body2",children:"The recording could not be uploaded."}),O&&T&&W&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(A.Z,{variant:"outlined",color:"buttonStandard",onClick:()=>G(),children:"Retry upload"}),(0,l.jsx)(A.Z,{variant:"outlined",color:"buttonStandard",onClick:()=>K(),children:"Download audio"})]})]})]})})})}var z=n(70883),G=n(44228),L=n(9646),K=n(10105),B=n(79393);function Y(e){var t;let n=e.message instanceof Error?e.message.message:e.message;return(0,l.jsx)(B.Z,{open:e.show,autoHideDuration:null!==(t=e.autoHideDuration)&&void 0!==t?t:3e3,onClose:()=>e.setShow(!1),message:(0,l.jsxs)(h.Z,{sx:{display:"flex",flexDirection:"row",gap:1,alignItems:"center"},children:[e.icon,n]})})}function H(e){let[t,n]=(0,f.useState)(!1),i=()=>{var t;null===(t=navigator)||void 0===t||t.clipboard.writeText((0,K.v)(e.session)),n(!0)};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(L.Z,{sx:{alignSelf:"flex-end"},variant:"outlined",onClick:()=>{i()},btnText:"Copy participant link",btnKey:"copy-participant-link"}),(0,l.jsx)(Y,{show:t,setShow:n,message:"Copied participant link to clipboard.",icon:(0,l.jsx)(G.Z,{})})]})}var X=n(40395),J=n(60335),$=n(21395),Q=n(42748),ee=n(11656),et=n(47905),en=n(86917),ei=n(58433),eo=n(14874),es=n(6722);function er(){let{session:e}=(0,f.useContext)(u.z),{subscriptions:t,thisUser:n}=(0,f.useContext)(z.l),{api:i,start:o}=(0,f.useContext)(F.E),{user:s,sessionToken:r}=(0,f.useContext)(R.rZ),[a,d]=(0,f.useState)([]),[x,p]=(0,f.useState)(!1),m=(0,eo.Z)(),g=async()=>{try{p(!0);let t={action:"mute",sessionId:e.id,parameters:{pids:["*"]}};o(i.postFacilitatorAction(s.access_token,r,t,!1))}finally{p(!1)}},j=async(t,n)=>{try{p(!0);let t={action:"mute",sessionId:e.id,parameters:{pids:[n.deviceId]}};o(i.postFacilitatorAction(s.access_token,r,t,!1))}catch(e){console.warn(e)}finally{p(!1)}},v=async(t,n)=>{try{p(!0);let t={action:"kick",sessionId:e.id,parameters:{pid:n.deviceId}};o(i.postFacilitatorAction(s.access_token,r,t,!1))}catch(e){console.warn(e)}finally{p(!1)}},w=t=>{var n,i;let{subscription:o}=t,s=I(o),r=null!==(i=null===(n=e.deviceIdBanList)||void 0===n?void 0:n.includes(o.deviceId))&&void 0!==i&&i;return(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)(h.Z,{sx:{width:"100%",height:"100%",display:"flex",flexDirection:"row",gap:1,alignItems:"center",opacity:r?.5:1},children:[(0,l.jsx)(k,{connected:!r&&o.enabled}),(0,l.jsxs)(y.Z,{variant:"h6",component:"span",sx:{flexGrow:1},children:[s,r?" (banned)":void 0]})]})})},b=t=>{var n,i,o;let{subscription:s}=t,{roster:r}=(0,es.dJs)(),a=r?null===(n=Object.entries(r).find(e=>{let[t,n]=e;return n.externalUserId===s.deviceId}))||void 0===n?void 0:n[1]:void 0,c=I(s),d=null!==(o=null===(i=e.deviceIdBanList)||void 0===i?void 0:i.includes(s.deviceId))&&void 0!==o&&o;return(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)(h.Z,{sx:{width:"100%",height:"100%",display:"flex",flexDirection:"row",gap:1,alignItems:"center",opacity:d?.5:1},children:[(0,l.jsx)(k,{connected:!d&&s.enabled}),(0,l.jsxs)(y.Z,{variant:"h6",component:"span",sx:{flexGrow:1},children:[c,d?" (banned)":void 0]}),a&&!d&&(0,l.jsx)(Z,{attendee:a,subscription:s})]})})},Z=e=>{let{attendee:t,subscription:i}=e;return(0,l.jsx)(l.Fragment,{children:i.subscriptionId!==(null==n?void 0:n.subscriptionId)&&(0,l.jsx)(C,{attendee:t,subscription:i})})},C=e=>{let{attendee:t,subscription:n}=e;return(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(O.ZP,{variant:"popover",popupId:"attendee-controls-menu-items-".concat(n.subscriptionId),children:e=>(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(J.Z,{"aria-label":"settings",...(0,T.vW)(e),children:(0,l.jsx)("img",{src:"/icons/triple-dots-vertical.svg"})}),(0,l.jsx)($.Z,{...(0,T.wK)(e),children:(0,l.jsx)(S,{attendee:t,subscription:n,requestClose:e.close})})]})})})},S=e=>{let{attendee:t,subscription:n,requestClose:i}=e,[o,s]=(0,f.useState)(!1),r=(0,es.ZzJ)(t.chimeAttendeeId).muted;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(Q.Z,{children:[(0,l.jsx)(ee.Z,{children:(0,l.jsx)(et.Z,{children:(0,l.jsx)("b",{children:n.participantName})})},"attendee-control-menu-header-".concat(n.subscriptionId)),(0,l.jsxs)(ee.Z,{disabled:x||r,onClick:r?void 0:()=>{i(),j(t,n)},children:[(0,l.jsx)(en.Z,{children:r?(0,l.jsx)("img",{src:"/icons/controls/participant-muted.svg"}):(0,l.jsx)("img",{src:"/icons/controls/mute-participant.svg"})}),(0,l.jsx)(et.Z,{inset:!1,children:r?"Participant muted":"Mute participant"})]},"attendee-control-menu-item-".concat(n.subscriptionId,"-mute")),(0,l.jsxs)(ee.Z,{disabled:x,onClick:()=>{s(!0)},children:[(0,l.jsx)(en.Z,{children:(0,l.jsx)("img",{src:"/icons/controls/remove-participant.svg"})}),(0,l.jsx)(et.Z,{inset:!1,children:"Remove participant"})]},"attendee-control-menu-item-".concat(n.subscriptionId,"-kick"))]}),(0,l.jsx)(X.Z,{prompt:"Remove the participant from the call?",options:[{key:"kick",text:"Remove participant",filled:!0},{key:"cancel",text:"Cancel",filled:!1}],onSelect:e=>{"kick"===e&&v(t,n)},open:o,setOpen:s,onClose:i})]})},k=e=>{let{connected:t}=e;return(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(h.Z,{sx:{p:1,borderRadius:4,height:42,background:t?m.palette.connected.main:m.palette.disconnected.main},children:(0,l.jsx)("img",{style:{height:26,margin:0,padding:0},src:t?"/icons/device-connected.svg":"/icons/device-disconnected.svg"})})})},I=e=>{let t=e.subscriptionId===(null==n?void 0:n.subscriptionId)?"(You) ":"",i=e.participantName&&e.participantName.length>0?e.participantName:"Unknown";return"".concat(t).concat(i)};return(0,f.useEffect)(()=>{d([...t].sort((e,t)=>e.role===t.role?0:e.role===c._b.Controller?-1:t.role===c._b.Controller?1:e.participantName.localeCompare(t.participantName)))},[t]),(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)(h.Z,{sx:{display:"flex",flexDirection:"column",gap:4},children:[(0,l.jsxs)(h.Z,{sx:{display:"flex",flexDirection:"row",gap:1,justifyContent:"flex-end"},children:[e.remoteConfiguration===c.VS.RemoteWithVideoCall&&(0,l.jsx)(L.Z,{variant:"outlined",startIcon:(0,l.jsx)("img",{src:"/icons/controls/participant-muted.svg"}),btnKey:"mute-all",btnText:"Mute all",sx:{alignSelf:"flex-end"},busy:x,onClick:e=>{g()}}),(0,l.jsx)(H,{session:e})]}),(0,l.jsx)(ei.ZP,{container:!0,spacing:2,children:a.map(t=>(0,l.jsxs)(ei.ZP,{item:!0,xs:6,children:[e.remoteConfiguration===c.VS.RemoteWithVideoCall&&(0,l.jsx)(b,{subscription:t}),e.remoteConfiguration!==c.VS.RemoteWithVideoCall&&(0,l.jsx)(w,{subscription:t})]},"participant-subscription-indicator-".concat(t.subscriptionId)))})]})})}function el(){let{subscriptions:e,thisUser:t}=(0,f.useContext)(z.l);return(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(N,{startIcon:(0,l.jsx)("img",{src:"/icons/session-participants.svg",style:{height:"1.45rem",width:"auto"}}),text:"".concat(e.filter(e=>e.deviceId!==(null==t?void 0:t.deviceId)).length," participants"),children:(0,l.jsx)(h.Z,{sx:{width:"55vw"},children:(0,l.jsx)(er,{})})})})}var ea=n(8260),ec=n(35231),ed=n(50467),eu=n(2842),ex=n(9542),ep=n(13971);function eh(e){let{colours:t,data:n}=e,i=e=>{let t={true:{l:!0,r:!1},false:{l:!1,r:!0}};return 0===e.true&&(t.false.l=!0),0===e.false&&(t.true.r=!0),t},[o,s]=(0,f.useState)(i(n));(0,f.useEffect)(()=>{s(i(n))},[n]);let r=e=>[e.l?16:0,e.r?16:0,e.r?16:0,e.l?16:0];return(0,l.jsx)(ec.h,{width:"100%",height:40,children:(0,l.jsxs)(ed.v,{layout:"vertical",margin:{left:0,right:0},height:40,data:[{name:"completion",complete:n.true,incomplete:n.false}],children:[(0,l.jsx)(eu.K,{hide:!0,type:"number",max:n.true+n.false}),(0,l.jsx)(ex.B,{hide:!0,dataKey:"name",type:"category"}),(0,l.jsx)(ep.$,{dataKey:"complete",stackId:"completion",fill:t[0],radius:r(o.true)}),(0,l.jsx)(ep.$,{dataKey:"incomplete",stackId:"completion",fill:t[1],radius:r(o.false)})]})})}var ef=n(37570),em=n(37552),eg=n(79617),ej=n(51847),ev=n(33578);(o=r||(r={}))[o.NotAnswered=0]="NotAnswered",o[o.Answered=1]="Answered";let ew=(e,t,n)=>{var i,o;let s=null!==(o=eb(null!==(i=n?null==e?void 0:e.filter(e=>e.questionId===n):e)&&void 0!==i?i:[]))&&void 0!==o?o:[],r=s.length,l=t.filter(e=>e.enabled&&e.role===c._b.Client),a=l.filter(e=>!s.find(t=>t.participantId===e.deviceId)),d=s.length+a.length;return{allAnswers:s,relevantParticipants:l,answeredCount:r,participantsWithoutAnswers:a,maxAnswers:d,complete:r===d}},eb=e=>null==e?void 0:e.sort((e,t)=>new Date(e.created).getTime()-new Date(t.created).getTime()),ey=(e,t)=>{var n;return[...e.allAnswers.map((e,n)=>({description:eZ(e,t),answered:1})),...null!==(n=e.participantsWithoutAnswers.map(e=>({description:eC(e),answered:0})))&&void 0!==n?n:[]]},eZ=(e,t)=>eC(t.find(t=>t.deviceId===e.participantId)),eC=e=>{var t,n;return null!==(n=null!==(t=null==e?void 0:e.participantName)&&void 0!==t?t:null==e?void 0:e.deviceName)&&void 0!==n?n:"Unknown"};function eS(e){let{sid:t}=(0,f.useContext)(ef.H),{answers:n}=(0,ea.ZP)(e.qid),i=(0,f.useContext)(z.l),[o,s]=(0,f.useState)(i.subscriptions),[r,a]=(0,f.useState)(ew(n,o,e.qid)),[c,d]=(0,f.useState)([]);(0,f.useEffect)(()=>{s(i.subscriptions)},[i]),(0,f.useEffect)(()=>{a(ew(n,o))},[n,o]),(0,f.useEffect)(()=>{d(ey(r,o))},[r,o]);let u=e=>(0,l.jsxs)(h.Z,{sx:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",borderRadius:2,background:"white",border:"1px solid #EFEFEF",p:2},children:[(0,l.jsx)(y.Z,{variant:"body1",sx:{borderRight:"1px solid black",overflowX:"scroll",textWrap:"nowrap",flexGrow:1,mr:.5,pr:.5},children:e.description}),1===e.answered&&(0,l.jsx)("img",{src:"/icons/checkbox-filled.svg"}),1!==e.answered&&(0,l.jsx)("img",{src:"/icons/checkbox.svg"})]}),x=(0,eo.Z)();return(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)(h.Z,{sx:{display:"flex",flexDirection:"column",gap:1,alignItems:"stretch"},children:[e.qid&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(h.Z,{sx:{display:"flex",flexDirection:"row",gap:1,alignItems:"center"},children:[(0,l.jsx)("img",{src:"/icons/busts.svg",style:{height:"1.5rem",width:"auto"}}),(0,l.jsxs)(y.Z,{variant:"body1",children:[e.label&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("b",{children:[e.label,":"]})," "]}),"".concat(r.answeredCount," of ").concat(r.maxAnswers," ")," ",1!==r.answeredCount?"have":"has"," voted"]})]}),(0,l.jsxs)(eg.Z,{elevation:0,disableGutters:!0,sx:{"&:before":{display:"none"}},children:[(0,l.jsxs)(ej.Z,{expandIcon:(0,l.jsx)(em.Z,{}),sx:{p:0},children:[r.answeredCount+r.participantsWithoutAnswers.length>0&&(0,l.jsx)(eh,{colours:[x.palette.primary.main,"#ededff"],data:{true:r.answeredCount,false:r.participantsWithoutAnswers.length}}),r.answeredCount+r.participantsWithoutAnswers.length===0&&(0,l.jsx)(eh,{colours:[x.palette.primary.main,"#ededff"],data:{true:0,false:100}})]}),(0,l.jsx)(ev.Z,{sx:{p:0},children:(0,l.jsx)(ei.ZP,{container:!0,spacing:1,sx:{mb:2},children:c.map((t,n)=>(0,l.jsx)(ei.ZP,{item:!0,xs:12,sm:6,md:4,children:(0,l.jsx)(u,{description:t.description,answered:t.answered})},"answer-indicator-grid-item-".concat(e.qid,"-").concat(n)))})})]})]}),!e.qid&&(0,l.jsx)(y.Z,{variant:"body1",children:"Not a polling slide"})]})})}function ek(){let{slideData:e}=(0,f.useContext)(x.X),{subscriptions:t}=(0,f.useContext)(z.l),{allAnswers:n}=(0,ea.ZP)(),[i,o]=(0,f.useState)(!1),[s,r]=(0,f.useState)({}),[a,c]=(0,f.useState)(!1),[d,u]=(0,f.useState)();(0,f.useEffect)(()=>{o(e.qids.length>0)},[e]),(0,f.useEffect)(()=>{r(Object.fromEntries(e.qids.map(e=>[e,ew(n[e],t,e)])))},[n,e,t]),(0,f.useEffect)(()=>{c(Object.values(s).every(e=>e.complete))},[s]);let p=(0,M.Z)();return(0,f.useEffect)(()=>{let e=a?p.palette.pollingComplete.main:p.palette.pollingInProgress.main;u(i?{icon:(0,l.jsx)(q.Z,{htmlColor:e}),text:a?"Polling complete":"Polling in progress"}:void 0)},[a,i]),(0,l.jsx)(l.Fragment,{children:i&&d&&(0,l.jsx)(N,{startIcon:d.icon,text:d.text,sx:{backgroundColor:p.palette.pollingInProgressBackground.main},children:(0,l.jsx)(h.Z,{sx:{width:"55vw",display:"flex",flexDirection:"column",gap:1},children:e.qids.map((t,n)=>{let i=e.qids.length>1?0===n?"First question":n===e.qids.length-1?"Last question":void 0:void 0;return(0,l.jsx)(eS,{qid:t,label:i},"facilitator-polling-monitor-".concat(t,"-").concat(n))})})})})}function eI(){let{sessionToken:e,user:t}=(0,f.useContext)(R.rZ),{session:n}=(0,f.useContext)(u.z),{api:i,start:o}=(0,f.useContext)(F.E),[s,r]=(0,f.useState)(!1),[a,d]=(0,f.useState)(!1),[x,p]=(0,f.useState)({key:"",text:"Please wait...",variant:"outlined"});(0,f.useEffect)(()=>{switch(n.facilitationState){case c._y.Ready:p({key:"open-session",text:"Open workshop",variant:"contained"});break;case c._y.Open:p({key:"close-session",text:"Close workshop",variant:"outlined"});break;case c._y.Closed:p({key:"open-waiting",text:"Open waiting room",variant:"contained"})}},[n]);let h=async s=>{try{r(!0);var l={action:s===c._y.Open?"open":s===c._y.Ready?"reset":"close",sessionId:n.id};await o(i.postFacilitatorAction(t.access_token,e,l))}catch(e){console.error(e)}finally{r(!1)}};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(L.Z,{busy:s,variant:x.variant,btnKey:x.key,btnText:x.text,onClick:e=>{switch(e){case"open-waiting":h(c._y.Ready);break;case"open-session":h(c._y.Open);break;case"close-session":d(!0);break;default:console.warn("Unexpected facilitation switch from menu.")}}}),(0,l.jsx)(X.Z,{open:a,setOpen:d,prompt:"Are you sure you want to close the workshop?",onSelect:e=>{"close"===e&&h(c._y.Closed)},options:[{key:"close",text:"Close",filled:!0},{key:"cancel",text:"Cancel",filled:!1}]})]})}function eE(){let{session:e}=(0,f.useContext)(u.z);return(0,l.jsxs)(h.Z,{sx:{width:"100%",display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",background:"white",p:1,borderRadius:2},children:[(0,l.jsx)(t=>{let{showBadge:n}=t;return(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)(h.Z,{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",children:[(0,l.jsx)("img",{src:"/icons/home.svg",style:{height:"2rem",width:"auto",verticalAlign:"middle",marginRight:12,paddingBottom:4}}),n&&(0,l.jsx)(C.Z,{color:"primary",badgeContent:c._y[e.facilitationState],anchorOrigin:{vertical:"bottom",horizontal:"right"},children:(0,l.jsx)(y.Z,{variant:"h5",component:"h1",children:e.sessionName})}),!n&&(0,l.jsx)(y.Z,{variant:"h5",component:"h1",children:e.sessionName})]})})},{showBadge:!1}),(0,l.jsxs)(h.Z,{sx:{flexGrow:1,display:"flex",flexDirection:"row",justifyContent:"flex-end",alignItems:"center",gap:4},children:[(0,l.jsx)(ek,{}),(0,l.jsx)(W,{}),(0,l.jsx)(el,{}),(0,l.jsx)(I,{}),(0,l.jsx)(eI,{})]})]})}function e_(e){let{notes:t}=e;return(0,l.jsx)("div",{dangerouslySetInnerHTML:{__html:t}})}var eR=n(7630),eF=n(69065),eD=n(80824),eP=n(66124);function eA(e){let{session:t}=(0,f.useContext)(u.z),[n,i]=(0,f.useState)(!1),[o,s]=(0,f.useState)(!1),[r,a]=(0,f.useState)(!1);return(0,f.useEffect)(()=>{s(t.facilitationState===c._y.Open)},[t.facilitationState]),(0,f.useEffect)(()=>{a(t.remoteConfiguration===c.VS.InPerson)},[t.remoteConfiguration]),(0,f.useEffect)(()=>{i(o&&r)},[o,r]),(0,l.jsxs)(eF.Z,{fullWidth:!0,maxWidth:"sm",open:n,onClose:()=>i(!1),children:[(0,l.jsxs)(eD.Z,{children:["The workshop is now open",(0,l.jsx)(h.Z,{style:{position:"absolute",top:0,right:0},children:(0,l.jsx)(J.Z,{"aria-label":"close",onClick:()=>i(!1),children:(0,l.jsx)(eR.Z,{})})})]}),(0,l.jsx)(eP.Z,{children:(0,l.jsxs)(h.Z,{sx:{display:"flex",flexDirection:"column",gap:2},children:[(0,l.jsxs)("ul",{children:[o&&(0,l.jsx)("li",{children:"Participants will now be able to enter the session"}),r&&(0,l.jsxs)("li",{children:["A test of the audio recording capability is available, but relevant sections will ",(0,l.jsx)("u",{children:"not"})," be automatically recorded"]})]}),(0,l.jsx)(A.Z,{variant:"contained",sx:{alignSelf:"center",textTransform:"uppercase"},onClick:()=>i(!1),children:"Continue"})]})})]})}let eU=e=>e.remoteConfiguration===c.VS.RemoteWithVideoCall?"left":"right",eO=e=>e.remoteConfiguration===c.VS.RemoteWithVideoCall,eT=e=>e.remoteConfiguration!==c.VS.RemoteWithVideoCall;function eN(){let{presentation:e,previews:t}=(0,f.useContext)(p.N),{slideData:n}=(0,f.useContext)(x.X),{session:i}=(0,f.useContext)(u.z),o=(0,f.useContext)(b.ui),[s,r]=(0,f.useState)(eT(i)),[a,d]=(0,f.useState)(eO(i)),[g,y]=(0,f.useState)(eU(i));return(0,f.useEffect)(()=>{r(eT(i)),d(eO(i)),y(eU(i))},[i]),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(h.Z,{sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column",gap:1,p:1,overflow:"hidden"},children:[(0,l.jsx)(h.Z,{children:(0,l.jsx)(eE,{})}),(0,l.jsxs)(h.Z,{sx:{flexGrow:1,display:"flex",flexDirection:"row",gap:1,overflowY:"hidden"},children:[(0,l.jsxs)(h.Z,{sx:{display:"flex",flexDirection:"column",width:"50vw",gap:1,flexShrink:0},children:[(0,l.jsx)(Z,{sx:{flexGrow:1,overflow:"hidden",minHeight:"50vh"},children:e}),s&&(0,l.jsx)(Z,{children:t}),"left"===g&&(0,l.jsx)(h.Z,{sx:{flexGrow:1,display:"block",overflowY:"hidden"},children:(0,l.jsx)(Z,{scrolling:!0,sx:{height:"100%"},children:(0,l.jsx)(e_,{notes:n.notes})})})]}),(0,l.jsxs)(h.Z,{sx:{flexGrow:1,width:"100%",height:"100%",display:"flex",flexDirection:"column",gap:1},children:[a&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(h.Z,{sx:{flexGrow:1},children:(0,l.jsx)(v.Z,{initialCallPreferences:o.call,sx:{width:"100%",height:"100%"},children:(0,l.jsx)(m.ZP,{role:c._b.Controller,children:(0,l.jsx)(j,{})})})}),(0,l.jsx)(w.Z,{orientation:"row"})]}),"right"===g&&(0,l.jsx)(h.Z,{sx:{flexGrow:1,display:"block",overflowY:"hidden"},children:(0,l.jsx)(Z,{scrolling:!0,sx:{height:"100%"},children:(0,l.jsx)(e_,{notes:n.notes})})})]})]})]}),(0,l.jsx)(eA,{})]})}var eq=n(27030);function eM(e){return(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)(eq.Z,{sid:e.sid,joinCode:e.joinCode,refresh:e.refresh,role:c._b.Controller,children:[(0,l.jsx)(d.Z,{}),(0,l.jsx)(eN,{})]})})}var eV=n(16463);function eW(){let e=(0,eV.useSearchParams)(),t=e.get("sid"),n=e.get("code"),i="true"===e.get("refresh");return null===t||null===n?(0,l.jsx)("p",{children:"Missing session id or join code"}):(0,l.jsx)(a.Z,{searchParams:e,children:(0,l.jsx)(eM,{sid:t,joinCode:n,refresh:i})})}},10105:function(e,t,n){"use strict";n.d(t,{k:function(){return o},v:function(){return i}});let i=e=>"".concat(window.location.href.split("/")[0],"//").concat(window.location.href.split("/")[2],"/participant/session?sid=").concat(e.id,"&code=").concat(e.joinCode),o=e=>"".concat(window.location.href.split("/")[0],"//").concat(window.location.href.split("/")[2],"/facilitator/session?sid=").concat(e.id,"&code=").concat(e.joinCode)}},function(e){e.O(0,[2908,6444,6221,1866,3732,7761,4403,7357,5591,4206,9419,5221,6236,9393,5373,3447,816,350,2971,7023,1744],function(){return e(e.s=59870)}),_N_E=e.O()}]);