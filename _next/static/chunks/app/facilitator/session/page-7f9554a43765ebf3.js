(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[44],{59870:function(e,t,i){Promise.resolve().then(i.bind(i,53209))},53209:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return eN}});var n,r,s,a,o=i(57437),l=i(53622),c=i(94547),d=i(78364),u=i(2265),x=i(31193),h=i(80511),f=i(96537),p=i(22960),g=i(56019),m=i(71733),j=i(79806),v=i(44228),w=i(42748),b=i(11656),Z=i(47905),y=i(86917),S=i(14595),C=i(60335),k=i(21395),I=i(24072),T=i(76396);function _(e){let t=t=>{t!==e.state&&e.onFacilitationStateChange(t)},i=t=>{t!==e.fullscreen&&e.onFullScreenChange(t)},n=()=>(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(w.Z,{children:[(0,o.jsx)(b.Z,{children:(0,o.jsx)(Z.Z,{inset:!0,children:(0,o.jsx)("b",{children:"Workshop facilitation"})})},"action-menu-video-heading"),[c._y.Ready,c._y.Open,c._y.Closed].map(i=>(0,o.jsxs)(b.Z,{disabled:e.stateBusy,onClick:()=>t(i),children:[e.state===i&&(0,o.jsx)(y.Z,{children:(0,o.jsx)(v.Z,{})}),(0,o.jsx)(Z.Z,{inset:e.state!==i,children:c._y[i]})]},"action-menu-item-".concat(c._y[i])))]}),(0,o.jsx)(S.Z,{}),(0,o.jsxs)(w.Z,{children:[(0,o.jsx)(b.Z,{children:(0,o.jsx)(Z.Z,{inset:!0,children:(0,o.jsx)("b",{children:"Screen mode"})})},"action-menu-screen-heading"),(0,o.jsxs)(b.Z,{disabled:e.fullscreenBusy,onClick:()=>i(!0),children:[e.fullscreen&&(0,o.jsx)(y.Z,{children:(0,o.jsx)(v.Z,{})}),(0,o.jsx)(Z.Z,{inset:!e.fullscreen,children:"Full screen"})]},"action-menu-item-screen-fullscreen"),(0,o.jsxs)(b.Z,{disabled:e.fullscreenBusy,onClick:()=>i(!1),children:[!e.fullscreen&&(0,o.jsx)(y.Z,{children:(0,o.jsx)(v.Z,{})}),(0,o.jsx)(Z.Z,{inset:e.fullscreen,children:"Windowed"})]},"action-menu-item-screen-windowed")]})]});return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(I.ZP,{variant:"popover",popupId:"facilitation-actions-popup",children:e=>(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(C.Z,{"aria-label":"settings",...(0,T.vW)(e),children:(0,o.jsx)("img",{src:"/icons//settings.svg"})}),(0,o.jsx)(k.Z,{...(0,T.wK)(e),children:(0,o.jsx)(n,{})})]})})})}function E(e){let[t,i]=(0,u.useState)(""),n=(0,u.useRef)();(0,u.useEffect)(()=>{if(e.startTime)return n.current=setInterval(r,1e3),()=>{clearInterval(n.current)};n.current&&(clearInterval(n.current),n.current=void 0),i("")},[e.startTime,e.duration_mins]);let r=(0,u.useCallback)(()=>{if(e.startTime){let t=new Date().getTime()-e.startTime.getTime();e.duration_mins&&(t=Math.max(6e4*e.duration_mins-t,0));let n=Math.floor(t/36e5),r=Math.floor((t-=36e5*n)/6e4),s=Math.floor((t-=6e4*r)/1e3);t-=1e3*s,i("".concat(n.toString().padStart(2,"0"),":").concat(r.toString().padStart(2,"0"),":").concat(s.toString().padStart(2,"0")))}else i("")},[e.startTime,e.duration_mins]);return(0,o.jsxs)(h.Z,{variant:"h5",children:[(0,o.jsx)("img",{src:"/icons/clock.svg",style:{height:26,verticalAlign:"middle",marginRight:12,paddingBottom:4}}),t]})}var D=i(38628),F=i(5085),R=i(69065),O=i(66124),P=i(7630),U=i(58433),A=i(14874),N=i(70883),W=i(10105),z=i(11144);function B(){let{session:e}=(0,u.useContext)(z.z),t=(0,u.useContext)(N.l),i=(0,A.Z)(),n=e=>"Device: ".concat(e.deviceName),r=e=>e.role===c._b.Controller?"\uD83D\uDD79ï¸":"",s=e=>e.participantName&&e.participantName.length>0?e.participantName:null,a=e=>{let{connected:t}=e;return(0,o.jsx)(x.Z,{sx:{p:1,borderRadius:4,height:42},style:{background:t?i.palette.connected.main:i.palette.disconnected.main},children:(0,o.jsx)("img",{style:{height:26,margin:0,padding:0},src:t?"/icons/device-connected.svg":"/icons/device-disconnected.svg"})})};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(h.Z,{variant:"h6",component:"h2",children:"Participants"}),(0,o.jsx)(U.ZP,{container:!0,spacing:2,sx:{mt:2},children:t.subscriptions.map(e=>(0,o.jsx)(U.ZP,{item:!0,xs:6,children:(0,o.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[(0,o.jsx)(a,{connected:e.enabled}),(0,o.jsxs)(x.Z,{sx:{ml:2},children:[(0,o.jsxs)(h.Z,{variant:"h6",children:[r(e),s(e)]}),(0,o.jsx)(h.Z,{variant:"body1",children:n(e)})]})]})},"connection-indicator-".concat(e.subscriptionId)))}),(0,o.jsx)(f.Z,{variant:"outlined",color:"buttonStandard",sx:{flexGrow:1,alignSelf:"start",mt:4},onClick:()=>{var t;null===(t=navigator)||void 0===t||t.clipboard.writeText((0,W.v)(e))},children:"Copy participant link"})]})}function H(){let[e,t]=(0,u.useState)(!1),i=()=>{t(!1)};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(C.Z,{"aria-label":"settings",onClick:()=>{t(!0)},children:(0,o.jsx)("img",{src:"/icons/session-participants.svg"})}),(0,o.jsx)(R.Z,{fullWidth:!0,maxWidth:"md",open:e,onClose:i,children:(0,o.jsxs)(O.Z,{children:[(0,o.jsx)(x.Z,{style:{position:"absolute",top:0,right:0},children:(0,o.jsx)(C.Z,{"aria-label":"close",onClick:i,children:(0,o.jsx)(P.Z,{})})}),(0,o.jsx)(x.Z,{sx:{p:2},display:"flex",flexDirection:"column",alignItems:"center",children:(0,o.jsx)(B,{})})]})})]})}var L=i(65301);(n=s||(s={}))[n.Ready=0]="Ready",n[n.InitError=1]="InitError",n[n.Recording=2]="Recording",n[n.Saving=3]="Saving",n[n.UploadSuccess=4]="UploadSuccess",n[n.UploadError=5]="UploadError";var M=i(4766),V=i(18502),G=i(63375),q=i(83040),X=i(15785),K=i(60658),J=i(1973);let Y=e=>{var t;return"".concat(null!==(t=e.recordingId)&&void 0!==t?t:"slide-"+"".concat(e.index).padStart(3,"0"))};function $(e){let{api:t,start:i}=(0,u.useContext)(J.E),{session:n}=(0,u.useContext)(z.z),r=(0,u.useContext)(F.rZ),s=(0,u.useContext)(M.X),[a,l]=(0,u.useState)(Y(s.data)),[c,d]=(0,u.useState)(!1),[g,m]=(0,u.useState)(!1),[j,v]=(0,u.useState)(!1),{record:w,stop:b,isRecording:Z,recordingTime:y,audioBlob:S,filenamePart:C,filenameSuffix:k,clearRecording:_}=function(){let[e,t]=(0,u.useState)(0),[i,n]=(0,u.useState)(void 0),[r,s]=(0,u.useState)(),{startRecording:a,stopRecording:o,togglePauseResume:l,recordingBlob:c,isRecording:d,isPaused:x,recordingTime:h,mediaRecorder:f}=(0,L.I)({noiseSuppression:!0,autoGainControl:!0},e=>{t(1)},{mimeType:"audio/webm"}),p=e=>"audio-recording-".concat(e);return(0,u.useEffect)(()=>{t(d?2:0)},[d]),(0,u.useEffect)(()=>{void 0!==c&&n(c)},[c]),{record:e=>{s(p(e)),a()},stop:()=>{o()},state:e,audioBlob:i,recordingTime:h,isRecording:d,filenamePart:r,filenameSuffix:"webm",clearRecording:()=>{n(void 0),s(void 0)}}}();(0,u.useEffect)(()=>{Z&&(console.debug("Stopping recording due to slide change."),b());let e=Y(s.data);console.debug("New slide id: ".concat(e)),l(e)},[s.data.index]),(0,u.useEffect)(()=>{d(Z),Z&&v(!1)},[Z]),(0,u.useEffect)(()=>{Z||void 0===S||void 0===C||E()},[S]);let E=()=>{if(void 0===S||void 0===C){console.debug("Audio blob or filename part empty. Skipping upload.");return}if(0===S.size){console.debug("Audio recording is empty. Skipping upload.");return}console.debug("Initiating upload for recording: <guid>-".concat(C,"-<guid>.").concat(k)),v(!1),m(!0),D(S,C,k).then(()=>{console.debug("Upload complete"),v(!1),_()}).catch(e=>{console.error("Upload failed",e),v(!0)}).finally(()=>{m(!1)})},D=async(e,s,a)=>{console.debug("Retrieving recording upload info...");let o=await i(t.getMediaUploadUrl(n.id,r.sessionToken,r.user.access_token,"deliberation",s,a));console.debug("Uploading recording...",o),await i((0,K.P)(e,o.uploadUrl,!0,"uploading recording")),console.debug("Upload recording complete.")},R=()=>{if(void 0===S||0===S.size){console.debug("Audio blob empty. Skipping download.");return}let e="recording-".concat(null!=C?C:"unknown",".").concat(k);console.debug("Downloading audio recording..."),function(e,t){let i=URL.createObjectURL(e),n=document.createElement("a");n.href=i,n.download=t;try{document.body.appendChild(n),n.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window}))}catch(e){console.error("Error downloading blob",e)}finally{document.body.removeChild(n)}}(S,e)},O=(0,p.Z)();return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(I.ZP,{variant:"popover",popupId:"recording-information-popup",children:t=>(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(f.Z,{startIcon:(0,o.jsx)(G.Z,{htmlColor:c?O.palette.recordingEnabled.main:g?O.palette.recordingUploading.main:j?O.palette.recordingFailed.main:O.palette.recordingDisabled.main}),endIcon:(0,o.jsx)(q.Z,{color:"action"}),variant:"text",color:"buttonStandard","aria-label":"Recording information",sx:{opacity:e.enableHint?1:.3},...(0,T.LI)(t),children:["Recording: ",c?"Active":g?"Uploading...":j?"Upload error":"Inactive"]}),(0,o.jsx)(V.ZP,{...(0,T.ZW)(t),anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},children:(0,o.jsxs)(x.Z,{sx:{p:1,display:"flex",flexDirection:"column",gap:1},children:[!Z&&(0,o.jsx)(f.Z,{variant:e.enableHint?"contained":"outlined",color:e.enableHint?"primary":"buttonStandard",onClick:()=>w(a),children:"Start Recording"}),Z&&(0,o.jsx)(f.Z,{variant:"outlined",color:"buttonStandard",onClick:()=>b(),children:"Stop Recording"}),(0,o.jsxs)(h.Z,{variant:"body2",children:["Slide activity: ",X.S[s.data.activity]]}),s.data.recordingId&&(0,o.jsxs)(h.Z,{variant:"body2",children:["Deliberation id: ",a,(0,o.jsx)("br",{})]}),Z&&(0,o.jsxs)(h.Z,{variant:"body2",sx:{fontSize:"0.5rem"},children:["Recording: ",y]}),j&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(x.Z,{sx:{display:"flex",flexDirection:"row",gap:1,alignItems:"center"},children:[(0,o.jsx)(G.Z,{htmlColor:O.palette.recordingFailed.main}),(0,o.jsx)(h.Z,{variant:"body1",children:"Recording upload failed"})]}),(0,o.jsx)(h.Z,{variant:"body2",children:"The recording could not be uploaded."}),S&&C&&k&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(f.Z,{variant:"outlined",color:"buttonStandard",onClick:()=>E(),children:"Retry upload"}),(0,o.jsx)(f.Z,{variant:"outlined",color:"buttonStandard",onClick:()=>R(),children:"Download audio"})]})]})]})})]})})})}function Q(e){let{api:t,start:i}=(0,u.useContext)(J.E),{session:n}=(0,u.useContext)(z.z),r=(0,u.useContext)(F.rZ),s=(0,u.useContext)(M.X),a=(0,p.Z)(),[l,d]=(0,u.useState)(n.facilitationState===c._y.Open),[f,v]=(0,u.useState)(!1),[w,b]=(0,u.useState)(!1),[Z,y]=(0,u.useState)(!1),[S,C]=(0,u.useState)(!1);(0,u.useEffect)(()=>{d(n.facilitationState===c._y.Open)},[n.facilitationState]),(0,u.useEffect)(()=>{y(n.facilitationState===c._y.Open&&n.remoteConfiguration===c.VS.InPerson&&s.data.activity===X.S.deliberation),C(n.facilitationState===c._y.Open&&n.remoteConfiguration===c.VS.InPerson&&(s.data.activity===X.S.deliberation||void 0!==s.data.recordingId))},[s.data.activity,n.facilitationState,n.remoteConfiguration]);let k=async e=>{try{b(!0),await i((0,D.v5)(t,r.user.access_token,r.sessionToken,n.id,e))}catch(e){console.error(e)}finally{b(!1)}},I=async e=>{try{switch(v(!0),e){case c._y.Ready:await i((0,D.T2)(t,r.user.access_token,r.sessionToken,n.id,"reset"));break;case c._y.Open:await i((0,D.T2)(t,r.user.access_token,r.sessionToken,n.id,"open"));break;case c._y.Closed:await i((0,D.T2)(t,r.user.access_token,r.sessionToken,n.id,"close"));break;default:console.warn("Unexpected facilitation switch from menu.")}}catch(e){console.error(e)}finally{v(!1)}};return(0,o.jsx)(m.Z,{position:"static",elevation:0,children:(0,o.jsx)(j.Z,{sx:{bgcolor:a.palette.headerBarBackground.main,color:"black"},children:(0,o.jsxs)(x.Z,{display:"flex",flexDirection:"row",justifyContent:"space-between",style:{width:"100%"},children:[(0,o.jsxs)(x.Z,{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",children:[(0,o.jsx)("img",{src:"/icons/home.svg",style:{height:26,verticalAlign:"middle",marginRight:12,paddingBottom:4}}),(0,o.jsx)(g.Z,{color:"primary",badgeContent:c._y[n.facilitationState],anchorOrigin:{vertical:"bottom",horizontal:"right"},children:(0,o.jsx)(h.Z,{variant:"h5",children:n.sessionName})})]}),l&&(0,o.jsx)(x.Z,{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",children:(0,o.jsx)(E,{startTime:function(e){if(e)return new Date(e)}(n.sessionStartedAt),duration_mins:n.sessionDurationMins})}),(0,o.jsx)(x.Z,{display:"flex",flexDirection:"row",children:(0,o.jsx)($,{enableHint:Z,autoRecord:S})}),(0,o.jsxs)(x.Z,{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",children:[(0,o.jsx)(H,{}),(0,o.jsx)(_,{state:n.facilitationState,fullscreen:n.fullScreen,onFacilitationStateChange:I,onFullScreenChange:k,stateBusy:f,fullscreenBusy:w})]})]})})})}var ee=i(93191);function et(e){let{notes:t}=e;return(0,o.jsx)("span",{dangerouslySetInnerHTML:{__html:t}})}var ei=i(79617),en=i(51847),er=i(33578),es=i(35231),ea=i(50467),eo=i(2842),el=i(9542),ec=i(13971);function ed(e){let{colours:t,data:i}=e,n=e=>{let t={true:{l:!0,r:!1},false:{l:!1,r:!0}};return 0===e.true&&(t.false.l=!0),0===e.false&&(t.true.r=!0),t},[r,s]=(0,u.useState)(n(i));(0,u.useEffect)(()=>{s(n(i))},[i]);let a=e=>[e.l?16:0,e.r?16:0,e.r?16:0,e.l?16:0];return(0,o.jsx)(es.h,{width:"100%",height:40,children:(0,o.jsxs)(ea.v,{layout:"vertical",margin:{left:0,right:0},height:40,data:[{name:"completion",complete:i.true,incomplete:i.false}],children:[(0,o.jsx)(eo.K,{hide:!0,type:"number",max:i.true+i.false}),(0,o.jsx)(el.B,{hide:!0,dataKey:"name",type:"category"}),(0,o.jsx)(ec.$,{dataKey:"complete",stackId:"completion",fill:t[0],radius:a(r.true)}),(0,o.jsx)(ec.$,{dataKey:"incomplete",stackId:"completion",fill:t[1],radius:a(r.false)})]})})}var eu=i(37552),ex=i(8260);(r=a||(a={}))[r.NotAnswered=0]="NotAnswered",r[r.Answered=1]="Answered";let eh=(e,t)=>{var i;let n=null!==(i=ef(e))&&void 0!==i?i:[],r=n.length,s=t.filter(e=>e.enabled&&e.role===c._b.Client),a=s.filter(e=>!n.find(t=>t.participantId===e.deviceId));return{allAnswers:n,relevantParticipants:s,answeredCount:r,participantsWithoutAnswers:a,maxAnswers:n.length+a.length}},ef=e=>null==e?void 0:e.sort((e,t)=>new Date(e.created).getTime()-new Date(t.created).getTime()),ep=(e,t)=>{var i;return[...e.allAnswers.map((e,i)=>({description:eg(e,t),answered:1})),...null!==(i=e.participantsWithoutAnswers.map(e=>({description:em(e),answered:0})))&&void 0!==i?i:[]]},eg=(e,t)=>em(t.find(t=>t.deviceId===e.participantId)),em=e=>{var t,i;return null!==(i=null!==(t=null==e?void 0:e.participantName)&&void 0!==t?t:null==e?void 0:e.deviceName)&&void 0!==i?i:"Unknown"};function ej(e){let{answers:t}=(0,ex.ZP)(e.qid),i=(0,u.useContext)(N.l),[n,r]=(0,u.useState)(i.subscriptions),[s,a]=(0,u.useState)(eh(t,n)),[l,c]=(0,u.useState)([]);(0,u.useEffect)(()=>{r(i.subscriptions)},[i]),(0,u.useEffect)(()=>{a(eh(t,n))},[t,n]),(0,u.useEffect)(()=>{c(ep(s,n))},[s,n]);let d=e=>(0,o.jsxs)(x.Z,{sx:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",borderRadius:2,background:"white",border:"1px solid #EFEFEF",p:2},children:[(0,o.jsx)(h.Z,{variant:"body1",sx:{borderRight:"1px solid black",overflowX:"scroll",textWrap:"nowrap",flexGrow:1,mr:.5,pr:.5},children:e.description}),1===e.answered&&(0,o.jsx)("img",{src:"/icons/checkbox-filled.svg"}),1!==e.answered&&(0,o.jsx)("img",{src:"/icons/checkbox.svg"})]}),f=(0,A.Z)();return(0,o.jsx)("div",{children:e.qid&&(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)(ei.Z,{sx:{background:"transparent"},elevation:0,children:[(0,o.jsx)(en.Z,{expandIcon:(0,o.jsx)(eu.Z,{}),sx:{p:0},children:(0,o.jsx)(ed,{colours:[f.palette.primary.main,"#ededff"],data:{true:s.answeredCount,false:s.participantsWithoutAnswers.length}})}),(0,o.jsxs)(er.Z,{sx:{p:0},children:[(0,o.jsxs)(h.Z,{variant:"body1",sx:{ml:1,mb:1},children:[(0,o.jsx)("img",{src:"/icons/busts.svg",style:{height:26,verticalAlign:"middle",marginRight:12,paddingBottom:4}}),"".concat(s.answeredCount," of ").concat(s.maxAnswers," ")," ",1!==s.answeredCount?"have":"has"," voted"]}),(0,o.jsx)(U.ZP,{container:!0,spacing:2,children:l.map((t,i)=>(0,o.jsx)(U.ZP,{item:!0,xs:12,sm:6,md:4,children:(0,o.jsx)(d,{description:t.description,answered:t.answered})},"answer-indicator-grid-item-".concat(e.qid,"-").concat(i)))})]})]})})})}var ev=i(6722),ew=i(11707);function eb(e){let{orientation:t,showLabels:i}=e,{muted:n,toggleMute:r}=(0,ev.HI)(),{tileId:s,isVideoEnabled:a,hasReachedVideoLimit:l,toggleVideo:c}=(0,ev.Onx)(),d=(0,ev.fjl)();return n?(0,o.jsx)(ev.PjE,{muted:!0}):(0,o.jsx)(ev.PjE,{}),a?(0,o.jsx)(ev.V1s,{}):(0,o.jsx)(ev.V1s,{disabled:!0}),ev.LPZ,(0,o.jsx)(ew.f6,{theme:ev.Wbj,children:(0,o.jsxs)(ev.VSr,{showLabels:i,layout:"horizontal"===t?"undocked-horizontal":"undocked-vertical",style:{boxShadow:"none"},children:[(0,o.jsx)(ev._nn,{}),(0,o.jsx)(ev.V8F,{})]})})}var eZ=i(31164),ey=i(68276),eS=i(8963),eC=i(97340),ek=i(28801);let eI=e=>{void 0!==window&&void 0!==window.localStorage&&window.localStorage.setItem("SlideTimers",JSON.stringify(e))},eT=()=>{if(void 0===window||void 0===window.localStorage)return{};{let e=window.localStorage.getItem("SlideTimers");return null!==e?JSON.parse(e):{}}},e_=e=>{let t=e%60;return"".concat(Math.floor(e/60)," mins, ").concat(t<10?"0":"").concat(t," secs")};function eE(e){let{session:t}=(0,u.useContext)(z.z),i=(0,u.useContext)(M.X),[n,r]=(0,u.useState)(),[s,a]=(0,u.useState)(),l=(0,u.useRef)();(0,u.useEffect)(()=>{r(eT())},[]),(0,u.useEffect)(()=>{void 0!==n&&eI(n)},[n]),(0,u.useEffect)(()=>{if(i.data&&i.data.secs){if(n){if(void 0===n[i.data.index]){console.debug("timer not found");let e={running:t.facilitationState===c._y.Open,startTime:i.data.secs,currentTime:i.data.secs,index:i.data.index};r({...n,[i.data.index]:e}),a(e)}else(void 0===s||s.index!==i.data.index)&&a(n[i.data.index])}}else a(void 0)},[i.data,n]),(0,u.useEffect)(()=>{void 0!==s&&(void 0!==l.current&&clearTimeout(l.current),l.current=setTimeout(d,1e3))},[s]);let d=(0,u.useCallback)(()=>{if(void 0!==l.current&&(clearTimeout(l.current),l.current=void 0),void 0!==s&&s.running&&s.currentTime>0){let e={...s,currentTime:s.currentTime-1};a(e),r({...n,[i.data.index]:e}),l.current=setTimeout(d,1e3)}},[s]);(0,u.useEffect)(()=>{t.facilitationState===c._y.Open?void 0===s||s.running||p():void 0!==s&&s.running&&g()},[t.facilitationState]);let p=()=>{if(void 0!==s){let e={...s,running:!0};a(e),r({...n,[i.data.index]:e}),void 0!==l.current&&clearTimeout(l.current),l.current=setTimeout(d,1e3)}},g=()=>{if(void 0!==s){let e={...s,running:!1};a(e),r({...n,[i.data.index]:e})}},m=()=>{if(void 0!==s){let e={...s,running:!1,currentTime:s.startTime};a(e),r({...n,[i.data.index]:e})}},j=e=>{if(void 0!==s){let t={...s,currentTime:s.currentTime+e};a(t),r({...n,[i.data.index]:t})}},v=s&&!s.running&&s.currentTime>0,w=s&&s.running&&s.currentTime>0;return(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)(x.Z,{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",children:[(0,o.jsxs)(x.Z,{display:"flex",flexDirection:"row",justifyContent:"start",alignItems:"center",children:[(0,o.jsx)("img",{src:"/icons/session-time.svg"}),void 0!==s&&(0,o.jsx)(h.Z,{variant:"h6",sx:{ml:1},children:e_(s.currentTime)})]}),(0,o.jsxs)(x.Z,{display:"flex",flexDirection:"row",justifyContent:"end",alignItems:"center",gap:1,children:[(0,o.jsx)(f.Z,{variant:"outlined",color:"buttonStandard",disabled:!v,onClick:()=>{p()},children:"Start"}),(0,o.jsx)(f.Z,{variant:"outlined",color:"buttonStandard",disabled:!w,onClick:()=>{g()},children:"Pause"}),(0,o.jsx)(f.Z,{variant:"outlined",color:"buttonStandard",onClick:()=>{j(60)},children:"+1 min"}),(0,o.jsx)(f.Z,{variant:"outlined",color:"buttonStandard",onClick:()=>{m()},children:"Reset"})]})]})})}var eD=i(80824);function eF(e){let{session:t}=(0,u.useContext)(z.z),[i,n]=(0,u.useState)(!1),[r,s]=(0,u.useState)(!1),[a,l]=(0,u.useState)(!1);return(0,u.useEffect)(()=>{s(t.facilitationState===c._y.Open)},[t.facilitationState]),(0,u.useEffect)(()=>{l(t.remoteConfiguration===c.VS.InPerson)},[t.remoteConfiguration]),(0,u.useEffect)(()=>{n(r&&a)},[r,a]),(0,o.jsxs)(R.Z,{fullWidth:!0,maxWidth:"sm",open:i,onClose:()=>n(!1),children:[(0,o.jsxs)(eD.Z,{children:["The workshop is now open",(0,o.jsx)(x.Z,{style:{position:"absolute",top:0,right:0},children:(0,o.jsx)(C.Z,{"aria-label":"close",onClick:()=>n(!1),children:(0,o.jsx)(P.Z,{})})})]}),(0,o.jsx)(O.Z,{children:(0,o.jsxs)(x.Z,{sx:{display:"flex",flexDirection:"column",gap:2},children:[(0,o.jsxs)("ul",{children:[r&&(0,o.jsx)("li",{children:"Participants will now be able to enter the session"}),a&&(0,o.jsxs)("li",{children:["A test of the audio recording capability is available, but relevant sections will ",(0,o.jsx)("u",{children:"not"})," be automatically recorded"]})]}),(0,o.jsx)(f.Z,{variant:"contained",sx:{alignSelf:"center",textTransform:"uppercase"},onClick:()=>n(!1),children:"Continue"})]})})]})}var eR=i(53771);function eO(){var e,t,i;let{api:n,start:r}=(0,u.useContext)(J.E),{session:s}=(0,u.useContext)(z.z),a=(0,u.useContext)(F.rZ);(0,u.useContext)(l.p);let d=(0,u.useContext)(M.X),p=(0,u.useContext)(ee.N),g=(0,u.useContext)(N.l),m=(0,u.useContext)(ey.u),j=new eS.ConsoleLogger("Zeitgeist meeting",eS.LogLevel.OFF),[v,w]=(0,u.useState)(void 0),[b,Z]=(0,u.useState)(!1),y=async e=>{try{Z(!0);let t=(0,D.T2)(n,a.user.access_token,a.sessionToken,s.id,e);await r(t)}catch(e){console.error(e)}finally{Z(!1)}};(0,u.useEffect)(()=>{s.facilitationState===c._y.Ready?w((0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(x.Z,{sx:{display:"flex",flexDirection:"row",alignItems:"center"},children:[(0,o.jsx)("img",{src:"/icons/session-participants.svg"}),(0,o.jsxs)(h.Z,{variant:"body1",sx:{ml:1},children:[g.subscriptions.filter(e=>e.deviceId!==a.deviceId).length," waiting"]})]}),(0,o.jsx)(f.Z,{variant:"contained",color:"primary",onClick:()=>y("open"),disabled:b,children:"Open workshop"})]})):s.facilitationState===c._y.Open?w((0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(x.Z,{sx:{display:"flex",flexDirection:"row",alignItems:"center"},children:[(0,o.jsx)("img",{src:"/icons/session-participants.svg"}),(0,o.jsxs)(h.Z,{variant:"body1",sx:{ml:1},children:[g.subscriptions.filter(e=>e.deviceId!==a.deviceId).length," participants"]})]}),(0,o.jsx)(f.Z,{variant:"outlined",color:"buttonStandard",onClick:()=>y("close"),disabled:b,children:"Close workshop"})]})):s.facilitationState===c._y.Closed&&w((0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(x.Z,{sx:{display:"flex",flexDirection:"row",alignItems:"center"},children:[(0,o.jsx)("img",{src:"/icons/session-participants.svg"}),(0,o.jsx)(h.Z,{variant:"body1",sx:{ml:1},children:"closed"})]}),(0,o.jsx)(f.Z,{variant:"outlined",color:"primary",onClick:()=>y("reset"),disabled:b,children:"Open waiting room"})]}))},[s.facilitationState,g,b]);let S=s.remoteConfiguration===c.VS.RemoteWithVideoCall;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(x.Z,{sx:{display:"flex",flexDirection:"column",justifyContent:"flex-start",gap:1,p:1,width:"100vw",height:"100vh",maxWidth:"100vw",maxHeight:"100vh",overflowX:"hidden",overflowY:"hidden"},children:[(0,o.jsx)(eF,{}),(0,o.jsx)(Q,{}),(0,o.jsxs)(x.Z,{sx:{flexGrow:1,flexBasis:"100%",maxHeight:"100%",overflowY:"hidden",display:"flex",flexDirection:"row",gap:1},children:[(0,o.jsx)(x.Z,{sx:{width:"50%",height:"100%",maxHeight:"100%",display:"flex",flexDirection:"column"},children:(0,o.jsx)(eC.Z,{title:"Participant view",tools:v,sx:{flexGrow:1},children:p.presentation})}),(0,o.jsx)(x.Z,{sx:{width:"50%",display:"block",overflow:"hidden"},children:(0,o.jsxs)(x.Z,{sx:{maxHeight:"100%",height:"100%",width:"100%",maxWidth:"100%",display:"flex",flexDirection:"column",gap:1},children:[S&&(0,o.jsx)(ev.ikO,{logger:j,children:(0,o.jsx)(ev.BAg,{children:(0,o.jsx)(ev.lUb,{children:(0,o.jsx)(eC.Z,{sx:{minHeight:"40vh",flexGrow:1},children:(0,o.jsxs)(x.Z,{sx:{width:"100%",height:"100%",display:"flex",flexDirection:"row"},children:[(0,o.jsx)(eb,{orientation:"vertical",showLabels:!1}),(0,o.jsx)(eZ.Z,{role:a.role,facilitationState:s.facilitationState,sid:s.id,sessionToken:a.sessionToken,accessToken:a.user.access_token,participantId:a.deviceId,participantName:null===(e=g.thisUser)||void 0===e?void 0:e.participantName,initialCallPreferences:m.call,sx:{flexGrow:1}})]})})})})}),(null==d?void 0:null===(t=d.data.qids)||void 0===t?void 0:t.length)>0&&(0,o.jsx)(eC.Z,{title:"Votes",scrolling:!1,children:(0,o.jsx)(x.Z,{sx:{display:"flex",flexDirection:"row",flexWrap:"wrap"},children:null===(i=d.data.qids)||void 0===i?void 0:i.map(e=>(0,o.jsx)(x.Z,{sx:{width:d.data.qids.length>1?"50%":"100%"},children:(0,o.jsx)(ej,{sid:s.id,qid:e})},"slide-".concat(d.data.index,"-answer-monitor-").concat(e)))})}),(null==d?void 0:d.data.secs)!==void 0&&d.data.secs>0&&(0,o.jsx)(eC.Z,{scrolling:!1,children:(0,o.jsx)(eE,{data:d.data})}),(0,o.jsx)(eC.Z,{title:"Notes",scrolling:!0,sx:{flexGrow:S?void 0:1,minHeight:"25vh"},children:(0,o.jsx)(et,{notes:d.data.notes})})]})})]})]}),(0,o.jsx)(x.Z,{sx:{position:"fixed",left:4,bottom:4},children:(0,o.jsx)(ek.Z,{})}),(0,o.jsx)(x.Z,{sx:{position:"fixed",right:4,bottom:4},children:(0,o.jsx)(eR.Z,{})})]})}var eP=i(98641);function eU(e){return(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)(eP.Z,{sid:e.sid,joinCode:e.joinCode,refresh:e.refresh,role:c._b.Controller,children:[(0,o.jsx)(d.Z,{}),(0,o.jsx)(eO,{})]})})}var eA=i(16463);function eN(){let e=(0,eA.useSearchParams)(),t=e.get("sid"),i=e.get("code"),n="true"===e.get("refresh");return null===t||null===i?(0,o.jsx)("p",{children:"Missing session id or join code"}):(0,o.jsx)(l.Z,{searchParams:e,children:(0,o.jsx)(eU,{sid:t,joinCode:i,refresh:n})})}},10105:function(e,t,i){"use strict";i.d(t,{k:function(){return r},v:function(){return n}});let n=e=>"".concat(window.location.href.split("/")[0],"//").concat(window.location.href.split("/")[2],"/participant/session?sid=").concat(e.id,"&code=").concat(e.joinCode),r=e=>"".concat(window.location.href.split("/")[0],"//").concat(window.location.href.split("/")[2],"/facilitator/session?sid=").concat(e.id,"&code=").concat(e.joinCode)}},function(e){e.O(0,[49,908,444,866,221,732,887,403,465,810,516,811,610,973,457,971,23,744],function(){return e(e.s=59870)}),_N_E=e.O()}]);