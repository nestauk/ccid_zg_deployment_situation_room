(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[44],{59870:function(e,n,t){Promise.resolve().then(t.bind(t,56930))},56930:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return eH}});var i,s,r,o,a=t(57437),l=t(53622),c=t(94547),d=t(78364),u=t(2265),x=t(60182),h=t(31193),f=t(80511),p=t(96537),g=t(22960),m=t(56019),j=t(71733),v=t(79806),w=t(44228),b=t(42748),Z=t(11656),y=t(47905),S=t(86917),C=t(14595),k=t(60335),I=t(21395),E=t(24072),T=t(76396);function _(e){let n=n=>{n!==e.state&&e.onFacilitationStateChange(n)},t=n=>{n!==e.fullscreen&&e.onFullScreenChange(n)},i=()=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(b.Z,{children:[(0,a.jsx)(Z.Z,{children:(0,a.jsx)(y.Z,{inset:!0,children:(0,a.jsx)("b",{children:"Workshop facilitation"})})},"action-menu-video-heading"),[c._y.Ready,c._y.Open,c._y.Closed].map(t=>(0,a.jsxs)(Z.Z,{disabled:e.stateBusy,onClick:()=>n(t),children:[e.state===t&&(0,a.jsx)(S.Z,{children:(0,a.jsx)(w.Z,{})}),(0,a.jsx)(y.Z,{inset:e.state!==t,children:c._y[t]})]},"action-menu-item-".concat(c._y[t])))]}),(0,a.jsx)(C.Z,{}),(0,a.jsxs)(b.Z,{children:[(0,a.jsx)(Z.Z,{children:(0,a.jsx)(y.Z,{inset:!0,children:(0,a.jsx)("b",{children:"Screen mode"})})},"action-menu-screen-heading"),(0,a.jsxs)(Z.Z,{disabled:e.fullscreenBusy,onClick:()=>t(!0),children:[e.fullscreen&&(0,a.jsx)(S.Z,{children:(0,a.jsx)(w.Z,{})}),(0,a.jsx)(y.Z,{inset:!e.fullscreen,children:"Full screen"})]},"action-menu-item-screen-fullscreen"),(0,a.jsxs)(Z.Z,{disabled:e.fullscreenBusy,onClick:()=>t(!1),children:[!e.fullscreen&&(0,a.jsx)(S.Z,{children:(0,a.jsx)(w.Z,{})}),(0,a.jsx)(y.Z,{inset:e.fullscreen,children:"Windowed"})]},"action-menu-item-screen-windowed")]})]});return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(E.ZP,{variant:"popover",popupId:"facilitation-actions-popup",children:e=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(k.Z,{"aria-label":"settings",...(0,T.vW)(e),children:(0,a.jsx)("img",{src:"/icons//settings.svg"})}),(0,a.jsx)(I.Z,{...(0,T.wK)(e),children:(0,a.jsx)(i,{})})]})})})}function D(e){let[n,t]=(0,u.useState)(""),i=(0,u.useRef)();(0,u.useEffect)(()=>{if(e.startTime)return i.current=setInterval(s,1e3),()=>{clearInterval(i.current)};i.current&&(clearInterval(i.current),i.current=void 0),t("")},[e.startTime,e.duration_mins]);let s=(0,u.useCallback)(()=>{if(e.startTime){let n=new Date().getTime()-e.startTime.getTime();e.duration_mins&&(n=Math.max(6e4*e.duration_mins-n,0));let i=Math.floor(n/36e5),s=Math.floor((n-=36e5*i)/6e4),r=Math.floor((n-=6e4*s)/1e3);n-=1e3*r,t("".concat(i.toString().padStart(2,"0"),":").concat(s.toString().padStart(2,"0"),":").concat(r.toString().padStart(2,"0")))}else t("")},[e.startTime,e.duration_mins]);return(0,a.jsxs)(f.Z,{variant:"h5",children:[(0,a.jsx)("img",{src:"/icons/clock.svg",style:{height:26,verticalAlign:"middle",marginRight:12,paddingBottom:4}}),n]})}let R=(e,n,t,i,s)=>e.postFacilitatorAction(n,t,{action:"fullscreen",sessionId:i,parameters:{full:s}}),F=(e,n,t,i,s)=>e.postFacilitatorAction(n,t,{action:s,sessionId:i});var P=t(5085),O=t(69065),A=t(66124),U=t(7630),N=t(58433),H=t(14874),W=t(70883),B=t(10105),L=t(37570);function M(){let e=(0,u.useContext)(L.H),n=(0,u.useContext)(W.l),t=(0,H.Z)(),i=e=>"Device: ".concat(e.deviceName),s=e=>e.role===c._b.Controller?"\uD83D\uDD79️":"",r=e=>e.participantName&&e.participantName.length>0?e.participantName:null,o=e=>{let{connected:n}=e;return(0,a.jsx)(h.Z,{sx:{p:1,borderRadius:4,height:42},style:{background:n?t.palette.connected.main:t.palette.disconnected.main},children:(0,a.jsx)("img",{style:{height:26,margin:0,padding:0},src:n?"/icons/device-connected.svg":"/icons/device-disconnected.svg"})})};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(f.Z,{variant:"h6",component:"h2",children:"Participants"}),(0,a.jsx)(N.ZP,{container:!0,spacing:2,sx:{mt:2},children:n.subscriptions.map(e=>(0,a.jsx)(N.ZP,{item:!0,xs:6,children:(0,a.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[(0,a.jsx)(o,{connected:e.enabled}),(0,a.jsxs)(h.Z,{sx:{ml:2},children:[(0,a.jsxs)(f.Z,{variant:"h6",children:[s(e),r(e)]}),(0,a.jsx)(f.Z,{variant:"body1",children:i(e)})]})]})},"connection-indicator-".concat(e.subscriptionId)))}),(0,a.jsx)(p.Z,{variant:"outlined",color:"buttonStandard",sx:{flexGrow:1,alignSelf:"start",mt:4},onClick:()=>{var n;null===(n=navigator)||void 0===n||n.clipboard.writeText((0,B.v)(e.session))},children:"Copy participant link"})]})}function V(){let[e,n]=(0,u.useState)(!1),t=()=>{n(!1)};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(k.Z,{"aria-label":"settings",onClick:()=>{n(!0)},children:(0,a.jsx)("img",{src:"/icons/session-participants.svg"})}),(0,a.jsx)(O.Z,{fullWidth:!0,maxWidth:"md",open:e,onClose:t,children:(0,a.jsxs)(A.Z,{children:[(0,a.jsx)(h.Z,{style:{position:"absolute",top:0,right:0},children:(0,a.jsx)(k.Z,{"aria-label":"close",onClick:t,children:(0,a.jsx)(U.Z,{})})}),(0,a.jsx)(h.Z,{sx:{p:2},display:"flex",flexDirection:"column",alignItems:"center",children:(0,a.jsx)(M,{})})]})})]})}var q=t(65301);(i=r||(r={}))[i.Ready=0]="Ready",i[i.InitError=1]="InitError",i[i.Recording=2]="Recording",i[i.Saving=3]="Saving",i[i.UploadSuccess=4]="UploadSuccess",i[i.UploadError=5]="UploadError";var z=t(4766),G=t(18502),X=t(63375),K=t(83040),J=t(15785),Y=t(60658),$=t(99341);let Q=e=>{var n;return"".concat(null!==(n=e.recordingId)&&void 0!==n?n:"slide-"+"".concat(e.index).padStart(3,"0"))};function ee(e){let{api:n,start:t}=(0,$.Z)(),i=(0,u.useContext)(P.rZ),s=(0,u.useContext)(z.X),r=(0,u.useContext)(L.H),[o,l]=(0,u.useState)(Q(s.data)),[c,d]=(0,u.useState)(!1),[x,m]=(0,u.useState)(!1),[j,v]=(0,u.useState)(!1),{record:w,stop:b,isRecording:Z,recordingTime:y,audioBlob:S,filenamePart:C,filenameSuffix:k,clearRecording:I}=function(){let[e,n]=(0,u.useState)(0),[t,i]=(0,u.useState)(void 0),[s,r]=(0,u.useState)(),{startRecording:o,stopRecording:a,togglePauseResume:l,recordingBlob:c,isRecording:d,isPaused:x,recordingTime:h,mediaRecorder:f}=(0,q.I)({noiseSuppression:!0,autoGainControl:!0},e=>{n(1)},{mimeType:"audio/webm"}),p=e=>"audio-recording-".concat(e);return(0,u.useEffect)(()=>{n(d?2:0)},[d]),(0,u.useEffect)(()=>{void 0!==c&&i(c)},[c]),{record:e=>{r(p(e)),o()},stop:()=>{a()},state:e,audioBlob:t,recordingTime:h,isRecording:d,filenamePart:s,filenameSuffix:"webm",clearRecording:()=>{i(void 0),r(void 0)}}}();(0,u.useEffect)(()=>{Z&&(console.debug("Stopping recording due to slide change."),b());let e=Q(s.data);console.debug("New slide id: ".concat(e)),l(e)},[s.data.index]),(0,u.useEffect)(()=>{d(Z),Z&&v(!1)},[Z]),(0,u.useEffect)(()=>{Z||void 0===S||void 0===C||_()},[S]);let _=()=>{if(void 0===S||void 0===C){console.debug("Audio blob or filename part empty. Skipping upload.");return}if(0===S.size){console.debug("Audio recording is empty. Skipping upload.");return}console.debug("Initiating upload for recording: <guid>-".concat(C,"-<guid>.").concat(k)),v(!1),m(!0),D(S,C,k).then(()=>{console.debug("Upload complete"),v(!1),I()}).catch(e=>{console.error("Upload failed",e),v(!0)}).finally(()=>{m(!1)})},D=async(e,s,o)=>{console.debug("Retrieving recording upload info...");let a=await t(n.getMediaUploadUrl(r.sid,i.sessionToken,i.user.access_token,"deliberation",s,o));console.debug("Uploading recording...",a),await t((0,Y.P)(e,a.uploadUrl)),console.debug("Upload recording complete.")},R=()=>{if(void 0===S||0===S.size){console.debug("Audio blob empty. Skipping download.");return}let e="recording-".concat(null!=C?C:"unknown",".").concat(k);console.debug("Downloading audio recording..."),function(e,n){let t=URL.createObjectURL(e),i=document.createElement("a");i.href=t,i.download=n;try{document.body.appendChild(i),i.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window}))}catch(e){console.error("Error downloading blob",e)}finally{document.body.removeChild(i)}}(S,e)},F=(0,g.Z)();return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(E.ZP,{variant:"popover",popupId:"recording-information-popup",children:n=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(p.Z,{startIcon:(0,a.jsx)(X.Z,{htmlColor:c?F.palette.recordingEnabled.main:x?F.palette.recordingUploading.main:j?F.palette.recordingFailed.main:F.palette.recordingDisabled.main}),endIcon:(0,a.jsx)(K.Z,{color:"action"}),variant:"text",color:"buttonStandard","aria-label":"Recording information",sx:{opacity:e.enableHint?1:.3},...(0,T.LI)(n),children:["Recording: ",c?"Active":x?"Uploading...":j?"Upload error":"Inactive"]}),(0,a.jsx)(G.ZP,{...(0,T.ZW)(n),anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},children:(0,a.jsxs)(h.Z,{sx:{p:1,display:"flex",flexDirection:"column",gap:1},children:[!Z&&(0,a.jsx)(p.Z,{variant:e.enableHint?"contained":"outlined",color:e.enableHint?"primary":"buttonStandard",onClick:()=>w(o),children:"Start Recording"}),Z&&(0,a.jsx)(p.Z,{variant:"outlined",color:"buttonStandard",onClick:()=>b(),children:"Stop Recording"}),(0,a.jsxs)(f.Z,{variant:"body2",children:["Slide activity: ",J.S[s.data.activity]]}),s.data.recordingId&&(0,a.jsxs)(f.Z,{variant:"body2",children:["Deliberation id: ",o,(0,a.jsx)("br",{})]}),Z&&(0,a.jsxs)(f.Z,{variant:"body2",sx:{fontSize:"0.5rem"},children:["Recording: ",y]}),j&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(h.Z,{sx:{display:"flex",flexDirection:"row",gap:1,alignItems:"center"},children:[(0,a.jsx)(X.Z,{htmlColor:F.palette.recordingFailed.main}),(0,a.jsx)(f.Z,{variant:"body1",children:"Recording upload failed"})]}),(0,a.jsx)(f.Z,{variant:"body2",children:"The recording could not be uploaded."}),S&&C&&k&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(p.Z,{variant:"outlined",color:"buttonStandard",onClick:()=>_(),children:"Retry upload"}),(0,a.jsx)(p.Z,{variant:"outlined",color:"buttonStandard",onClick:()=>R(),children:"Download audio"})]})]})]})})]})})})}function en(e){let{api:n,start:t}=(0,$.Z)(),i=(0,u.useContext)(L.H),s=(0,u.useContext)(x.d),r=(0,u.useContext)(P.rZ),o=(0,u.useContext)(z.X),l=(0,g.Z)(),[d,p]=(0,u.useState)(s.facilitationState===c._y.Open),[w,b]=(0,u.useState)(!1),[Z,y]=(0,u.useState)(!1),[S,C]=(0,u.useState)(!1),[k,I]=(0,u.useState)(!1);(0,u.useEffect)(()=>{p(s.facilitationState===c._y.Open)},[s]),(0,u.useEffect)(()=>{C(s.facilitationState===c._y.Open&&s.inPersonRecordingEnabled&&i.session.remoteConfiguration===c.VS.InPerson&&o.data.activity===J.S.deliberation),I(s.facilitationState===c._y.Open&&s.inPersonRecordingEnabled&&i.session.remoteConfiguration===c.VS.InPerson&&(o.data.activity===J.S.deliberation||void 0!==o.data.recordingId))},[o.data.activity,s.inPersonRecordingEnabled,s.facilitationState,i.session.remoteConfiguration]);let E=async e=>{try{y(!0),await t(R(n,r.user.access_token,r.sessionToken,i.session.id,e))}catch(e){console.error(e)}finally{y(!1)}},T=async e=>{try{switch(b(!0),e){case c._y.Ready:await t(F(n,r.user.access_token,r.sessionToken,i.session.id,"reset"));break;case c._y.Open:await t(F(n,r.user.access_token,r.sessionToken,i.session.id,"open"));break;case c._y.Closed:await t(F(n,r.user.access_token,r.sessionToken,i.session.id,"close"));break;default:console.warn("Unexpected facilitation switch from menu.")}}catch(e){console.error(e)}finally{b(!1)}};return(0,a.jsx)(j.Z,{position:"static",elevation:0,children:(0,a.jsx)(v.Z,{sx:{bgcolor:l.palette.headerBarBackground.main,color:"black"},children:(0,a.jsxs)(h.Z,{display:"flex",flexDirection:"row",justifyContent:"space-between",style:{width:"100%"},children:[(0,a.jsxs)(h.Z,{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",children:[(0,a.jsx)("img",{src:"/icons/home.svg",style:{height:26,verticalAlign:"middle",marginRight:12,paddingBottom:4}}),(0,a.jsx)(m.Z,{color:"primary",badgeContent:c._y[s.facilitationState],anchorOrigin:{vertical:"bottom",horizontal:"right"},children:(0,a.jsx)(f.Z,{variant:"h5",children:i.session.sessionName})})]}),d&&(0,a.jsx)(h.Z,{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",children:(0,a.jsx)(D,{startTime:s.sessionStartedAt,duration_mins:i.session.sessionDurationMins})}),s.inPersonRecordingEnabled&&(0,a.jsx)(h.Z,{display:"flex",flexDirection:"row",children:(0,a.jsx)(ee,{enableHint:S,autoRecord:k})}),(0,a.jsxs)(h.Z,{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",children:[(0,a.jsx)(V,{}),(0,a.jsx)(_,{state:s.facilitationState,fullscreen:s.fullScreen,onFacilitationStateChange:T,onFullScreenChange:E,stateBusy:w,fullscreenBusy:Z})]})]})})})}var et=t(93191);function ei(e){let{notes:n}=e;return(0,a.jsx)("span",{dangerouslySetInnerHTML:{__html:n}})}var es=t(79617),er=t(51847),eo=t(33578),ea=t(35231),el=t(50467),ec=t(2842),ed=t(9542),eu=t(13971);function ex(e){let{colours:n,data:t}=e,i=e=>{let n={true:{l:!0,r:!1},false:{l:!1,r:!0}};return 0===e.true&&(n.false.l=!0),0===e.false&&(n.true.r=!0),n},[s,r]=(0,u.useState)(i(t));(0,u.useEffect)(()=>{r(i(t))},[t]);let o=e=>[e.l?16:0,e.r?16:0,e.r?16:0,e.l?16:0];return(0,a.jsx)(ea.h,{width:"100%",height:40,children:(0,a.jsxs)(el.v,{layout:"vertical",margin:{left:0,right:0},height:40,data:[{name:"completion",complete:t.true,incomplete:t.false}],children:[(0,a.jsx)(ec.K,{hide:!0,type:"number",max:t.true+t.false}),(0,a.jsx)(ed.B,{hide:!0,dataKey:"name",type:"category"}),(0,a.jsx)(eu.$,{dataKey:"complete",stackId:"completion",fill:n[0],radius:o(s.true)}),(0,a.jsx)(eu.$,{dataKey:"incomplete",stackId:"completion",fill:n[1],radius:o(s.false)})]})})}var eh=t(74382),ef=t(37552);(s=o||(o={}))[s.NotAnswered=0]="NotAnswered",s[s.Answered=1]="Answered";let ep=(e,n)=>{var t;let i=null!==(t=eg(e.answers))&&void 0!==t?t:[],s=i.length,r=n.filter(e=>e.enabled&&e.role===c._b.Client),o=r.filter(e=>!i.find(n=>n.participantId===e.deviceId));return{allAnswers:i,relevantParticipants:r,answeredCount:s,participantsWithoutAnswers:o,maxAnswers:i.length+o.length}},eg=e=>null==e?void 0:e.sort((e,n)=>new Date(e.created).getTime()-new Date(n.created).getTime()),em=(e,n)=>{var t;return[...e.allAnswers.map((e,t)=>({description:ej(e,n),answered:1})),...null!==(t=e.participantsWithoutAnswers.map(e=>({description:ev(e),answered:0})))&&void 0!==t?t:[]]},ej=(e,n)=>ev(n.find(n=>n.deviceId===e.participantId)),ev=e=>{var n,t;return null!==(t=null!==(n=null==e?void 0:e.participantName)&&void 0!==n?n:null==e?void 0:e.deviceName)&&void 0!==t?t:"Unknown"};function ew(e){let n=(0,u.useContext)(eh.v1),t=(0,u.useContext)(W.l),i=()=>{var t;return{qid:e.qid,answers:null!==(t=n.allAnswers[e.qid])&&void 0!==t?t:[]}},[s,r]=(0,u.useState)(i()),[o,l]=(0,u.useState)(t.subscriptions),[c,d]=(0,u.useState)(ep(s,o)),[x,p]=(0,u.useState)([]);(0,u.useEffect)(()=>{l(t.subscriptions)},[t]),(0,u.useEffect)(()=>{r(i())},[n]),(0,u.useEffect)(()=>{d(ep(s,o))},[s,o]),(0,u.useEffect)(()=>{p(em(c,o))},[c,o]);let g=e=>(0,a.jsxs)(h.Z,{sx:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",borderRadius:2,background:"white",border:"1px solid #EFEFEF",p:2},children:[(0,a.jsx)(f.Z,{variant:"body1",sx:{borderRight:"1px solid black",overflowX:"scroll",textWrap:"nowrap",flexGrow:1,mr:.5,pr:.5},children:e.description}),1===e.answered&&(0,a.jsx)("img",{src:"/icons/checkbox-filled.svg"}),1!==e.answered&&(0,a.jsx)("img",{src:"/icons/checkbox.svg"})]}),m=(0,H.Z)();return(0,a.jsx)("div",{children:e.qid&&(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(es.Z,{sx:{background:"transparent"},elevation:0,children:[(0,a.jsx)(er.Z,{expandIcon:(0,a.jsx)(ef.Z,{}),sx:{p:0},children:(0,a.jsx)(ex,{colours:[m.palette.primary.main,"#ededff"],data:{true:c.answeredCount,false:c.participantsWithoutAnswers.length}})}),(0,a.jsxs)(eo.Z,{sx:{p:0},children:[(0,a.jsxs)(f.Z,{variant:"body1",sx:{ml:1,mb:1},children:[(0,a.jsx)("img",{src:"/icons/busts.svg",style:{height:26,verticalAlign:"middle",marginRight:12,paddingBottom:4}}),"".concat(c.answeredCount," of ").concat(c.maxAnswers," ")," ",1!==c.answeredCount?"have":"has"," voted"]}),(0,a.jsx)(N.ZP,{container:!0,spacing:2,children:x.map((n,t)=>(0,a.jsx)(N.ZP,{item:!0,xs:12,sm:6,md:4,children:(0,a.jsx)(g,{description:n.description,answered:n.answered})},"answer-indicator-grid-item-".concat(e.qid,"-").concat(t)))})]})]})})})}var eb=t(6722),eZ=t(11707);function ey(e){let{orientation:n,showLabels:t}=e,{muted:i,toggleMute:s}=(0,eb.HI)(),{tileId:r,isVideoEnabled:o,hasReachedVideoLimit:l,toggleVideo:c}=(0,eb.Onx)(),d=(0,eb.fjl)();return i?(0,a.jsx)(eb.PjE,{muted:!0}):(0,a.jsx)(eb.PjE,{}),o?(0,a.jsx)(eb.V1s,{}):(0,a.jsx)(eb.V1s,{disabled:!0}),eb.LPZ,(0,a.jsx)(eZ.f6,{theme:eb.Wbj,children:(0,a.jsxs)(eb.VSr,{showLabels:t,layout:"horizontal"===n?"undocked-horizontal":"undocked-vertical",style:{boxShadow:"none"},children:[(0,a.jsx)(eb._nn,{}),(0,a.jsx)(eb.V8F,{})]})})}var eS=t(31164),eC=t(68276),ek=t(8963),eI=t(97340),eE=t(28801);let eT=e=>{void 0!==window&&void 0!==window.localStorage&&window.localStorage.setItem("SlideTimers",JSON.stringify(e))},e_=()=>{if(void 0===window||void 0===window.localStorage)return{};{let e=window.localStorage.getItem("SlideTimers");return null!==e?JSON.parse(e):{}}},eD=e=>{let n=e%60;return"".concat(Math.floor(e/60)," mins, ").concat(n<10?"0":"").concat(n," secs")};function eR(e){let n=(0,u.useContext)(z.X),t=(0,u.useContext)(x.d),[i,s]=(0,u.useState)(),[r,o]=(0,u.useState)(),l=(0,u.useRef)();(0,u.useEffect)(()=>{s(e_())},[]),(0,u.useEffect)(()=>{void 0!==i&&eT(i)},[i]),(0,u.useEffect)(()=>{if(n.data&&n.data.secs){if(i){if(void 0===i[n.data.index]){console.debug("timer not found");let e={running:t.facilitationState===c._y.Open,startTime:n.data.secs,currentTime:n.data.secs,index:n.data.index};s({...i,[n.data.index]:e}),o(e)}else(void 0===r||r.index!==n.data.index)&&o(i[n.data.index])}}else o(void 0)},[n.data,i]),(0,u.useEffect)(()=>{void 0!==r&&(void 0!==l.current&&clearTimeout(l.current),l.current=setTimeout(d,1e3))},[r]);let d=(0,u.useCallback)(()=>{if(void 0!==l.current&&(clearTimeout(l.current),l.current=void 0),void 0!==r&&r.running&&r.currentTime>0){let e={...r,currentTime:r.currentTime-1};o(e),s({...i,[n.data.index]:e}),l.current=setTimeout(d,1e3)}},[r]);(0,u.useEffect)(()=>{t.facilitationState===c._y.Open?void 0===r||r.running||g():void 0!==r&&r.running&&m()},[t.facilitationState]);let g=()=>{if(void 0!==r){let e={...r,running:!0};o(e),s({...i,[n.data.index]:e}),void 0!==l.current&&clearTimeout(l.current),l.current=setTimeout(d,1e3)}},m=()=>{if(void 0!==r){let e={...r,running:!1};o(e),s({...i,[n.data.index]:e})}},j=()=>{if(void 0!==r){let e={...r,running:!1,currentTime:r.startTime};o(e),s({...i,[n.data.index]:e})}},v=e=>{if(void 0!==r){let t={...r,currentTime:r.currentTime+e};o(t),s({...i,[n.data.index]:t})}},w=r&&!r.running&&r.currentTime>0,b=r&&r.running&&r.currentTime>0;return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(h.Z,{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",children:[(0,a.jsxs)(h.Z,{display:"flex",flexDirection:"row",justifyContent:"start",alignItems:"center",children:[(0,a.jsx)("img",{src:"/icons/session-time.svg"}),void 0!==r&&(0,a.jsx)(f.Z,{variant:"h6",sx:{ml:1},children:eD(r.currentTime)})]}),(0,a.jsxs)(h.Z,{display:"flex",flexDirection:"row",justifyContent:"end",alignItems:"center",gap:1,children:[(0,a.jsx)(p.Z,{variant:"outlined",color:"buttonStandard",disabled:!w,onClick:()=>{g()},children:"Start"}),(0,a.jsx)(p.Z,{variant:"outlined",color:"buttonStandard",disabled:!b,onClick:()=>{m()},children:"Pause"}),(0,a.jsx)(p.Z,{variant:"outlined",color:"buttonStandard",onClick:()=>{v(60)},children:"+1 min"}),(0,a.jsx)(p.Z,{variant:"outlined",color:"buttonStandard",onClick:()=>{j()},children:"Reset"})]})]})})}var eF=t(80824);function eP(e){let n=(0,u.useContext)(x.d),t=(0,u.useContext)(L.H),[i,s]=(0,u.useState)(!1),[r,o]=(0,u.useState)(!1),[l,d]=(0,u.useState)(!1);return(0,u.useEffect)(()=>{o(n.facilitationState===c._y.Open)},[n.facilitationState]),(0,u.useEffect)(()=>{d(t.session.remoteConfiguration===c.VS.InPerson&&n.inPersonRecordingEnabled)},[n.inPersonRecordingEnabled,t.session.remoteConfiguration]),(0,u.useEffect)(()=>{s(r&&l)},[r,l]),(0,a.jsxs)(O.Z,{fullWidth:!0,maxWidth:"sm",open:i,onClose:()=>s(!1),children:[(0,a.jsxs)(eF.Z,{children:["The workshop is now open",(0,a.jsx)(h.Z,{style:{position:"absolute",top:0,right:0},children:(0,a.jsx)(k.Z,{"aria-label":"close",onClick:()=>s(!1),children:(0,a.jsx)(U.Z,{})})})]}),(0,a.jsx)(A.Z,{children:(0,a.jsxs)(h.Z,{sx:{display:"flex",flexDirection:"column",gap:2},children:[(0,a.jsxs)("ul",{children:[r&&(0,a.jsx)("li",{children:"Participants will now be able to enter the session"}),l&&(0,a.jsx)("li",{children:"Relevant sections will be automatically recorded"})]}),(0,a.jsx)(p.Z,{variant:"contained",sx:{alignSelf:"center",textTransform:"uppercase"},onClick:()=>s(!1),children:"Continue"})]})})]})}function eO(){var e,n,t;let{api:i,start:s}=(0,$.Z)(),r=(0,u.useContext)(P.rZ);(0,u.useContext)(l.p);let o=(0,u.useContext)(L.H),d=(0,u.useContext)(x.d),g=(0,u.useContext)(z.X),m=(0,u.useContext)(et.N),j=(0,u.useContext)(W.l),v=(0,u.useContext)(eC.u),w=new ek.ConsoleLogger("Zeitgeist meeting",ek.LogLevel.OFF),[b,Z]=(0,u.useState)(void 0),[y,S]=(0,u.useState)(!1),C=async e=>{try{S(!0);let n=F(i,r.user.access_token,r.sessionToken,o.sid,e);await s(n)}catch(e){console.error(e)}finally{S(!1)}};(0,u.useEffect)(()=>{d.facilitationState===c._y.Ready?Z((0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(h.Z,{sx:{display:"flex",flexDirection:"row",alignItems:"center"},children:[(0,a.jsx)("img",{src:"/icons/session-participants.svg"}),(0,a.jsxs)(f.Z,{variant:"body1",sx:{ml:1},children:[j.subscriptions.filter(e=>e.deviceId!==r.deviceId).length," waiting"]})]}),(0,a.jsx)(p.Z,{variant:"contained",color:"primary",onClick:()=>C("open"),disabled:y,children:"Open workshop"})]})):d.facilitationState===c._y.Open?Z((0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(h.Z,{sx:{display:"flex",flexDirection:"row",alignItems:"center"},children:[(0,a.jsx)("img",{src:"/icons/session-participants.svg"}),(0,a.jsxs)(f.Z,{variant:"body1",sx:{ml:1},children:[j.subscriptions.filter(e=>e.deviceId!==r.deviceId).length," participants"]})]}),(0,a.jsx)(p.Z,{variant:"outlined",color:"buttonStandard",onClick:()=>C("close"),disabled:y,children:"Close workshop"})]})):d.facilitationState===c._y.Closed&&Z((0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(h.Z,{sx:{display:"flex",flexDirection:"row",alignItems:"center"},children:[(0,a.jsx)("img",{src:"/icons/session-participants.svg"}),(0,a.jsx)(f.Z,{variant:"body1",sx:{ml:1},children:"closed"})]}),(0,a.jsx)(p.Z,{variant:"outlined",color:"primary",onClick:()=>C("reset"),disabled:y,children:"Open waiting room"})]}))},[d.facilitationState,j,y]);let k=o.session.remoteConfiguration===c.VS.RemoteWithVideoCall;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(h.Z,{sx:{display:"flex",flexDirection:"column",justifyContent:"flex-start",gap:1,p:1,width:"100vw",height:"100vh",maxWidth:"100vw",maxHeight:"100vh",overflowX:"hidden",overflowY:"hidden"},children:[(0,a.jsx)(eP,{}),(0,a.jsx)(en,{}),(0,a.jsxs)(h.Z,{sx:{flexGrow:1,flexBasis:"100%",maxHeight:"100%",overflowY:"hidden",display:"flex",flexDirection:"row",gap:1},children:[(0,a.jsx)(h.Z,{sx:{width:"50%",height:"100%",maxHeight:"100%",display:"flex",flexDirection:"column"},children:(0,a.jsx)(eI.Z,{title:"Participant view",tools:b,sx:{flexGrow:1},children:m.presentation})}),(0,a.jsx)(h.Z,{sx:{width:"50%",display:"block",overflow:"hidden"},children:(0,a.jsxs)(h.Z,{sx:{maxHeight:"100%",height:"100%",width:"100%",maxWidth:"100%",display:"flex",flexDirection:"column",gap:1},children:[k&&(0,a.jsx)(eb.ikO,{logger:w,children:(0,a.jsx)(eb.BAg,{children:(0,a.jsx)(eb.lUb,{children:(0,a.jsx)(eI.Z,{sx:{minHeight:"40vh",flexGrow:1},children:(0,a.jsxs)(h.Z,{sx:{width:"100%",height:"100%",display:"flex",flexDirection:"row"},children:[(0,a.jsx)(ey,{orientation:"vertical",showLabels:!1}),(0,a.jsx)(eS.Z,{role:r.role,facilitationState:d.facilitationState,sid:o.sid,sessionToken:r.sessionToken,accessToken:r.user.access_token,participantId:r.deviceId,participantName:null===(e=j.thisUser)||void 0===e?void 0:e.participantName,initialCallPreferences:v.call,sx:{flexGrow:1}})]})})})})}),(null==g?void 0:null===(n=g.data.qids)||void 0===n?void 0:n.length)>0&&(0,a.jsx)(eI.Z,{title:"Votes",scrolling:!1,children:(0,a.jsx)(h.Z,{sx:{display:"flex",flexDirection:"row",flexWrap:"wrap"},children:null===(t=g.data.qids)||void 0===t?void 0:t.map(e=>(0,a.jsx)(h.Z,{sx:{width:g.data.qids.length>1?"50%":"100%"},children:(0,a.jsx)(ew,{sid:o.sid,qid:e})},"slide-".concat(g.data.index,"-answer-monitor-").concat(e)))})}),(null==g?void 0:g.data.secs)!==void 0&&g.data.secs>0&&(0,a.jsx)(eI.Z,{scrolling:!1,children:(0,a.jsx)(eR,{data:g.data})}),(0,a.jsx)(eI.Z,{title:"Notes",scrolling:!0,sx:{flexGrow:k?void 0:1,minHeight:"25vh"},children:(0,a.jsx)(ei,{notes:g.data.notes})})]})})]})]}),(0,a.jsx)(h.Z,{sx:{position:"fixed",left:4,bottom:4},children:(0,a.jsx)(eE.Z,{})})]})}var eA=t(82297);function eU(e){return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(eA.Z,{sid:e.sid,joinCode:e.joinCode,refresh:e.refresh,role:c._b.Controller,children:[(0,a.jsx)(d.Z,{}),(0,a.jsx)(eO,{})]})})}var eN=t(16463);function eH(){let e=(0,eN.useSearchParams)(),n=e.get("sid"),t=e.get("code"),i="true"===e.get("refresh");return null===n||null===t?(0,a.jsx)("p",{children:"Missing session id or join code"}):(0,a.jsx)(l.Z,{searchParams:e,children:(0,a.jsx)(eU,{sid:n,joinCode:t,refresh:i})})}},10105:function(e,n,t){"use strict";t.d(n,{k:function(){return s},v:function(){return i}});let i=e=>"".concat(window.location.href.split("/")[0],"//").concat(window.location.href.split("/")[2],"/participant/session?sid=").concat(e.id,"&code=").concat(e.joinCode),s=e=>"".concat(window.location.href.split("/")[0],"//").concat(window.location.href.split("/")[2],"/facilitator/session?sid=").concat(e.id,"&code=").concat(e.joinCode)}},function(e){e.O(0,[49,908,444,866,221,732,887,403,465,810,516,811,610,506,758,971,23,744],function(){return e(e.s=59870)}),_N_E=e.O()}]);