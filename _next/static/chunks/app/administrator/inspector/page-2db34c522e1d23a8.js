(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[382],{78005:function(e,t,s){Promise.resolve().then(s.bind(s,11255))},68935:function(e,t,s){"use strict";s.d(t,{Z:function(){return S}});var i=s(23950),n=s(22988),o=s(2265),a=s(44839),r=s(87542),c=s(26259),l=s(41259),d=s(48762),u=s(47794),h=s(13143),p=s(57437);let m=["className","component","disableGutters","fixed","maxWidth","classes"],g=(0,h.Z)(),b=(0,u.Z)("div",{name:"MuiContainer",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:s}=e;return[t.root,t[`maxWidth${(0,l.Z)(String(s.maxWidth))}`],s.fixed&&t.fixed,s.disableGutters&&t.disableGutters]}}),f=e=>(0,d.Z)({props:e,name:"MuiContainer",defaultTheme:g}),v=(e,t)=>{let{classes:s,fixed:i,disableGutters:n,maxWidth:o}=e,a={root:["root",o&&`maxWidth${(0,l.Z)(String(o))}`,i&&"fixed",n&&"disableGutters"]};return(0,c.Z)(a,e=>(0,r.ZP)(t,e),s)};function S(e={}){let{createStyledComponent:t=b,useThemeProps:s=f,componentName:r="MuiContainer"}=e,c=t(({theme:e,ownerState:t})=>(0,n.Z)({width:"100%",marginLeft:"auto",boxSizing:"border-box",marginRight:"auto",display:"block"},!t.disableGutters&&{paddingLeft:e.spacing(2),paddingRight:e.spacing(2),[e.breakpoints.up("sm")]:{paddingLeft:e.spacing(3),paddingRight:e.spacing(3)}}),({theme:e,ownerState:t})=>t.fixed&&Object.keys(e.breakpoints.values).reduce((t,s)=>{let i=e.breakpoints.values[s];return 0!==i&&(t[e.breakpoints.up(s)]={maxWidth:`${i}${e.breakpoints.unit}`}),t},{}),({theme:e,ownerState:t})=>(0,n.Z)({},"xs"===t.maxWidth&&{[e.breakpoints.up("xs")]:{maxWidth:Math.max(e.breakpoints.values.xs,444)}},t.maxWidth&&"xs"!==t.maxWidth&&{[e.breakpoints.up(t.maxWidth)]:{maxWidth:`${e.breakpoints.values[t.maxWidth]}${e.breakpoints.unit}`}}));return o.forwardRef(function(e,t){let o=s(e),{className:l,component:d="div",disableGutters:u=!1,fixed:h=!1,maxWidth:g="lg"}=o,b=(0,i.Z)(o,m),f=(0,n.Z)({},o,{component:d,disableGutters:u,fixed:h,maxWidth:g}),S=v(f,r);return(0,p.jsx)(c,(0,n.Z)({as:d,ownerState:f,className:(0,a.Z)(S.root,l),ref:t},b))})}},11255:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return x}});var i=s(57437),n=s(2265),o=s(80511),a=s(96537),r=s(44908),c=s(65786),l=s(20920),d=s(95107),u=s(16463),h=s(67022),p=s(94547);let m=(0,s(68935).Z)();var g=s(99341);(0,l.Z)();let b={id:void 0,created:void 0,sessionName:"test session",sessionDescription:"a test session",sessionSlug:"test",creatorSub:void 0,joinCode:void 0,sessionPresentationUris:["/workshops/dev-testing/presentation.xml"],sessionStartTime:new Date,sessionDurationMins:20,remoteConfiguration:p.VS.InPerson,chimeMeetingDataId:void 0,chimeMeetingData:void 0,answers:[],audience:p.EQ.LiveWorkshop,facilitationState:p._y.Ready,fullScreen:!0,sessionStartedAt:void 0,facilitatorEmail:"lewis.westbury@nesta.org.uk",location:void 0,documentation:void 0,anticipatedParticipants:12},f=[{name:"Zeitgeist demo",description:"A Zeitgeist demonstration workshop.",slug:"zg-demo",alt:"Illustrative graphic",uris:["/workshops/zg-demo/presentation.xml"],remote:p.VS.Remote},{name:"Zeitgeist gallery",description:"A multi-module gallery workshop, illustrating the various input and visualisation components that the Zeitgeist platform offers.",slug:"zg-gallery",alt:"Illustrative graphic",uris:["/workshops/zg-welcome/presentation.xml","/workshops/zg-gallery/presentation.xml"],remote:p.VS.Remote},{name:"Options 2040 demo",description:"A demonstration session, illustrating The Strategy Room content, combined with Options 2040 branding.",slug:"options-demo",alt:"Illustrative graphic",uris:["/workshops/options-transport/presentation.xml"],remote:p.VS.Remote},{name:"DSIT demo",description:"An illustrative demo session, combining pre-existing content and DSIT branding.",slug:"dsit-demo",alt:"Illustrative graphic",uris:["/workshops/dsit-demo/presentation.xml"],remote:p.VS.Remote}],v=()=>S(f[0].name,f[0].description,f[0].uris,f[0].slug,f[0].alt,f[0].remote),S=(e,t,s,i,n,o)=>{let a=structuredClone(b);return a.sessionName=e,a.sessionDescription=t,a.remoteConfiguration=o,a.sessionPresentationUris=s,a.sessionSlug=i,a.sessionGraphic=void 0,a.sessionGraphicAltText=n,a};function x(){let[e,t]=(0,n.useState)([]),[s,l]=(0,n.useState)([]),[x,w]=(0,n.useState)(),[k,y]=(0,n.useState)({sessionId:""}),[C,A]=(0,n.useState)(JSON.stringify(v(),null,2)),[T,U]=(0,n.useState)(!0),[Z,D]=(0,n.useState)(!0),[j,P]=(0,n.useState)(!1),R=(0,n.useRef)(null);(0,u.useRouter)();let I=(0,h.aC)(),{api:N,start:O}=(0,g.Z)();(0,n.useEffect)(()=>{void 0!==document&&(document.title="Zg Admin: Inspector")},[]);let W=()=>{R.current.disabled=!0,O(N.listDeliberationSessions(I.user.access_token,p.yI.All)).then(e=>{console.log("sessions",e),t(e)}).catch(e=>{console.error("error",e)}).finally(()=>{R.current.disabled=!1})},E=e=>{var t;O(N.getDeliberationSessionAdmin(e,null===(t=I.user)||void 0===t?void 0:t.access_token)).then(e=>{console.log("session",e),w(e),y({...k,sessionId:e.id})}).catch(e=>{console.error("error",e)})};(0,n.useEffect)(()=>{A(JSON.stringify(x,null,2))},[x]);let L=e=>{O(N.postDeliberationSessionAdmin(I.user.access_token,e)).then(e=>{console.log("session",e),w(e),y({...k,sessionId:e.id}),W()}).catch(e=>{console.error("error",e)})},_=e=>{O(N.putDeliberationSessionAdmin(I.user.access_token,e)).then(e=>{console.log("session",e),w(e),y({...k,sessionId:e.id}),W()}).catch(e=>{console.error("error",e)})},G=(e,t)=>{w(b),y({...k,sessionId:e}),E(e)},J=e=>{if(!e)return v();let t={...b};return t.id=void 0,t.answers=[],t.sessionName=e.sessionName+" (copy)",t.sessionDescription=e.sessionDescription,t.sessionGraphic=e.sessionGraphic,t.sessionSlug=e.sessionSlug,t.sessionPresentationUris=e.sessionPresentationUris,t.facilitationState=p._y.Ready,t.sessionStartedAt=void 0,t.sessionStartTime=new Date,t};return(0,n.useEffect)(()=>{l(e.filter(e=>e.audience!==p.EQ.AutomatedTests||!!j&&e.audience===p.EQ.AutomatedTests))},[e,T,Z,j]),(0,i.jsxs)(m,{maxWidth:!1,children:[(0,i.jsx)(o.Z,{variant:"h1",children:"Zeitgeist admin"}),!!I.isAuthenticated&&(0,i.jsxs)(o.Z,{variant:"body2",children:["Signed in as: ",I.user.profile.email]}),(0,i.jsx)(o.Z,{variant:"body1",children:"A rough and ready admin backend."}),(0,i.jsxs)("p",{children:[!I.isAuthenticated&&(0,i.jsx)(a.Z,{variant:"contained",onClick:()=>{I.signinRedirect()},children:"Sign in"}),!!I.isAuthenticated&&(0,i.jsx)(a.Z,{variant:"outlined",onClick:()=>{I.signoutRedirect()},children:"Sign out"})]}),(0,i.jsxs)(o.Z,{variant:"h2",children:[e.length," Deliberation sessions"]}),(0,i.jsxs)("div",{children:[!!I.isAuthenticated&&(0,i.jsx)(a.Z,{variant:"contained",ref:R,onClick:()=>{W()},children:"Fetch"}),!I.isAuthenticated&&(0,i.jsx)("p",{children:"Sign in to fetch all sessions"})]}),(0,i.jsx)(r.Z,{control:(0,i.jsx)(c.Z,{checked:T,onChange:e=>{U(e.target.checked)}}),label:"Show public sessions"}),(0,i.jsx)(r.Z,{control:(0,i.jsx)(c.Z,{checked:Z,onChange:e=>{D(e.target.checked)}}),label:"Show testing sessions"}),(0,i.jsx)(r.Z,{control:(0,i.jsx)(c.Z,{checked:j,onChange:e=>{P(e.target.checked)}}),label:"Show sessions for automatic testing"}),e.length>0&&(0,i.jsx)(d._,{autoHeight:!0,rows:s,columns:[{field:"id",headerName:"Id",width:300},{field:"sessionStartTime",headerName:"Starts",width:250,valueGetter:(e,t)=>new Date(e).toLocaleString()},{field:"sessionName",headerName:"Name",width:350},{field:"facilitationState",headerName:"State",width:100,valueGetter:(e,t)=>p._y[e]},{field:"joinCode",headerName:"Join code",width:100},{field:"remoteConfiguration",headerName:"Remote",width:150,valueGetter:(e,t)=>p.VS[e]}],onRowClick:e=>{G(e.row.id,e.row.joinCode)},initialState:{pagination:{paginationModel:{page:0,pageSize:25}}},pageSizeOptions:[25,50,75,100,150,200]}),(0,i.jsx)(o.Z,{variant:"h2",children:"Inspector"}),(0,i.jsx)(o.Z,{variant:"h3",children:"Get session"}),(0,i.jsxs)("p",{children:[(0,i.jsx)("input",{name:"sessionId",type:"text",value:k.sessionId,onChange:e=>{y({...k,[e.target.name]:e.target.value})}}),(0,i.jsx)(a.Z,{variant:"contained",onClick:()=>{E(k.sessionId)},children:"Get session"}),(0,i.jsx)("br",{})]}),(0,i.jsx)(o.Z,{variant:"h3",children:"Create session"}),(0,i.jsx)("p",{children:f.map((e,t)=>(0,i.jsxs)(a.Z,{variant:"outlined",onClick:()=>{w(S(e.name,e.description,e.uris,e.slug,e.alt,e.remote))},children:["New ",e.name]},"btn-new-".concat(e.name)))}),(0,i.jsxs)("div",{children:[(0,i.jsx)("textarea",{value:C,rows:24,cols:100,onChange:e=>{A(e.target.value)}}),I.isAuthenticated&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("br",{}),(0,i.jsx)(a.Z,{variant:"outlined",onClick:()=>{w(J(x))},children:"Duplicate session"}),(0,i.jsx)("br",{}),(0,i.jsx)("br",{}),(0,i.jsx)(a.Z,{variant:"contained",onClick:()=>{console.log("currentSessionJson",C),L(JSON.parse(C))},disabled:!(()=>{try{return!!JSON.parse(null!=C?C:"{}")}catch(e){return!1}})(),children:"Create session"}),(0,i.jsx)(a.Z,{variant:"contained",onClick:()=>{console.log("currentSessionJson",C),_(JSON.parse(C))},disabled:!(()=>{try{var e;return(null===(e=JSON.parse(null!=C?C:"{}"))||void 0===e?void 0:e.id)!==void 0}catch(e){return!1}})(),children:"Update session"})]})]})]})}},69026:function(e,t,s){"use strict";s.d(t,{N:function(){return o},Z:function(){return a}});var i=s(94547),n=s(60658);let o=(e,t)=>{let{sid:s,pid:i,qid:n}=e;return{id:void 0,created:void 0,questionId:n,participantId:i,jsonValue:void 0,mimeType:void 0,pII:t}};class a{getServerTime(){return(0,n.L)({baseUri:this.baseUri,title:"getServerTime",method:"GET",path:"/utils/servertime"})}postDeliberationSessionAdmin(e,t){return(0,n.L)({baseUri:this.baseUri,title:"postDeliberationSessionAdmin",method:"POST",path:"/sessions/admin",body:t,accessToken:e})}putDeliberationSessionAdmin(e,t){return(0,n.L)({baseUri:this.baseUri,title:"putDeliberationSessionAdmin",method:"PUT",path:"/sessions/admin/".concat(t.id),body:t,accessToken:e})}postFacilitatorAction(e,t,s){return(0,n.L)({baseUri:this.baseUri,title:"postFacilitatorAction",description:s.action,method:"POST",path:"/sessions/admin/actions/".concat(s.sessionId),body:s,group:"FacilitatorAction",accessToken:e,sessionToken:t})}getDeliberationSessionAdmin(e,t){return(0,n.L)({baseUri:this.baseUri,title:"getDeliberationSessionAdmin",description:t?"(with access token)":void 0,method:"GET",path:"/sessions/admin/".concat(e),accessToken:t})}listDeliberationSessions(e,t){return(0,n.L)({baseUri:this.baseUri,title:"listDeliberationSessions",description:i.yI[t],method:"GET",path:"/sessions/list/".concat(i.yI[t]),accessToken:e})}getDeliberationSession(e,t){return(0,n.L)({baseUri:this.baseUri,title:"getDeliberationSession",description:t?"(with access token)":"",method:"GET",path:"/sessions/".concat(e),accessToken:t})}retrieveMeetingAttendeeData(e,t,s,i,o){let a=o?"".concat(this.baseUri,"/sessions/admin/").concat(e,"/attendee"):"".concat(this.baseUri,"/sessions/").concat(e,"/attendee");return(0,n.L)({baseUri:this.baseUri,title:"getDeliberationSessionMeeting",method:"GET",path:a,body:{name:i,participantId:s},sessionToken:t,accessToken:o})}exchangeJoinCodeForSessionToken(e){return(0,n.L)({baseUri:this.baseUri,title:"exchangeJoinCodeForSessionToken",method:"POST",path:"/sessions/".concat(e.sessionId,"/token"),body:e})}postDeliberationAnswer(e,t,s){let i=t.questionId;return(0,n.L)({baseUri:this.baseUri,title:"postDeliberationAnswer",method:"POST",path:"/sessions/".concat(e,"/questions/").concat(i,"/answers"),body:t,sessionToken:s})}getDeliberationAnswer(e,t,s,i){return(0,n.L)({baseUri:this.baseUri,title:"getDeliberationAnswer",method:"GET",path:"/sessions/".concat(e,"/questions/").concat(t,"/answers?pid=").concat(s),sessionToken:i})}getDeliberationAnswersForQuestion(e,t,s){return(0,n.L)({baseUri:this.baseUri,title:"getDeliberationAnswersForQuestion",method:"GET",path:"/sessions/".concat(e,"/questions/").concat(t,"/answers"),sessionToken:s})}getDeliberationAnswersForParticipant(e,t,s){return(0,n.L)({baseUri:this.baseUri,title:"getDeliberationAnswersForParticipant",method:"GET",path:"/sessions/".concat(e,"/participants/").concat(t,"/answers"),sessionToken:s})}postWorkshopContentAccessRequest(e,t,s){return(0,n.L)({baseUri:this.baseUri,title:"postWorkshopContentAccessRequest",description:"".concat(s.objectKeys.length," items"),method:"POST",path:"/sessions/".concat(e,"/content"),body:s,sessionToken:t})}postPublicContentAccessRequest(e,t){return(0,n.L)({baseUri:this.baseUri,title:"postPublicContentAccessRequest",description:"".concat(t.workshopDirectory),method:"POST",path:"/sessions/".concat(e,"/content/public"),body:t})}getReport(e,t,s){return(0,n.L)({baseUri:this.baseUri,title:"getReport",description:i.gY[s],method:"GET",path:"/sessions/admin/".concat(e,"/report/").concat(i.gY[s]),accessToken:t})}getMediaUploadUrl(e,t,s,i,o,a){return(0,n.L)({baseUri:this.baseUri,title:"getMediaUploadUrl",method:"POST",path:"/sessions/admin/".concat(e,"/upload"),body:{sessionId:e,section:i,filenamePart:o,filenameSuffix:a},accessToken:s,sessionToken:t})}constructor(e){this.baseUri=e}}},60658:function(e,t,s){"use strict";s.d(t,{L:function(){return n},P:function(){return o}});var i=s(2057);let n=function(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],s=async()=>{var t;let s={method:e.method,headers:{"Content-Type":null!==(t=e.contentType)&&void 0!==t?t:"application/json"}};e.body&&(s.body=JSON.stringify(e.body)),e.accessToken&&(s.headers.Authorization="Bearer ".concat(e.accessToken)),e.sessionToken&&(s.headers["X-Deliberation-Session-Token"]=e.sessionToken);let i=await fetch("".concat(e.baseUri).concat(e.path),s);if(i.ok)return JSON.parse(await i.text());throw i.statusText};return new i.Z({title:e.title,description:e.description,action:s,retries:t?"indefinite":3,delay_ms:2e3,max_delay_ms:6e3})},o=function(e,t){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(0===e.size)throw"Blob is empty";let n=async()=>{console.debug("Ready to upload ".concat(e.size," bytes..."));let s=await fetch(t,{method:"PUT",headers:{"Content-Type":"application/octet-stream"},body:e});if(!s.ok)throw s.statusText;return console.debug("Upload complete."),{size:e.size,target:t,method:"PUT",response:s}};return new i.Z({title:"Put: ".concat(t),description:"".concat(e.size," bytes"),action:n,retries:s?"indefinite":3,delay_ms:2e3})}},2057:function(e,t,s){"use strict";var i,n;s.d(t,{Z:function(){return o},l:function(){return i}}),(n=i||(i={}))[n.Ready=0]="Ready",n[n.Running=1]="Running",n[n.Success=2]="Success",n[n.Waiting=3]="Waiting",n[n.Failed=4]="Failed",n[n.Cancelled=5]="Cancelled";class o{setState(e){var t,s;console.debug("Task ".concat(this.initProps.title),"(".concat(this.initProps.description,")"),i[e]),this.state=e,null===(s=this.runProps)||void 0===s||null===(t=s.onStateChange)||void 0===t||t.call(s,e)}cancel(){return 3===this.state&&(this.setState(5),!0)}getNextDelay(){var e,t,s;return Math.min((null!==(e=this.initProps.delay_ms)&&void 0!==e?e:0)*this.attempts,null!==(s=null!==(t=this.initProps.max_delay_ms)&&void 0!==t?t:this.initProps.delay_ms)&&void 0!==s?s:0)}async run(e){var t,s,i,n,o,a;this.runProps=e;do try{this.attempts++,this.promise=this.initProps.action(),this.result=await this.promise,this.setState(2)}catch(e){this.error=e,this.attempts<=("indefinite"===this.initProps.retries?50:this.initProps.retries)?(this.setState(3),await new Promise(e=>setTimeout(e,this.getNextDelay()))):this.setState(4)}while(3===this.state);switch(this.state){case 2:return await (null===(s=this.runProps)||void 0===s?void 0:null===(t=s.onSuccess)||void 0===t?void 0:t.call(s,this.result)),this.result;case 4:throw await (null===(n=this.runProps)||void 0===n?void 0:null===(i=n.onFailure)||void 0===i?void 0:i.call(n,this.error)),this.error;case 5:throw await (null===(a=this.runProps)||void 0===a?void 0:null===(o=a.onCancelled)||void 0===o?void 0:o.call(a)),"Task cancelled";default:throw"Unexpected state after attempt loop: ".concat(this.state)}}constructor(e){this.attempts=0,this.state=0,this.initProps=e,this.group=e.group,console.debug("Task ".concat(this.initProps.title),"(".concat(this.initProps.description,")"),i[this.state])}}},99341:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});var i=s(2265),n=s(2057),o=s(69026);function a(){let[e,t]=(0,i.useState)(new o.Z("https://hf3n3vkh6g.execute-api.eu-west-2.amazonaws.com/prod")),[s,a]=(0,i.useState)([]),r=async()=>{a([...s])};return{api:e,start:async e=>{if(void 0!==e.group){let t=s.filter(t=>t.group===e.group);t.length>0&&(t.forEach(e=>e.cancel()),await Promise.allSettled(t.filter(e=>void 0!==e.promise).map(e=>e.promise)))}return a([...s,e]),e.run({onStateChange:r})},allTasks:s,startedTasks:s.filter(e=>e.state===n.l.Running),waitingTasks:s.filter(e=>e.state===n.l.Waiting),succeededTasks:s.filter(e=>e.state===n.l.Success),failedTasks:s.filter(e=>e.state===n.l.Failed),cancelledTasks:s.filter(e=>e.state===n.l.Cancelled)}}},94547:function(e,t,s){"use strict";var i,n,o,a,r,c,l,d,u,h,p,m,g,b,f,v;s.d(t,{EQ:function(){return n},SC:function(){return d},VS:function(){return a},_b:function(){return i},_y:function(){return o},gY:function(){return c},um:function(){return r},yI:function(){return l}}),(u=i||(i={}))[u.Controller=0]="Controller",u[u.Client=1]="Client",(h=n||(n={}))[h.LiveWorkshop=0]="LiveWorkshop",h[h.AutomatedTests=1]="AutomatedTests",h[h.TestingWorkshop=2]="TestingWorkshop",h[h.DemoWorkshop=3]="DemoWorkshop",(p=o||(o={}))[p.Absent=0]="Absent",p[p.Ready=1]="Ready",p[p.Open=2]="Open",p[p.Closed=3]="Closed",(m=a||(a={}))[m.InPerson=0]="InPerson",m[m.Remote=1]="Remote",m[m.RemoteWithVideoCall=2]="RemoteWithVideoCall",(g=r||(r={}))[g.Offline=0]="Offline",g[g.Online=1]="Online",g[g.Connecting=2]="Connecting",g[g.Connected=3]="Connected",g[g.Joining=4]="Joining",g[g.Joined=5]="Joined",g[g.Disconnecting=6]="Disconnecting",g[g.Disconnected=7]="Disconnected",g[g.Error=8]="Error",(b=c||(c={}))[b.ContactAndConsent=0]="ContactAndConsent",b[b.EnjoymentAndSatisfaction=1]="EnjoymentAndSatisfaction",(f=l||(l={}))[f.All=0]="All",f[f.Upcoming=1]="Upcoming",f[f.Past=2]="Past",f[f.Answered=3]="Answered",(v=d||(d={})).facilitators="facilitators",v.analysts="analysts",v.administrators="administrators"}},function(e){e.O(0,[732,887,403,465,516,107,971,23,744],function(){return e(e.s=78005)}),_N_E=e.O()}]);