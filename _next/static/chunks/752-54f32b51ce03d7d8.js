(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[752],{75914:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AwsCrc32=void 0;var n=i(25825),r=i(68200),s=i(6525),o=function(){function e(){this.crc32=new s.Crc32}return e.prototype.update=function(e){(0,r.isEmptyData)(e)||this.crc32.update((0,r.convertToBuffer)(e))},e.prototype.digest=function(){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(e){return[2,(0,r.numToUint8)(this.crc32.digest())]})})},e.prototype.reset=function(){this.crc32=new s.Crc32},e}();t.AwsCrc32=o},6525:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AwsCrc32=t.Crc32=t.crc32=void 0;var n=i(25825),r=i(68200);function s(e){return new o().update(e).digest()}t.crc32=s;var o=function(){function e(){this.checksum=4294967295}return e.prototype.update=function(e){var t,i;try{for(var r=n.__values(e),s=r.next();!s.done;s=r.next()){var o=s.value;this.checksum=this.checksum>>>8^l[(this.checksum^o)&255]}}catch(e){t={error:e}}finally{try{s&&!s.done&&(i=r.return)&&i.call(r)}finally{if(t)throw t.error}}return this},e.prototype.digest=function(){return(4294967295^this.checksum)>>>0},e}();t.Crc32=o;var a=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],l=(0,r.uint32ArrayFrom)(a),d=i(75914);Object.defineProperty(t,"AwsCrc32",{enumerable:!0,get:function(){return d.AwsCrc32}})},69981:function(e,t,i){"use strict";var n=i(9109).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.convertToBuffer=void 0;var r=i(54306),s=void 0!==n&&n.from?function(e){return n.from(e,"utf8")}:r.fromUtf8;function o(e){return e instanceof Uint8Array?e:"string"==typeof e?s(e):ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(e)}t.convertToBuffer=o},68200:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uint32ArrayFrom=t.numToUint8=t.isEmptyData=t.convertToBuffer=void 0;var n=i(69981);Object.defineProperty(t,"convertToBuffer",{enumerable:!0,get:function(){return n.convertToBuffer}});var r=i(14962);Object.defineProperty(t,"isEmptyData",{enumerable:!0,get:function(){return r.isEmptyData}});var s=i(26375);Object.defineProperty(t,"numToUint8",{enumerable:!0,get:function(){return s.numToUint8}});var o=i(35600);Object.defineProperty(t,"uint32ArrayFrom",{enumerable:!0,get:function(){return o.uint32ArrayFrom}})},14962:function(e,t){"use strict";function i(e){return"string"==typeof e?0===e.length:0===e.byteLength}Object.defineProperty(t,"__esModule",{value:!0}),t.isEmptyData=void 0,t.isEmptyData=i},26375:function(e,t){"use strict";function i(e){return new Uint8Array([(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e])}Object.defineProperty(t,"__esModule",{value:!0}),t.numToUint8=void 0,t.numToUint8=i},35600:function(e,t){"use strict";function i(e){if(!Uint32Array.from){for(var t=new Uint32Array(e.length),i=0;i<e.length;)t[i]=e[i],i+=1;return t}return Uint32Array.from(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.uint32ArrayFrom=void 0,t.uint32ArrayFrom=i},55589:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},67802:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},62673:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},77364:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},13405:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isMsWindow=void 0;var i=["decrypt","digest","encrypt","exportKey","generateKey","importKey","sign","verify"];function n(e){return"MSInputMethodContext"in e&&"msCrypto"in e}function r(e){if(n(e)&&void 0!==e.msCrypto.subtle){var t=e.msCrypto,r=t.getRandomValues,s=t.subtle;return i.map(function(e){return s[e]}).concat(r).every(function(e){return"function"==typeof e})}return!1}t.isMsWindow=r},50741:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(25825);n.__exportStar(i(55589),t),n.__exportStar(i(67802),t),n.__exportStar(i(62673),t),n.__exportStar(i(77364),t),n.__exportStar(i(13405),t)},47134:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EMPTY_DATA_SHA_256=t.SHA_256_HMAC_ALGO=t.SHA_256_HASH=void 0,t.SHA_256_HASH={name:"SHA-256"},t.SHA_256_HMAC_ALGO={name:"HMAC",hash:t.SHA_256_HASH},t.EMPTY_DATA_SHA_256=new Uint8Array([227,176,196,66,152,252,28,20,154,251,244,200,153,111,185,36,39,174,65,228,100,155,147,76,164,149,153,27,120,82,184,85])},62087:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Sha256=void 0;var n=i(43768),r=i(41902),s=i(92339),o=i(89411),a=i(50741),l=i(73461),d=i(34536),u=function(){function e(e){(0,o.supportsWebCrypto)((0,l.locateWindow)())?this.hash=new r.Sha256(e):(0,a.isMsWindow)((0,l.locateWindow)())?this.hash=new n.Sha256(e):this.hash=new s.Sha256(e)}return e.prototype.update=function(e,t){this.hash.update((0,d.convertToBuffer)(e))},e.prototype.digest=function(){return this.hash.digest()},e.prototype.reset=function(){this.hash.reset()},e}();t.Sha256=u},43768:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Sha256=void 0;var n=i(64626),r=i(47134),s=i(54306),o=i(73461),a=function(){function e(e){this.secret=e,this.reset()}return e.prototype.update=function(e){var t=this;(0,n.isEmptyData)(e)||(this.operation=this.operation.then(function(i){return i.onerror=function(){t.operation=Promise.reject(Error("Error encountered updating hash"))},i.process(d(e)),i}),this.operation.catch(function(){}))},e.prototype.digest=function(){return this.operation.then(function(e){return new Promise(function(t,i){e.onerror=function(){i(Error("Error encountered finalizing hash"))},e.oncomplete=function(){e.result&&t(new Uint8Array(e.result)),i(Error("Error encountered finalizing hash"))},e.finish()})})},e.prototype.reset=function(){this.secret?(this.operation=l(this.secret).then(function(e){return(0,o.locateWindow)().msCrypto.subtle.sign(r.SHA_256_HMAC_ALGO,e)}),this.operation.catch(function(){})):this.operation=Promise.resolve((0,o.locateWindow)().msCrypto.subtle.digest("SHA-256"))},e}();function l(e){return new Promise(function(t,i){var n=(0,o.locateWindow)().msCrypto.subtle.importKey("raw",d(e),r.SHA_256_HMAC_ALGO,!1,["sign"]);n.oncomplete=function(){n.result&&t(n.result),i(Error("ImportKey completed without importing key."))},n.onerror=function(){i(Error("ImportKey failed to import key."))}})}function d(e){return"string"==typeof e?(0,s.fromUtf8)(e):ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(e)}t.Sha256=a},98250:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebCryptoSha256=t.Ie11Sha256=void 0,i(25825).__exportStar(i(62087),t);var n=i(43768);Object.defineProperty(t,"Ie11Sha256",{enumerable:!0,get:function(){return n.Sha256}});var r=i(41902);Object.defineProperty(t,"WebCryptoSha256",{enumerable:!0,get:function(){return r.Sha256}})},64626:function(e,t){"use strict";function i(e){return"string"==typeof e?0===e.length:0===e.byteLength}Object.defineProperty(t,"__esModule",{value:!0}),t.isEmptyData=void 0,t.isEmptyData=i},41902:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Sha256=void 0;var n=i(34536),r=i(47134),s=i(73461),o=function(){function e(e){this.toHash=new Uint8Array(0),this.secret=e,this.reset()}return e.prototype.update=function(e){if(!(0,n.isEmptyData)(e)){var t=(0,n.convertToBuffer)(e),i=new Uint8Array(this.toHash.byteLength+t.byteLength);i.set(this.toHash,0),i.set(t,this.toHash.byteLength),this.toHash=i}},e.prototype.digest=function(){var e=this;return this.key?this.key.then(function(t){return(0,s.locateWindow)().crypto.subtle.sign(r.SHA_256_HMAC_ALGO,t,e.toHash).then(function(e){return new Uint8Array(e)})}):(0,n.isEmptyData)(this.toHash)?Promise.resolve(r.EMPTY_DATA_SHA_256):Promise.resolve().then(function(){return(0,s.locateWindow)().crypto.subtle.digest(r.SHA_256_HASH,e.toHash)}).then(function(e){return Promise.resolve(new Uint8Array(e))})},e.prototype.reset=function(){var e=this;this.toHash=new Uint8Array(0),this.secret&&void 0!==this.secret&&(this.key=new Promise(function(t,i){(0,s.locateWindow)().crypto.subtle.importKey("raw",(0,n.convertToBuffer)(e.secret),r.SHA_256_HMAC_ALGO,!1,["sign"]).then(t,i)}),this.key.catch(function(){}))},e}();t.Sha256=o},62603:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RawSha256=void 0;var n=i(9967),r=function(){function e(){this.state=Int32Array.from(n.INIT),this.temp=new Int32Array(64),this.buffer=new Uint8Array(64),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}return e.prototype.update=function(e){if(this.finished)throw Error("Attempted to update an already finished hash.");var t=0,i=e.byteLength;if(this.bytesHashed+=i,8*this.bytesHashed>n.MAX_HASHABLE_LENGTH)throw Error("Cannot hash more than 2^53 - 1 bits");for(;i>0;)this.buffer[this.bufferLength++]=e[t++],i--,this.bufferLength===n.BLOCK_SIZE&&(this.hashBuffer(),this.bufferLength=0)},e.prototype.digest=function(){if(!this.finished){var e=8*this.bytesHashed,t=new DataView(this.buffer.buffer,this.buffer.byteOffset,this.buffer.byteLength),i=this.bufferLength;if(t.setUint8(this.bufferLength++,128),i%n.BLOCK_SIZE>=n.BLOCK_SIZE-8){for(var r=this.bufferLength;r<n.BLOCK_SIZE;r++)t.setUint8(r,0);this.hashBuffer(),this.bufferLength=0}for(var r=this.bufferLength;r<n.BLOCK_SIZE-8;r++)t.setUint8(r,0);t.setUint32(n.BLOCK_SIZE-8,Math.floor(e/4294967296),!0),t.setUint32(n.BLOCK_SIZE-4,e),this.hashBuffer(),this.finished=!0}for(var s=new Uint8Array(n.DIGEST_LENGTH),r=0;r<8;r++)s[4*r]=this.state[r]>>>24&255,s[4*r+1]=this.state[r]>>>16&255,s[4*r+2]=this.state[r]>>>8&255,s[4*r+3]=this.state[r]>>>0&255;return s},e.prototype.hashBuffer=function(){for(var e=this,t=e.buffer,i=e.state,r=i[0],s=i[1],o=i[2],a=i[3],l=i[4],d=i[5],u=i[6],c=i[7],h=0;h<n.BLOCK_SIZE;h++){if(h<16)this.temp[h]=(255&t[4*h])<<24|(255&t[4*h+1])<<16|(255&t[4*h+2])<<8|255&t[4*h+3];else{var f=this.temp[h-2],p=(f>>>17|f<<15)^(f>>>19|f<<13)^f>>>10,m=((f=this.temp[h-15])>>>7|f<<25)^(f>>>18|f<<14)^f>>>3;this.temp[h]=(p+this.temp[h-7]|0)+(m+this.temp[h-16]|0)}var g=(((l>>>6|l<<26)^(l>>>11|l<<21)^(l>>>25|l<<7))+(l&d^~l&u)|0)+(c+(n.KEY[h]+this.temp[h]|0)|0)|0,v=((r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10))+(r&s^r&o^s&o)|0;c=u,u=d,d=l,l=a+g|0,a=o,o=s,s=r,r=g+v|0}i[0]+=r,i[1]+=s,i[2]+=o,i[3]+=a,i[4]+=l,i[5]+=d,i[6]+=u,i[7]+=c},e}();t.RawSha256=r},9967:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MAX_HASHABLE_LENGTH=t.INIT=t.KEY=t.DIGEST_LENGTH=t.BLOCK_SIZE=void 0,t.BLOCK_SIZE=64,t.DIGEST_LENGTH=32,t.KEY=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),t.INIT=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],t.MAX_HASHABLE_LENGTH=9007199254740991},92339:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(25825).__exportStar(i(62930),t)},62930:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Sha256=void 0;var n=i(25825),r=i(9967),s=i(62603),o=i(34536),a=function(){function e(e){this.secret=e,this.hash=new s.RawSha256,this.reset()}return e.prototype.update=function(e){if(!(0,o.isEmptyData)(e)&&!this.error)try{this.hash.update((0,o.convertToBuffer)(e))}catch(e){this.error=e}},e.prototype.digestSync=function(){if(this.error)throw this.error;return this.outer?(this.outer.finished||this.outer.update(this.hash.digest()),this.outer.digest()):this.hash.digest()},e.prototype.digest=function(){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(e){return[2,this.digestSync()]})})},e.prototype.reset=function(){if(this.hash=new s.RawSha256,this.secret){this.outer=new s.RawSha256;var e=l(this.secret),t=new Uint8Array(r.BLOCK_SIZE);t.set(e);for(var i=0;i<r.BLOCK_SIZE;i++)e[i]^=54,t[i]^=92;this.hash.update(e),this.outer.update(t);for(var i=0;i<e.byteLength;i++)e[i]=0}},e}();function l(e){var t=(0,o.convertToBuffer)(e);if(t.byteLength>r.BLOCK_SIZE){var i=new s.RawSha256;i.update(t),t=i.digest()}var n=new Uint8Array(r.BLOCK_SIZE);return n.set(t),n}t.Sha256=a},83336:function(e,t,i){"use strict";var n=i(9109).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.convertToBuffer=void 0;var r=i(54306),s=void 0!==n&&n.from?function(e){return n.from(e,"utf8")}:r.fromUtf8;function o(e){return e instanceof Uint8Array?e:"string"==typeof e?s(e):ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(e)}t.convertToBuffer=o},34536:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uint32ArrayFrom=t.numToUint8=t.isEmptyData=t.convertToBuffer=void 0;var n=i(83336);Object.defineProperty(t,"convertToBuffer",{enumerable:!0,get:function(){return n.convertToBuffer}});var r=i(8748);Object.defineProperty(t,"isEmptyData",{enumerable:!0,get:function(){return r.isEmptyData}});var s=i(11800);Object.defineProperty(t,"numToUint8",{enumerable:!0,get:function(){return s.numToUint8}});var o=i(31592);Object.defineProperty(t,"uint32ArrayFrom",{enumerable:!0,get:function(){return o.uint32ArrayFrom}})},8748:function(e,t){"use strict";function i(e){return"string"==typeof e?0===e.length:0===e.byteLength}Object.defineProperty(t,"__esModule",{value:!0}),t.isEmptyData=void 0,t.isEmptyData=i},11800:function(e,t){"use strict";function i(e){return new Uint8Array([(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e])}Object.defineProperty(t,"__esModule",{value:!0}),t.numToUint8=void 0,t.numToUint8=i},31592:function(e,t){"use strict";function i(e){if(!Uint32Array.from){for(var t=new Uint32Array(e.length),i=0;i<e.length;)t[i]=e[i],i+=1;return t}return Uint32Array.from(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.uint32ArrayFrom=void 0,t.uint32ArrayFrom=i},19540:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RawSha256=void 0;var n=i(40171),r=function(){function e(){this.state=Int32Array.from(n.INIT),this.temp=new Int32Array(64),this.buffer=new Uint8Array(64),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}return e.prototype.update=function(e){if(this.finished)throw Error("Attempted to update an already finished hash.");var t=0,i=e.byteLength;if(this.bytesHashed+=i,8*this.bytesHashed>n.MAX_HASHABLE_LENGTH)throw Error("Cannot hash more than 2^53 - 1 bits");for(;i>0;)this.buffer[this.bufferLength++]=e[t++],i--,this.bufferLength===n.BLOCK_SIZE&&(this.hashBuffer(),this.bufferLength=0)},e.prototype.digest=function(){if(!this.finished){var e=8*this.bytesHashed,t=new DataView(this.buffer.buffer,this.buffer.byteOffset,this.buffer.byteLength),i=this.bufferLength;if(t.setUint8(this.bufferLength++,128),i%n.BLOCK_SIZE>=n.BLOCK_SIZE-8){for(var r=this.bufferLength;r<n.BLOCK_SIZE;r++)t.setUint8(r,0);this.hashBuffer(),this.bufferLength=0}for(var r=this.bufferLength;r<n.BLOCK_SIZE-8;r++)t.setUint8(r,0);t.setUint32(n.BLOCK_SIZE-8,Math.floor(e/4294967296),!0),t.setUint32(n.BLOCK_SIZE-4,e),this.hashBuffer(),this.finished=!0}for(var s=new Uint8Array(n.DIGEST_LENGTH),r=0;r<8;r++)s[4*r]=this.state[r]>>>24&255,s[4*r+1]=this.state[r]>>>16&255,s[4*r+2]=this.state[r]>>>8&255,s[4*r+3]=this.state[r]>>>0&255;return s},e.prototype.hashBuffer=function(){for(var e=this,t=e.buffer,i=e.state,r=i[0],s=i[1],o=i[2],a=i[3],l=i[4],d=i[5],u=i[6],c=i[7],h=0;h<n.BLOCK_SIZE;h++){if(h<16)this.temp[h]=(255&t[4*h])<<24|(255&t[4*h+1])<<16|(255&t[4*h+2])<<8|255&t[4*h+3];else{var f=this.temp[h-2],p=(f>>>17|f<<15)^(f>>>19|f<<13)^f>>>10,m=((f=this.temp[h-15])>>>7|f<<25)^(f>>>18|f<<14)^f>>>3;this.temp[h]=(p+this.temp[h-7]|0)+(m+this.temp[h-16]|0)}var g=(((l>>>6|l<<26)^(l>>>11|l<<21)^(l>>>25|l<<7))+(l&d^~l&u)|0)+(c+(n.KEY[h]+this.temp[h]|0)|0)|0,v=((r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10))+(r&s^r&o^s&o)|0;c=u,u=d,d=l,l=a+g|0,a=o,o=s,s=r,r=g+v|0}i[0]+=r,i[1]+=s,i[2]+=o,i[3]+=a,i[4]+=l,i[5]+=d,i[6]+=u,i[7]+=c},e}();t.RawSha256=r},40171:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MAX_HASHABLE_LENGTH=t.INIT=t.KEY=t.DIGEST_LENGTH=t.BLOCK_SIZE=void 0,t.BLOCK_SIZE=64,t.DIGEST_LENGTH=32,t.KEY=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),t.INIT=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],t.MAX_HASHABLE_LENGTH=9007199254740991},99131:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(25825).__exportStar(i(45401),t)},45401:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Sha256=void 0;var n=i(25825),r=i(40171),s=i(19540),o=i(41720),a=function(){function e(e){if(this.hash=new s.RawSha256,e){this.outer=new s.RawSha256;var t=l(e),i=new Uint8Array(r.BLOCK_SIZE);i.set(t);for(var n=0;n<r.BLOCK_SIZE;n++)t[n]^=54,i[n]^=92;this.hash.update(t),this.outer.update(i);for(var n=0;n<t.byteLength;n++)t[n]=0}}return e.prototype.update=function(e){if(!(0,o.isEmptyData)(e)&&!this.error)try{this.hash.update((0,o.convertToBuffer)(e))}catch(e){this.error=e}},e.prototype.digestSync=function(){if(this.error)throw this.error;return this.outer?(this.outer.finished||this.outer.update(this.hash.digest()),this.outer.digest()):this.hash.digest()},e.prototype.digest=function(){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(e){return[2,this.digestSync()]})})},e}();function l(e){var t=(0,o.convertToBuffer)(e);if(t.byteLength>r.BLOCK_SIZE){var i=new s.RawSha256;i.update(t),t=i.digest()}var n=new Uint8Array(r.BLOCK_SIZE);return n.set(t),n}t.Sha256=a},89411:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(25825).__exportStar(i(43739),t)},43739:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.supportsZeroByteGCM=t.supportsSubtleCrypto=t.supportsSecureRandom=t.supportsWebCrypto=void 0;var n=i(25825),r=["decrypt","digest","encrypt","exportKey","generateKey","importKey","sign","verify"];function s(e){return!!o(e)&&"object"==typeof e.crypto.subtle&&a(e.crypto.subtle)}function o(e){return"object"==typeof e&&"object"==typeof e.crypto&&"function"==typeof e.crypto.getRandomValues}function a(e){return e&&r.every(function(t){return"function"==typeof e[t]})}function l(e){return n.__awaiter(this,void 0,void 0,function(){var t,i;return n.__generator(this,function(n){switch(n.label){case 0:if(!a(e))return[2,!1];n.label=1;case 1:return n.trys.push([1,4,,5]),[4,e.generateKey({name:"AES-GCM",length:128},!1,["encrypt"])];case 2:return t=n.sent(),[4,e.encrypt({name:"AES-GCM",iv:new Uint8Array(Array(12)),additionalData:new Uint8Array(Array(16)),tagLength:128},t,new Uint8Array(0))];case 3:return[2,16===n.sent().byteLength];case 4:return i=n.sent(),[2,!1];case 5:return[2]}})})}t.supportsWebCrypto=s,t.supportsSecureRandom=o,t.supportsSubtleCrypto=a,t.supportsZeroByteGCM=l},59880:function(e,t,i){"use strict";var n=i(9109).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.convertToBuffer=void 0;var r=i(54306),s=void 0!==n&&n.from?function(e){return n.from(e,"utf8")}:r.fromUtf8;function o(e){return e instanceof Uint8Array?e:"string"==typeof e?s(e):ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(e)}t.convertToBuffer=o},41720:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uint32ArrayFrom=t.numToUint8=t.isEmptyData=t.convertToBuffer=void 0;var n=i(59880);Object.defineProperty(t,"convertToBuffer",{enumerable:!0,get:function(){return n.convertToBuffer}});var r=i(69992);Object.defineProperty(t,"isEmptyData",{enumerable:!0,get:function(){return r.isEmptyData}});var s=i(7186);Object.defineProperty(t,"numToUint8",{enumerable:!0,get:function(){return s.numToUint8}});var o=i(73212);Object.defineProperty(t,"uint32ArrayFrom",{enumerable:!0,get:function(){return o.uint32ArrayFrom}})},69992:function(e,t){"use strict";function i(e){return"string"==typeof e?0===e.length:0===e.byteLength}Object.defineProperty(t,"__esModule",{value:!0}),t.isEmptyData=void 0,t.isEmptyData=i},7186:function(e,t){"use strict";function i(e){return new Uint8Array([(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e])}Object.defineProperty(t,"__esModule",{value:!0}),t.numToUint8=void 0,t.numToUint8=i},73212:function(e,t){"use strict";function i(e){if(!Uint32Array.from){for(var t=new Uint32Array(e.length),i=0;i<e.length;)t[i]=e[i],i+=1;return t}return Uint32Array.from(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.uint32ArrayFrom=void 0,t.uint32ArrayFrom=i},46628:function(e,t,i){"use strict";i.r(t),i.d(t,{$Command:function(){return iO.mY},AllowNotifications:function(){return nk.Us},AssociateChannelFlowCommand:function(){return n_},BadRequestException:function(){return nk.w5},BatchChannelMembershipsFilterSensitiveLog:function(){return nk.IP},BatchCreateChannelMembershipCommand:function(){return nT},BatchCreateChannelMembershipResponseFilterSensitiveLog:function(){return nk.SH},ChannelAssociatedWithFlowSummaryFilterSensitiveLog:function(){return nk.qI},ChannelBanFilterSensitiveLog:function(){return nk.IA},ChannelBanSummaryFilterSensitiveLog:function(){return nk.xS},ChannelFilterSensitiveLog:function(){return nk.oF},ChannelFlowCallbackCommand:function(){return nP},ChannelFlowCallbackRequestFilterSensitiveLog:function(){return nk.YJ},ChannelFlowFilterSensitiveLog:function(){return nk.Lk},ChannelFlowSummaryFilterSensitiveLog:function(){return nk.mc},ChannelMembershipFilterSensitiveLog:function(){return nk.vw},ChannelMembershipForAppInstanceUserSummaryFilterSensitiveLog:function(){return nk.rX},ChannelMembershipPreferencesFilterSensitiveLog:function(){return nk.Vc},ChannelMembershipSummaryFilterSensitiveLog:function(){return nk.$T},ChannelMembershipType:function(){return nk.L5},ChannelMessageCallbackFilterSensitiveLog:function(){return nk.UH},ChannelMessageFilterSensitiveLog:function(){return nk.Pe},ChannelMessagePersistenceType:function(){return nk.bt},ChannelMessageStatus:function(){return nk.kl},ChannelMessageSummaryFilterSensitiveLog:function(){return nk.T},ChannelMessageType:function(){return nk.YQ},ChannelMode:function(){return nk.S4},ChannelModeratedByAppInstanceUserSummaryFilterSensitiveLog:function(){return nk.X9},ChannelModeratorFilterSensitiveLog:function(){return nk.Uf},ChannelModeratorSummaryFilterSensitiveLog:function(){return nk.uU},ChannelPrivacy:function(){return nk.rv},ChannelSummaryFilterSensitiveLog:function(){return nk.LR},ChimeSDKMessaging:function(){return rh},ChimeSDKMessagingClient:function(){return nw},ChimeSDKMessagingServiceException:function(){return rL.h},ConflictException:function(){return nk.no},CreateChannelBanCommand:function(){return nE},CreateChannelBanResponseFilterSensitiveLog:function(){return nk.iZ},CreateChannelCommand:function(){return nM},CreateChannelFlowCommand:function(){return nI},CreateChannelFlowRequestFilterSensitiveLog:function(){return nk.GW},CreateChannelMembershipCommand:function(){return nA},CreateChannelMembershipResponseFilterSensitiveLog:function(){return nk.Fz},CreateChannelModeratorCommand:function(){return nR},CreateChannelModeratorResponseFilterSensitiveLog:function(){return nk.Yb},CreateChannelRequestFilterSensitiveLog:function(){return nk.vD},DeleteChannelBanCommand:function(){return nx},DeleteChannelCommand:function(){return nO},DeleteChannelFlowCommand:function(){return nD},DeleteChannelMembershipCommand:function(){return nL},DeleteChannelMessageCommand:function(){return nF},DeleteChannelModeratorCommand:function(){return nB},DeleteMessagingStreamingConfigurationsCommand:function(){return nN},DescribeChannelBanCommand:function(){return nV},DescribeChannelBanResponseFilterSensitiveLog:function(){return nk.rF},DescribeChannelCommand:function(){return nU},DescribeChannelFlowCommand:function(){return nz},DescribeChannelFlowResponseFilterSensitiveLog:function(){return nk.wz},DescribeChannelMembershipCommand:function(){return nj},DescribeChannelMembershipForAppInstanceUserCommand:function(){return n$},DescribeChannelMembershipForAppInstanceUserResponseFilterSensitiveLog:function(){return nk.KF},DescribeChannelMembershipResponseFilterSensitiveLog:function(){return nk.lE},DescribeChannelModeratedByAppInstanceUserCommand:function(){return nW},DescribeChannelModeratedByAppInstanceUserResponseFilterSensitiveLog:function(){return nk.mK},DescribeChannelModeratorCommand:function(){return nH},DescribeChannelModeratorResponseFilterSensitiveLog:function(){return nk.Iq},DescribeChannelResponseFilterSensitiveLog:function(){return nk.q8},DisassociateChannelFlowCommand:function(){return nK},ErrorCode:function(){return nk.jK},ExpirationCriterion:function(){return nk.a9},FallbackAction:function(){return nk.pO},ForbiddenException:function(){return nk.V2},GetChannelMembershipPreferencesCommand:function(){return nG},GetChannelMembershipPreferencesResponseFilterSensitiveLog:function(){return nk.Ty},GetChannelMessageCommand:function(){return nq},GetChannelMessageResponseFilterSensitiveLog:function(){return nk.Z4},GetChannelMessageStatusCommand:function(){return nQ},GetMessagingSessionEndpointCommand:function(){return nZ},GetMessagingStreamingConfigurationsCommand:function(){return nY},IdentityFilterSensitiveLog:function(){return nk.Ql},InvocationType:function(){return nk.ut},ListChannelBansCommand:function(){return nJ},ListChannelBansRequestFilterSensitiveLog:function(){return nk.on},ListChannelBansResponseFilterSensitiveLog:function(){return nk.ho},ListChannelFlowsCommand:function(){return nX},ListChannelFlowsRequestFilterSensitiveLog:function(){return nk.Di},ListChannelFlowsResponseFilterSensitiveLog:function(){return nk.M_},ListChannelMembershipsCommand:function(){return n0},ListChannelMembershipsForAppInstanceUserCommand:function(){return n1},ListChannelMembershipsForAppInstanceUserRequestFilterSensitiveLog:function(){return nk.Lt},ListChannelMembershipsForAppInstanceUserResponseFilterSensitiveLog:function(){return nk.Vq},ListChannelMembershipsRequestFilterSensitiveLog:function(){return nk.mW},ListChannelMembershipsResponseFilterSensitiveLog:function(){return nk.oW},ListChannelMessagesCommand:function(){return n2},ListChannelMessagesRequestFilterSensitiveLog:function(){return nk.v7},ListChannelMessagesResponseFilterSensitiveLog:function(){return nk.tB},ListChannelModeratorsCommand:function(){return n3},ListChannelModeratorsRequestFilterSensitiveLog:function(){return nk.q2},ListChannelModeratorsResponseFilterSensitiveLog:function(){return nk.hG},ListChannelsAssociatedWithChannelFlowCommand:function(){return n5},ListChannelsAssociatedWithChannelFlowRequestFilterSensitiveLog:function(){return nk.yP},ListChannelsAssociatedWithChannelFlowResponseFilterSensitiveLog:function(){return nk.QG},ListChannelsCommand:function(){return n4},ListChannelsModeratedByAppInstanceUserCommand:function(){return n6},ListChannelsModeratedByAppInstanceUserRequestFilterSensitiveLog:function(){return nk.SA},ListChannelsModeratedByAppInstanceUserResponseFilterSensitiveLog:function(){return nk.CE},ListChannelsRequestFilterSensitiveLog:function(){return nk.Qc},ListChannelsResponseFilterSensitiveLog:function(){return nk.VO},ListSubChannelsCommand:function(){return n8},ListSubChannelsRequestFilterSensitiveLog:function(){return nk.XF},ListSubChannelsResponseFilterSensitiveLog:function(){return nk.xD},ListTagsForResourceCommand:function(){return n9},ListTagsForResourceResponseFilterSensitiveLog:function(){return nk.iO},MessageAttributeValueFilterSensitiveLog:function(){return nk.Z9},MessagingDataType:function(){return nk.h1},NotFoundException:function(){return nk.TR},ProcessorFilterSensitiveLog:function(){return nk.Nl},PushNotificationConfigurationFilterSensitiveLog:function(){return nk.cB},PushNotificationPreferencesFilterSensitiveLog:function(){return nk.Nd},PushNotificationType:function(){return nk.TQ},PutChannelExpirationSettingsCommand:function(){return n7},PutChannelMembershipPreferencesCommand:function(){return re},PutChannelMembershipPreferencesRequestFilterSensitiveLog:function(){return nk.kU},PutChannelMembershipPreferencesResponseFilterSensitiveLog:function(){return nk.aJ},PutMessagingStreamingConfigurationsCommand:function(){return rt},RedactChannelMessageCommand:function(){return ri},ResourceLimitExceededException:function(){return nk.j0},SearchChannelsCommand:function(){return rn},SearchChannelsRequestFilterSensitiveLog:function(){return nk.rt},SearchChannelsResponseFilterSensitiveLog:function(){return nk.rm},SearchFieldKey:function(){return nk.u4},SearchFieldOperator:function(){return nk._J},SendChannelMessageCommand:function(){return rr},SendChannelMessageRequestFilterSensitiveLog:function(){return nk.J2},ServiceFailureException:function(){return nk.q9},ServiceUnavailableException:function(){return nk.ds},SortOrder:function(){return nk.As},TagFilterSensitiveLog:function(){return nk.gW},TagResourceCommand:function(){return rs},TagResourceRequestFilterSensitiveLog:function(){return nk.Cc},ThrottledClientException:function(){return nk.ie},UnauthorizedClientException:function(){return nk.Vh},UntagResourceCommand:function(){return ro},UntagResourceRequestFilterSensitiveLog:function(){return nk.hz},UpdateChannelCommand:function(){return ra},UpdateChannelFlowCommand:function(){return rl},UpdateChannelFlowRequestFilterSensitiveLog:function(){return nk.Si},UpdateChannelMessageCommand:function(){return rd},UpdateChannelMessageRequestFilterSensitiveLog:function(){return nk.VU},UpdateChannelReadMarkerCommand:function(){return ru},UpdateChannelRequestFilterSensitiveLog:function(){return nk.ui},__Client:function(){return iO.KU},paginateListChannelBans:function(){return rp},paginateListChannelFlows:function(){return rg},paginateListChannelMemberships:function(){return ry},paginateListChannelMembershipsForAppInstanceUser:function(){return rb},paginateListChannelMessages:function(){return rC},paginateListChannelModerators:function(){return rk},paginateListChannels:function(){return rA},paginateListChannelsAssociatedWithChannelFlow:function(){return rP},paginateListChannelsModeratedByAppInstanceUser:function(){return rM},paginateListSubChannels:function(){return rx},paginateSearchChannels:function(){return rD}});var n,r,s,o,a=i(96108);function l(e){return e}let d=e=>t=>async i=>{if(!a.aW.isInstance(i.request))return t(i);let{request:n}=i,{handlerProtocol:r=""}=e.requestHandler.metadata||{};if(r.indexOf("h2")>=0&&!n.headers[":authority"])delete n.headers.host,n.headers[":authority"]=n.hostname+(n.port?":"+n.port:"");else if(!n.headers.host){let e=n.hostname;null!=n.port&&(e+=`:${n.port}`),n.headers.host=e}return t(i)},u={name:"hostHeaderMiddleware",step:"build",priority:"low",tags:["HOST"],override:!0},c=e=>({applyToStack:t=>{t.add(d(e),u)}}),h=()=>(e,t)=>async i=>{try{let n=await e(i),{clientName:r,commandName:s,logger:o,dynamoDbDocumentClientOptions:a={}}=t,{overrideInputFilterSensitiveLog:l,overrideOutputFilterSensitiveLog:d}=a,u=l??t.inputFilterSensitiveLog,c=d??t.outputFilterSensitiveLog,{$metadata:h,...f}=n.output;return o?.info?.({clientName:r,commandName:s,input:u(i.input),output:c(f),metadata:h}),n}catch(l){let{clientName:e,commandName:n,logger:r,dynamoDbDocumentClientOptions:s={}}=t,{overrideInputFilterSensitiveLog:o}=s,a=o??t.inputFilterSensitiveLog;throw r?.error?.({clientName:e,commandName:n,input:a(i.input),error:l,metadata:l.$metadata}),l}},f={name:"loggerMiddleware",tags:["LOGGER"],step:"initialize",override:!0},p=e=>({applyToStack:e=>{e.add(h(),f)}});var m=i(25566);let g="X-Amzn-Trace-Id",v="AWS_LAMBDA_FUNCTION_NAME",b="_X_AMZN_TRACE_ID",S=e=>t=>async i=>{let{request:n}=i;if(!a.aW.isInstance(n)||"node"!==e.runtime||n.headers.hasOwnProperty(g))return t(i);let r=m.env[v],s=m.env[b],o=e=>"string"==typeof e&&e.length>0;return o(r)&&o(s)&&(n.headers[g]=s),t({...i,request:n})},y={step:"build",tags:["RECURSION_DETECTION"],name:"recursionDetectionMiddleware",override:!0,priority:"low"},w=e=>({applyToStack:t=>{t.add(S(e),y)}}),C=(e,t,i)=>{let n,r,s;let o=!1,a=async()=>{r||(r=e());try{n=await r,s=!0,o=!1}finally{r=void 0}return n};return void 0===t?async e=>((!s||e?.forceRefresh)&&(n=await a()),n):async e=>((!s||e?.forceRefresh)&&(n=await a()),o||(i&&!i(n)?o=!0:t(n)&&await a()),n)};i(6525);let _={},k={};for(let e=0;e<256;e++){let t=e.toString(16).toLowerCase();1===t.length&&(t=`0${t}`),_[e]=t,k[t]=e}function T(e){if(e.length%2!=0)throw Error("Hex encoded strings must have an even number length");let t=new Uint8Array(e.length/2);for(let i=0;i<e.length;i+=2){let n=e.slice(i,i+2).toLowerCase();if(n in k)t[i/2]=k[n];else throw Error(`Cannot decode unrecognized sequence ${n} as hexadecimal`)}return t}function P(e){let t="";for(let i=0;i<e.byteLength;i++)t+=_[e[i]];return t}class E{constructor(e){if(this.bytes=e,8!==e.byteLength)throw Error("Int64 buffers must be exactly 8 bytes")}static fromNumber(e){if(e>0x7fffffffffffffff||e<-0x8000000000000000)throw Error(`${e} is too large (or, if negative, too small) to represent as an Int64`);let t=new Uint8Array(8);for(let i=7,n=Math.abs(Math.round(e));i>-1&&n>0;i--,n/=256)t[i]=n;return e<0&&M(t),new E(t)}valueOf(){let e=this.bytes.slice(0),t=128&e[0];return t&&M(e),parseInt(P(e),16)*(t?-1:1)}toString(){return String(this.valueOf())}}function M(e){for(let t=0;t<8;t++)e[t]^=255;for(let t=7;t>-1&&(e[t]++,0===e[t]);t--);}class I{constructor(e,t){this.toUtf8=e,this.fromUtf8=t}format(e){let t=[];for(let i of Object.keys(e)){let n=this.fromUtf8(i);t.push(Uint8Array.from([n.byteLength]),n,this.formatHeaderValue(e[i]))}let i=new Uint8Array(t.reduce((e,t)=>e+t.byteLength,0)),n=0;for(let e of t)i.set(e,n),n+=e.byteLength;return i}formatHeaderValue(e){switch(e.type){case"boolean":return Uint8Array.from([e.value?0:1]);case"byte":return Uint8Array.from([2,e.value]);case"short":let t=new DataView(new ArrayBuffer(3));return t.setUint8(0,3),t.setInt16(1,e.value,!1),new Uint8Array(t.buffer);case"integer":let i=new DataView(new ArrayBuffer(5));return i.setUint8(0,4),i.setInt32(1,e.value,!1),new Uint8Array(i.buffer);case"long":let n=new Uint8Array(9);return n[0]=5,n.set(e.value.bytes,1),n;case"binary":let r=new DataView(new ArrayBuffer(3+e.value.byteLength));r.setUint8(0,6),r.setUint16(1,e.value.byteLength,!1);let s=new Uint8Array(r.buffer);return s.set(e.value,3),s;case"string":let o=this.fromUtf8(e.value),a=new DataView(new ArrayBuffer(3+o.byteLength));a.setUint8(0,7),a.setUint16(1,o.byteLength,!1);let l=new Uint8Array(a.buffer);return l.set(o,3),l;case"timestamp":let d=new Uint8Array(9);return d[0]=8,d.set(E.fromNumber(e.value.valueOf()).bytes,1),d;case"uuid":if(!V.test(e.value))throw Error(`Invalid UUID received: ${e.value}`);let u=new Uint8Array(17);return u[0]=9,u.set(T(e.value.replace(/\-/g,"")),1),u}}parse(e){let t={},i=0;for(;i<e.byteLength;){let n=e.getUint8(i++),r=this.toUtf8(new Uint8Array(e.buffer,e.byteOffset+i,n));switch(i+=n,e.getUint8(i++)){case 0:t[r]={type:A,value:!0};break;case 1:t[r]={type:A,value:!1};break;case 2:t[r]={type:R,value:e.getInt8(i++)};break;case 3:t[r]={type:x,value:e.getInt16(i,!1)},i+=2;break;case 4:t[r]={type:O,value:e.getInt32(i,!1)},i+=4;break;case 5:t[r]={type:D,value:new E(new Uint8Array(e.buffer,e.byteOffset+i,8))},i+=8;break;case 6:let s=e.getUint16(i,!1);i+=2,t[r]={type:L,value:new Uint8Array(e.buffer,e.byteOffset+i,s)},i+=s;break;case 7:let o=e.getUint16(i,!1);i+=2,t[r]={type:F,value:this.toUtf8(new Uint8Array(e.buffer,e.byteOffset+i,o))},i+=o;break;case 8:t[r]={type:B,value:new Date(new E(new Uint8Array(e.buffer,e.byteOffset+i,8)).valueOf())},i+=8;break;case 9:let a=new Uint8Array(e.buffer,e.byteOffset+i,16);i+=16,t[r]={type:N,value:`${P(a.subarray(0,4))}-${P(a.subarray(4,6))}-${P(a.subarray(6,8))}-${P(a.subarray(8,10))}-${P(a.subarray(10))}`};break;default:throw Error("Unrecognized header type tag")}}return t}}!function(e){e[e.boolTrue=0]="boolTrue",e[e.boolFalse=1]="boolFalse",e[e.byte=2]="byte",e[e.short=3]="short",e[e.integer=4]="integer",e[e.long=5]="long",e[e.byteArray=6]="byteArray",e[e.string=7]="string",e[e.timestamp=8]="timestamp",e[e.uuid=9]="uuid"}(n||(n={}));let A="boolean",R="byte",x="short",O="integer",D="long",L="binary",F="string",B="timestamp",N="uuid",V=/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/,U={},z={};for(let e=0;e<256;e++){let t=e.toString(16).toLowerCase();1===t.length&&(t=`0${t}`),U[e]=t,z[t]=e}function j(e){let t="";for(let i=0;i<e.byteLength;i++)t+=U[e[i]];return t}var $=i(30349);let W=e=>e[$.zK]||(e[$.zK]={}),H=e=>{if("function"==typeof e)return e;let t=Promise.resolve(e);return()=>t};var K=i(10637),G=i(80102);let q=e=>"string"==typeof e?(0,G.$)(e):ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(e),Q="X-Amz-Algorithm",Z="X-Amz-Credential",Y="X-Amz-Date",J="X-Amz-SignedHeaders",X="X-Amz-Expires",ee="X-Amz-Signature",et="X-Amz-Security-Token",ei="authorization",en=Y.toLowerCase(),er=[ei,en,"date"],es=ee.toLowerCase(),eo="x-amz-content-sha256",ea=et.toLowerCase(),el={authorization:!0,"cache-control":!0,connection:!0,expect:!0,from:!0,"keep-alive":!0,"max-forwards":!0,pragma:!0,referer:!0,te:!0,trailer:!0,"transfer-encoding":!0,upgrade:!0,"user-agent":!0,"x-amzn-trace-id":!0},ed=/^proxy-/,eu=/^sec-/,ec="AWS4-HMAC-SHA256",eh="AWS4-HMAC-SHA256-PAYLOAD",ef="UNSIGNED-PAYLOAD",ep=50,em="aws4_request",eg=604800,ev={},eb=[],eS=(e,t,i)=>`${e}/${t}/${i}/${em}`,ey=async(e,t,i,n,r)=>{let s=await ew(e,t.secretAccessKey,t.accessKeyId),o=`${i}:${n}:${r}:${j(s)}:${t.sessionToken}`;if(o in ev)return ev[o];for(eb.push(o);eb.length>ep;)delete ev[eb.shift()];let a=`AWS4${t.secretAccessKey}`;for(let t of[i,n,r,em])a=await ew(e,a,t);return ev[o]=a},ew=(e,t,i)=>{let n=new e(t);return n.update(q(i)),n.digest()},eC=({headers:e},t,i)=>{let n={};for(let r of Object.keys(e).sort()){if(void 0==e[r])continue;let s=r.toLowerCase();(!(s in el||t?.has(s)||ed.test(s)||eu.test(s))||i&&(!i||i.has(s)))&&(n[s]=e[r].trim().replace(/\s+/g," "))}return n};var e_=i(13587);let ek=({query:e={}})=>{let t=[],i={};for(let n of Object.keys(e).sort()){if(n.toLowerCase()===es)continue;t.push(n);let r=e[n];"string"==typeof r?i[n]=`${(0,e_.i)(n)}=${(0,e_.i)(r)}`:Array.isArray(r)&&(i[n]=r.slice(0).reduce((e,t)=>e.concat([`${(0,e_.i)(n)}=${(0,e_.i)(t)}`]),[]).sort().join("&"))}return t.map(e=>i[e]).filter(e=>e).join("&")},eT=e=>"function"==typeof ArrayBuffer&&e instanceof ArrayBuffer||"[object ArrayBuffer]"===Object.prototype.toString.call(e),eP=async({headers:e,body:t},i)=>{for(let t of Object.keys(e))if(t.toLowerCase()===eo)return e[t];if(void 0==t)return"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855";if("string"==typeof t||ArrayBuffer.isView(t)||eT(t)){let e=new i;return e.update(q(t)),j(await e.digest())}return ef},eE=(e,t)=>{for(let i of(e=e.toLowerCase(),Object.keys(t)))if(e===i.toLowerCase())return!0;return!1},eM=({headers:e,query:t,...i})=>({...i,headers:{...e},query:t?eI(t):void 0}),eI=e=>Object.keys(e).reduce((t,i)=>{let n=e[i];return{...t,[i]:Array.isArray(n)?[...n]:n}},{}),eA=(e,t={})=>{let{headers:i,query:n={}}="function"==typeof e.clone?e.clone():eM(e);for(let e of Object.keys(i)){let r=e.toLowerCase();"x-amz-"!==r.slice(0,6)||t.unhoistableHeaders?.has(r)||(n[e]=i[e],delete i[e])}return{...e,headers:i,query:n}},eR=e=>{for(let t of Object.keys((e="function"==typeof e.clone?e.clone():eM(e)).headers))er.indexOf(t.toLowerCase())>-1&&delete e.headers[t];return e},ex=e=>eO(e).toISOString().replace(/\.\d{3}Z$/,"Z"),eO=e=>"number"==typeof e?new Date(1e3*e):"string"==typeof e?new Date(Number(e)?1e3*Number(e):e):e;class eD{constructor({applyChecksum:e,credentials:t,region:i,service:n,sha256:r,uriEscapePath:s=!0}){this.headerMarshaller=new I(K.G,G.$),this.service=n,this.sha256=r,this.uriEscapePath=s,this.applyChecksum="boolean"!=typeof e||e,this.regionProvider=H(i),this.credentialProvider=H(t)}async presign(e,t={}){let{signingDate:i=new Date,expiresIn:n=3600,unsignableHeaders:r,unhoistableHeaders:s,signableHeaders:o,signingRegion:a,signingService:l}=t,d=await this.credentialProvider();this.validateResolvedCredentials(d);let u=a??await this.regionProvider(),{longDate:c,shortDate:h}=eL(i);if(n>eg)return Promise.reject("Signature version 4 presigned URLs must have an expiration date less than one week in the future");let f=eS(h,u,l??this.service),p=eA(eR(e),{unhoistableHeaders:s});d.sessionToken&&(p.query[et]=d.sessionToken),p.query[Q]=ec,p.query[Z]=`${d.accessKeyId}/${f}`,p.query[Y]=c,p.query[X]=n.toString(10);let m=eC(p,r,o);return p.query[J]=eF(m),p.query[ee]=await this.getSignature(c,f,this.getSigningKey(d,u,h,l),this.createCanonicalRequest(p,m,await eP(e,this.sha256))),p}async sign(e,t){return"string"==typeof e?this.signString(e,t):e.headers&&e.payload?this.signEvent(e,t):e.message?this.signMessage(e,t):this.signRequest(e,t)}async signEvent({headers:e,payload:t},{signingDate:i=new Date,priorSignature:n,signingRegion:r,signingService:s}){let o=r??await this.regionProvider(),{shortDate:a,longDate:l}=eL(i),d=eS(a,o,s??this.service),u=await eP({headers:{},body:t},this.sha256),c=new this.sha256;c.update(e);let h=[eh,l,d,n,j(await c.digest()),u].join("\n");return this.signString(h,{signingDate:i,signingRegion:o,signingService:s})}async signMessage(e,{signingDate:t=new Date,signingRegion:i,signingService:n}){return this.signEvent({headers:this.headerMarshaller.format(e.message.headers),payload:e.message.body},{signingDate:t,signingRegion:i,signingService:n,priorSignature:e.priorSignature}).then(t=>({message:e.message,signature:t}))}async signString(e,{signingDate:t=new Date,signingRegion:i,signingService:n}={}){let r=await this.credentialProvider();this.validateResolvedCredentials(r);let s=i??await this.regionProvider(),{shortDate:o}=eL(t),a=new this.sha256(await this.getSigningKey(r,s,o,n));return a.update(q(e)),j(await a.digest())}async signRequest(e,{signingDate:t=new Date,signableHeaders:i,unsignableHeaders:n,signingRegion:r,signingService:s}={}){let o=await this.credentialProvider();this.validateResolvedCredentials(o);let a=r??await this.regionProvider(),l=eR(e),{longDate:d,shortDate:u}=eL(t),c=eS(u,a,s??this.service);l.headers[en]=d,o.sessionToken&&(l.headers[ea]=o.sessionToken);let h=await eP(l,this.sha256);!eE(eo,l.headers)&&this.applyChecksum&&(l.headers[eo]=h);let f=eC(l,n,i),p=await this.getSignature(d,c,this.getSigningKey(o,a,u,s),this.createCanonicalRequest(l,f,h));return l.headers[ei]=`${ec} Credential=${o.accessKeyId}/${c}, SignedHeaders=${eF(f)}, Signature=${p}`,l}createCanonicalRequest(e,t,i){let n=Object.keys(t).sort();return`${e.method}
${this.getCanonicalPath(e)}
${ek(e)}
${n.map(e=>`${e}:${t[e]}`).join("\n")}

${n.join(";")}
${i}`}async createStringToSign(e,t,i){let n=new this.sha256;n.update(q(i));let r=await n.digest();return`${ec}
${e}
${t}
${j(r)}`}getCanonicalPath({path:e}){if(this.uriEscapePath){let t=[];for(let i of e.split("/"))i?.length!==0&&"."!==i&&(".."===i?t.pop():t.push(i));return encodeURIComponent(`${e?.startsWith("/")?"/":""}${t.join("/")}${t.length>0&&e?.endsWith("/")?"/":""}`).replace(/%2F/g,"/")}return e}async getSignature(e,t,i,n){let r=await this.createStringToSign(e,t,n),s=new this.sha256(await i);return s.update(q(r)),j(await s.digest())}getSigningKey(e,t,i,n){return ey(this.sha256,e,i,t,n||this.service)}validateResolvedCredentials(e){if("object"!=typeof e||"string"!=typeof e.accessKeyId||"string"!=typeof e.secretAccessKey)throw Error("Resolved credential object is not valid")}}let eL=e=>{let t=ex(e).replace(/[\-:]/g,"");return{longDate:t,shortDate:t.slice(0,8)}},eF=e=>Object.keys(e).sort().join(";"),eB=3e5,eN=e=>{let t;let i=e.credentials?eV(e.credentials):e.credentialDefaultProvider(e),{signingEscapePath:n=!0,systemClockOffset:r=e.systemClockOffset||0,sha256:s}=e;return t=e.signer?H(e.signer):e.regionInfoProvider?()=>H(e.region)().then(async t=>[await e.regionInfoProvider(t,{useFipsEndpoint:await e.useFipsEndpoint(),useDualstackEndpoint:await e.useDualstackEndpoint()})||{},t]).then(([t,r])=>{let{signingRegion:o,signingService:a}=t;e.signingRegion=e.signingRegion||o||r,e.signingName=e.signingName||a||e.serviceId;let l={...e,credentials:i,region:e.signingRegion,service:e.signingName,sha256:s,uriEscapePath:n};return new(e.signerConstructor||eD)(l)}):async t=>{let r=(t=Object.assign({},{name:"sigv4",signingName:e.signingName||e.defaultSigningName,signingRegion:await H(e.region)(),properties:{}},t)).signingRegion,o=t.signingName;e.signingRegion=e.signingRegion||r,e.signingName=e.signingName||o||e.serviceId;let a={...e,credentials:i,region:e.signingRegion,service:e.signingName,sha256:s,uriEscapePath:n};return new(e.signerConstructor||eD)(a)},{...e,systemClockOffset:r,signingEscapePath:n,credentials:i,signer:t}},eV=e=>"function"==typeof e?C(e,e=>void 0!==e.expiration&&e.expiration.getTime()-Date.now()<eB,e=>void 0!==e.expiration):H(e),eU=e=>new Date(Date.now()+e),ez=(e,t)=>Math.abs(eU(t).getTime()-e)>=3e5,ej=(e,t)=>{let i=Date.parse(e);return ez(i,t)?i-Date.now():t},e$=e=>(t,i)=>async function(n){let r;if(!a.aW.isInstance(n.request))return t(n);let s=i.endpointV2?.properties?.authSchemes?.[0],o=s?.name==="sigv4a"?s?.signingRegionSet?.join(","):void 0,l=await e.signer(s),d={signingDate:eU(e.systemClockOffset),signingRegion:o||i.signing_region,signingService:i.signing_service};if(i.s3ExpressIdentity){let e=l;if((r=await e.signWithCredentials(n.request,i.s3ExpressIdentity,d)).headers["X-Amz-Security-Token"]||r.headers["x-amz-security-token"])throw Error("X-Amz-Security-Token must not be set for s3-express requests.")}else r=await l.sign(n.request,d);let u=await t({...n,request:r}).catch(t=>{let i=t.ServerTime??eW(t.$response);throw i&&(e.systemClockOffset=ej(i,e.systemClockOffset)),t}),c=eW(u.response);return c&&(e.systemClockOffset=ej(c,e.systemClockOffset)),u},eW=e=>a.Zn.isInstance(e)?e.headers?.date??e.headers?.Date:void 0,eH={name:"awsAuthMiddleware",tags:["SIGNATURE","AWSAUTH"],relation:"after",toMiddleware:"retryMiddleware",override:!0},eK=e=>({applyToStack:t=>{t.addRelativeTo(e$(e),eH)}});function eG(e){return{...e,customUserAgent:"string"==typeof e.customUserAgent?[[e.customUserAgent]]:e.customUserAgent}}let eq=RegExp("^(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}$"),eQ=e=>eq.test(e)||e.startsWith("[")&&e.endsWith("]"),eZ=RegExp("^(?!.*-$)(?!-)[a-zA-Z0-9-]{1,63}$"),eY=(e,t=!1)=>{if(!t)return eZ.test(e);for(let t of e.split("."))if(!eY(t))return!1;return!0},eJ={},eX="endpoints";function e0(e){return"object"!=typeof e||null==e?e:"ref"in e?`$${e0(e.ref)}`:"fn"in e?`${e.fn}(${(e.argv||[]).map(e0).join(", ")})`:JSON.stringify(e,null,2)}class e1 extends Error{constructor(e){super(e),this.name="EndpointError"}}let e2=(e,t)=>e===t,e3=e=>{let t=e.split("."),i=[];for(let n of t){let t=n.indexOf("[");if(-1!==t){if(n.indexOf("]")!==n.length-1)throw new e1(`Path: '${e}' does not end with ']'`);let r=n.slice(t+1,-1);if(Number.isNaN(parseInt(r)))throw new e1(`Invalid array index: '${r}' in path: '${e}'`);0!==t&&i.push(n.slice(0,t)),i.push(r)}else i.push(n)}return i},e5=(e,t)=>e3(t).reduce((i,n)=>{if("object"!=typeof i)throw new e1(`Index '${n}' in '${t}' not found in '${JSON.stringify(e)}'`);return Array.isArray(i)?i[parseInt(n)]:i[n]},e),e4=e=>null!=e,e6=e=>!e,e8={[$.cj.HTTP]:80,[$.cj.HTTPS]:443},e9={booleanEquals:e2,getAttr:e5,isSet:e4,isValidHostLabel:eY,not:e6,parseURL:e=>{let t=(()=>{try{if(e instanceof URL)return e;if("object"==typeof e&&"hostname"in e){let{hostname:t,port:i,protocol:n="",path:r="",query:s={}}=e,o=new URL(`${n}//${t}${i?`:${i}`:""}${r}`);return o.search=Object.entries(s).map(([e,t])=>`${e}=${t}`).join("&"),o}return new URL(e)}catch(e){return null}})();if(!t)return console.error(`Unable to parse ${JSON.stringify(e)} as a whatwg URL.`),null;let i=t.href,{host:n,hostname:r,pathname:s,protocol:o,search:a}=t;if(a)return null;let l=o.slice(0,-1);if(!Object.values($.cj).includes(l))return null;let d=eQ(r),u=i.includes(`${n}:${e8[l]}`)||"string"==typeof e&&e.includes(`${n}:${e8[l]}`),c=`${n}${u?`:${e8[l]}`:""}`;return{scheme:l,authority:c,path:s,normalizedPath:s.endsWith("/")?s:`${s}/`,isIp:d}},stringEquals:(e,t)=>e===t,substring:(e,t,i,n)=>t>=i||e.length<i?null:n?e.substring(e.length-i,e.length-t):e.substring(t,i),uriEncode:e=>encodeURIComponent(e).replace(/[!*'()]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`)},e7=(e,t)=>{let i=[],n={...t.endpointParams,...t.referenceRecord},r=0;for(;r<e.length;){let t=e.indexOf("{",r);if(-1===t){i.push(e.slice(r));break}i.push(e.slice(r,t));let s=e.indexOf("}",t);if(-1===s){i.push(e.slice(t));break}"{"===e[t+1]&&"}"===e[s+1]&&(i.push(e.slice(t+1,s)),r=s+2);let o=e.substring(t+1,s);if(o.includes("#")){let[e,t]=o.split("#");i.push(e5(n[e],t))}else i.push(n[o]);r=s+1}return i.join("")},te=({ref:e},t)=>({...t.endpointParams,...t.referenceRecord})[e],tt=(e,t,i)=>{if("string"==typeof e)return e7(e,i);if(e.fn)return ti(e,i);if(e.ref)return te(e,i);throw new e1(`'${t}': ${String(e)} is not a string, function or reference.`)},ti=({fn:e,argv:t},i)=>{let n=t.map(e=>["boolean","number"].includes(typeof e)?e:tt(e,"arg",i)),r=e.split(".");return r[0]in eJ&&null!=r[1]?eJ[r[0]][r[1]](...n):e9[e](...n)},tn=({assign:e,...t},i)=>{if(e&&e in i.referenceRecord)throw new e1(`'${e}' is already defined in Reference Record.`);let n=ti(t,i);return i.logger?.debug?.(eX,`evaluateCondition: ${e0(t)} = ${e0(n)}`),{result:""===n||!!n,...null!=e&&{toAssign:{name:e,value:n}}}},tr=(e=[],t)=>{let i={};for(let n of e){let{result:e,toAssign:r}=tn(n,{...t,referenceRecord:{...t.referenceRecord,...i}});if(!e)return{result:e};r&&(i[r.name]=r.value,t.logger?.debug?.(eX,`assign: ${r.name} := ${e0(r.value)}`))}return{result:!0,referenceRecord:i}},ts=(e,t)=>Object.entries(e).reduce((e,[i,n])=>({...e,[i]:n.map(e=>{let n=tt(e,"Header value entry",t);if("string"!=typeof n)throw new e1(`Header '${i}' value '${n}' is not a string`);return n})}),{}),to=(e,t)=>{if(Array.isArray(e))return e.map(e=>to(e,t));switch(typeof e){case"string":return e7(e,t);case"object":if(null===e)throw new e1(`Unexpected endpoint property: ${e}`);return ta(e,t);case"boolean":return e;default:throw new e1(`Unexpected endpoint property type: ${typeof e}`)}},ta=(e,t)=>Object.entries(e).reduce((e,[i,n])=>({...e,[i]:to(n,t)}),{}),tl=(e,t)=>{let i=tt(e,"Endpoint URL",t);if("string"==typeof i)try{return new URL(i)}catch(e){throw console.error(`Failed to construct URL with ${i}`,e),e}throw new e1(`Endpoint URL must be a string, got ${typeof i}`)},td=(e,t)=>{let{conditions:i,endpoint:n}=e,{result:r,referenceRecord:s}=tr(i,t);if(!r)return;let o={...t,referenceRecord:{...t.referenceRecord,...s}},{url:a,properties:l,headers:d}=n;return t.logger?.debug?.(eX,`Resolving endpoint from template: ${e0(n)}`),{...void 0!=d&&{headers:ts(d,o)},...void 0!=l&&{properties:ta(l,o)},url:tl(a,o)}},tu=(e,t)=>{let{conditions:i,error:n}=e,{result:r,referenceRecord:s}=tr(i,t);if(r)throw new e1(tt(n,"Error",{...t,referenceRecord:{...t.referenceRecord,...s}}))},tc=(e,t)=>{let{conditions:i,rules:n}=e,{result:r,referenceRecord:s}=tr(i,t);if(r)return th(n,{...t,referenceRecord:{...t.referenceRecord,...s}})},th=(e,t)=>{for(let i of e)if("endpoint"===i.type){let e=td(i,t);if(e)return e}else if("error"===i.type)tu(i,t);else if("tree"===i.type){let e=tc(i,t);if(e)return e}else throw new e1(`Unknown endpoint rule: ${i}`);throw new e1("Rules evaluation failed")},tf=(e,t)=>{let{endpointParams:i,logger:n}=t,{parameters:r,rules:s}=e;t.logger?.debug?.(`${eX} Initial EndpointParams: ${e0(i)}`);let o=Object.entries(r).filter(([,e])=>null!=e.default).map(([e,t])=>[e,t.default]);if(o.length>0)for(let[e,t]of o)i[e]=i[e]??t;for(let e of Object.entries(r).filter(([,e])=>e.required).map(([e])=>e))if(null==i[e])throw new e1(`Missing required parameter: '${e}'`);let a=th(s,{endpointParams:i,logger:n,referenceRecord:{}});if(t.endpointParams?.Endpoint)try{let{protocol:e,port:i}=new URL(t.endpointParams.Endpoint);a.url.protocol=e,a.url.port=i}catch(e){}return t.logger?.debug?.(`${eX} Resolved endpoint: ${e0(a)}`),a},tp=(e,t=!1)=>{if(t){for(let t of e.split("."))if(!tp(t))return!1;return!0}return!(!eY(e)||e.length<3||e.length>63||e!==e.toLowerCase()||eQ(e))},tm=e=>{let t=e.split(":");if(t.length<6)return null;let[i,n,r,s,o,...a]=t;return"arn"!==i||""===n||""===r||""===a[0]?null:{partition:n,service:r,region:s,accountId:o,resourceId:a[0].includes("/")?a[0].split("/"):a}},tg=JSON.parse('{"partitions":[{"id":"aws","outputs":{"dnsSuffix":"amazonaws.com","dualStackDnsSuffix":"api.aws","implicitGlobalRegion":"us-east-1","name":"aws","supportsDualStack":true,"supportsFIPS":true},"regionRegex":"^(us|eu|ap|sa|ca|me|af|il)\\\\-\\\\w+\\\\-\\\\d+$","regions":{"af-south-1":{"description":"Africa (Cape Town)"},"ap-east-1":{"description":"Asia Pacific (Hong Kong)"},"ap-northeast-1":{"description":"Asia Pacific (Tokyo)"},"ap-northeast-2":{"description":"Asia Pacific (Seoul)"},"ap-northeast-3":{"description":"Asia Pacific (Osaka)"},"ap-south-1":{"description":"Asia Pacific (Mumbai)"},"ap-south-2":{"description":"Asia Pacific (Hyderabad)"},"ap-southeast-1":{"description":"Asia Pacific (Singapore)"},"ap-southeast-2":{"description":"Asia Pacific (Sydney)"},"ap-southeast-3":{"description":"Asia Pacific (Jakarta)"},"ap-southeast-4":{"description":"Asia Pacific (Melbourne)"},"aws-global":{"description":"AWS Standard global region"},"ca-central-1":{"description":"Canada (Central)"},"eu-central-1":{"description":"Europe (Frankfurt)"},"eu-central-2":{"description":"Europe (Zurich)"},"eu-north-1":{"description":"Europe (Stockholm)"},"eu-south-1":{"description":"Europe (Milan)"},"eu-south-2":{"description":"Europe (Spain)"},"eu-west-1":{"description":"Europe (Ireland)"},"eu-west-2":{"description":"Europe (London)"},"eu-west-3":{"description":"Europe (Paris)"},"il-central-1":{"description":"Israel (Tel Aviv)"},"me-central-1":{"description":"Middle East (UAE)"},"me-south-1":{"description":"Middle East (Bahrain)"},"sa-east-1":{"description":"South America (Sao Paulo)"},"us-east-1":{"description":"US East (N. Virginia)"},"us-east-2":{"description":"US East (Ohio)"},"us-west-1":{"description":"US West (N. California)"},"us-west-2":{"description":"US West (Oregon)"}}},{"id":"aws-cn","outputs":{"dnsSuffix":"amazonaws.com.cn","dualStackDnsSuffix":"api.amazonwebservices.com.cn","implicitGlobalRegion":"cn-northwest-1","name":"aws-cn","supportsDualStack":true,"supportsFIPS":true},"regionRegex":"^cn\\\\-\\\\w+\\\\-\\\\d+$","regions":{"aws-cn-global":{"description":"AWS China global region"},"cn-north-1":{"description":"China (Beijing)"},"cn-northwest-1":{"description":"China (Ningxia)"}}},{"id":"aws-us-gov","outputs":{"dnsSuffix":"amazonaws.com","dualStackDnsSuffix":"api.aws","implicitGlobalRegion":"us-gov-west-1","name":"aws-us-gov","supportsDualStack":true,"supportsFIPS":true},"regionRegex":"^us\\\\-gov\\\\-\\\\w+\\\\-\\\\d+$","regions":{"aws-us-gov-global":{"description":"AWS GovCloud (US) global region"},"us-gov-east-1":{"description":"AWS GovCloud (US-East)"},"us-gov-west-1":{"description":"AWS GovCloud (US-West)"}}},{"id":"aws-iso","outputs":{"dnsSuffix":"c2s.ic.gov","dualStackDnsSuffix":"c2s.ic.gov","implicitGlobalRegion":"us-iso-east-1","name":"aws-iso","supportsDualStack":false,"supportsFIPS":true},"regionRegex":"^us\\\\-iso\\\\-\\\\w+\\\\-\\\\d+$","regions":{"aws-iso-global":{"description":"AWS ISO (US) global region"},"us-iso-east-1":{"description":"US ISO East"},"us-iso-west-1":{"description":"US ISO WEST"}}},{"id":"aws-iso-b","outputs":{"dnsSuffix":"sc2s.sgov.gov","dualStackDnsSuffix":"sc2s.sgov.gov","implicitGlobalRegion":"us-isob-east-1","name":"aws-iso-b","supportsDualStack":false,"supportsFIPS":true},"regionRegex":"^us\\\\-isob\\\\-\\\\w+\\\\-\\\\d+$","regions":{"aws-iso-b-global":{"description":"AWS ISOB (US) global region"},"us-isob-east-1":{"description":"US ISOB East (Ohio)"}}},{"id":"aws-iso-e","outputs":{"dnsSuffix":"cloud.adc-e.uk","dualStackDnsSuffix":"cloud.adc-e.uk","implicitGlobalRegion":"eu-isoe-west-1","name":"aws-iso-e","supportsDualStack":false,"supportsFIPS":true},"regionRegex":"^eu\\\\-isoe\\\\-\\\\w+\\\\-\\\\d+$","regions":{}},{"id":"aws-iso-f","outputs":{"dnsSuffix":"csp.hci.ic.gov","dualStackDnsSuffix":"csp.hci.ic.gov","implicitGlobalRegion":"us-isof-south-1","name":"aws-iso-f","supportsDualStack":false,"supportsFIPS":true},"regionRegex":"^us\\\\-isof\\\\-\\\\w+\\\\-\\\\d+$","regions":{}}],"version":"1.1"}'),tv="",tb=()=>tv,tS={isVirtualHostableS3Bucket:tp,parseArn:tm,partition:e=>{let{partitions:t}=tg;for(let i of t){let{regions:t,outputs:n}=i;for(let[i,r]of Object.entries(t))if(i===e)return{...n,...r}}for(let i of t){let{regionRegex:t,outputs:n}=i;if(new RegExp(t).test(e))return{...n}}let i=t.find(e=>"aws"===e.id);if(!i)throw Error("Provided region was not found in the partition array or regex, and default partition with id 'aws' doesn't exist.");return{...i.outputs}}};eJ.aws=tS;let ty="user-agent",tw="x-amz-user-agent",tC=" ",t_="/",tk=/[^\!\$\%\&\'\*\+\-\.\^\_\`\|\~\d\w]/g,tT=/[^\!\$\%\&\'\*\+\-\.\^\_\`\|\~\d\w\#]/g,tP="-",tE=e=>(t,i)=>async n=>{let{request:r}=n;if(!a.aW.isInstance(r))return t(n);let{headers:s}=r,o=i?.userAgent?.map(tM)||[],l=(await e.defaultUserAgentProvider()).map(tM),d=e?.customUserAgent?.map(tM)||[],u=tb(),c=(u?[u]:[]).concat([...l,...o,...d]).join(tC),h=[...l.filter(e=>e.startsWith("aws-sdk-")),...d].join(tC);return"browser"!==e.runtime?(h&&(s[tw]=s[tw]?`${s[ty]} ${h}`:h),s[ty]=c):s[tw]=c,t({...n,request:r})},tM=e=>{let t=e[0].split(t_).map(e=>e.replace(tk,tP)).join(t_),i=e[1]?.replace(tT,tP),n=t.indexOf(t_),r=t.substring(0,n),s=t.substring(n+1);return"api"===r&&(s=s.toLowerCase()),[r,s,i].filter(e=>e&&e.length>0).reduce((e,t,i)=>{switch(i){case 0:return t;case 1:return`${e}/${t}`;default:return`${e}#${t}`}},"")},tI={name:"getUserAgentMiddleware",step:"build",priority:"low",tags:["SET_USER_AGENT","USER_AGENT"],override:!0},tA=e=>({applyToStack:t=>{t.add(tE(e),tI)}});!function(e){e.ENV="env",e.CONFIG="shared config entry"}(r||(r={}));let tR=!1,tx=!1,tO=e=>"string"==typeof e&&(e.startsWith("fips-")||e.endsWith("-fips")),tD=e=>tO(e)?["fips-aws-global","aws-fips"].includes(e)?"us-east-1":e.replace(/fips-(dkr-|prod-)?|-fips/,""):e,tL=e=>{let{region:t,useFipsEndpoint:i}=e;if(!t)throw Error("Region is missing");return{...e,region:async()=>"string"==typeof t?tD(t):tD(await t()),useFipsEndpoint:async()=>!!tO("string"==typeof t?t:await t())||("function"!=typeof i?Promise.resolve(!!i):i())}},tF="content-length";function tB(e){return t=>async i=>{let n=i.request;if(a.aW.isInstance(n)){let{body:t,headers:i}=n;if(t&&-1===Object.keys(i).map(e=>e.toLowerCase()).indexOf(tF))try{let i=e(t);n.headers={...n.headers,[tF]:String(i)}}catch(e){}}return t({...i,request:n})}}let tN={step:"build",tags:["SET_CONTENT_LENGTH","CONTENT_LENGTH"],name:"contentLengthMiddleware",override:!0},tV=e=>({applyToStack:t=>{t.add(tB(e.bodyLengthChecker),tN)}}),tU=async e=>{let t=e?.Bucket||"";if("string"==typeof e.Bucket&&(e.Bucket=t.replace(/#/g,encodeURIComponent("#")).replace(/\?/g,encodeURIComponent("?"))),tH(t)){if(!0===e.ForcePathStyle)throw Error("Path-style addressing cannot be used with ARN buckets")}else tW(t)&&(-1===t.indexOf(".")||String(e.Endpoint).startsWith("http:"))&&t.toLowerCase()===t&&!(t.length<3)||(e.ForcePathStyle=!0);return e.DisableMultiRegionAccessPoints&&(e.disableMultiRegionAccessPoints=!0,e.DisableMRAP=!0),e},tz=/^[a-z0-9][a-z0-9\.\-]{1,61}[a-z0-9]$/,tj=/(\d+\.){3}\d+/,t$=/\.\./,tW=e=>tz.test(e)&&!tj.test(e)&&!t$.test(e),tH=e=>{let[t,i,n,r,s,o]=e.split(":"),a="arn"===t&&e.split(":").length>=6,l=5===[t,i,n,s,o].filter(Boolean).length;if(a&&!l)throw Error(`Invalid ARN: ${e} was an invalid ARN.`);return"arn"===t&&!!i&&!!n&&!!s&&!!o},tK=(e,t,i)=>{let n=async()=>{let n=i[e]??i[t];return"function"==typeof n?n():n};return"endpoint"===e||"endpoint"===t?async()=>{let e=await n();if(e&&"object"==typeof e){if("url"in e)return e.url.href;if("hostname"in e){let{protocol:t,hostname:i,port:n,path:r}=e;return`${t}//${i}${n?":"+n:""}${r}`}}return e}:n},tG=async e=>void 0;function tq(e){let t={};if(e=e.replace(/^\?/,""))for(let i of e.split("&")){let[e,n=null]=i.split("=");e=decodeURIComponent(e),n&&(n=decodeURIComponent(n)),e in t?Array.isArray(t[e])?t[e].push(n):t[e]=[t[e],n]:t[e]=n}return t}let tQ=e=>{let t;if("string"==typeof e)return tQ(new URL(e));let{hostname:i,pathname:n,port:r,protocol:s,search:o}=e;return o&&(t=tq(o)),{hostname:i,port:r?parseInt(r):void 0,protocol:s,path:n,query:t}},tZ=e=>"object"==typeof e?"url"in e?tQ(e.url):e:tQ(e),tY=async(e,t,i,n)=>{if(!i.endpoint){let e=await tG(i.serviceId||"");e&&(i.endpoint=()=>Promise.resolve(tZ(e)))}let r=await tJ(e,t,i);if("function"!=typeof i.endpointProvider)throw Error("config.endpointProvider is not set.");return i.endpointProvider(r,n)},tJ=async(e,t,i)=>{let n={},r=t?.getEndpointParameterInstructions?.()||{};for(let[t,s]of Object.entries(r))switch(s.type){case"staticContextParams":n[t]=s.value;break;case"contextParams":n[t]=e[s.name];break;case"clientContextParams":case"builtInParams":n[t]=await tK(s.name,t,i)();break;default:throw Error("Unrecognized endpoint parameter instruction: "+JSON.stringify(s))}return 0===Object.keys(r).length&&Object.assign(n,i),"s3"===String(i.serviceId).toLowerCase()&&await tU(n),n},tX=({config:e,instructions:t})=>(i,n)=>async r=>{let s=await tY(r.input,{getEndpointParameterInstructions:()=>t},{...e},n);n.endpointV2=s,n.authSchemes=s.properties?.authSchemes;let o=n.authSchemes?.[0];if(o){n.signing_region=o.signingRegion,n.signing_service=o.signingName;let e=W(n),t=e?.selectedHttpAuthScheme?.httpAuthOption;t&&(t.signingProperties=Object.assign(t.signingProperties||{},{signing_region:o.signingRegion,signingRegion:o.signingRegion,signing_service:o.signingName,signingName:o.signingName,signingRegionSet:o.signingRegionSet},o.properties))}return i({...r})},t0=(e,t)=>(i,n)=>async n=>{let{response:r}=await i(n);try{let i=await t(r,e);return{response:r,output:i}}catch(e){if(Object.defineProperty(e,"$response",{value:r}),!("$metadata"in e)){let t="Deserialization error: to see the raw response, inspect the hidden field {error}.$response on this object.";e.message+="\n  "+t}throw e}},t1=(e,t)=>(i,n)=>async r=>{let s=n.endpointV2?.url&&e.urlParser?async()=>e.urlParser(n.endpointV2.url):e.endpoint;if(!s)throw Error("No valid endpoint provider available.");let o=await t(r.input,{...e,endpoint:s});return i({...r,request:o})},t2={name:"deserializerMiddleware",step:"deserialize",tags:["DESERIALIZER"],override:!0},t3={name:"serializerMiddleware",step:"serialize",tags:["SERIALIZER"],override:!0};function t5(e,t,i){return{applyToStack:n=>{n.add(t0(e,i),t2),n.add(t1(e,t),t3)}}}let t4={step:"serialize",tags:["ENDPOINT_PARAMETERS","ENDPOINT_V2","ENDPOINT"],name:"endpointV2Middleware",override:!0,relation:"before",toMiddleware:t3.name},t6=(e,t)=>({applyToStack:i=>{i.addRelativeTo(tX({config:e,instructions:t}),t4)}}),t8=e=>{let t=e.tls??!0,{endpoint:i}=e,n=null!=i?async()=>tZ(await H(i)()):void 0,r=!!i;return{...e,endpoint:n,tls:t,isCustomEndpoint:r,useDualstackEndpoint:H(e.useDualstackEndpoint??!1),useFipsEndpoint:H(e.useFipsEndpoint??!1)}};!function(e){e.STANDARD="standard",e.ADAPTIVE="adaptive"}(s||(s={}));let t9=3,t7=s.STANDARD,ie=["BandwidthLimitExceeded","EC2ThrottledException","LimitExceededException","PriorRequestNotComplete","ProvisionedThroughputExceededException","RequestLimitExceeded","RequestThrottled","RequestThrottledException","SlowDown","ThrottledException","Throttling","ThrottlingException","TooManyRequestsException","TransactionInProgressException"],it=["TimeoutError","RequestTimeout","RequestTimeoutException"],ii=[500,502,503,504],ir=["ECONNRESET","ECONNREFUSED","EPIPE","ETIMEDOUT"],is=e=>e.$metadata?.httpStatusCode===429||ie.includes(e.name)||e.$retryable?.throttling==!0,io=e=>it.includes(e.name)||ir.includes(e?.code||"")||ii.includes(e.$metadata?.httpStatusCode||0),ia=e=>{if(e.$metadata?.httpStatusCode!==void 0){let t=e.$metadata.httpStatusCode;if(500<=t&&t<=599&&!io(e))return!0}return!1};class il{constructor(e){this.currentCapacity=0,this.enabled=!1,this.lastMaxRate=0,this.measuredTxRate=0,this.requestCount=0,this.lastTimestamp=0,this.timeWindow=0,this.beta=e?.beta??.7,this.minCapacity=e?.minCapacity??1,this.minFillRate=e?.minFillRate??.5,this.scaleConstant=e?.scaleConstant??.4,this.smooth=e?.smooth??.8;let t=this.getCurrentTimeInSeconds();this.lastThrottleTime=t,this.lastTxRateBucket=Math.floor(this.getCurrentTimeInSeconds()),this.fillRate=this.minFillRate,this.maxCapacity=this.minCapacity}getCurrentTimeInSeconds(){return Date.now()/1e3}async getSendToken(){return this.acquireTokenBucket(1)}async acquireTokenBucket(e){if(this.enabled){if(this.refillTokenBucket(),e>this.currentCapacity){let t=(e-this.currentCapacity)/this.fillRate*1e3;await new Promise(e=>setTimeout(e,t))}this.currentCapacity=this.currentCapacity-e}}refillTokenBucket(){let e=this.getCurrentTimeInSeconds();if(!this.lastTimestamp){this.lastTimestamp=e;return}let t=(e-this.lastTimestamp)*this.fillRate;this.currentCapacity=Math.min(this.maxCapacity,this.currentCapacity+t),this.lastTimestamp=e}updateClientSendingRate(e){let t;if(this.updateMeasuredRate(),is(e)){let e=this.enabled?Math.min(this.measuredTxRate,this.fillRate):this.measuredTxRate;this.lastMaxRate=e,this.calculateTimeWindow(),this.lastThrottleTime=this.getCurrentTimeInSeconds(),t=this.cubicThrottle(e),this.enableTokenBucket()}else this.calculateTimeWindow(),t=this.cubicSuccess(this.getCurrentTimeInSeconds());let i=Math.min(t,2*this.measuredTxRate);this.updateTokenBucketRate(i)}calculateTimeWindow(){this.timeWindow=this.getPrecise(Math.pow(this.lastMaxRate*(1-this.beta)/this.scaleConstant,1/3))}cubicThrottle(e){return this.getPrecise(e*this.beta)}cubicSuccess(e){return this.getPrecise(this.scaleConstant*Math.pow(e-this.lastThrottleTime-this.timeWindow,3)+this.lastMaxRate)}enableTokenBucket(){this.enabled=!0}updateTokenBucketRate(e){this.refillTokenBucket(),this.fillRate=Math.max(e,this.minFillRate),this.maxCapacity=Math.max(e,this.minCapacity),this.currentCapacity=Math.min(this.currentCapacity,this.maxCapacity)}updateMeasuredRate(){let e=Math.floor(2*this.getCurrentTimeInSeconds())/2;if(this.requestCount++,e>this.lastTxRateBucket){let t=this.requestCount/(e-this.lastTxRateBucket);this.measuredTxRate=this.getPrecise(t*this.smooth+this.measuredTxRate*(1-this.smooth)),this.requestCount=0,this.lastTxRateBucket=e}}getPrecise(e){return parseFloat(e.toFixed(8))}}let id=100,iu=2e4,ic=500,ih=500,ip=5,im=10,ig=1,iv="amz-sdk-invocation-id",ib="amz-sdk-request",iS=()=>{let e=id;return{computeNextBackoffDelay:t=>Math.floor(Math.min(iu,Math.random()*2**t*e)),setDelayBase:t=>{e=t}}},iy=({retryDelay:e,retryCount:t,retryCost:i})=>({getRetryCount:()=>t,getRetryDelay:()=>Math.min(iu,e),getRetryCost:()=>i});class iw{constructor(e){this.maxAttempts=e,this.mode=s.STANDARD,this.capacity=ih,this.retryBackoffStrategy=iS(),this.maxAttemptsProvider="function"==typeof e?e:async()=>e}async acquireInitialRetryToken(e){return iy({retryDelay:id,retryCount:0})}async refreshRetryTokenForRetry(e,t){let i=await this.getMaxAttempts();if(this.shouldRetry(e,t,i)){let i=t.errorType;this.retryBackoffStrategy.setDelayBase("THROTTLING"===i?ic:id);let n=this.retryBackoffStrategy.computeNextBackoffDelay(e.getRetryCount()),r=t.retryAfterHint?Math.max(t.retryAfterHint.getTime()-Date.now()||0,n):n,s=this.getCapacityCost(i);return this.capacity-=s,iy({retryDelay:r,retryCount:e.getRetryCount()+1,retryCost:s})}throw Error("No retry token available")}recordSuccess(e){this.capacity=Math.max(ih,this.capacity+(e.getRetryCost()??ig))}getCapacity(){return this.capacity}async getMaxAttempts(){try{return await this.maxAttemptsProvider()}catch(e){return console.warn(`Max attempts provider could not resolve. Using default of ${t9}`),t9}}shouldRetry(e,t,i){return e.getRetryCount()+1<i&&this.capacity>=this.getCapacityCost(t.errorType)&&this.isRetryableError(t.errorType)}getCapacityCost(e){return"TRANSIENT"===e?im:ip}isRetryableError(e){return"THROTTLING"===e||"TRANSIENT"===e}}class iC{constructor(e,t){this.maxAttemptsProvider=e,this.mode=s.ADAPTIVE;let{rateLimiter:i}=t??{};this.rateLimiter=i??new il,this.standardRetryStrategy=new iw(e)}async acquireInitialRetryToken(e){return await this.rateLimiter.getSendToken(),this.standardRetryStrategy.acquireInitialRetryToken(e)}async refreshRetryTokenForRetry(e,t){return this.rateLimiter.updateClientSendingRate(t),this.standardRetryStrategy.refreshRetryTokenForRetry(e,t)}recordSuccess(e){this.rateLimiter.updateClientSendingRate({}),this.standardRetryStrategy.recordSuccess(e)}}var i_=new Uint8Array(16);function ik(){if(!o&&!(o="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return o(i_)}for(var iT=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,iP=function(e){return"string"==typeof e&&iT.test(e)},iE=[],iM=0;iM<256;++iM)iE.push((iM+256).toString(16).substr(1));var iI=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=(iE[e[t+0]]+iE[e[t+1]]+iE[e[t+2]]+iE[e[t+3]]+"-"+iE[e[t+4]]+iE[e[t+5]]+"-"+iE[e[t+6]]+iE[e[t+7]]+"-"+iE[e[t+8]]+iE[e[t+9]]+"-"+iE[e[t+10]]+iE[e[t+11]]+iE[e[t+12]]+iE[e[t+13]]+iE[e[t+14]]+iE[e[t+15]]).toLowerCase();if(!iP(i))throw TypeError("Stringified UUID is invalid");return i},iA=function(e,t,i){var n=(e=e||{}).random||(e.rng||ik)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){i=i||0;for(var r=0;r<16;++r)t[i+r]=n[r];return t}return iI(n)};let iR=e=>e instanceof Error?e:e instanceof Object?Object.assign(Error(),e):"string"==typeof e?Error(e):Error(`AWS SDK error wrapper for ${e}`),ix=e=>{let{retryStrategy:t}=e,i=H(e.maxAttempts??t9);return{...e,maxAttempts:i,retryStrategy:async()=>t||(await H(e.retryMode)()===s.ADAPTIVE?new iC(i):new iw(i))}};var iO=i(23710);let iD=e=>e?.body instanceof ReadableStream,iL=e=>(t,i)=>async n=>{let r=await e.retryStrategy(),s=await e.maxAttempts();if(!iF(r))return r?.mode&&(i.userAgent=[...i.userAgent||[],["cfg/retry-mode",r.mode]]),r.retry(t,n);{let e=await r.acquireInitialRetryToken(i.partition_id),o=Error(),l=0,d=0,{request:u}=n,c=a.aW.isInstance(u);for(c&&(u.headers[iv]=iA());;)try{c&&(u.headers[ib]=`attempt=${l+1}; max=${s}`);let{response:i,output:o}=await t(n);return r.recordSuccess(e),o.$metadata.attempts=l+1,o.$metadata.totalRetryDelay=d,{response:i,output:o}}catch(s){let t=iB(s);if(o=iR(s),c&&iD(u))throw(i.logger instanceof iO.vk?console:i.logger)?.warn("An error was encountered in a non-retryable streaming request."),o;try{e=await r.refreshRetryTokenForRetry(e,t)}catch(e){throw o.$metadata||(o.$metadata={}),o.$metadata.attempts=l+1,o.$metadata.totalRetryDelay=d,o}l=e.getRetryCount();let n=e.getRetryDelay();d+=n,await new Promise(e=>setTimeout(e,n))}}},iF=e=>void 0!==e.acquireInitialRetryToken&&void 0!==e.refreshRetryTokenForRetry&&void 0!==e.recordSuccess,iB=e=>{let t={errorType:iN(e)},i=iz(e.$response);return i&&(t.retryAfterHint=i),t},iN=e=>is(e)?"THROTTLING":io(e)?"TRANSIENT":ia(e)?"SERVER_ERROR":"CLIENT_ERROR",iV={name:"retryMiddleware",tags:["RETRY"],step:"finalizeRequest",priority:"high",override:!0},iU=e=>({applyToStack:t=>{t.add(iL(e),iV)}}),iz=e=>{if(!a.Zn.isInstance(e))return;let t=Object.keys(e.headers).find(e=>"retry-after"===e.toLowerCase());if(!t)return;let i=e.headers[t],n=Number(i);return new Date(Number.isNaN(n)?i:1e3*n)},ij=e=>({...e,useDualstackEndpoint:e.useDualstackEndpoint??!1,useFipsEndpoint:e.useFipsEndpoint??!1,defaultSigningName:"chime"});var i$={i8:"3.468.0"},iW=i(98250),iH=i(22510),iK=i.n(iH);let iG=({serviceId:e,clientVersion:t})=>async()=>{let i="undefined"!=typeof window&&window?.navigator?.userAgent?iK().parse(window.navigator.userAgent):void 0,n=[["aws-sdk-js",t],["ua","2.0"],[`os/${i?.os?.name||"other"}`,i?.os?.version],["lang/js"],["md/browser",`${i?.browser?.name??"unknown"}_${i?.browser?.version??"unknown"}`]];return e&&n.push([`api/${e}`,t]),n};var iq=i(14247);let iQ=e=>()=>Promise.reject(e),iZ="function"==typeof TextEncoder?new TextEncoder:null,iY=e=>{if("string"==typeof e){if(iZ)return iZ.encode(e).byteLength;let t=e.length;for(let i=t-1;i>=0;i--){let n=e.charCodeAt(i);n>127&&n<=2047?t++:n>2047&&n<=65535&&(t+=2),n>=56320&&n<=57343&&i--}return t}if("number"==typeof e.byteLength)return e.byteLength;if("number"==typeof e.size)return e.size;throw Error(`Body Length computation failed for ${e}`)};var iJ=i(80880);let iX="required",i0="fn",i1="argv",i2="ref",i3="isSet",i5="booleanEquals",i4="error",i6="endpoint",i8="tree",i9="PartitionResult",i7={[iX]:!1,type:"String"},ne={[iX]:!0,default:!1,type:"Boolean"},nt={[i2]:"Endpoint"},ni={[i0]:i5,[i1]:[{[i2]:"UseFIPS"},!0]},nn={[i0]:i5,[i1]:[{[i2]:"UseDualStack"},!0]},nr={},ns={[i0]:"getAttr",[i1]:[{[i2]:i9},"supportsFIPS"]},no={[i0]:i5,[i1]:[!0,{[i0]:"getAttr",[i1]:[{[i2]:i9},"supportsDualStack"]}]},na=[ni],nl=[nn],nd=[{[i2]:"Region"}],nu={version:"1.0",parameters:{Region:i7,UseDualStack:ne,UseFIPS:ne,Endpoint:i7},rules:[{conditions:[{[i0]:i3,[i1]:[nt]}],rules:[{conditions:na,error:"Invalid Configuration: FIPS and custom endpoint are not supported",type:i4},{conditions:nl,error:"Invalid Configuration: Dualstack and custom endpoint are not supported",type:i4},{endpoint:{url:nt,properties:nr,headers:nr},type:i6}],type:i8},{conditions:[{[i0]:i3,[i1]:nd}],rules:[{conditions:[{[i0]:"aws.partition",[i1]:nd,assign:i9}],rules:[{conditions:[ni,nn],rules:[{conditions:[{[i0]:i5,[i1]:[!0,ns]},no],rules:[{endpoint:{url:"https://messaging-chime-fips.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:nr,headers:nr},type:i6}],type:i8},{error:"FIPS and DualStack are enabled, but this partition does not support one or both",type:i4}],type:i8},{conditions:na,rules:[{conditions:[{[i0]:i5,[i1]:[ns,!0]}],rules:[{endpoint:{url:"https://messaging-chime-fips.{Region}.{PartitionResult#dnsSuffix}",properties:nr,headers:nr},type:i6}],type:i8},{error:"FIPS is enabled but this partition does not support FIPS",type:i4}],type:i8},{conditions:nl,rules:[{conditions:[no],rules:[{endpoint:{url:"https://messaging-chime.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:nr,headers:nr},type:i6}],type:i8},{error:"DualStack is enabled but this partition does not support DualStack",type:i4}],type:i8},{endpoint:{url:"https://messaging-chime.{Region}.{PartitionResult#dnsSuffix}",properties:nr,headers:nr},type:i6}],type:i8}],type:i8},{error:"Invalid Configuration: Missing Region",type:i4}]},nc=(e,t={})=>tf(nu,{endpointParams:e,logger:t.logger}),nh=e=>({apiVersion:"2021-05-15",base64Decoder:e?.base64Decoder??iJ.G,base64Encoder:e?.base64Encoder??iJ.s,disableHostPrefix:e?.disableHostPrefix??!1,endpointProvider:e?.endpointProvider??nc,extensions:e?.extensions??[],logger:e?.logger??new iO.vk,serviceId:e?.serviceId??"Chime SDK Messaging",urlParser:e?.urlParser??tQ,utf8Decoder:e?.utf8Decoder??G.$,utf8Encoder:e?.utf8Encoder??K.G}),nf=["in-region","cross-region","mobile","standard","legacy"],np=({defaultsMode:e}={})=>C(async()=>{let t="function"==typeof e?await e():e;switch(t?.toLowerCase()){case"auto":return Promise.resolve(nm()?"mobile":"standard");case"mobile":case"in-region":case"cross-region":case"standard":case"legacy":return Promise.resolve(t?.toLocaleLowerCase());case void 0:return Promise.resolve("legacy");default:throw Error(`Invalid parameter for "defaultsMode", expect ${nf.join(", ")}, got ${t}`)}}),nm=()=>{let e="undefined"!=typeof window&&window?.navigator?.userAgent?iK().parse(window.navigator.userAgent):void 0,t=e?.platform?.type;return"tablet"===t||"mobile"===t},ng=e=>{let t=np(e),i=()=>t().then(iO.jv),n=nh(e);return{...n,...e,runtime:"browser",defaultsMode:t,bodyLengthChecker:e?.bodyLengthChecker??iY,credentialDefaultProvider:e?.credentialDefaultProvider??(e=>()=>Promise.reject(Error("Credential is missing"))),defaultUserAgentProvider:e?.defaultUserAgentProvider??iG({serviceId:n.serviceId,clientVersion:i$.i8}),maxAttempts:e?.maxAttempts??t9,region:e?.region??iQ("Region is missing"),requestHandler:e?.requestHandler??new iq.BX(i),retryMode:e?.retryMode??(async()=>(await i()).retryMode||t7),sha256:e?.sha256??iW.Sha256,streamCollector:e?.streamCollector??iq.CF,useDualstackEndpoint:e?.useDualstackEndpoint??(()=>Promise.resolve(tR)),useFipsEndpoint:e?.useFipsEndpoint??(()=>Promise.resolve(tx))}},nv=e=>{let t=async()=>{if(void 0===e.region)throw Error("Region is missing from runtimeConfig");let t=e.region;return"string"==typeof t?t:t()};return{setRegion(e){t=e},region:()=>t}},nb=e=>({region:e.region()}),nS=e=>e,ny=(e,t)=>{let i={...nS(nv(e)),...nS((0,iO.kE)(e)),...nS((0,a.cA)(e))};return t.forEach(e=>e.configure(i)),{...e,...nb(i),...(0,iO.SQ)(i),...(0,a.AO)(i)}};class nw extends iO.KU{constructor(...[e]){let t=ny(eG(eN(l(ix(t8(tL(ij(ng(e||{})))))))),e?.extensions||[]);super(t),this.config=t,this.middlewareStack.use(iU(this.config)),this.middlewareStack.use(tV(this.config)),this.middlewareStack.use(c(this.config)),this.middlewareStack.use(p(this.config)),this.middlewareStack.use(w(this.config)),this.middlewareStack.use(eK(this.config)),this.middlewareStack.use(tA(this.config))}destroy(){super.destroy()}}var nC=i(81633);class n_ extends iO.mY{static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,i){this.middlewareStack.use(t5(t,this.serialize,this.deserialize)),this.middlewareStack.use(t6(t,n_.getEndpointParameterInstructions()));let n=e.concat(this.middlewareStack),{logger:r}=t,s={logger:r,clientName:"ChimeSDKMessagingClient",commandName:"AssociateChannelFlowCommand",inputFilterSensitiveLog:e=>e,outputFilterSensitiveLog:e=>e,[$.zK]:{service:"ChimeMessagingService",operation:"AssociateChannelFlow"}},{requestHandler:o}=t;return n.resolve(e=>o.handle(e.request,i||{}),s)}serialize(e,t){return(0,nC.if)(e,t)}deserialize(e,t){return(0,nC.uD)(e,t)}}var nk=i(4122);class nT extends iO.mY{static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,i){this.middlewareStack.use(t5(t,this.serialize,this.deserialize)),this.middlewareStack.use(t6(t,nT.getEndpointParameterInstructions()));let n=e.concat(this.middlewareStack),{logger:r}=t,s={logger:r,clientName:"ChimeSDKMessagingClient",commandName:"BatchCreateChannelMembershipCommand",inputFilterSensitiveLog:e=>e,outputFilterSensitiveLog:nk.SH,[$.zK]:{service:"ChimeMessagingService",operation:"BatchCreateChannelMembership"}},{requestHandler:o}=t;return n.resolve(e=>o.handle(e.request,i||{}),s)}serialize(e,t){return(0,nC.mJ)(e,t)}deserialize(e,t){return(0,nC.xP)(e,t)}}class nP extends iO.mY{static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,i){this.middlewareStack.use(t5(t,this.serialize,this.deserialize)),this.middlewareStack.use(t6(t,nP.getEndpointParameterInstructions()));let n=e.concat(this.middlewareStack),{logger:r}=t,s={logger:r,clientName:"ChimeSDKMessagingClient",commandName:"ChannelFlowCallbackCommand",inputFilterSensitiveLog:nk.YJ,outputFilterSensitiveLog:e=>e,[$.zK]:{service:"ChimeMessagingService",operation:"ChannelFlowCallback"}},{requestHandler:o}=t;return n.resolve(e=>o.handle(e.request,i||{}),s)}serialize(e,t){return(0,nC.tJ)(e,t)}deserialize(e,t){return(0,nC.xA)(e,t)}}class nE extends iO.mY{static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,i){this.middlewareStack.use(t5(t,this.serialize,this.deserialize)),this.middlewareStack.use(t6(t,nE.getEndpointParameterInstructions()));let n=e.concat(this.middlewareStack),{logger:r}=t,s={logger:r,clientName:"ChimeSDKMessagingClient",commandName:"CreateChannelBanCommand",inputFilterSensitiveLog:e=>e,outputFilterSensitiveLog:nk.iZ,[$.zK]:{service:"ChimeMessagingService",operation:"CreateChannelBan"}},{requestHandler:o}=t;return n.resolve(e=>o.handle(e.request,i||{}),s)}serialize(e,t){return(0,nC.O8)(e,t)}deserialize(e,t){return(0,nC.HL)(e,t)}}class nM extends iO.mY{static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,i){this.middlewareStack.use(t5(t,this.serialize,this.deserialize)),this.middlewareStack.use(t6(t,nM.getEndpointParameterInstructions()));let n=e.concat(this.middlewareStack),{logger:r}=t,s={logger:r,clientName:"ChimeSDKMessagingClient",commandName:"CreateChannelCommand",inputFilterSensitiveLog:nk.vD,outputFilterSensitiveLog:e=>e,[$.zK]:{service:"ChimeMessagingService",operation:"CreateChannel"}},{requestHandler:o}=t;return n.resolve(e=>o.handle(e.request,i||{}),s)}serialize(e,t){return(0,nC.yN)(e,t)}deserialize(e,t){return(0,nC.JJ)(e,t)}}class nI extends iO.mY{static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,i){this.middlewareStack.use(t5(t,this.serialize,this.deserialize)),this.middlewareStack.use(t6(t,nI.getEndpointParameterInstructions()));let n=e.concat(this.middlewareStack),{logger:r}=t,s={logger:r,clientName:"ChimeSDKMessagingClient",commandName:"CreateChannelFlowCommand",inputFilterSensitiveLog:nk.GW,outputFilterSensitiveLog:e=>e,[$.zK]:{service:"ChimeMessagingService",operation:"CreateChannelFlow"}},{requestHandler:o}=t;return n.resolve(e=>o.handle(e.request,i||{}),s)}serialize(e,t){return(0,nC.t1)(e,t)}deserialize(e,t){return(0,nC.eb)(e,t)}}class nA extends iO.mY{static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,i){this.middlewareStack.use(t5(t,this.serialize,this.deserialize)),this.middlewareStack.use(t6(t,nA.getEndpointParameterInstructions()));let n=e.concat(this.middlewareStack),{logger:r}=t,s={logger:r,clientName:"ChimeSDKMessagingClient",commandName:"CreateChannelMembershipCommand",inputFilterSensitiveLog:e=>e,outputFilterSensitiveLog:nk.Fz,[$.zK]:{service:"ChimeMessagingService",operation:"CreateChannelMembership"}},{requestHandler:o}=t;return n.resolve(e=>o.handle(e.request,i||{}),s)}serialize(e,t){return(0,nC.kk)(e,t)}deserialize(e,t){return(0,nC.uQ)(e,t)}}class nR extends iO.mY{static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,i){this.middlewareStack.use(t5(t,this.serialize,this.deserialize)),this.middlewareStack.use(t6(t,nR.getEndpointParameterInstructions()));let n=e.concat(this.middlewareStack),{logger:r}=t,s={logger:r,clientName:"ChimeSDKMessagingClient",commandName:"CreateChannelModeratorCommand",inputFilterSensitiveLog:e=>e,outputFilterSensitiveLog:nk.Yb,[$.zK]:{service:"ChimeMessagingService",operation:"CreateChannelModerator"}},{requestHandler:o}=t;return n.resolve(e=>o.handle(e.request,i||{}),s)}serialize(e,t){return(0,nC.l9)(e,t)}deserialize(e,t){return(0,nC.N_)(e,t)}}class nx extends iO.mY{static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,i){this.middlewareStack.use(t5(t,this.serialize,this.deserialize)),this.middlewareStack.use(t6(t,nx.getEndpointParameterInstructions()));let n=e.concat(this.middlewareStack),{logger:r}=t,s={logger:r,clientName:"ChimeSDKMessagingClient",commandName:"DeleteChannelBanCommand",inputFilterSensitiveLog:e=>e,outputFilterSensitiveLog:e=>e,[$.zK]:{service:"ChimeMessagingService",operation:"DeleteChannelBan"}},{requestHandler:o}=t;return n.resolve(e=>o.handle(e.request,i||{}),s)}serialize(e,t){return(0,nC.rg)(e,t)}deserialize(e,t){return(0,nC.C7)(e,t)}}class nO extends iO.mY{static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,i){this.middlewareStack.use(t5(t,this.serialize,this.deserialize)),this.middlewareStack.use(t6(t,nO.getEndpointParameterInstructions()));let n=e.concat(this.middlewareStack),{logger:r}=t,s={logger:r,clientName:"ChimeSDKMessagingClient",commandName:"DeleteChannelCommand",inputFilterSensitiveLog:e=>e,outputFilterSensitiveLog:e=>e,[$.zK]:{service:"ChimeMessagingService",operation:"DeleteChannel"}},{requestHandler:o}=t;return n.resolve(e=>o.handle(e.request,i||{}),s)}serialize(e,t){return(0,nC.px)(e,t)}deserialize(e,t){return(0,nC.An)(e,t)}}class nD extends iO.mY{static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,i){this.middlewareStack.use(t5(t,this.serialize,this.deserialize)),this.middlewareStack.use(t6(t,nD.getEndpointParameterInstructions()));let n=e.concat(this.middlewareStack),{logger:r}=t,s={logger:r,clientName:"ChimeSDKMessagingClient",commandName:"DeleteChannelFlowCommand",inputFilterSensitiveLog:e=>e,outputFilterSensitiveLog:e=>e,[$.zK]:{service:"ChimeMessagingService",operation:"DeleteChannelFlow"}},{requestHandler:o}=t;return n.resolve(e=>o.handle(e.request,i||{}),s)}serialize(e,t){return(0,nC.tO)(e,t)}deserialize(e,t){return(0,nC.W7)(e,t)}}class nL extends iO.mY{static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,i){this.middlewareStack.use(t5(t,this.serialize,this.deserialize)),this.middlewareStack.use(t6(t,nL.getEndpointParameterInstructions()));let n=e.concat(this.middlewareStack),{logger:r}=t,s={logger:r,clientName:"ChimeSDKMessagingClient",commandName:"DeleteChannelMembershipCommand",inputFilterSensitiveLog:e=>e,outputFilterSensitiveLog:e=>e,[$.zK]:{service:"ChimeMessagingService",operation:"DeleteChannelMembership"}},{requestHandler:o}=t;return n.resolve(e=>o.handle(e.request,i||{}),s)}serialize(e,t){return(0,nC.bJ)(e,t)}deserialize(e,t){return(0,nC.Ls)(e,t)}}class nF extends iO.mY{static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,i){this.middlewareStack.use(t5(t,this.serialize,this.deserialize)),this.middlewareStack.use(t6(t,nF.getEndpointParameterInstructions()));let n=e.concat(this.middlewareStack),{logger:r}=t,s={logger:r,clientName:"ChimeSDKMessagingClient",commandName:"DeleteChannelMessageCommand",inputFilterSensitiveLog:e=>e,outputFilterSensitiveLog:e=>e,[$.zK]:{service:"ChimeMessagingService",operation:"DeleteChannelMessage"}},{requestHandler:o}=t;return n.resolve(e=>o.handle(e.request,i||{}),s)}serialize(e,t){return(0,nC.Qb)(e,t)}deserialize(e,t){return(0,nC.jm)(e,t)}}class nB extends iO.mY{static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,i){this.middlewareStack.use(t5(t,this.serialize,this.deserialize)),this.middlewareStack.use(t6(t,nB.getEndpointParameterInstructions()));let n=e.concat(this.middlewareStack),{logger:r}=t,s={logger:r,clientName:"ChimeSDKMessagingClient",commandName:"DeleteChannelModeratorCommand",inputFilterSensitiveLog:e=>e,outputFilterSensitiveLog:e=>e,[$.zK]:{service:"ChimeMessagingService",operation:"DeleteChannelModerator"}},{requestHandler:o}=t;return n.resolve(e=>o.handle(e.request,i||{}),s)}serialize(e,t){return(0,nC.fu)(e,t)}deserialize(e,t){return(0,nC.aO)(e,t)}}class nN extends iO.mY{static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,i){this.middlewareStack.use(t5(t,this.serialize,this.deserialize)),this.middlewareStack.use(t6(t,nN.getEndpointParameterInstructions()));let n=e.concat(this.middlewareStack),{logger:r}=t,s={logger:r,clientName:"ChimeSDKMessagingClient",commandName:"DeleteMessagingStreamingConfigurationsCommand",inputFilterSensitiveLog:e=>e,outputFilterSensitiveLog:e=>e,[$.zK]:{service:"ChimeMessagingService",operation:"DeleteMessagingStreamingConfigurations"}},{requestHandler:o}=t;return n.resolve(e=>o.handle(e.request,i||{}),s)}serialize(e,t){return(0,nC.V2)(e,t)}deserialize(e,t){return(0,nC.eV)(e,t)}}class nV extends iO.mY{static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,i){this.middlewareStack.use(t5(t,this.serialize,this.deserialize)),this.middlewareStack.use(t6(t,nV.getEndpointParameterInstructions()));let n=e.concat(this.middlewareStack),{logger:r}=t,s={logger:r,clientName:"ChimeSDKMessagingClient",commandName:"DescribeChannelBanCommand",inputFilterSensitiveLog:e=>e,outputFilterSensitiveLog:nk.rF,[$.zK]:{service:"ChimeMessagingService",operation:"DescribeChannelBan"}},{requestHandler:o}=t;return n.resolve(e=>o.handle(e.request,i||{}),s)}serialize(e,t){return(0,nC.lb)(e,t)}deserialize(e,t){return(0,nC.H6)(e,t)}}class nU extends iO.mY{static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,i){this.middlewareStack.use(t5(t,this.serialize,this.deserialize)),this.middlewareStack.use(t6(t,nU.getEndpointParameterInstructions()));let n=e.concat(this.middlewareStack),{logger:r}=t,s={logger:r,clientName:"ChimeSDKMessagingClient",commandName:"DescribeChannelCommand",inputFilterSensitiveLog:e=>e,outputFilterSensitiveLog:nk.q8,[$.zK]:{service:"ChimeMessagingService",operation:"DescribeChannel"}},{requestHandler:o}=t;return n.resolve(e=>o.handle(e.request,i||{}),s)}serialize(e,t){return(0,nC.qh)(e,t)}deserialize(e,t){return(0,nC.IN)(e,t)}}class nz extends iO.mY{static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,i){this.middlewareStack.use(t5(t,this.serialize,this.deserialize)),this.middlewareStack.use(t6(t,nz.getEndpointParameterInstructions()));let n=e.concat(this.middlewareStack),{logger:r}=t,s={logger:r,clientName:"ChimeSDKMessagingClient",commandName:"DescribeChannelFlowCommand",inputFilterSensitiveLog:e=>e,outputFilterSensitiveLog:nk.wz,[$.zK]:{service:"ChimeMessagingService",operation:"DescribeChannelFlow"}},{requestHandler:o}=t;return n.resolve(e=>o.handle(e.request,i||{}),s)}serialize(e,t){return(0,nC.nW)(e,t)}deserialize(e,t){return(0,nC.zt)(e,t)}}class nj extends iO.mY{static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,i){this.middlewareStack.use(t5(t,this.serialize,this.deserialize)),this.middlewareStack.use(t6(t,nj.getEndpointParameterInstructions()));let n=e.concat(this.middlewareStack),{logger:r}=t,s={logger:r,clientName:"ChimeSDKMessagingClient",commandName:"DescribeChannelMembershipCommand",inputFilterSensitiveLog:e=>e,outputFilterSensitiveLog:nk.lE,[$.zK]:{service:"ChimeMessagingService",operation:"DescribeChannelMembership"}},{requestHandler:o}=t;return n.resolve(e=>o.handle(e.request,i||{}),s)}serialize(e,t){return(0,nC.$H)(e,t)}deserialize(e,t){return(0,nC.PI)(e,t)}}class n$ extends iO.mY{static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,i){this.middlewareStack.use(t5(t,this.serialize,this.deserialize)),this.middlewareStack.use(t6(t,n$.getEndpointParameterInstructions()));let n=e.concat(this.middlewareStack),{logger:r}=t,s={logger:r,clientName:"ChimeSDKMessagingClient",commandName:"DescribeChannelMembershipForAppInstanceUserCommand",inputFilterSensitiveLog:e=>e,outputFilterSensitiveLog:nk.KF,[$.zK]:{service:"ChimeMessagingService",operation:"DescribeChannelMembershipForAppInstanceUser"}},{requestHandler:o}=t;return n.resolve(e=>o.handle(e.request,i||{}),s)}serialize(e,t){return(0,nC.oN)(e,t)}deserialize(e,t){return(0,nC.KA)(e,t)}}class nW extends iO.mY{static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,i){this.middlewareStack.use(t5(t,this.serialize,this.deserialize)),this.middlewareStack.use(t6(t,nW.getEndpointParameterInstructions()));let n=e.concat(this.middlewareStack),{logger:r}=t,s={logger:r,clientName:"ChimeSDKMessagingClient",commandName:"DescribeChannelModeratedByAppInstanceUserCommand",inputFilterSensitiveLog:e=>e,outputFilterSensitiveLog:nk.mK,[$.zK]:{service:"ChimeMessagingService",operation:"DescribeChannelModeratedByAppInstanceUser"}},{requestHandler:o}=t;return n.resolve(e=>o.handle(e.request,i||{}),s)}serialize(e,t){return(0,nC.h9)(e,t)}deserialize(e,t){return(0,nC.rN)(e,t)}}class nH extends iO.mY{static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,i){this.middlewareStack.use(t5(t,this.serialize,this.deserialize)),this.middlewareStack.use(t6(t,nH.getEndpointParameterInstructions()));let n=e.concat(this.middlewareStack),{logger:r}=t,s={logger:r,clientName:"ChimeSDKMessagingClient",commandName:"DescribeChannelModeratorCommand",inputFilterSensitiveLog:e=>e,outputFilterSensitiveLog:nk.Iq,[$.zK]:{service:"ChimeMessagingService",operation:"DescribeChannelModerator"}},{requestHandler:o}=t;return n.resolve(e=>o.handle(e.request,i||{}),s)}serialize(e,t){return(0,nC.Up)(e,t)}deserialize(e,t){return(0,nC.U$)(e,t)}}class nK extends iO.mY{static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,i){this.middlewareStack.use(t5(t,this.serialize,this.deserialize)),this.middlewareStack.use(t6(t,nK.getEndpointParameterInstructions()));let n=e.concat(this.middlewareStack),{logger:r}=t,s={logger:r,clientName:"ChimeSDKMessagingClient",commandName:"DisassociateChannelFlowCommand",inputFilterSensitiveLog:e=>e,outputFilterSensitiveLog:e=>e,[$.zK]:{service:"ChimeMessagingService",operation:"DisassociateChannelFlow"}},{requestHandler:o}=t;return n.resolve(e=>o.handle(e.request,i||{}),s)}serialize(e,t){return(0,nC.ZD)(e,t)}deserialize(e,t){return(0,nC.t2)(e,t)}}class nG extends iO.mY{static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,i){this.middlewareStack.use(t5(t,this.serialize,this.deserialize)),this.middlewareStack.use(t6(t,nG.getEndpointParameterInstructions()));let n=e.concat(this.middlewareStack),{logger:r}=t,s={logger:r,clientName:"ChimeSDKMessagingClient",commandName:"GetChannelMembershipPreferencesCommand",inputFilterSensitiveLog:e=>e,outputFilterSensitiveLog:nk.Ty,[$.zK]:{service:"ChimeMessagingService",operation:"GetChannelMembershipPreferences"}},{requestHandler:o}=t;return n.resolve(e=>o.handle(e.request,i||{}),s)}serialize(e,t){return(0,nC.Iy)(e,t)}deserialize(e,t){return(0,nC.Xx)(e,t)}}class nq extends iO.mY{static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,i){this.middlewareStack.use(t5(t,this.serialize,this.deserialize)),this.middlewareStack.use(t6(t,nq.getEndpointParameterInstructions()));let n=e.concat(this.middlewareStack),{logger:r}=t,s={logger:r,clientName:"ChimeSDKMessagingClient",commandName:"GetChannelMessageCommand",inputFilterSensitiveLog:e=>e,outputFilterSensitiveLog:nk.Z4,[$.zK]:{service:"ChimeMessagingService",operation:"GetChannelMessage"}},{requestHandler:o}=t;return n.resolve(e=>o.handle(e.request,i||{}),s)}serialize(e,t){return(0,nC.VW)(e,t)}deserialize(e,t){return(0,nC.se)(e,t)}}class nQ extends iO.mY{static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,i){this.middlewareStack.use(t5(t,this.serialize,this.deserialize)),this.middlewareStack.use(t6(t,nQ.getEndpointParameterInstructions()));let n=e.concat(this.middlewareStack),{logger:r}=t,s={logger:r,clientName:"ChimeSDKMessagingClient",commandName:"GetChannelMessageStatusCommand",inputFilterSensitiveLog:e=>e,outputFilterSensitiveLog:e=>e,[$.zK]:{service:"ChimeMessagingService",operation:"GetChannelMessageStatus"}},{requestHandler:o}=t;return n.resolve(e=>o.handle(e.request,i||{}),s)}serialize(e,t){return(0,nC.DW)(e,t)}deserialize(e,t){return(0,nC.RN)(e,t)}}class nZ extends iO.mY{static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,i){this.middlewareStack.use(t5(t,this.serialize,this.deserialize)),this.middlewareStack.use(t6(t,nZ.getEndpointParameterInstructions()));let n=e.concat(this.middlewareStack),{logger:r}=t,s={logger:r,clientName:"ChimeSDKMessagingClient",commandName:"GetMessagingSessionEndpointCommand",inputFilterSensitiveLog:e=>e,outputFilterSensitiveLog:e=>e,[$.zK]:{service:"ChimeMessagingService",operation:"GetMessagingSessionEndpoint"}},{requestHandler:o}=t;return n.resolve(e=>o.handle(e.request,i||{}),s)}serialize(e,t){return(0,nC.wd)(e,t)}deserialize(e,t){return(0,nC.mz)(e,t)}}class nY extends iO.mY{static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,i){this.middlewareStack.use(t5(t,this.serialize,this.deserialize)),this.middlewareStack.use(t6(t,nY.getEndpointParameterInstructions()));let n=e.concat(this.middlewareStack),{logger:r}=t,s={logger:r,clientName:"ChimeSDKMessagingClient",commandName:"GetMessagingStreamingConfigurationsCommand",inputFilterSensitiveLog:e=>e,outputFilterSensitiveLog:e=>e,[$.zK]:{service:"ChimeMessagingService",operation:"GetMessagingStreamingConfigurations"}},{requestHandler:o}=t;return n.resolve(e=>o.handle(e.request,i||{}),s)}serialize(e,t){return(0,nC.Cm)(e,t)}deserialize(e,t){return(0,nC.oi)(e,t)}}class nJ extends iO.mY{static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,i){this.middlewareStack.use(t5(t,this.serialize,this.deserialize)),this.middlewareStack.use(t6(t,nJ.getEndpointParameterInstructions()));let n=e.concat(this.middlewareStack),{logger:r}=t,s={logger:r,clientName:"ChimeSDKMessagingClient",commandName:"ListChannelBansCommand",inputFilterSensitiveLog:nk.on,outputFilterSensitiveLog:nk.ho,[$.zK]:{service:"ChimeMessagingService",operation:"ListChannelBans"}},{requestHandler:o}=t;return n.resolve(e=>o.handle(e.request,i||{}),s)}serialize(e,t){return(0,nC.RU)(e,t)}deserialize(e,t){return(0,nC.CI)(e,t)}}class nX extends iO.mY{static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,i){this.middlewareStack.use(t5(t,this.serialize,this.deserialize)),this.middlewareStack.use(t6(t,nX.getEndpointParameterInstructions()));let n=e.concat(this.middlewareStack),{logger:r}=t,s={logger:r,clientName:"ChimeSDKMessagingClient",commandName:"ListChannelFlowsCommand",inputFilterSensitiveLog:nk.Di,outputFilterSensitiveLog:nk.M_,[$.zK]:{service:"ChimeMessagingService",operation:"ListChannelFlows"}},{requestHandler:o}=t;return n.resolve(e=>o.handle(e.request,i||{}),s)}serialize(e,t){return(0,nC.P0)(e,t)}deserialize(e,t){return(0,nC.OV)(e,t)}}class n0 extends iO.mY{static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,i){this.middlewareStack.use(t5(t,this.serialize,this.deserialize)),this.middlewareStack.use(t6(t,n0.getEndpointParameterInstructions()));let n=e.concat(this.middlewareStack),{logger:r}=t,s={logger:r,clientName:"ChimeSDKMessagingClient",commandName:"ListChannelMembershipsCommand",inputFilterSensitiveLog:nk.mW,outputFilterSensitiveLog:nk.oW,[$.zK]:{service:"ChimeMessagingService",operation:"ListChannelMemberships"}},{requestHandler:o}=t;return n.resolve(e=>o.handle(e.request,i||{}),s)}serialize(e,t){return(0,nC.FS)(e,t)}deserialize(e,t){return(0,nC.kX)(e,t)}}class n1 extends iO.mY{static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,i){this.middlewareStack.use(t5(t,this.serialize,this.deserialize)),this.middlewareStack.use(t6(t,n1.getEndpointParameterInstructions()));let n=e.concat(this.middlewareStack),{logger:r}=t,s={logger:r,clientName:"ChimeSDKMessagingClient",commandName:"ListChannelMembershipsForAppInstanceUserCommand",inputFilterSensitiveLog:nk.Lt,outputFilterSensitiveLog:nk.Vq,[$.zK]:{service:"ChimeMessagingService",operation:"ListChannelMembershipsForAppInstanceUser"}},{requestHandler:o}=t;return n.resolve(e=>o.handle(e.request,i||{}),s)}serialize(e,t){return(0,nC.uJ)(e,t)}deserialize(e,t){return(0,nC.hM)(e,t)}}class n2 extends iO.mY{static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,i){this.middlewareStack.use(t5(t,this.serialize,this.deserialize)),this.middlewareStack.use(t6(t,n2.getEndpointParameterInstructions()));let n=e.concat(this.middlewareStack),{logger:r}=t,s={logger:r,clientName:"ChimeSDKMessagingClient",commandName:"ListChannelMessagesCommand",inputFilterSensitiveLog:nk.v7,outputFilterSensitiveLog:nk.tB,[$.zK]:{service:"ChimeMessagingService",operation:"ListChannelMessages"}},{requestHandler:o}=t;return n.resolve(e=>o.handle(e.request,i||{}),s)}serialize(e,t){return(0,nC.Ev)(e,t)}deserialize(e,t){return(0,nC.Jn)(e,t)}}class n3 extends iO.mY{static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,i){this.middlewareStack.use(t5(t,this.serialize,this.deserialize)),this.middlewareStack.use(t6(t,n3.getEndpointParameterInstructions()));let n=e.concat(this.middlewareStack),{logger:r}=t,s={logger:r,clientName:"ChimeSDKMessagingClient",commandName:"ListChannelModeratorsCommand",inputFilterSensitiveLog:nk.q2,outputFilterSensitiveLog:nk.hG,[$.zK]:{service:"ChimeMessagingService",operation:"ListChannelModerators"}},{requestHandler:o}=t;return n.resolve(e=>o.handle(e.request,i||{}),s)}serialize(e,t){return(0,nC.X7)(e,t)}deserialize(e,t){return(0,nC.My)(e,t)}}class n5 extends iO.mY{static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,i){this.middlewareStack.use(t5(t,this.serialize,this.deserialize)),this.middlewareStack.use(t6(t,n5.getEndpointParameterInstructions()));let n=e.concat(this.middlewareStack),{logger:r}=t,s={logger:r,clientName:"ChimeSDKMessagingClient",commandName:"ListChannelsAssociatedWithChannelFlowCommand",inputFilterSensitiveLog:nk.yP,outputFilterSensitiveLog:nk.QG,[$.zK]:{service:"ChimeMessagingService",operation:"ListChannelsAssociatedWithChannelFlow"}},{requestHandler:o}=t;return n.resolve(e=>o.handle(e.request,i||{}),s)}serialize(e,t){return(0,nC.et)(e,t)}deserialize(e,t){return(0,nC.VA)(e,t)}}class n4 extends iO.mY{static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,i){this.middlewareStack.use(t5(t,this.serialize,this.deserialize)),this.middlewareStack.use(t6(t,n4.getEndpointParameterInstructions()));let n=e.concat(this.middlewareStack),{logger:r}=t,s={logger:r,clientName:"ChimeSDKMessagingClient",commandName:"ListChannelsCommand",inputFilterSensitiveLog:nk.Qc,outputFilterSensitiveLog:nk.VO,[$.zK]:{service:"ChimeMessagingService",operation:"ListChannels"}},{requestHandler:o}=t;return n.resolve(e=>o.handle(e.request,i||{}),s)}serialize(e,t){return(0,nC.gR)(e,t)}deserialize(e,t){return(0,nC.YZ)(e,t)}}class n6 extends iO.mY{static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,i){this.middlewareStack.use(t5(t,this.serialize,this.deserialize)),this.middlewareStack.use(t6(t,n6.getEndpointParameterInstructions()));let n=e.concat(this.middlewareStack),{logger:r}=t,s={logger:r,clientName:"ChimeSDKMessagingClient",commandName:"ListChannelsModeratedByAppInstanceUserCommand",inputFilterSensitiveLog:nk.SA,outputFilterSensitiveLog:nk.CE,[$.zK]:{service:"ChimeMessagingService",operation:"ListChannelsModeratedByAppInstanceUser"}},{requestHandler:o}=t;return n.resolve(e=>o.handle(e.request,i||{}),s)}serialize(e,t){return(0,nC.lj)(e,t)}deserialize(e,t){return(0,nC.yx)(e,t)}}class n8 extends iO.mY{static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,i){this.middlewareStack.use(t5(t,this.serialize,this.deserialize)),this.middlewareStack.use(t6(t,n8.getEndpointParameterInstructions()));let n=e.concat(this.middlewareStack),{logger:r}=t,s={logger:r,clientName:"ChimeSDKMessagingClient",commandName:"ListSubChannelsCommand",inputFilterSensitiveLog:nk.XF,outputFilterSensitiveLog:nk.xD,[$.zK]:{service:"ChimeMessagingService",operation:"ListSubChannels"}},{requestHandler:o}=t;return n.resolve(e=>o.handle(e.request,i||{}),s)}serialize(e,t){return(0,nC.Jp)(e,t)}deserialize(e,t){return(0,nC.Px)(e,t)}}class n9 extends iO.mY{static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,i){this.middlewareStack.use(t5(t,this.serialize,this.deserialize)),this.middlewareStack.use(t6(t,n9.getEndpointParameterInstructions()));let n=e.concat(this.middlewareStack),{logger:r}=t,s={logger:r,clientName:"ChimeSDKMessagingClient",commandName:"ListTagsForResourceCommand",inputFilterSensitiveLog:e=>e,outputFilterSensitiveLog:nk.iO,[$.zK]:{service:"ChimeMessagingService",operation:"ListTagsForResource"}},{requestHandler:o}=t;return n.resolve(e=>o.handle(e.request,i||{}),s)}serialize(e,t){return(0,nC.b9)(e,t)}deserialize(e,t){return(0,nC.m$)(e,t)}}class n7 extends iO.mY{static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,i){this.middlewareStack.use(t5(t,this.serialize,this.deserialize)),this.middlewareStack.use(t6(t,n7.getEndpointParameterInstructions()));let n=e.concat(this.middlewareStack),{logger:r}=t,s={logger:r,clientName:"ChimeSDKMessagingClient",commandName:"PutChannelExpirationSettingsCommand",inputFilterSensitiveLog:e=>e,outputFilterSensitiveLog:e=>e,[$.zK]:{service:"ChimeMessagingService",operation:"PutChannelExpirationSettings"}},{requestHandler:o}=t;return n.resolve(e=>o.handle(e.request,i||{}),s)}serialize(e,t){return(0,nC.f2)(e,t)}deserialize(e,t){return(0,nC.Hd)(e,t)}}class re extends iO.mY{static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,i){this.middlewareStack.use(t5(t,this.serialize,this.deserialize)),this.middlewareStack.use(t6(t,re.getEndpointParameterInstructions()));let n=e.concat(this.middlewareStack),{logger:r}=t,s={logger:r,clientName:"ChimeSDKMessagingClient",commandName:"PutChannelMembershipPreferencesCommand",inputFilterSensitiveLog:nk.kU,outputFilterSensitiveLog:nk.aJ,[$.zK]:{service:"ChimeMessagingService",operation:"PutChannelMembershipPreferences"}},{requestHandler:o}=t;return n.resolve(e=>o.handle(e.request,i||{}),s)}serialize(e,t){return(0,nC.Ut)(e,t)}deserialize(e,t){return(0,nC.jz)(e,t)}}class rt extends iO.mY{static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,i){this.middlewareStack.use(t5(t,this.serialize,this.deserialize)),this.middlewareStack.use(t6(t,rt.getEndpointParameterInstructions()));let n=e.concat(this.middlewareStack),{logger:r}=t,s={logger:r,clientName:"ChimeSDKMessagingClient",commandName:"PutMessagingStreamingConfigurationsCommand",inputFilterSensitiveLog:e=>e,outputFilterSensitiveLog:e=>e,[$.zK]:{service:"ChimeMessagingService",operation:"PutMessagingStreamingConfigurations"}},{requestHandler:o}=t;return n.resolve(e=>o.handle(e.request,i||{}),s)}serialize(e,t){return(0,nC.DC)(e,t)}deserialize(e,t){return(0,nC.vn)(e,t)}}class ri extends iO.mY{static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,i){this.middlewareStack.use(t5(t,this.serialize,this.deserialize)),this.middlewareStack.use(t6(t,ri.getEndpointParameterInstructions()));let n=e.concat(this.middlewareStack),{logger:r}=t,s={logger:r,clientName:"ChimeSDKMessagingClient",commandName:"RedactChannelMessageCommand",inputFilterSensitiveLog:e=>e,outputFilterSensitiveLog:e=>e,[$.zK]:{service:"ChimeMessagingService",operation:"RedactChannelMessage"}},{requestHandler:o}=t;return n.resolve(e=>o.handle(e.request,i||{}),s)}serialize(e,t){return(0,nC.pZ)(e,t)}deserialize(e,t){return(0,nC.eY)(e,t)}}class rn extends iO.mY{static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,i){this.middlewareStack.use(t5(t,this.serialize,this.deserialize)),this.middlewareStack.use(t6(t,rn.getEndpointParameterInstructions()));let n=e.concat(this.middlewareStack),{logger:r}=t,s={logger:r,clientName:"ChimeSDKMessagingClient",commandName:"SearchChannelsCommand",inputFilterSensitiveLog:nk.rt,outputFilterSensitiveLog:nk.rm,[$.zK]:{service:"ChimeMessagingService",operation:"SearchChannels"}},{requestHandler:o}=t;return n.resolve(e=>o.handle(e.request,i||{}),s)}serialize(e,t){return(0,nC.mv)(e,t)}deserialize(e,t){return(0,nC.BE)(e,t)}}class rr extends iO.mY{static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,i){this.middlewareStack.use(t5(t,this.serialize,this.deserialize)),this.middlewareStack.use(t6(t,rr.getEndpointParameterInstructions()));let n=e.concat(this.middlewareStack),{logger:r}=t,s={logger:r,clientName:"ChimeSDKMessagingClient",commandName:"SendChannelMessageCommand",inputFilterSensitiveLog:nk.J2,outputFilterSensitiveLog:e=>e,[$.zK]:{service:"ChimeMessagingService",operation:"SendChannelMessage"}},{requestHandler:o}=t;return n.resolve(e=>o.handle(e.request,i||{}),s)}serialize(e,t){return(0,nC.jy)(e,t)}deserialize(e,t){return(0,nC.On)(e,t)}}class rs extends iO.mY{static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,i){this.middlewareStack.use(t5(t,this.serialize,this.deserialize)),this.middlewareStack.use(t6(t,rs.getEndpointParameterInstructions()));let n=e.concat(this.middlewareStack),{logger:r}=t,s={logger:r,clientName:"ChimeSDKMessagingClient",commandName:"TagResourceCommand",inputFilterSensitiveLog:nk.Cc,outputFilterSensitiveLog:e=>e,[$.zK]:{service:"ChimeMessagingService",operation:"TagResource"}},{requestHandler:o}=t;return n.resolve(e=>o.handle(e.request,i||{}),s)}serialize(e,t){return(0,nC.FJ)(e,t)}deserialize(e,t){return(0,nC.A6)(e,t)}}class ro extends iO.mY{static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,i){this.middlewareStack.use(t5(t,this.serialize,this.deserialize)),this.middlewareStack.use(t6(t,ro.getEndpointParameterInstructions()));let n=e.concat(this.middlewareStack),{logger:r}=t,s={logger:r,clientName:"ChimeSDKMessagingClient",commandName:"UntagResourceCommand",inputFilterSensitiveLog:nk.hz,outputFilterSensitiveLog:e=>e,[$.zK]:{service:"ChimeMessagingService",operation:"UntagResource"}},{requestHandler:o}=t;return n.resolve(e=>o.handle(e.request,i||{}),s)}serialize(e,t){return(0,nC.mO)(e,t)}deserialize(e,t){return(0,nC.s7)(e,t)}}class ra extends iO.mY{static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,i){this.middlewareStack.use(t5(t,this.serialize,this.deserialize)),this.middlewareStack.use(t6(t,ra.getEndpointParameterInstructions()));let n=e.concat(this.middlewareStack),{logger:r}=t,s={logger:r,clientName:"ChimeSDKMessagingClient",commandName:"UpdateChannelCommand",inputFilterSensitiveLog:nk.ui,outputFilterSensitiveLog:e=>e,[$.zK]:{service:"ChimeMessagingService",operation:"UpdateChannel"}},{requestHandler:o}=t;return n.resolve(e=>o.handle(e.request,i||{}),s)}serialize(e,t){return(0,nC.mc)(e,t)}deserialize(e,t){return(0,nC.gW)(e,t)}}class rl extends iO.mY{static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,i){this.middlewareStack.use(t5(t,this.serialize,this.deserialize)),this.middlewareStack.use(t6(t,rl.getEndpointParameterInstructions()));let n=e.concat(this.middlewareStack),{logger:r}=t,s={logger:r,clientName:"ChimeSDKMessagingClient",commandName:"UpdateChannelFlowCommand",inputFilterSensitiveLog:nk.Si,outputFilterSensitiveLog:e=>e,[$.zK]:{service:"ChimeMessagingService",operation:"UpdateChannelFlow"}},{requestHandler:o}=t;return n.resolve(e=>o.handle(e.request,i||{}),s)}serialize(e,t){return(0,nC.HO)(e,t)}deserialize(e,t){return(0,nC.H2)(e,t)}}class rd extends iO.mY{static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,i){this.middlewareStack.use(t5(t,this.serialize,this.deserialize)),this.middlewareStack.use(t6(t,rd.getEndpointParameterInstructions()));let n=e.concat(this.middlewareStack),{logger:r}=t,s={logger:r,clientName:"ChimeSDKMessagingClient",commandName:"UpdateChannelMessageCommand",inputFilterSensitiveLog:nk.VU,outputFilterSensitiveLog:e=>e,[$.zK]:{service:"ChimeMessagingService",operation:"UpdateChannelMessage"}},{requestHandler:o}=t;return n.resolve(e=>o.handle(e.request,i||{}),s)}serialize(e,t){return(0,nC.G_)(e,t)}deserialize(e,t){return(0,nC.LF)(e,t)}}class ru extends iO.mY{static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,i){this.middlewareStack.use(t5(t,this.serialize,this.deserialize)),this.middlewareStack.use(t6(t,ru.getEndpointParameterInstructions()));let n=e.concat(this.middlewareStack),{logger:r}=t,s={logger:r,clientName:"ChimeSDKMessagingClient",commandName:"UpdateChannelReadMarkerCommand",inputFilterSensitiveLog:e=>e,outputFilterSensitiveLog:e=>e,[$.zK]:{service:"ChimeMessagingService",operation:"UpdateChannelReadMarker"}},{requestHandler:o}=t;return n.resolve(e=>o.handle(e.request,i||{}),s)}serialize(e,t){return(0,nC.kI)(e,t)}deserialize(e,t){return(0,nC.iR)(e,t)}}let rc={AssociateChannelFlowCommand:n_,BatchCreateChannelMembershipCommand:nT,ChannelFlowCallbackCommand:nP,CreateChannelCommand:nM,CreateChannelBanCommand:nE,CreateChannelFlowCommand:nI,CreateChannelMembershipCommand:nA,CreateChannelModeratorCommand:nR,DeleteChannelCommand:nO,DeleteChannelBanCommand:nx,DeleteChannelFlowCommand:nD,DeleteChannelMembershipCommand:nL,DeleteChannelMessageCommand:nF,DeleteChannelModeratorCommand:nB,DeleteMessagingStreamingConfigurationsCommand:nN,DescribeChannelCommand:nU,DescribeChannelBanCommand:nV,DescribeChannelFlowCommand:nz,DescribeChannelMembershipCommand:nj,DescribeChannelMembershipForAppInstanceUserCommand:n$,DescribeChannelModeratedByAppInstanceUserCommand:nW,DescribeChannelModeratorCommand:nH,DisassociateChannelFlowCommand:nK,GetChannelMembershipPreferencesCommand:nG,GetChannelMessageCommand:nq,GetChannelMessageStatusCommand:nQ,GetMessagingSessionEndpointCommand:nZ,GetMessagingStreamingConfigurationsCommand:nY,ListChannelBansCommand:nJ,ListChannelFlowsCommand:nX,ListChannelMembershipsCommand:n0,ListChannelMembershipsForAppInstanceUserCommand:n1,ListChannelMessagesCommand:n2,ListChannelModeratorsCommand:n3,ListChannelsCommand:n4,ListChannelsAssociatedWithChannelFlowCommand:n5,ListChannelsModeratedByAppInstanceUserCommand:n6,ListSubChannelsCommand:n8,ListTagsForResourceCommand:n9,PutChannelExpirationSettingsCommand:n7,PutChannelMembershipPreferencesCommand:re,PutMessagingStreamingConfigurationsCommand:rt,RedactChannelMessageCommand:ri,SearchChannelsCommand:rn,SendChannelMessageCommand:rr,TagResourceCommand:rs,UntagResourceCommand:ro,UpdateChannelCommand:ra,UpdateChannelFlowCommand:rl,UpdateChannelMessageCommand:rd,UpdateChannelReadMarkerCommand:ru};class rh extends nw{}(0,iO.TW)(rc,rh);let rf=async(e,t,...i)=>await e.send(new nJ(t),...i);async function*rp(e,t,...i){let n,r=e.startingToken||void 0,s=!0;for(;s;){if(t.NextToken=r,t.MaxResults=e.pageSize,e.client instanceof nw)n=await rf(e.client,t,...i);else throw Error("Invalid client, expected ChimeSDKMessaging | ChimeSDKMessagingClient");yield n;let o=r;s=!!((r=n.NextToken)&&(!e.stopOnSameToken||r!==o))}}let rm=async(e,t,...i)=>await e.send(new nX(t),...i);async function*rg(e,t,...i){let n,r=e.startingToken||void 0,s=!0;for(;s;){if(t.NextToken=r,t.MaxResults=e.pageSize,e.client instanceof nw)n=await rm(e.client,t,...i);else throw Error("Invalid client, expected ChimeSDKMessaging | ChimeSDKMessagingClient");yield n;let o=r;s=!!((r=n.NextToken)&&(!e.stopOnSameToken||r!==o))}}let rv=async(e,t,...i)=>await e.send(new n1(t),...i);async function*rb(e,t,...i){let n,r=e.startingToken||void 0,s=!0;for(;s;){if(t.NextToken=r,t.MaxResults=e.pageSize,e.client instanceof nw)n=await rv(e.client,t,...i);else throw Error("Invalid client, expected ChimeSDKMessaging | ChimeSDKMessagingClient");yield n;let o=r;s=!!((r=n.NextToken)&&(!e.stopOnSameToken||r!==o))}}let rS=async(e,t,...i)=>await e.send(new n0(t),...i);async function*ry(e,t,...i){let n,r=e.startingToken||void 0,s=!0;for(;s;){if(t.NextToken=r,t.MaxResults=e.pageSize,e.client instanceof nw)n=await rS(e.client,t,...i);else throw Error("Invalid client, expected ChimeSDKMessaging | ChimeSDKMessagingClient");yield n;let o=r;s=!!((r=n.NextToken)&&(!e.stopOnSameToken||r!==o))}}let rw=async(e,t,...i)=>await e.send(new n2(t),...i);async function*rC(e,t,...i){let n,r=e.startingToken||void 0,s=!0;for(;s;){if(t.NextToken=r,t.MaxResults=e.pageSize,e.client instanceof nw)n=await rw(e.client,t,...i);else throw Error("Invalid client, expected ChimeSDKMessaging | ChimeSDKMessagingClient");yield n;let o=r;s=!!((r=n.NextToken)&&(!e.stopOnSameToken||r!==o))}}let r_=async(e,t,...i)=>await e.send(new n3(t),...i);async function*rk(e,t,...i){let n,r=e.startingToken||void 0,s=!0;for(;s;){if(t.NextToken=r,t.MaxResults=e.pageSize,e.client instanceof nw)n=await r_(e.client,t,...i);else throw Error("Invalid client, expected ChimeSDKMessaging | ChimeSDKMessagingClient");yield n;let o=r;s=!!((r=n.NextToken)&&(!e.stopOnSameToken||r!==o))}}let rT=async(e,t,...i)=>await e.send(new n5(t),...i);async function*rP(e,t,...i){let n,r=e.startingToken||void 0,s=!0;for(;s;){if(t.NextToken=r,t.MaxResults=e.pageSize,e.client instanceof nw)n=await rT(e.client,t,...i);else throw Error("Invalid client, expected ChimeSDKMessaging | ChimeSDKMessagingClient");yield n;let o=r;s=!!((r=n.NextToken)&&(!e.stopOnSameToken||r!==o))}}let rE=async(e,t,...i)=>await e.send(new n6(t),...i);async function*rM(e,t,...i){let n,r=e.startingToken||void 0,s=!0;for(;s;){if(t.NextToken=r,t.MaxResults=e.pageSize,e.client instanceof nw)n=await rE(e.client,t,...i);else throw Error("Invalid client, expected ChimeSDKMessaging | ChimeSDKMessagingClient");yield n;let o=r;s=!!((r=n.NextToken)&&(!e.stopOnSameToken||r!==o))}}let rI=async(e,t,...i)=>await e.send(new n4(t),...i);async function*rA(e,t,...i){let n,r=e.startingToken||void 0,s=!0;for(;s;){if(t.NextToken=r,t.MaxResults=e.pageSize,e.client instanceof nw)n=await rI(e.client,t,...i);else throw Error("Invalid client, expected ChimeSDKMessaging | ChimeSDKMessagingClient");yield n;let o=r;s=!!((r=n.NextToken)&&(!e.stopOnSameToken||r!==o))}}let rR=async(e,t,...i)=>await e.send(new n8(t),...i);async function*rx(e,t,...i){let n,r=e.startingToken||void 0,s=!0;for(;s;){if(t.NextToken=r,t.MaxResults=e.pageSize,e.client instanceof nw)n=await rR(e.client,t,...i);else throw Error("Invalid client, expected ChimeSDKMessaging | ChimeSDKMessagingClient");yield n;let o=r;s=!!((r=n.NextToken)&&(!e.stopOnSameToken||r!==o))}}let rO=async(e,t,...i)=>await e.send(new rn(t),...i);async function*rD(e,t,...i){let n,r=e.startingToken||void 0,s=!0;for(;s;){if(t.NextToken=r,t.MaxResults=e.pageSize,e.client instanceof nw)n=await rO(e.client,t,...i);else throw Error("Invalid client, expected ChimeSDKMessaging | ChimeSDKMessagingClient");yield n;let o=r;s=!!((r=n.NextToken)&&(!e.stopOnSameToken||r!==o))}}var rL=i(53951)},53951:function(e,t,i){"use strict";i.d(t,{h:function(){return r}});var n=i(23710);class r extends n.sI{constructor(e){super(e),Object.setPrototypeOf(this,r.prototype)}}},4122:function(e,t,i){"use strict";i.d(t,{$T:function(){return Q},As:function(){return E},CE:function(){return eO},Cc:function(){return ej},Di:function(){return eb},Fz:function(){return es},GW:function(){return er},IA:function(){return L},IP:function(){return R},Iq:function(){return ef},J2:function(){return ez},KF:function(){return ec},L5:function(){return o},LR:function(){return H},Lk:function(){return N},Lt:function(){return eC},M_:function(){return eS},Nd:function(){return G},Nl:function(){return B},Pe:function(){return Z},QG:function(){return eR},Qc:function(){return eM},Ql:function(){return A},S4:function(){return b},SA:function(){return ex},SH:function(){return x},Si:function(){return eH},T:function(){return Y},TQ:function(){return C},TR:function(){return c},Ty:function(){return ep},UH:function(){return z},Uf:function(){return X},Us:function(){return s},V2:function(){return u},VO:function(){return eI},VU:function(){return eK},Vc:function(){return q},Vh:function(){return m},Vq:function(){return e_},X9:function(){return J},XF:function(){return eD},YJ:function(){return j},YQ:function(){return T},Yb:function(){return eo},Z4:function(){return em},Z9:function(){return V},_J:function(){return I},a9:function(){return v},aJ:function(){return eN},bt:function(){return _},cB:function(){return U},ds:function(){return f},gW:function(){return et},h1:function(){return P},hG:function(){return eE},ho:function(){return ev},hz:function(){return e$},iO:function(){return eF},iZ:function(){return en},ie:function(){return p},j0:function(){return g},jK:function(){return a},kU:function(){return eB},kl:function(){return k},lE:function(){return eu},mK:function(){return eh},mW:function(){return ey},mc:function(){return $},no:function(){return d},oF:function(){return O},oW:function(){return ew},on:function(){return eg},pO:function(){return w},q2:function(){return eP},q8:function(){return ea},q9:function(){return h},qI:function(){return D},rF:function(){return el},rX:function(){return K},rm:function(){return eU},rt:function(){return eV},rv:function(){return S},tB:function(){return eT},u4:function(){return M},uU:function(){return ee},ui:function(){return eW},ut:function(){return y},v7:function(){return ek},vD:function(){return ei},vw:function(){return W},w5:function(){return l},wz:function(){return ed},xD:function(){return eL},xS:function(){return F},yP:function(){return eA}});var n=i(23710),r=i(53951);let s={ALL:"ALL",FILTERED:"FILTERED",NONE:"NONE"},o={DEFAULT:"DEFAULT",HIDDEN:"HIDDEN"},a={AccessDenied:"AccessDenied",BadRequest:"BadRequest",Conflict:"Conflict",Forbidden:"Forbidden",NotFound:"NotFound",PhoneNumberAssociationsExist:"PhoneNumberAssociationsExist",PreconditionFailed:"PreconditionFailed",ResourceLimitExceeded:"ResourceLimitExceeded",ServiceFailure:"ServiceFailure",ServiceUnavailable:"ServiceUnavailable",Throttled:"Throttled",Throttling:"Throttling",Unauthorized:"Unauthorized",Unprocessable:"Unprocessable",VoiceConnectorGroupAssociationsExist:"VoiceConnectorGroupAssociationsExist"};class l extends r.h{constructor(e){super({name:"BadRequestException",$fault:"client",...e}),this.name="BadRequestException",this.$fault="client",Object.setPrototypeOf(this,l.prototype),this.Code=e.Code,this.Message=e.Message}}class d extends r.h{constructor(e){super({name:"ConflictException",$fault:"client",...e}),this.name="ConflictException",this.$fault="client",Object.setPrototypeOf(this,d.prototype),this.Code=e.Code,this.Message=e.Message}}class u extends r.h{constructor(e){super({name:"ForbiddenException",$fault:"client",...e}),this.name="ForbiddenException",this.$fault="client",Object.setPrototypeOf(this,u.prototype),this.Code=e.Code,this.Message=e.Message}}class c extends r.h{constructor(e){super({name:"NotFoundException",$fault:"client",...e}),this.name="NotFoundException",this.$fault="client",Object.setPrototypeOf(this,c.prototype),this.Code=e.Code,this.Message=e.Message}}class h extends r.h{constructor(e){super({name:"ServiceFailureException",$fault:"server",...e}),this.name="ServiceFailureException",this.$fault="server",Object.setPrototypeOf(this,h.prototype),this.Code=e.Code,this.Message=e.Message}}class f extends r.h{constructor(e){super({name:"ServiceUnavailableException",$fault:"server",...e}),this.name="ServiceUnavailableException",this.$fault="server",Object.setPrototypeOf(this,f.prototype),this.Code=e.Code,this.Message=e.Message}}class p extends r.h{constructor(e){super({name:"ThrottledClientException",$fault:"client",...e}),this.name="ThrottledClientException",this.$fault="client",Object.setPrototypeOf(this,p.prototype),this.Code=e.Code,this.Message=e.Message}}class m extends r.h{constructor(e){super({name:"UnauthorizedClientException",$fault:"client",...e}),this.name="UnauthorizedClientException",this.$fault="client",Object.setPrototypeOf(this,m.prototype),this.Code=e.Code,this.Message=e.Message}}class g extends r.h{constructor(e){super({name:"ResourceLimitExceededException",$fault:"client",...e}),this.name="ResourceLimitExceededException",this.$fault="client",Object.setPrototypeOf(this,g.prototype),this.Code=e.Code,this.Message=e.Message}}let v={CREATED_TIMESTAMP:"CREATED_TIMESTAMP",LAST_MESSAGE_TIMESTAMP:"LAST_MESSAGE_TIMESTAMP"},b={RESTRICTED:"RESTRICTED",UNRESTRICTED:"UNRESTRICTED"},S={PRIVATE:"PRIVATE",PUBLIC:"PUBLIC"},y={ASYNC:"ASYNC"},w={ABORT:"ABORT",CONTINUE:"CONTINUE"},C={DEFAULT:"DEFAULT",VOIP:"VOIP"},_={NON_PERSISTENT:"NON_PERSISTENT",PERSISTENT:"PERSISTENT"},k={DENIED:"DENIED",FAILED:"FAILED",PENDING:"PENDING",SENT:"SENT"},T={CONTROL:"CONTROL",STANDARD:"STANDARD"},P={Channel:"Channel",ChannelMessage:"ChannelMessage"},E={ASCENDING:"ASCENDING",DESCENDING:"DESCENDING"},M={MEMBERS:"MEMBERS"},I={EQUALS:"EQUALS",INCLUDES:"INCLUDES"},A=e=>({...e,...e.Name&&{Name:n.oc}}),R=e=>({...e,...e.InvitedBy&&{InvitedBy:A(e.InvitedBy)},...e.Members&&{Members:e.Members.map(e=>A(e))}}),x=e=>({...e,...e.BatchChannelMemberships&&{BatchChannelMemberships:R(e.BatchChannelMemberships)}}),O=e=>({...e,...e.Name&&{Name:n.oc},...e.Metadata&&{Metadata:n.oc},...e.CreatedBy&&{CreatedBy:A(e.CreatedBy)}}),D=e=>({...e,...e.Name&&{Name:n.oc},...e.Metadata&&{Metadata:n.oc}}),L=e=>({...e,...e.Member&&{Member:A(e.Member)},...e.CreatedBy&&{CreatedBy:A(e.CreatedBy)}}),F=e=>({...e,...e.Member&&{Member:A(e.Member)}}),B=e=>({...e,...e.Name&&{Name:n.oc}}),N=e=>({...e,...e.Processors&&{Processors:e.Processors.map(e=>B(e))},...e.Name&&{Name:n.oc}}),V=e=>({...e,...e.StringValues&&{StringValues:n.oc}}),U=e=>({...e,...e.Title&&{Title:n.oc},...e.Body&&{Body:n.oc}}),z=e=>({...e,...e.Content&&{Content:n.oc},...e.Metadata&&{Metadata:n.oc},...e.PushNotification&&{PushNotification:U(e.PushNotification)},...e.MessageAttributes&&{MessageAttributes:Object.entries(e.MessageAttributes).reduce((e,[t,i])=>(e[t]=V(i),e),{})},...e.ContentType&&{ContentType:n.oc}}),j=e=>({...e,...e.ChannelMessage&&{ChannelMessage:z(e.ChannelMessage)}}),$=e=>({...e,...e.Name&&{Name:n.oc},...e.Processors&&{Processors:e.Processors.map(e=>B(e))}}),W=e=>({...e,...e.InvitedBy&&{InvitedBy:A(e.InvitedBy)},...e.Member&&{Member:A(e.Member)}}),H=e=>({...e,...e.Name&&{Name:n.oc},...e.Metadata&&{Metadata:n.oc}}),K=e=>({...e,...e.ChannelSummary&&{ChannelSummary:H(e.ChannelSummary)}}),G=e=>({...e,...e.FilterRule&&{FilterRule:n.oc}}),q=e=>({...e,...e.PushNotifications&&{PushNotifications:G(e.PushNotifications)}}),Q=e=>({...e,...e.Member&&{Member:A(e.Member)}}),Z=e=>({...e,...e.Content&&{Content:n.oc},...e.Metadata&&{Metadata:n.oc},...e.Sender&&{Sender:A(e.Sender)},...e.MessageAttributes&&{MessageAttributes:Object.entries(e.MessageAttributes).reduce((e,[t,i])=>(e[t]=V(i),e),{})},...e.ContentType&&{ContentType:n.oc}}),Y=e=>({...e,...e.Content&&{Content:n.oc},...e.Metadata&&{Metadata:n.oc},...e.Sender&&{Sender:A(e.Sender)},...e.MessageAttributes&&{MessageAttributes:Object.entries(e.MessageAttributes).reduce((e,[t,i])=>(e[t]=V(i),e),{})},...e.ContentType&&{ContentType:n.oc}}),J=e=>({...e,...e.ChannelSummary&&{ChannelSummary:H(e.ChannelSummary)}}),X=e=>({...e,...e.Moderator&&{Moderator:A(e.Moderator)},...e.CreatedBy&&{CreatedBy:A(e.CreatedBy)}}),ee=e=>({...e,...e.Moderator&&{Moderator:A(e.Moderator)}}),et=e=>({...e,...e.Key&&{Key:n.oc},...e.Value&&{Value:n.oc}}),ei=e=>({...e,...e.Name&&{Name:n.oc},...e.Metadata&&{Metadata:n.oc},...e.ClientRequestToken&&{ClientRequestToken:n.oc},...e.Tags&&{Tags:e.Tags.map(e=>et(e))},...e.ChannelId&&{ChannelId:n.oc}}),en=e=>({...e,...e.Member&&{Member:A(e.Member)}}),er=e=>({...e,...e.Processors&&{Processors:e.Processors.map(e=>B(e))},...e.Name&&{Name:n.oc},...e.Tags&&{Tags:e.Tags.map(e=>et(e))},...e.ClientRequestToken&&{ClientRequestToken:n.oc}}),es=e=>({...e,...e.Member&&{Member:A(e.Member)}}),eo=e=>({...e,...e.ChannelModerator&&{ChannelModerator:A(e.ChannelModerator)}}),ea=e=>({...e,...e.Channel&&{Channel:O(e.Channel)}}),el=e=>({...e,...e.ChannelBan&&{ChannelBan:L(e.ChannelBan)}}),ed=e=>({...e,...e.ChannelFlow&&{ChannelFlow:N(e.ChannelFlow)}}),eu=e=>({...e,...e.ChannelMembership&&{ChannelMembership:W(e.ChannelMembership)}}),ec=e=>({...e,...e.ChannelMembership&&{ChannelMembership:K(e.ChannelMembership)}}),eh=e=>({...e,...e.Channel&&{Channel:J(e.Channel)}}),ef=e=>({...e,...e.ChannelModerator&&{ChannelModerator:X(e.ChannelModerator)}}),ep=e=>({...e,...e.Member&&{Member:A(e.Member)},...e.Preferences&&{Preferences:q(e.Preferences)}}),em=e=>({...e,...e.ChannelMessage&&{ChannelMessage:Z(e.ChannelMessage)}}),eg=e=>({...e,...e.NextToken&&{NextToken:n.oc}}),ev=e=>({...e,...e.NextToken&&{NextToken:n.oc},...e.ChannelBans&&{ChannelBans:e.ChannelBans.map(e=>F(e))}}),eb=e=>({...e,...e.NextToken&&{NextToken:n.oc}}),eS=e=>({...e,...e.ChannelFlows&&{ChannelFlows:e.ChannelFlows.map(e=>$(e))},...e.NextToken&&{NextToken:n.oc}}),ey=e=>({...e,...e.NextToken&&{NextToken:n.oc}}),ew=e=>({...e,...e.ChannelMemberships&&{ChannelMemberships:e.ChannelMemberships.map(e=>Q(e))},...e.NextToken&&{NextToken:n.oc}}),eC=e=>({...e,...e.NextToken&&{NextToken:n.oc}}),e_=e=>({...e,...e.ChannelMemberships&&{ChannelMemberships:e.ChannelMemberships.map(e=>K(e))},...e.NextToken&&{NextToken:n.oc}}),ek=e=>({...e,...e.NextToken&&{NextToken:n.oc}}),eT=e=>({...e,...e.NextToken&&{NextToken:n.oc},...e.ChannelMessages&&{ChannelMessages:e.ChannelMessages.map(e=>Y(e))}}),eP=e=>({...e,...e.NextToken&&{NextToken:n.oc}}),eE=e=>({...e,...e.NextToken&&{NextToken:n.oc},...e.ChannelModerators&&{ChannelModerators:e.ChannelModerators.map(e=>ee(e))}}),eM=e=>({...e,...e.NextToken&&{NextToken:n.oc}}),eI=e=>({...e,...e.Channels&&{Channels:e.Channels.map(e=>H(e))},...e.NextToken&&{NextToken:n.oc}}),eA=e=>({...e,...e.NextToken&&{NextToken:n.oc}}),eR=e=>({...e,...e.Channels&&{Channels:e.Channels.map(e=>D(e))},...e.NextToken&&{NextToken:n.oc}}),ex=e=>({...e,...e.NextToken&&{NextToken:n.oc}}),eO=e=>({...e,...e.Channels&&{Channels:e.Channels.map(e=>J(e))},...e.NextToken&&{NextToken:n.oc}}),eD=e=>({...e,...e.NextToken&&{NextToken:n.oc}}),eL=e=>({...e,...e.NextToken&&{NextToken:n.oc}}),eF=e=>({...e,...e.Tags&&{Tags:e.Tags.map(e=>et(e))}}),eB=e=>({...e,...e.Preferences&&{Preferences:q(e.Preferences)}}),eN=e=>({...e,...e.Member&&{Member:A(e.Member)},...e.Preferences&&{Preferences:q(e.Preferences)}}),eV=e=>({...e,...e.NextToken&&{NextToken:n.oc}}),eU=e=>({...e,...e.Channels&&{Channels:e.Channels.map(e=>H(e))},...e.NextToken&&{NextToken:n.oc}}),ez=e=>({...e,...e.Content&&{Content:n.oc},...e.Metadata&&{Metadata:n.oc},...e.ClientRequestToken&&{ClientRequestToken:n.oc},...e.PushNotification&&{PushNotification:U(e.PushNotification)},...e.MessageAttributes&&{MessageAttributes:Object.entries(e.MessageAttributes).reduce((e,[t,i])=>(e[t]=V(i),e),{})},...e.ContentType&&{ContentType:n.oc}}),ej=e=>({...e,...e.Tags&&{Tags:e.Tags.map(e=>et(e))}}),e$=e=>({...e,...e.TagKeys&&{TagKeys:n.oc}}),eW=e=>({...e,...e.Name&&{Name:n.oc},...e.Metadata&&{Metadata:n.oc}}),eH=e=>({...e,...e.Processors&&{Processors:e.Processors.map(e=>B(e))},...e.Name&&{Name:n.oc}}),eK=e=>({...e,...e.Content&&{Content:n.oc},...e.Metadata&&{Metadata:n.oc},...e.ContentType&&{ContentType:n.oc}})},45968:function(e,t,i){"use strict";i.d(t,{Z:function(){return c}});var n,r=new Uint8Array(16);function s(){if(!n&&!(n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(r)}for(var o=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,a=function(e){return"string"==typeof e&&o.test(e)},l=[],d=0;d<256;++d)l.push((d+256).toString(16).substr(1));var u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=(l[e[t+0]]+l[e[t+1]]+l[e[t+2]]+l[e[t+3]]+"-"+l[e[t+4]]+l[e[t+5]]+"-"+l[e[t+6]]+l[e[t+7]]+"-"+l[e[t+8]]+l[e[t+9]]+"-"+l[e[t+10]]+l[e[t+11]]+l[e[t+12]]+l[e[t+13]]+l[e[t+14]]+l[e[t+15]]).toLowerCase();if(!a(i))throw TypeError("Stringified UUID is invalid");return i},c=function(e,t,i){var n=(e=e||{}).random||(e.rng||s)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){i=i||0;for(var r=0;r<16;++r)t[i+r]=n[r];return t}return u(n)}},61430:function(e,t,i){"use strict";i.r(t),i.d(t,{fromHex:function(){return s},toHex:function(){return o}});let n={},r={};for(let e=0;e<256;e++){let t=e.toString(16).toLowerCase();1===t.length&&(t=`0${t}`),n[e]=t,r[t]=e}function s(e){if(e.length%2!=0)throw Error("Hex encoded strings must have an even number length");let t=new Uint8Array(e.length/2);for(let i=0;i<e.length;i+=2){let n=e.slice(i,i+2).toLowerCase();if(n in r)t[i/2]=r[n];else throw Error(`Cannot decode unrecognized sequence ${n} as hexadecimal`)}return t}function o(e){let t="";for(let i=0;i<e.byteLength;i++)t+=n[e[i]];return t}},73461:function(e,t,i){"use strict";i.r(t),i.d(t,{locateWindow:function(){return r}});let n={};function r(){return"undefined"!=typeof window?window:"undefined"!=typeof self?self:n}},54306:function(e,t,i){"use strict";i.r(t),i.d(t,{fromUtf8:function(){return a},toUtf8:function(){return l}});let n=e=>{let t=[];for(let i=0,n=e.length;i<n;i++){let n=e.charCodeAt(i);if(n<128)t.push(n);else if(n<2048)t.push(n>>6|192,63&n|128);else if(i+1<e.length&&(64512&n)==55296&&(64512&e.charCodeAt(i+1))==56320){let r=65536+((1023&n)<<10)+(1023&e.charCodeAt(++i));t.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}else t.push(n>>12|224,n>>6&63|128,63&n|128)}return Uint8Array.from(t)},r=e=>{let t="";for(let i=0,n=e.length;i<n;i++){let n=e[i];n<128?t+=String.fromCharCode(n):192<=n&&n<224?t+=String.fromCharCode((31&n)<<6|63&e[++i]):240<=n&&n<365?t+=decodeURIComponent("%"+[n,e[++i],e[++i],e[++i]].map(e=>e.toString(16)).join("%")):t+=String.fromCharCode((15&n)<<12|(63&e[++i])<<6|63&e[++i])}return t};function s(e){return new TextEncoder().encode(e)}function o(e){return new TextDecoder("utf-8").decode(e)}let a=e=>"function"==typeof TextEncoder?s(e):n(e),l=e=>"function"==typeof TextDecoder?o(e):r(e)},59676:function(e,t,i){"use strict";var n,r=i(23963);n={value:!0},t.Z=void 0;var s=r(i(19118)),o=i(57437);t.Z=(0,s.default)((0,o.jsx)("path",{d:"M9 9V3H7v2.59L3.91 2.5 2.5 3.91 5.59 7H3v2zm12 0V7h-2.59l3.09-3.09-1.41-1.41L17 5.59V3h-2v6zM3 15v2h2.59L2.5 20.09l1.41 1.41L7 18.41V21h2v-6zm12 0v6h2v-2.59l3.09 3.09 1.41-1.41L18.41 17H21v-2z"}),"ZoomInMap")},81386:function(e,t,i){"use strict";var n,r=i(23963);n={value:!0},t.Z=void 0;var s=r(i(19118)),o=i(57437);t.Z=(0,s.default)((0,o.jsx)("path",{d:"m15 3 2.3 2.3-2.89 2.87 1.42 1.42L18.7 6.7 21 9V3zM3 9l2.3-2.3 2.87 2.89 1.42-1.42L6.7 5.3 9 3H3zm6 12-2.3-2.3 2.89-2.87-1.42-1.42L5.3 17.3 3 15v6zm12-6-2.3 2.3-2.87-2.89-1.42 1.42 2.89 2.87L15 21h6z"}),"ZoomOutMap")},19118:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return n.createSvgIcon}});var n=i(4966)},42555:function(e,t,i){"use strict";i.d(t,{Z:function(){return k}});var n=i(23950),r=i(22988),s=i(2265),o=i(12272),a=i(88256),l=i(26259),d=i(48024),u=i(95885),c=i(96537),h=i(8550),f=i(40468),p=i(49481),m=i(87542);function g(e){return(0,m.ZP)("MuiLoadingButton",e)}var v=(0,i(34535).Z)("MuiLoadingButton",["root","loading","loadingIndicator","loadingIndicatorCenter","loadingIndicatorStart","loadingIndicatorEnd","endIconLoadingEnd","startIconLoadingStart"]),b=i(57437);let S=["children","disabled","id","loading","loadingIndicator","loadingPosition","variant"],y=e=>{let{loading:t,loadingPosition:i,classes:n}=e,s={root:["root",t&&"loading"],startIcon:[t&&"startIconLoading".concat((0,o.Z)(i))],endIcon:[t&&"endIconLoading".concat((0,o.Z)(i))],loadingIndicator:["loadingIndicator",t&&"loadingIndicator".concat((0,o.Z)(i))]},a=(0,l.Z)(s,g,n);return(0,r.Z)({},n,a)},w=e=>"ownerState"!==e&&"theme"!==e&&"sx"!==e&&"as"!==e&&"classes"!==e,C=(0,d.ZP)(c.Z,{shouldForwardProp:e=>w(e)||"classes"===e,name:"MuiLoadingButton",slot:"Root",overridesResolver:(e,t)=>[t.root,t.startIconLoadingStart&&{["& .".concat(v.startIconLoadingStart)]:t.startIconLoadingStart},t.endIconLoadingEnd&&{["& .".concat(v.endIconLoadingEnd)]:t.endIconLoadingEnd}]})(e=>{let{ownerState:t,theme:i}=e;return(0,r.Z)({["& .".concat(v.startIconLoadingStart,", & .").concat(v.endIconLoadingEnd)]:{transition:i.transitions.create(["opacity"],{duration:i.transitions.duration.short}),opacity:0}},"center"===t.loadingPosition&&{transition:i.transitions.create(["background-color","box-shadow","border-color"],{duration:i.transitions.duration.short}),["&.".concat(v.loading)]:{color:"transparent"}},"start"===t.loadingPosition&&t.fullWidth&&{["& .".concat(v.startIconLoadingStart,", & .").concat(v.endIconLoadingEnd)]:{transition:i.transitions.create(["opacity"],{duration:i.transitions.duration.short}),opacity:0,marginRight:-8}},"end"===t.loadingPosition&&t.fullWidth&&{["& .".concat(v.startIconLoadingStart,", & .").concat(v.endIconLoadingEnd)]:{transition:i.transitions.create(["opacity"],{duration:i.transitions.duration.short}),opacity:0,marginLeft:-8}})}),_=(0,d.ZP)("span",{name:"MuiLoadingButton",slot:"LoadingIndicator",overridesResolver:(e,t)=>{let{ownerState:i}=e;return[t.loadingIndicator,t["loadingIndicator".concat((0,o.Z)(i.loadingPosition))]]}})(e=>{let{theme:t,ownerState:i}=e;return(0,r.Z)({position:"absolute",visibility:"visible",display:"flex"},"start"===i.loadingPosition&&("outlined"===i.variant||"contained"===i.variant)&&{left:"small"===i.size?10:14},"start"===i.loadingPosition&&"text"===i.variant&&{left:6},"center"===i.loadingPosition&&{left:"50%",transform:"translate(-50%)",color:(t.vars||t).palette.action.disabled},"end"===i.loadingPosition&&("outlined"===i.variant||"contained"===i.variant)&&{right:"small"===i.size?10:14},"end"===i.loadingPosition&&"text"===i.variant&&{right:6},"start"===i.loadingPosition&&i.fullWidth&&{position:"relative",left:-10},"end"===i.loadingPosition&&i.fullWidth&&{position:"relative",right:-10})});var k=s.forwardRef(function(e,t){let i=s.useContext(h.Z),o=(0,p.Z)(i,e),l=(0,u.i)({props:o,name:"MuiLoadingButton"}),{children:d,disabled:c=!1,id:m,loading:g=!1,loadingIndicator:v,loadingPosition:w="center",variant:k="text"}=l,T=(0,n.Z)(l,S),P=(0,a.Z)(m),E=null!=v?v:(0,b.jsx)(f.Z,{"aria-labelledby":P,color:"inherit",size:16}),M=(0,r.Z)({},l,{disabled:c,loading:g,loadingIndicator:E,loadingPosition:w,variant:k}),I=y(M),A=g?(0,b.jsx)(_,{className:I.loadingIndicator,ownerState:M,children:E}):null;return(0,b.jsxs)(C,(0,r.Z)({disabled:c||g,id:P,ref:t},T,{variant:k,classes:I,ownerState:M,children:["end"===M.loadingPosition?d:A,"end"===M.loadingPosition?A:d]}))})},31193:function(e,t,i){"use strict";i.d(t,{Z:function(){return d}});var n=i(20732),r=i(35960),s=i(74050),o=i(52737),a=(0,i(34535).Z)("MuiBox",["root"]);let l=(0,s.Z)();var d=(0,n.Z)({themeId:o.Z,defaultTheme:l,defaultClassName:a.root,generateClassName:r.Z.generate})},58433:function(e,t,i){"use strict";i.d(t,{ZP:function(){return D}});var n=i(23950),r=i(22988),s=i(2265),o=i(44839),a=i(11939),l=i(40261),d=i(26259),u=i(48024),c=i(95885),h=i(22960),f=s.createContext(),p=i(34535),m=i(87542);function g(e){return(0,m.ZP)("MuiGrid",e)}let v=[0,1,2,3,4,5,6,7,8,9,10],b=["column-reverse","column","row-reverse","row"],S=["nowrap","wrap-reverse","wrap"],y=["auto",!0,1,2,3,4,5,6,7,8,9,10,11,12];var w=(0,p.Z)("MuiGrid",["root","container","item","zeroMinWidth",...v.map(e=>"spacing-xs-".concat(e)),...b.map(e=>"direction-xs-".concat(e)),...S.map(e=>"wrap-xs-".concat(e)),...y.map(e=>"grid-xs-".concat(e)),...y.map(e=>"grid-sm-".concat(e)),...y.map(e=>"grid-md-".concat(e)),...y.map(e=>"grid-lg-".concat(e)),...y.map(e=>"grid-xl-".concat(e))]),C=i(57437);let _=["className","columns","columnSpacing","component","container","direction","item","rowSpacing","spacing","wrap","zeroMinWidth"];function k(e){let t=parseFloat(e);return"".concat(t).concat(String(e).replace(String(t),"")||"px")}function T(e){let t,{theme:i,ownerState:n}=e;return i.breakpoints.keys.reduce((e,s)=>{let o={};if(n[s]&&(t=n[s]),!t)return e;if(!0===t)o={flexBasis:0,flexGrow:1,maxWidth:"100%"};else if("auto"===t)o={flexBasis:"auto",flexGrow:0,flexShrink:0,maxWidth:"none",width:"auto"};else{let l=(0,a.P$)({values:n.columns,breakpoints:i.breakpoints.values}),d="object"==typeof l?l[s]:l;if(null==d)return e;let u="".concat(Math.round(t/d*1e8)/1e6,"%"),c={};if(n.container&&n.item&&0!==n.columnSpacing){let e=i.spacing(n.columnSpacing);if("0px"!==e){let t="calc(".concat(u," + ").concat(k(e),")");c={flexBasis:t,maxWidth:t}}}o=(0,r.Z)({flexBasis:u,flexGrow:0,maxWidth:u},c)}return 0===i.breakpoints.values[s]?Object.assign(e,o):e[i.breakpoints.up(s)]=o,e},{})}function P(e){let{theme:t,ownerState:i}=e,n=(0,a.P$)({values:i.direction,breakpoints:t.breakpoints.values});return(0,a.k9)({theme:t},n,e=>{let t={flexDirection:e};return 0===e.indexOf("column")&&(t["& > .".concat(w.item)]={maxWidth:"none"}),t})}function E(e){let{breakpoints:t,values:i}=e,n="";Object.keys(i).forEach(e=>{""===n&&0!==i[e]&&(n=e)});let r=Object.keys(t).sort((e,i)=>t[e]-t[i]);return r.slice(0,r.indexOf(n))}function M(e){let{theme:t,ownerState:i}=e,{container:n,rowSpacing:r}=i,s={};if(n&&0!==r){let e;let i=(0,a.P$)({values:r,breakpoints:t.breakpoints.values});"object"==typeof i&&(e=E({breakpoints:t.breakpoints.values,values:i})),s=(0,a.k9)({theme:t},i,(i,n)=>{var r;let s=t.spacing(i);return"0px"!==s?{marginTop:"-".concat(k(s)),["& > .".concat(w.item)]:{paddingTop:k(s)}}:null!=(r=e)&&r.includes(n)?{}:{marginTop:0,["& > .".concat(w.item)]:{paddingTop:0}}})}return s}function I(e){let{theme:t,ownerState:i}=e,{container:n,columnSpacing:r}=i,s={};if(n&&0!==r){let e;let i=(0,a.P$)({values:r,breakpoints:t.breakpoints.values});"object"==typeof i&&(e=E({breakpoints:t.breakpoints.values,values:i})),s=(0,a.k9)({theme:t},i,(i,n)=>{var r;let s=t.spacing(i);return"0px"!==s?{width:"calc(100% + ".concat(k(s),")"),marginLeft:"-".concat(k(s)),["& > .".concat(w.item)]:{paddingLeft:k(s)}}:null!=(r=e)&&r.includes(n)?{}:{width:"100%",marginLeft:0,["& > .".concat(w.item)]:{paddingLeft:0}}})}return s}function A(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e||e<=0)return[];if("string"==typeof e&&!Number.isNaN(Number(e))||"number"==typeof e)return[i["spacing-xs-".concat(String(e))]];let n=[];return t.forEach(t=>{let r=e[t];Number(r)>0&&n.push(i["spacing-".concat(t,"-").concat(String(r))])}),n}let R=(0,u.ZP)("div",{name:"MuiGrid",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:i}=e,{container:n,direction:r,item:s,spacing:o,wrap:a,zeroMinWidth:l,breakpoints:d}=i,u=[];n&&(u=A(o,d,t));let c=[];return d.forEach(e=>{let n=i[e];n&&c.push(t["grid-".concat(e,"-").concat(String(n))])}),[t.root,n&&t.container,s&&t.item,l&&t.zeroMinWidth,...u,"row"!==r&&t["direction-xs-".concat(String(r))],"wrap"!==a&&t["wrap-xs-".concat(String(a))],...c]}})(e=>{let{ownerState:t}=e;return(0,r.Z)({boxSizing:"border-box"},t.container&&{display:"flex",flexWrap:"wrap",width:"100%"},t.item&&{margin:0},t.zeroMinWidth&&{minWidth:0},"wrap"!==t.wrap&&{flexWrap:t.wrap})},P,M,I,T);function x(e,t){if(!e||e<=0)return[];if("string"==typeof e&&!Number.isNaN(Number(e))||"number"==typeof e)return["spacing-xs-".concat(String(e))];let i=[];return t.forEach(t=>{let n=e[t];if(Number(n)>0){let e="spacing-".concat(t,"-").concat(String(n));i.push(e)}}),i}let O=e=>{let{classes:t,container:i,direction:n,item:r,spacing:s,wrap:o,zeroMinWidth:a,breakpoints:l}=e,u=[];i&&(u=x(s,l));let c=[];l.forEach(t=>{let i=e[t];i&&c.push("grid-".concat(t,"-").concat(String(i)))});let h={root:["root",i&&"container",r&&"item",a&&"zeroMinWidth",...u,"row"!==n&&"direction-xs-".concat(String(n)),"wrap"!==o&&"wrap-xs-".concat(String(o)),...c]};return(0,d.Z)(h,g,t)};var D=s.forwardRef(function(e,t){let i=(0,c.i)({props:e,name:"MuiGrid"}),{breakpoints:a}=(0,h.Z)(),d=(0,l.Z)(i),{className:u,columns:p,columnSpacing:m,component:g="div",container:v=!1,direction:b="row",item:S=!1,rowSpacing:y,spacing:w=0,wrap:k="wrap",zeroMinWidth:T=!1}=d,P=(0,n.Z)(d,_),E=y||w,M=m||w,I=s.useContext(f),A=v?p||12:I,x={},D=(0,r.Z)({},P);a.keys.forEach(e=>{null!=P[e]&&(x[e]=P[e],delete D[e])});let L=(0,r.Z)({},d,{columns:A,container:v,direction:b,item:S,rowSpacing:E,columnSpacing:M,wrap:k,zeroMinWidth:T,spacing:w},x,{breakpoints:a.keys}),F=O(L);return(0,C.jsx)(f.Provider,{value:A,children:(0,C.jsx)(R,(0,r.Z)({ownerState:L,className:(0,o.Z)(F.root,u),as:g,ref:t},D))})})},4966:function(e,t,i){"use strict";i.r(t),i.d(t,{capitalize:function(){return r.Z},createChainedFunction:function(){return s},createSvgIcon:function(){return o.Z},debounce:function(){return a.Z},deprecatedPropType:function(){return l},isMuiElement:function(){return d.Z},ownerDocument:function(){return u.Z},ownerWindow:function(){return c.Z},requirePropFactory:function(){return h},setRef:function(){return f},unstable_ClassNameGenerator:function(){return w},unstable_useEnhancedEffect:function(){return p.Z},unstable_useId:function(){return m.Z},unsupportedProp:function(){return g},useControlled:function(){return v.Z},useEventCallback:function(){return b.Z},useForkRef:function(){return S.Z},useIsFocusVisible:function(){return y.Z}});var n=i(35960),r=i(12272),s=i(24559).Z,o=i(9528),a=i(70576),l=function(e,t){return()=>null},d=i(99633),u=i(8754),c=i(88095);i(22988);var h=function(e,t){return()=>null},f=i(99969).Z,p=i(48632),m=i(88256),g=function(e,t,i,n,r){return null},v=i(75115),b=i(26182),S=i(60909),y=i(86850);let w={configure:e=>{n.Z.configure(e)}}},33351:function(e,t,i){"use strict";i.d(t,{Z:function(){return o}});var n=i(35960),r=i(20732),s=(0,i(34535).Z)("MuiBox",["root"]),o=(0,r.Z)({defaultClassName:s.root,generateClassName:n.Z.generate})},20732:function(e,t,i){"use strict";i.d(t,{Z:function(){return f}});var n=i(22988),r=i(23950),s=i(2265),o=i(44839),a=i(51828),l=i(47267),d=i(40261),u=i(14874),c=i(57437);let h=["className","component"];function f(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{themeId:t,defaultTheme:i,defaultClassName:f="MuiBox-root",generateClassName:p}=e,m=(0,a.default)("div",{shouldForwardProp:e=>"theme"!==e&&"sx"!==e&&"as"!==e})(l.Z);return s.forwardRef(function(e,s){let a=(0,u.Z)(i),l=(0,d.Z)(e),{className:g,component:v="div"}=l,b=(0,r.Z)(l,h);return(0,c.jsx)(m,(0,n.Z)({as:v,ref:s,className:(0,o.Z)(g,p?p(f):f),theme:t&&a[t]||a},b))})}},69059:function(e){"use strict";function t(e,t){for(var i=Array(arguments.length-1),n=0,r=2,s=!0;r<arguments.length;)i[n++]=arguments[r++];return new Promise(function(r,o){i[n]=function(e){if(s){if(s=!1,e)o(e);else{for(var t=Array(arguments.length-1),i=0;i<t.length;)t[i++]=arguments[i];r.apply(null,t)}}};try{e.apply(t||null,i)}catch(e){s&&(s=!1,o(e))}})}e.exports=t},95920:function(e,t){"use strict";var i=t;i.length=function(e){var t=e.length;if(!t)return 0;for(var i=0;--t%4>1&&"="===e.charAt(t);)++i;return Math.ceil(3*e.length)/4-i};for(var n=Array(64),r=Array(123),s=0;s<64;)r[n[s]=s<26?s+65:s<52?s+71:s<62?s-4:s-59|43]=s++;i.encode=function(e,t,i){for(var r,s=null,o=[],a=0,l=0;t<i;){var d=e[t++];switch(l){case 0:o[a++]=n[d>>2],r=(3&d)<<4,l=1;break;case 1:o[a++]=n[r|d>>4],r=(15&d)<<2,l=2;break;case 2:o[a++]=n[r|d>>6],o[a++]=n[63&d],l=0}a>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,o)),a=0)}return(l&&(o[a++]=n[r],o[a++]=61,1===l&&(o[a++]=61)),s)?(a&&s.push(String.fromCharCode.apply(String,o.slice(0,a))),s.join("")):String.fromCharCode.apply(String,o.slice(0,a))};var o="invalid encoding";i.decode=function(e,t,i){for(var n,s=i,a=0,l=0;l<e.length;){var d=e.charCodeAt(l++);if(61===d&&a>1)break;if(void 0===(d=r[d]))throw Error(o);switch(a){case 0:n=d,a=1;break;case 1:t[i++]=n<<2|(48&d)>>4,n=d,a=2;break;case 2:t[i++]=(15&n)<<4|(60&d)>>2,n=d,a=3;break;case 3:t[i++]=(3&n)<<6|d,a=0}}if(1===a)throw Error(o);return i-s},i.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}},95986:function(e){"use strict";function t(){this._listeners={}}e.exports=t,t.prototype.on=function(e,t,i){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:i||this}),this},t.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var i=this._listeners[e],n=0;n<i.length;)i[n].fn===t?i.splice(n,1):++n;return this},t.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var i=[],n=1;n<arguments.length;)i.push(arguments[n++]);for(n=0;n<t.length;)t[n].fn.apply(t[n++].ctx,i)}return this}},46958:function(e){"use strict";function t(e){return"undefined"!=typeof Float32Array?function(){var t=new Float32Array([-0]),i=new Uint8Array(t.buffer),n=128===i[3];function r(e,n,r){t[0]=e,n[r]=i[0],n[r+1]=i[1],n[r+2]=i[2],n[r+3]=i[3]}function s(e,n,r){t[0]=e,n[r]=i[3],n[r+1]=i[2],n[r+2]=i[1],n[r+3]=i[0]}function o(e,n){return i[0]=e[n],i[1]=e[n+1],i[2]=e[n+2],i[3]=e[n+3],t[0]}function a(e,n){return i[3]=e[n],i[2]=e[n+1],i[1]=e[n+2],i[0]=e[n+3],t[0]}e.writeFloatLE=n?r:s,e.writeFloatBE=n?s:r,e.readFloatLE=n?o:a,e.readFloatBE=n?a:o}():function(){function t(e,t,i,n){var r=t<0?1:0;if(r&&(t=-t),0===t)e(1/t>0?0:2147483648,i,n);else if(isNaN(t))e(2143289344,i,n);else if(t>34028234663852886e22)e((r<<31|2139095040)>>>0,i,n);else if(t<11754943508222875e-54)e((r<<31|Math.round(t/1401298464324817e-60))>>>0,i,n);else{var s=Math.floor(Math.log(t)/Math.LN2),o=8388607&Math.round(t*Math.pow(2,-s)*8388608);e((r<<31|s+127<<23|o)>>>0,i,n)}}function o(e,t,i){var n=e(t,i),r=(n>>31)*2+1,s=n>>>23&255,o=8388607&n;return 255===s?o?NaN:1/0*r:0===s?1401298464324817e-60*r*o:r*Math.pow(2,s-150)*(o+8388608)}e.writeFloatLE=t.bind(null,i),e.writeFloatBE=t.bind(null,n),e.readFloatLE=o.bind(null,r),e.readFloatBE=o.bind(null,s)}(),"undefined"!=typeof Float64Array?function(){var t=new Float64Array([-0]),i=new Uint8Array(t.buffer),n=128===i[7];function r(e,n,r){t[0]=e,n[r]=i[0],n[r+1]=i[1],n[r+2]=i[2],n[r+3]=i[3],n[r+4]=i[4],n[r+5]=i[5],n[r+6]=i[6],n[r+7]=i[7]}function s(e,n,r){t[0]=e,n[r]=i[7],n[r+1]=i[6],n[r+2]=i[5],n[r+3]=i[4],n[r+4]=i[3],n[r+5]=i[2],n[r+6]=i[1],n[r+7]=i[0]}function o(e,n){return i[0]=e[n],i[1]=e[n+1],i[2]=e[n+2],i[3]=e[n+3],i[4]=e[n+4],i[5]=e[n+5],i[6]=e[n+6],i[7]=e[n+7],t[0]}function a(e,n){return i[7]=e[n],i[6]=e[n+1],i[5]=e[n+2],i[4]=e[n+3],i[3]=e[n+4],i[2]=e[n+5],i[1]=e[n+6],i[0]=e[n+7],t[0]}e.writeDoubleLE=n?r:s,e.writeDoubleBE=n?s:r,e.readDoubleLE=n?o:a,e.readDoubleBE=n?a:o}():function(){function t(e,t,i,n,r,s){var o,a=n<0?1:0;if(a&&(n=-n),0===n)e(0,r,s+t),e(1/n>0?0:2147483648,r,s+i);else if(isNaN(n))e(0,r,s+t),e(2146959360,r,s+i);else if(n>17976931348623157e292)e(0,r,s+t),e((a<<31|2146435072)>>>0,r,s+i);else if(n<22250738585072014e-324)e((o=n/5e-324)>>>0,r,s+t),e((a<<31|o/4294967296)>>>0,r,s+i);else{var l=Math.floor(Math.log(n)/Math.LN2);1024===l&&(l=1023),e(4503599627370496*(o=n*Math.pow(2,-l))>>>0,r,s+t),e((a<<31|l+1023<<20|1048576*o&1048575)>>>0,r,s+i)}}function o(e,t,i,n,r){var s=e(n,r+t),o=e(n,r+i),a=(o>>31)*2+1,l=o>>>20&2047,d=4294967296*(1048575&o)+s;return 2047===l?d?NaN:1/0*a:0===l?5e-324*a*d:a*Math.pow(2,l-1075)*(d+4503599627370496)}e.writeDoubleLE=t.bind(null,i,0,4),e.writeDoubleBE=t.bind(null,n,4,0),e.readDoubleLE=o.bind(null,r,0,4),e.readDoubleBE=o.bind(null,s,4,0)}(),e}function i(e,t,i){t[i]=255&e,t[i+1]=e>>>8&255,t[i+2]=e>>>16&255,t[i+3]=e>>>24}function n(e,t,i){t[i]=e>>>24,t[i+1]=e>>>16&255,t[i+2]=e>>>8&255,t[i+3]=255&e}function r(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function s(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}e.exports=t(t)},37079:function(module){"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},77587:function(e){"use strict";function t(e,t,i){var n=i||8192,r=n>>>1,s=null,o=n;return function(i){if(i<1||i>r)return e(i);o+i>n&&(s=e(n),o=0);var a=t.call(s,o,o+=i);return 7&o&&(o=(7|o)+1),a}}e.exports=t},30783:function(e,t){"use strict";var i=t;i.length=function(e){for(var t=0,i=0,n=0;n<e.length;++n)(i=e.charCodeAt(n))<128?t+=1:i<2048?t+=2:(64512&i)==55296&&(64512&e.charCodeAt(n+1))==56320?(++n,t+=4):t+=3;return t},i.read=function(e,t,i){if(i-t<1)return"";for(var n,r=null,s=[],o=0;t<i;)(n=e[t++])<128?s[o++]=n:n>191&&n<224?s[o++]=(31&n)<<6|63&e[t++]:n>239&&n<365?(n=((7&n)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,s[o++]=55296+(n>>10),s[o++]=56320+(1023&n)):s[o++]=(15&n)<<12|(63&e[t++])<<6|63&e[t++],o>8191&&((r||(r=[])).push(String.fromCharCode.apply(String,s)),o=0);return r?(o&&r.push(String.fromCharCode.apply(String,s.slice(0,o))),r.join("")):String.fromCharCode.apply(String,s.slice(0,o))},i.write=function(e,t,i){for(var n,r,s=i,o=0;o<e.length;++o)(n=e.charCodeAt(o))<128?t[i++]=n:(n<2048?t[i++]=n>>6|192:((64512&n)==55296&&(64512&(r=e.charCodeAt(o+1)))==56320?(n=65536+((1023&n)<<10)+(1023&r),++o,t[i++]=n>>18|240,t[i++]=n>>12&63|128):t[i++]=n>>12|224,t[i++]=n>>6&63|128),t[i++]=63&n|128);return i-s}},14247:function(e,t,i){"use strict";i.d(t,{BX:function(){return l},CF:function(){return u}});var n=i(96108),r=i(13587);function s(e){let t=[];for(let i of Object.keys(e).sort()){let n=e[i];if(i=(0,r.i)(i),Array.isArray(n))for(let e=0,s=n.length;e<s;e++)t.push(`${i}=${(0,r.i)(n[e])}`);else{let e=i;(n||"string"==typeof n)&&(e+=`=${(0,r.i)(n)}`),t.push(e)}}return t.join("&")}function o(e=0){return new Promise((t,i)=>{e&&setTimeout(()=>{let t=Error(`Request did not complete within ${e} ms`);t.name="TimeoutError",i(t)},e)})}let a={supported:!!("undefined"!=typeof Request&&"keepalive"in new Request("https://[::1]"))};class l{static create(e){return"function"==typeof e?.handle?e:new l(e)}constructor(e){"function"==typeof e?this.configProvider=e().then(e=>e||{}):(this.config=e??{},this.configProvider=Promise.resolve(this.config))}destroy(){}async handle(e,{abortSignal:t}={}){this.config||(this.config=await this.configProvider);let i=this.config.requestTimeout,r=!0===this.config.keepAlive;if(t?.aborted){let e=Error("Request aborted");return e.name="AbortError",Promise.reject(e)}let l=e.path,d=s(e.query||{});d&&(l+=`?${d}`),e.fragment&&(l+=`#${e.fragment}`);let u="";if(null!=e.username||null!=e.password){let t=e.username??"",i=e.password??"";u=`${t}:${i}@`}let{port:c,method:h}=e,f=`${e.protocol}//${u}${e.hostname}${c?`:${c}`:""}${l}`,p={body:"GET"===h||"HEAD"===h?void 0:e.body,headers:new Headers(e.headers),method:h};"undefined"!=typeof AbortController&&(p.signal=t),a.supported&&(p.keepalive=r);let m=[fetch(new Request(f,p)).then(e=>{let t=e.headers,i={};for(let e of t.entries())i[e[0]]=e[1];return void 0!=e.body?{response:new n.Zn({headers:i,reason:e.statusText,statusCode:e.status,body:e.body})}:e.blob().then(t=>({response:new n.Zn({headers:i,reason:e.statusText,statusCode:e.status,body:t})}))}),o(i)];return t&&m.push(new Promise((e,i)=>{t.onabort=()=>{let e=Error("Request aborted");e.name="AbortError",i(e)}})),Promise.race(m)}updateHttpClientConfig(e,t){this.config=void 0,this.configProvider=this.configProvider.then(i=>(i[e]=t,i))}httpHandlerConfigs(){return this.config??{}}}var d=i(80880);let u=e=>"function"==typeof Blob&&e instanceof Blob?c(e):h(e);async function c(e){let t=await f(e);return new Uint8Array((0,d.G)(t))}async function h(e){let t=new Uint8Array(0),i=e.getReader(),n=!1;for(;!n;){let{done:e,value:r}=await i.read();if(r){let e=t;(t=new Uint8Array(e.length+r.length)).set(e),t.set(r,e.length)}n=e}return t}function f(e){return new Promise((t,i)=>{let n=new FileReader;n.onloadend=()=>{if(2!==n.readyState)return i(Error("Reader aborted too early"));let e=n.result??"",r=e.indexOf(","),s=r>-1?r+1:e.length;t(e.substring(s))},n.onabort=()=>i(Error("Read aborted")),n.onerror=()=>i(n.error),n.readAsDataURL(e)})}},96108:function(e,t,i){"use strict";i.d(t,{aW:function(){return s},Zn:function(){return a},cA:function(){return n},AO:function(){return r}});let n=e=>{let t=e.httpHandler;return{setHttpHandler(e){t=e},httpHandler:()=>t,updateHttpClientConfig(e,i){t.updateHttpClientConfig(e,i)},httpHandlerConfigs:()=>t.httpHandlerConfigs()}},r=e=>({httpHandler:e.httpHandler()});i(30349);class s{constructor(e){this.method=e.method||"GET",this.hostname=e.hostname||"localhost",this.port=e.port,this.query=e.query||{},this.headers=e.headers||{},this.body=e.body,this.protocol=e.protocol?":"!==e.protocol.slice(-1)?`${e.protocol}:`:e.protocol:"https:",this.path=e.path?"/"!==e.path.charAt(0)?`/${e.path}`:e.path:"/",this.username=e.username,this.password=e.password,this.fragment=e.fragment}static isInstance(e){if(!e)return!1;let t=e;return"method"in t&&"protocol"in t&&"hostname"in t&&"path"in t&&"object"==typeof t.query&&"object"==typeof t.headers}clone(){let e=new s({...this,headers:{...this.headers}});return e.query&&(e.query=o(e.query)),e}}function o(e){return Object.keys(e).reduce((t,i)=>{let n=e[i];return{...t,[i]:Array.isArray(n)?[...n]:n}},{})}class a{constructor(e){this.statusCode=e.statusCode,this.reason=e.reason,this.headers=e.headers||{},this.body=e.body}static isInstance(e){if(!e)return!1;let t=e;return"number"==typeof t.statusCode&&"object"==typeof t.headers}}},23710:function(e,t,i){"use strict";i.d(t,{KU:function(){return d},mY:function(){return S},vk:function(){return n},oc:function(){return y},sI:function(){return O},F3:function(){return et},Wg:function(){return b},TW:function(){return w},to:function(){return D},zE:function(){return C},CE:function(){return k},Fx:function(){return _},Wh:function(){return T},pY:function(){return P},kE:function(){return W},jv:function(){return N},UI:function(){return G},KX:function(){return x},SQ:function(){return H},Is:function(){return ee},qn:function(){return q},PC:function(){return F}});class n{trace(){}debug(){}info(){}warn(){}error(){}}let r=(e,t)=>{let i=[];if(e&&i.push(e),t)for(let e of t)i.push(e);return i},s=(e,t)=>`${e||"anonymous"}${t&&t.length>0?` (a.k.a. ${t.join(",")})`:""}`,o=()=>{let e=[],t=[],i=!1,n=new Set,d=e=>e.sort((e,t)=>a[t.step]-a[e.step]||l[t.priority||"normal"]-l[e.priority||"normal"]),u=i=>{let s=!1,o=e=>{let t=r(e.name,e.aliases);if(t.includes(i)){for(let e of(s=!0,t))n.delete(e);return!1}return!0};return e=e.filter(o),t=t.filter(o),s},c=i=>{let s=!1,o=e=>{if(e.middleware===i){for(let t of(s=!0,r(e.name,e.aliases)))n.delete(t);return!1}return!0};return e=e.filter(o),t=t.filter(o),s},h=i=>(e.forEach(e=>{i.add(e.middleware,{...e})}),t.forEach(e=>{i.addRelativeTo(e.middleware,{...e})}),i.identifyOnResolve?.(m.identifyOnResolve()),i),f=e=>{let t=[];return e.before.forEach(e=>{0===e.before.length&&0===e.after.length?t.push(e):t.push(...f(e))}),t.push(e),e.after.reverse().forEach(e=>{0===e.before.length&&0===e.after.length?t.push(e):t.push(...f(e))}),t},p=(i=!1)=>{let n=[],o=[],a={};return e.forEach(e=>{let t={...e,before:[],after:[]};for(let e of r(t.name,t.aliases))a[e]=t;n.push(t)}),t.forEach(e=>{let t={...e,before:[],after:[]};for(let e of r(t.name,t.aliases))a[e]=t;o.push(t)}),o.forEach(e=>{if(e.toMiddleware){let t=a[e.toMiddleware];if(void 0===t){if(i)return;throw Error(`${e.toMiddleware} is not found when adding ${s(e.name,e.aliases)} middleware ${e.relation} ${e.toMiddleware}`)}"after"===e.relation&&t.after.push(e),"before"===e.relation&&t.before.push(e)}}),d(n).map(f).reduce((e,t)=>(e.push(...t),e),[])},m={add:(t,i={})=>{let{name:o,override:a,aliases:l}=i,d={step:"initialize",priority:"normal",middleware:t,...i},u=r(o,l);if(u.length>0){if(u.some(e=>n.has(e))){if(!a)throw Error(`Duplicate middleware name '${s(o,l)}'`);for(let t of u){let i=e.findIndex(e=>e.name===t||e.aliases?.some(e=>e===t));if(-1===i)continue;let n=e[i];if(n.step!==d.step||d.priority!==n.priority)throw Error(`"${s(n.name,n.aliases)}" middleware with ${n.priority} priority in ${n.step} step cannot be overridden by "${s(o,l)}" middleware with ${d.priority} priority in ${d.step} step.`);e.splice(i,1)}}for(let e of u)n.add(e)}e.push(d)},addRelativeTo:(e,i)=>{let{name:o,override:a,aliases:l}=i,d={middleware:e,...i},u=r(o,l);if(u.length>0){if(u.some(e=>n.has(e))){if(!a)throw Error(`Duplicate middleware name '${s(o,l)}'`);for(let e of u){let i=t.findIndex(t=>t.name===e||t.aliases?.some(t=>t===e));if(-1===i)continue;let n=t[i];if(n.toMiddleware!==d.toMiddleware||n.relation!==d.relation)throw Error(`"${s(n.name,n.aliases)}" middleware ${n.relation} "${n.toMiddleware}" middleware cannot be overridden by "${s(o,l)}" middleware ${d.relation} "${d.toMiddleware}" middleware.`);t.splice(i,1)}}for(let e of u)n.add(e)}t.push(d)},clone:()=>h(o()),use:e=>{e.applyToStack(m)},remove:e=>"string"==typeof e?u(e):c(e),removeByTag:i=>{let s=!1,o=e=>{let{tags:t,name:o,aliases:a}=e;if(t&&t.includes(i)){for(let e of r(o,a))n.delete(e);return s=!0,!1}return!0};return e=e.filter(o),t=t.filter(o),s},concat:e=>{let t=h(o());return t.use(e),t.identifyOnResolve(i||t.identifyOnResolve()||(e.identifyOnResolve?.()??!1)),t},applyToStack:h,identify:()=>p(!0).map(e=>{let t=e.step??e.relation+" "+e.toMiddleware;return s(e.name,e.aliases)+" - "+t}),identifyOnResolve:e=>("boolean"==typeof e&&(i=e),i),resolve:(e,t)=>{for(let i of p().map(e=>e.middleware).reverse())e=i(e,t);return i&&console.log(m.identify()),e}};return m},a={initialize:5,serialize:4,build:3,finalizeRequest:2,deserialize:1},l={high:3,normal:2,low:1};class d{constructor(e){this.middlewareStack=o(),this.config=e}send(e,t,i){let n="function"!=typeof t?t:void 0,r="function"==typeof t?t:i,s=e.resolveMiddleware(this.middlewareStack,this.config,n);if(!r)return s(e).then(e=>e.output);s(e).then(e=>r(null,e.output),e=>r(e)).catch(()=>{})}destroy(){this.config.requestHandler.destroy&&this.config.requestHandler.destroy()}}var u=i(80880),c=i(10637),h=i(80102);function f(e,t="utf-8"){return"base64"===t?(0,u.s)(e):(0,c.G)(e)}function p(e,t){return"base64"===t?m.mutate((0,u.G)(e)):m.mutate((0,h.$)(e))}class m extends Uint8Array{static fromString(e,t="utf-8"){if("string"==typeof e)return p(e,t);throw Error(`Unsupported conversion from ${typeof e} to Uint8ArrayBlobAdapter.`)}static mutate(e){return Object.setPrototypeOf(e,m.prototype),e}transformToString(e="utf-8"){return f(this,e)}}i(14247);let g={},v={};for(let e=0;e<256;e++){let t=e.toString(16).toLowerCase();1===t.length&&(t=`0${t}`),g[e]=t,v[t]=e}let b=async(e=new Uint8Array,t)=>{if(e instanceof Uint8Array)return m.mutate(e);if(!e)return m.mutate(new Uint8Array);let i=t.streamCollector(e);return m.mutate(await i)};class S{constructor(){this.middlewareStack=o()}}let y="***SensitiveInformation***",w=(e,t)=>{for(let i of Object.keys(e)){let n=e[i],r=async function(e,t,i){let r=new n(e);if("function"==typeof t)this.send(r,t);else{if("function"!=typeof i)return this.send(r,t);if("object"!=typeof t)throw Error(`Expected http options but got ${typeof t}`);this.send(r,t||{},i)}},s=(i[0].toLowerCase()+i.slice(1)).replace(/Command$/,"");t.prototype[s]=r}},C=e=>{if(null!=e){if("number"==typeof e){if((0===e||1===e)&&R.warn(A(`Expected boolean, got ${typeof e}: ${e}`)),0===e)return!1;if(1===e)return!0}if("string"==typeof e){let t=e.toLowerCase();if(("false"===t||"true"===t)&&R.warn(A(`Expected boolean, got ${typeof e}: ${e}`)),"false"===t)return!1;if("true"===t)return!0}if("boolean"==typeof e)return e;throw TypeError(`Expected boolean, got ${typeof e}: ${e}`)}},_=e=>{if(null!=e){if("string"==typeof e){let t=parseFloat(e);if(!Number.isNaN(t))return String(t)!==String(e)&&R.warn(A(`Expected number but observed string: ${e}`)),t}if("number"==typeof e)return e;throw TypeError(`Expected number, got ${typeof e}: ${e}`)}},k=(e,t)=>{if(null==e){if(t)throw TypeError(`Expected a non-null value for ${t}`);throw TypeError("Expected a non-null value")}return e},T=e=>{if(null==e)return;if("object"==typeof e&&!Array.isArray(e))return e;let t=Array.isArray(e)?"array":typeof e;throw TypeError(`Expected object, got ${t}: ${e}`)},P=e=>{if(null!=e){if("string"==typeof e)return e;if(["boolean","number","bigint"].includes(typeof e))return R.warn(A(`Expected string, got ${typeof e}: ${e}`)),String(e);throw TypeError(`Expected string, got ${typeof e}: ${e}`)}},E=e=>"string"==typeof e?_(I(e)):_(e),M=/(-?(?:0|[1-9]\d*)(?:\.\d+)?(?:[eE][+-]?\d+)?)|(-?Infinity)|(NaN)/g,I=e=>{let t=e.match(M);if(null===t||t[0].length!==e.length)throw TypeError("Expected real number, got implicit NaN");return parseFloat(e)},A=e=>String(TypeError(e).stack||e).split("\n").slice(0,5).filter(e=>!e.includes("stackTraceWarning")).join("\n"),R={warn:console.warn},x=e=>{let t;if(null!=e){if("number"==typeof e)t=e;else if("string"==typeof e)t=E(e);else throw TypeError("Epoch timestamps must be expressed as floating point numbers or their string representation");if(Number.isNaN(t)||t===1/0||t===-1/0)throw TypeError("Epoch timestamps must be valid, non-Infinite, non-NaN numerics");return new Date(Math.round(1e3*t))}};class O extends Error{constructor(e){super(e.message),Object.setPrototypeOf(this,O.prototype),this.name=e.name,this.$fault=e.$fault,this.$metadata=e.$metadata}}let D=(e,t={})=>{Object.entries(t).filter(([,e])=>void 0!==e).forEach(([t,i])=>{(void 0==e[t]||""===e[t])&&(e[t]=i)});let i=e.message||e.Message||"UnknownError";return e.message=i,delete e.Message,e},L=({output:e,parsedBody:t,exceptionCtor:i,errorCode:n})=>{let r=B(e),s=r.httpStatusCode?r.httpStatusCode+"":void 0;throw D(new i({name:t?.code||t?.Code||n||s||"UnknownError",$fault:"client",$metadata:r}),t)},F=e=>({output:t,parsedBody:i,errorCode:n})=>{L({output:t,parsedBody:i,exceptionCtor:e,errorCode:n})},B=e=>({httpStatusCode:e.statusCode,requestId:e.headers["x-amzn-requestid"]??e.headers["x-amzn-request-id"]??e.headers["x-amz-request-id"],extendedRequestId:e.headers["x-amz-id-2"],cfId:e.headers["x-amz-cf-id"]}),N=e=>{switch(e){case"standard":case"cross-region":return{retryMode:"standard",connectionTimeout:3100};case"in-region":return{retryMode:"standard",connectionTimeout:1100};case"mobile":return{retryMode:"standard",connectionTimeout:3e4};default:return{}}};var V=i(30349);let U=e=>{let t=[];for(let i in V.f3){let n=V.f3[i];void 0!==e[n]&&t.push({algorithmId:()=>n,checksumConstructor:()=>e[n]})}return{_checksumAlgorithms:t,addChecksumAlgorithm(e){this._checksumAlgorithms.push(e)},checksumAlgorithms(){return this._checksumAlgorithms}}},z=e=>{let t={};return e.checksumAlgorithms().forEach(e=>{t[e.algorithmId()]=e.checksumConstructor()}),t},j=e=>{let t=e.retryStrategy;return{setRetryStrategy(e){t=e},retryStrategy:()=>t}},$=e=>{let t={};return t.retryStrategy=e.retryStrategy(),t},W=e=>({...U(e),...j(e)}),H=e=>({...z(e),...$(e)}),K=function(){let e=Object.getPrototypeOf(this).constructor,t=Function.bind.apply(String,[null,...arguments]),i=new t;return Object.setPrototypeOf(i,e.prototype),i};function G(e,t,i){let n,r;if(void 0===t&&void 0===i)n={},r=e;else{if(n=e,"function"==typeof t)return Q(n,t,r=i);r=t}for(let e of Object.keys(r)){if(!Array.isArray(r[e])){n[e]=r[e];continue}Z(n,null,r,e)}return n}K.prototype=Object.create(String.prototype,{constructor:{value:K,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf(K,String);let q=(e,t)=>{let i={};for(let n in t)Z(i,e,t,n);return i},Q=(e,t,i)=>G(e,Object.entries(i).reduce((e,[i,n])=>(Array.isArray(n)?e[i]=n:"function"==typeof n?e[i]=[t,n()]:e[i]=[t,n],e),{})),Z=(e,t,i,n)=>{if(null!==t){let r=i[n];"function"==typeof r&&(r=[,r]);let[s=Y,o=J,a=n]=r;("function"==typeof s&&s(t[a])||"function"!=typeof s&&s)&&(e[n]=o(t[a]));return}let[r,s]=i[n];if("function"==typeof s){let t;let i=void 0===r&&null!=(t=s()),o="function"==typeof r&&!!r(void 0)||"function"!=typeof r&&!!r;i?e[n]=t:o&&(e[n]=s())}else{let t=void 0===r&&null!=s,i="function"==typeof r&&!!r(s)||"function"!=typeof r&&!!r;(t||i)&&(e[n]=s)}},Y=e=>null!=e,J=e=>e;function X(e){return encodeURIComponent(e).replace(/[!'()*]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}let ee=(e,t,i,n,r,s)=>{if(null!=t&&void 0!==t[i]){let t=n();if(t.length<=0)throw Error("Empty value provided for input HTTP label: "+i+".");e=e.replace(r,s?t.split("/").map(e=>X(e)).join("/"):X(t))}else throw Error("No value provided for input HTTP label: "+i+".");return e},et=e=>{if(null==e)return{};if(Array.isArray(e))return e.filter(e=>null!=e).map(et);if("object"==typeof e){let t={};for(let i of Object.keys(e))null!=e[i]&&(t[i]=et(e[i]));return t}return e}},30349:function(e,t,i){"use strict";var n,r,s,o,a,l,d;i.d(t,{f3:function(){return o},cj:function(){return s},zK:function(){return u}}),function(e){e.HEADER="header",e.QUERY="query"}(n||(n={})),function(e){e.HEADER="header",e.QUERY="query"}(r||(r={})),function(e){e.HTTP="http",e.HTTPS="https"}(s||(s={})),function(e){e.MD5="md5",e.CRC32="crc32",e.CRC32C="crc32c",e.SHA1="sha1",e.SHA256="sha256"}(o||(o={})),function(e){e[e.HEADER=0]="HEADER",e[e.TRAILER=1]="TRAILER"}(a||(a={}));let u="__smithy_context";!function(e){e.PROFILE="profile",e.SSO_SESSION="sso-session",e.SERVICES="services"}(l||(l={})),function(e){e.HTTP_0_9="http/0.9",e.HTTP_1_0="http/1.0",e.TDS_8_0="tds/8.0"}(d||(d={}))},80880:function(e,t,i){"use strict";i.d(t,{G:function(){return l},s:function(){return d}});let n={},r=Array(64);for(let e=0,t=65,i=90;e+t<=i;e++){let i=String.fromCharCode(e+t);n[i]=e,r[e]=i}for(let e=0,t=97,i=122;e+t<=i;e++){let i=String.fromCharCode(e+t),s=e+26;n[i]=s,r[s]=i}for(let e=0;e<10;e++){n[e.toString(10)]=e+52;let t=e.toString(10),i=e+52;n[t]=i,r[i]=t}n["+"]=62,r[62]="+",n["/"]=63,r[63]="/";let s=6,o=8,a=63,l=e=>{let t=e.length/4*3;"=="===e.slice(-2)?t-=2:"="===e.slice(-1)&&t--;let i=new ArrayBuffer(t),r=new DataView(i);for(let t=0;t<e.length;t+=4){let i=0,a=0;for(let r=t,o=t+3;r<=o;r++)if("="!==e[r]){if(!(e[r]in n))throw TypeError(`Invalid character ${e[r]} in base64 string.`);i|=n[e[r]]<<(o-r)*s,a+=s}else i>>=s;let l=t/4*3;i>>=a%o;let d=Math.floor(a/o);for(let e=0;e<d;e++){let t=(d-e-1)*o;r.setUint8(l+e,(i&255<<t)>>t)}}return new Uint8Array(i)};function d(e){let t="";for(let i=0;i<e.length;i+=3){let n=0,l=0;for(let t=i,r=Math.min(i+3,e.length);t<r;t++)n|=e[t]<<(r-t-1)*o,l+=o;let d=Math.ceil(l/s);n<<=d*s-l;for(let e=1;e<=d;e++){let i=(d-e)*s;t+=r[(n&a<<i)>>i]}t+="==".slice(0,4-d)}return t}},13587:function(e,t,i){"use strict";i.d(t,{i:function(){return n}});let n=e=>encodeURIComponent(e).replace(/[!'()*]/g,r),r=e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`},80102:function(e,t,i){"use strict";i.d(t,{$:function(){return n}});let n=e=>new TextEncoder().encode(e)},10637:function(e,t,i){"use strict";i.d(t,{G:function(){return n}});let n=e=>new TextDecoder("utf-8").decode(e)},22073:function(e,t,i){"use strict";i.d(t,{Z:function(){return c}});var n,r=new Uint8Array(16);function s(){if(!n&&!(n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(r)}for(var o=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,a=function(e){return"string"==typeof e&&o.test(e)},l=[],d=0;d<256;++d)l.push((d+256).toString(16).substr(1));var u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=(l[e[t+0]]+l[e[t+1]]+l[e[t+2]]+l[e[t+3]]+"-"+l[e[t+4]]+l[e[t+5]]+"-"+l[e[t+6]]+l[e[t+7]]+"-"+l[e[t+8]]+l[e[t+9]]+"-"+l[e[t+10]]+l[e[t+11]]+l[e[t+12]]+l[e[t+13]]+l[e[t+14]]+l[e[t+15]]).toLowerCase();if(!a(i))throw TypeError("Stringified UUID is invalid");return i},c=function(e,t,i){var n=(e=e||{}).random||(e.rng||s)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){i=i||0;for(var r=0;r<16;++r)t[i+r]=n[r];return t}return u(n)}},70544:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=r(i(81211));class o{constructor(e,t,i,n=1e3,r=200){this.realtimeController=e,this.selfAttendeeId=t,this.hasBandwidthPriorityCallback=i,this.waitIntervalMs=n,this.updateIntervalMs=r,this.speakerScores={},this.speakerMuteState={},this.detectorCallbackToHandler=new Map,this.detectorCallbackToScoresTimer=new Map,this.detectorCallbackToActivityTimer=new Map,this.hasBandwidthPriority=!1,this.mostRecentUpdateTimestamp={}}needUpdate(e){return!this.activeSpeakers||0===this.speakerScores[e]&&this.activeSpeakers.includes(e)||this.speakerScores[e]>0&&!this.activeSpeakers.includes(e)}updateActiveSpeakers(e,t,i){if(!this.needUpdate(i))return;let n=[],r=Object.keys(this.speakerScores);for(let e=0;e<r.length;e++){let t=r[e];n.push({attendeeId:t,activeScore:this.speakerScores[t]})}let s=n.sort((e,t)=>t.activeScore-e.activeScore).filter(function(e){return e.activeScore>0}).map(function(e){return e.attendeeId});this.activeSpeakers=s,t(s);let o=s.length>0&&s[0]===this.selfAttendeeId&&e.prioritizeVideoSendBandwidthForActiveSpeaker();this.hasBandwidthPriority!==o&&(this.hasBandwidthPriority=o,this.hasBandwidthPriorityCallback(o))}updateScore(e,t,i,n,r){let s=e.calculateScore(i,n,r);this.speakerScores[i]!==s&&(this.speakerScores[i]=s,this.mostRecentUpdateTimestamp[i]=Date.now(),this.updateActiveSpeakers(e,t,i))}subscribe(e,t,i,n){let r=(i,n)=>{if(!n){this.speakerScores[i]=0,this.mostRecentUpdateTimestamp[i]=Date.now(),this.updateActiveSpeakers(e,t,i);return}this.realtimeController.realtimeSubscribeToVolumeIndicator(i,(i,n,r,s)=>{this.mostRecentUpdateTimestamp[i]=Date.now(),null!==r&&(this.speakerMuteState[i]=r),this.updateScore(e,t,i,n,r)})};this.detectorCallbackToHandler.set(t,r);let o=new s.default(this.updateIntervalMs);if(o.start(()=>{for(let i in this.speakerScores)Date.now()-this.mostRecentUpdateTimestamp[i]>this.waitIntervalMs&&this.updateScore(e,t,i,0,this.speakerMuteState[i])}),this.detectorCallbackToActivityTimer.set(t,o),i&&n){let e=new s.default(n);e.start(()=>{i(this.speakerScores)}),this.detectorCallbackToScoresTimer.set(t,e)}this.realtimeController.realtimeSubscribeToAttendeeIdPresence(r)}unsubscribe(e){let t=this.detectorCallbackToHandler.get(e);this.detectorCallbackToHandler.delete(e),t&&this.realtimeController.realtimeUnsubscribeToAttendeeIdPresence(t);let i=this.detectorCallbackToActivityTimer.get(e);i&&(i.stop(),this.detectorCallbackToActivityTimer.delete(e));let n=this.detectorCallbackToScoresTimer.get(e);n&&(n.stop(),this.detectorCallbackToHandler.delete(e))}destroy(){return n(this,void 0,void 0,function*(){for(let e of this.detectorCallbackToHandler.values())this.realtimeController.realtimeUnsubscribeToAttendeeIdPresence(e);for(let e of this.detectorCallbackToActivityTimer.values())e.stop();for(let e of this.detectorCallbackToScoresTimer.values())e.stop();this.detectorCallbackToHandler.clear(),this.detectorCallbackToActivityTimer.clear(),this.detectorCallbackToScoresTimer.clear()})}}t.default=o},75827:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(e=.9,t=.01,i=.2,n=.2){this.speakerWeight=e,this.cutoffThreshold=t,this.silenceThreshold=i,this.takeoverRate=n,this.volumes={}}calculateScore(e,t,i){(i||null===t)&&(t=0),this.volumes.hasOwnProperty(e)||(this.volumes[e]=0),t=t>this.silenceThreshold?1:0;let n=this.volumes[e]*this.speakerWeight+t*(1-this.speakerWeight);for(let i in this.volumes[e]=n,this.volumes)i!==e&&(this.volumes[i]=Math.max(this.volumes[i]-this.takeoverRate*t,0));return n<this.cutoffThreshold?0:n}prioritizeVideoSendBandwidthForActiveSpeaker(){return!0}}t.default=i},85546:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(e,t){this.appName=e,this.appVersion=t}static create(e,t){let n=/^[a-zA-Z0-9]+[a-zA-Z0-9_-]*[a-zA-Z0-9]+$/g;if(!e||e.length>32)throw Error("appName should be a valid string and 1 to 32 characters in length");if(!n.test(e))throw Error(`appName must satisfy ${n} regular expression`);let r=/^(0|[1-9]\d*)\.(0|[1-9]\d*)\.(0|[1-9]\d*)(?:-((?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\.(?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\+([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?$/gm;if(!t||t.length>32)throw Error("appVersion should be a valid string and 1 to 32 characters in length");if(!r.test(t))throw Error("appVersion must satisfy Semantic Versioning format");return new i(e,t)}}t.default=i},49717:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{}t.default=i},97241:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=r(i(81341)),o=r(i(45619));class a{constructor(e){this.logger=e,this.audioDevice=null,this.audioElement=null,this.audioStream=null,this.browserBehavior=new s.default,this.observers=new Set}bindAudioElement(e){return n(this,void 0,void 0,function*(){if(!e)throw Error(`Cannot bind audio element: ${e}`);return this.audioElement=e,this.audioElement.autoplay=!0,this.bindAudioMix()})}unbindAudioElement(){this.audioElement&&(this.audioElement.srcObject=null,this.audioElement=null,this.forEachObserver(e=>{this.audioStream&&e.meetingAudioStreamBecameInactive(this.audioStream)}))}bindAudioStream(e){return n(this,void 0,void 0,function*(){if(e){this.audioStream=e;try{yield this.bindAudioMix()}catch(e){this.logger&&this.logger.warn(`Failed to bind audio stream: ${e}`)}}})}bindAudioDevice(e){return n(this,void 0,void 0,function*(){if(e&&!this.browserBehavior.supportsSetSinkId())throw Error("Cannot select audio output device. This browser does not support setSinkId.");return this.audioDevice=e,this.bindAudioMix()})}forEachObserver(e){for(let t of this.observers)o.default.nextTick(()=>{e(t)})}bindAudioMix(){var e,t;return n(this,void 0,void 0,function*(){if(!this.audioElement)return;let i=this.audioElement.srcObject;this.audioStream&&(this.audioElement.srcObject=this.audioStream),i!==this.audioStream&&this.forEachObserver(e=>{i&&e.meetingAudioStreamBecameInactive(i),this.audioStream&&e.meetingAudioStreamBecameActive(this.audioStream)});let n=(null===(e=this.audioDevice)||void 0===e?void 0:e.deviceId)!==this.audioElement.sinkId;if(n&&void 0===this.audioElement.sinkId)throw Error("Cannot select audio output device. This browser does not support setSinkId.");let r=this.audioDevice?this.audioDevice.deviceId:"";if(r===this.audioElement.sinkId)return;let s=this.audioElement,o=this.audioStream;if(this.browserBehavior.hasChromiumWebRTC()&&(s.srcObject=null),n)try{yield s.setSinkId(r)}catch(e){throw null===(t=this.logger)||void 0===t||t.error(`Failed to set sinkId for audio element: ${e}`),e}this.browserBehavior.hasChromiumWebRTC()&&(s.srcObject=o)})}getCurrentMeetingAudioStream(){return n(this,void 0,void 0,function*(){return this.audioStream})}addAudioMixObserver(e){return n(this,void 0,void 0,function*(){this.observers.add(e)})}removeAudioMixObserver(e){return n(this,void 0,void 0,function*(){this.observers.delete(e)})}audioOutputDidChange(e){return n(this,void 0,void 0,function*(){return this.logger.info("Receive an audio output change event"),this.bindAudioDevice(e)})}}t.default=a},96665:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let r=n(i(81341));class s{constructor(e=null,t=!0){this.audioBitrateBps=e,this.enableAudioRedundancy=new r.default().supportsAudioRedundancy()&&t}static fullbandSpeechMono(e=!0){return new s(4e4,e)}static fullbandMusicMono(e=!0){return new s(64e3,e)}static fullbandMusicStereo(e=!0){return new s(128e3,e)}isStereo(){return 128e3===this.audioBitrateBps}hasRedundancyEnabled(){return this.enableAudioRedundancy}}t.default=s},43316:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_VIDEO_SUBSCRIPTION_LIMIT=void 0,t.DEFAULT_VIDEO_SUBSCRIPTION_LIMIT=25;class i{constructor(){this.logger=null,this.browserBehavior=null,this.meetingSessionConfiguration=null,this.signalingClient=null,this.peer=null,this.previousSdpOffer=null,this.sdpOfferInit=null,this.audioVideoController=null,this.realtimeController=null,this.videoTileController=null,this.mediaStreamBroker=null,this.activeAudioInput=void 0,this.activeVideoInput=void 0,this.audioMixController=null,this.transceiverController=null,this.indexFrame=null,this.iceCandidates=[],this.iceCandidateHandler=null,this.iceGatheringStateEventHandler=null,this.sdpAnswer=null,this.turnCredentials=null,this.reconnectController=null,this.removableObservers=[],this.audioProfile=null,this.videoStreamIndex=null,this.videoDownlinkBandwidthPolicy=null,this.videoUplinkBandwidthPolicy=null,this.lastKnownVideoAvailability=null,this.videoCaptureAndEncodeParameter=null,this.videosToReceive=null,this.lastVideosToReceive=null,this.videoSubscriptions=null,this.lastVideoSubscriptionConfiguration=new Map,this.videoSubscriptionLimit=t.DEFAULT_VIDEO_SUBSCRIPTION_LIMIT,this.previousSdpAnswerAsString="",this.serverSupportsCompression=!1,this.videoSendCodecPreferences=[],this.currentVideoSendCodec=void 0,this.meetingSupportedVideoSendCodecPreferences=void 0,this.prioritizedSendVideoCodecCapabilities=[],this.videosPaused=null,this.videoDuplexMode=null,this.volumeIndicatorAdapter=null,this.statsCollector=null,this.connectionMonitor=null,this.videoInputAttachedTimestampMs=0,this.audioDeviceInformation={},this.videoDeviceInformation={},this.enableSimulcast=!1,this.enableSVC=!1,this.eventController=null,this.signalingOpenDurationMs=null,this.iceGatheringDurationMs=null,this.startAudioVideoTimestamp=null,this.attendeePresenceDurationMs=null,this.meetingStartDurationMs=null,this.poorConnectionCount=0,this.maxVideoTileCount=0,this.startTimeMs=null}resetConnectionSpecificState(){this.peer&&this.peer.close(),this.peer=null,this.previousSdpOffer=null,this.sdpOfferInit=null,void 0!==this.transceiverController&&this.transceiverController.reset(),this.indexFrame=null,this.iceCandidates=[],this.iceCandidateHandler=null,this.sdpAnswer=null,this.turnCredentials=null,this.videoDownlinkBandwidthPolicy.reset(),this.videoUplinkBandwidthPolicy.reset&&this.videoUplinkBandwidthPolicy.reset(),this.lastVideosToReceive=null,this.lastVideoSubscriptionConfiguration=new Map,this.videoSubscriptions=null,this.videoSubscriptionLimit=t.DEFAULT_VIDEO_SUBSCRIPTION_LIMIT,this.previousSdpAnswerAsString="",this.serverSupportsCompression=!1,this.currentVideoSendCodec=void 0,this.meetingSupportedVideoSendCodecPreferences=void 0,this.videoDuplexMode=null}}t.default=i},204:function(e,t,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return r(t,e),t},o=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let l=a(i(70544)),d=a(i(97241)),u=a(i(96665)),c=a(i(81341)),h=a(i(41405)),f=a(i(61239)),p=a(i(55510)),m=a(i(57456)),g=a(i(8056)),v=a(i(1090)),b=a(i(77041)),S=a(i(91930)),y=a(i(20311)),w=a(i(45619)),C=a(i(99521)),_=a(i(1265)),k=a(i(97618)),T=a(i(75745)),P=a(i(94839)),E=s(i(45377)),M=a(i(62811)),I=a(i(75749)),A=i(39163),R=a(i(36851)),x=a(i(14194)),O=a(i(44525)),D=a(i(84209)),L=a(i(4307)),F=a(i(9500)),B=a(i(4347)),N=a(i(32908)),V=a(i(75583)),U=a(i(86581)),z=a(i(17928)),j=a(i(61849)),$=a(i(522)),W=a(i(40708)),H=a(i(22505)),K=a(i(91604)),G=a(i(55960)),q=a(i(60519)),Q=a(i(34395)),Z=a(i(38521)),Y=a(i(44970)),J=a(i(9478)),X=a(i(60653)),ee=a(i(30296)),et=a(i(27737)),ei=a(i(33301)),en=a(i(1529)),er=a(i(14055)),es=a(i(31288)),eo=i(71906),ea=a(i(48786)),el=a(i(12019)),ed=a(i(71461)),eu=i(85336),ec=a(i(47569)),eh=a(i(44550)),ef=a(i(62073)),ep=a(i(54008)),em=a(i(86351)),eg=a(i(88576)),ev=a(i(46735)),eb=a(i(75762)),eS=a(i(43316));class ey{constructor(e,t,i,n,r,s){this._audioProfile=new u.default,this.connectionHealthData=new h.default,this.observerQueue=new Set,this.meetingSessionContext=new eS.default,this.enableSimulcast=!1,this.enableSVC=!1,this.useUpdateTransceiverControllerForUplink=!1,this.totalRetryCount=0,this.startAudioVideoTimestamp=0,this.mayNeedRenegotiationForSimulcastLayerChange=!1,this.promotedToPrimaryMeeting=!1,this.hasGetRTCPeerConnectionStatsDeprecationMessageBeenSent=!1,this.receiveIndexTask=void 0,this.monitorTask=void 0,this.destroyed=!1,this._logger=t,this.sessionStateController=new C.default(this._logger),this._configuration=e,this._webSocketAdapter=i,this._realtimeController=new y.default(n),this._realtimeController.realtimeSetLocalAttendeeId(e.credentials.attendeeId,e.credentials.externalUserId),this._mediaStreamBroker=n,this._reconnectController=r,this._videoTileController=new ep.default(new em.default,this,this._logger),this._audioMixController=new d.default(this._logger),this._mediaStreamBroker.addMediaStreamBrokerObserver(this._audioMixController),this.meetingSessionContext.logger=this._logger,this._eventController=s}destroy(){return o(this,void 0,void 0,function*(){this.observerQueue.clear(),this._mediaStreamBroker.removeMediaStreamBrokerObserver(this._audioMixController),this.destroyed=!0})}get configuration(){return this._configuration}get realtimeController(){return this._realtimeController}get activeSpeakerDetector(){return this._activeSpeakerDetector||(this._activeSpeakerDetector=new l.default(this._realtimeController,this._configuration.credentials.attendeeId,this.handleHasBandwidthPriority.bind(this))),this._activeSpeakerDetector}get videoTileController(){return this._videoTileController}get audioMixController(){return this._audioMixController}get logger(){return this._logger}get rtcPeerConnection(){return this.meetingSessionContext&&this.meetingSessionContext.peer||null}get mediaStreamBroker(){return this._mediaStreamBroker}get eventController(){return this._eventController}getRTCPeerConnectionStats(e){return(this.hasGetRTCPeerConnectionStatsDeprecationMessageBeenSent||(this.logger.warn("The `getRTCPeerConnectionStats()` is on its way to be deprecated. It makes an additional call to the `getStats` API and therefore may cause slight performance degradation. Please use the new API `clientMetricReport.getRTCStatsReport()` returned by `metricsDidReceive(clientMetricReport)` callback instead."),this.hasGetRTCPeerConnectionStatsDeprecationMessageBeenSent=!0),this.rtcPeerConnection)?this.rtcPeerConnection.getStats(e):null}setAudioProfile(e){this._audioProfile=e}addObserver(e){this.logger.info("adding meeting observer"),this.observerQueue.add(e)}removeObserver(e){this.logger.info("removing meeting observer"),this.observerQueue.delete(e)}forEachObserver(e){for(let t of this.observerQueue)w.default.nextTick(()=>{this.observerQueue.has(t)&&e(t)})}initSignalingClient(){this.connectionHealthData.reset(),this.meetingSessionContext.signalingClient||(this.meetingSessionContext=new eS.default,this.meetingSessionContext.logger=this.logger,this.meetingSessionContext.eventController=this.eventController,this.meetingSessionContext.browserBehavior=new c.default,this.meetingSessionContext.videoSendCodecPreferences=this.videoSendCodecPreferences,this.meetingSessionContext.audioProfile=this._audioProfile,this.meetingSessionContext.meetingSessionConfiguration=this.configuration,this.meetingSessionContext.signalingClient=new P.default(this._webSocketAdapter,this.logger))}uninstallPreStartObserver(){this.meetingSessionContext.signalingClient.removeObserver(this.preStartObserver),this.preStartObserver=void 0}prestart(){return this.logger.info("Pre-connecting signaling connection."),this.createOrReuseSignalingTask().run().then(()=>{let e=()=>o(this,void 0,void 0,function*(){this.logger.info("Early connection closed; discarding signaling task."),this.signalingTask=void 0,this.uninstallPreStartObserver()});this.preStartObserver={handleSignalingClientEvent(t){t.type===M.default.WebSocketClosed&&e()}},this.meetingSessionContext.signalingClient.registerObserver(this.preStartObserver)}).catch(e=>{this.logger.error(`Signaling task pre-start failed: ${e}`),this.signalingTask=void 0})}start(e){this.startReturningPromise(e).then(()=>{this.logger.info("start completed")}).catch(e=>{this.logger.error(`start failed: ${e}`)})}startReturningPromise(e){return(null==e?void 0:e.signalingOnly)===!0?this.prestart():(this.activeSpeakerDetector,new Promise((e,t)=>{this.sessionStateController.perform(_.default.Connect,()=>{this.actionConnect(!1).then(e).catch(t)})}))}connectWithPromises(e){let t=this.meetingSessionContext,i=(e,t)=>new ee.default(this.logger,t,e);this.monitorTask=new z.default(t,this.configuration.connectionHealthPolicyConfiguration,this.connectionHealthData);let n=this.monitorTask.once(),r=new H.default(t).once();this.receiveIndexTask=new q.default(t),this.monitorTask.pauseResubscribeCheck(),this.receiveIndexTask.pauseIngestion();let s=new Z.default(this.logger,"Signaling",[this.createOrReuseSignalingTask(),new U.default(t),new Q.default(t),new N.default(t),this.receiveIndexTask]).once(),o=new L.default(t).once(s),a=new x.default(t).once(o,r),l=new F.default(t).once(a),d=new Y.default(t).once(l),u=new B.default(t).once(d),c=new X.default(t).once(u),h=new K.default(t).once(c);return new Z.default(this.logger,this.wrapTaskName("AudioVideoStart"),[n,i(this.configuration.connectionTimeoutMs,new Z.default(this.logger,"Peer",[c,h,e?new ee.default(this.logger,new $.default(this.logger,"FinalizeConnection",[new et.default(t),new J.default(t)]),this.meetingSessionContext.meetingSessionConfiguration.attendeePresenceTimeoutMs):new J.default(t)]))])}actionConnect(e){var t;return o(this,void 0,void 0,function*(){this.initSignalingClient(),this.uninstallPreStartObserver(),this.meetingSessionContext.mediaStreamBroker=this._mediaStreamBroker,this.meetingSessionContext.realtimeController=this._realtimeController,this.meetingSessionContext.audioMixController=this._audioMixController,this.meetingSessionContext.audioVideoController=this,this.enableSimulcast=this.configuration.enableSimulcastForUnifiedPlanChromiumBasedBrowsers&&new c.default().hasChromiumWebRTC(),this.enableSimulcast&&this.configuration.enableSVC&&this.logger.warn("SVC cannot be enabled at the same time as simulcast. Disabling SVC, using simulcast."),this.enableSVC=!this.enableSimulcast&&this.configuration.enableSVC&&new c.default().supportsScalableVideoCoding();let i=!!this.configuration.urls.audioHostURL;if(i?this.enableSimulcast?(this.logger.info("Using transceiver controller with simulcast support"),new b.default(this.configuration.credentials.attendeeId).hasModality(b.default.MODALITY_CONTENT)?this.meetingSessionContext.transceiverController=new en.default(this.logger,this.meetingSessionContext.browserBehavior,this.meetingSessionContext):this.meetingSessionContext.transceiverController=new er.default(this.logger,this.meetingSessionContext.browserBehavior,this.meetingSessionContext)):(this.logger.info("Using default transceiver controller"),this.meetingSessionContext.transceiverController=new ei.default(this.logger,this.meetingSessionContext.browserBehavior,this.meetingSessionContext)):(this.logger.info("Using video only transceiver controller"),this.meetingSessionContext.transceiverController=new es.default(this.logger,this.meetingSessionContext.browserBehavior,this.meetingSessionContext)),this.meetingSessionContext.volumeIndicatorAdapter=new eb.default(this.logger,this._realtimeController,ey.MIN_VOLUME_DECIBELS,ey.MAX_VOLUME_DECIBELS,this.configuration.credentials.attendeeId),this.meetingSessionContext.videoTileController=this._videoTileController,this.meetingSessionContext.videoDownlinkBandwidthPolicy=this.configuration.videoDownlinkBandwidthPolicy,this.meetingSessionContext.videoUplinkBandwidthPolicy=this.configuration.videoUplinkBandwidthPolicy,this.meetingSessionContext.enableSimulcast=this.enableSimulcast,this.meetingSessionContext.enableSVC=this.enableSVC,this.enableSimulcast){let e=this.meetingSessionContext.videoUplinkBandwidthPolicy;e||(e=new eg.default(this.configuration.credentials.attendeeId,this.meetingSessionContext.logger),this.meetingSessionContext.videoUplinkBandwidthPolicy=e),e.addObserver(this),this.meetingSessionContext.videoDownlinkBandwidthPolicy||(this.meetingSessionContext.videoDownlinkBandwidthPolicy=new ed.default(this.meetingSessionContext.logger)),this.meetingSessionContext.videoStreamIndex=new ef.default(this.logger)}else this.meetingSessionContext.enableSimulcast=!1,this.meetingSessionContext.videoStreamIndex=new eh.default(this.logger),this.meetingSessionContext.videoUplinkBandwidthPolicy||(this.meetingSessionContext.videoUplinkBandwidthPolicy=new ev.default(this.configuration.credentials.attendeeId,!this.meetingSessionContext.browserBehavior.disableResolutionScaleDown(),this.meetingSessionContext.logger,this.meetingSessionContext.browserBehavior),this.meetingSessionContext.videoUplinkBandwidthPolicy.setSVCEnabled(this.enableSVC)),this.meetingSessionContext.videoDownlinkBandwidthPolicy||(this.meetingSessionContext.videoDownlinkBandwidthPolicy=new el.default(this.configuration.credentials.attendeeId)),this.meetingSessionContext.videoUplinkBandwidthPolicy.setTransceiverController&&this.meetingSessionContext.videoUplinkBandwidthPolicy.updateTransceiverController&&(this.useUpdateTransceiverControllerForUplink=!0,this.meetingSessionContext.videoUplinkBandwidthPolicy.setTransceiverController(this.meetingSessionContext.transceiverController)),this.meetingSessionContext.audioProfile=this._audioProfile;if(new b.default(this.configuration.credentials.attendeeId).hasModality(b.default.MODALITY_CONTENT)){let e=this.configuration.meetingFeatures.contentMaxResolution===p.default.VideoResolutionUHD;e&&this.setVideoMaxBandwidthKbps(2500),this.meetingSessionContext.videoUplinkBandwidthPolicy.setHighResolutionFeatureEnabled(e)}else{let e=this.configuration.meetingFeatures.videoMaxResolution===p.default.VideoResolutionFHD;this.meetingSessionContext.videoUplinkBandwidthPolicy.setHighResolutionFeatureEnabled(e)}this.meetingSessionContext.videoUplinkBandwidthPolicy&&this.maxUplinkBandwidthKbps&&this.meetingSessionContext.videoUplinkBandwidthPolicy.setIdealMaxBandwidthKbps(this.maxUplinkBandwidthKbps),this.meetingSessionContext.videoDownlinkBandwidthPolicy.bindToTileController&&this.meetingSessionContext.videoDownlinkBandwidthPolicy.bindToTileController(this._videoTileController),this.meetingSessionContext.videoDownlinkBandwidthPolicy.setWantsResubscribeObserver&&this.meetingSessionContext.videoDownlinkBandwidthPolicy.setWantsResubscribeObserver(()=>this.update({needsRenegotiation:!1})),this.meetingSessionContext.lastKnownVideoAvailability=new v.default,this.meetingSessionContext.videoCaptureAndEncodeParameter=new ea.default(0,0,0,0,!1),this.meetingSessionContext.videosToReceive=new ec.default,this.meetingSessionContext.videosPaused=new ec.default,this.meetingSessionContext.statsCollector=new R.default(this,this.logger),this.meetingSessionContext.connectionMonitor=new f.default(this,this._realtimeController,this.connectionHealthData,new S.default(this.meetingSessionContext.signalingClient,ey.PING_PONG_INTERVAL_MS,this.logger),this.meetingSessionContext.statsCollector),this.meetingSessionContext.reconnectController=this._reconnectController,this.meetingSessionContext.videoDeviceInformation={},e||(this.totalRetryCount=0,this._reconnectController.reset(),this.startAudioVideoTimestamp=Date.now(),this.forEachObserver(e=>{eo.Maybe.of(e.audioVideoDidStartConnecting).map(t=>t.bind(e)(!1))}),null===(t=this.eventController)||void 0===t||t.publishEvent("meetingStartRequested")),this.meetingSessionContext.startAudioVideoTimestamp=this.startAudioVideoTimestamp,this._reconnectController.hasStartedConnectionAttempt()?this._reconnectController.startedConnectionAttempt(!1):this._reconnectController.startedConnectionAttempt(!0);let n=i&&this.meetingSessionContext.meetingSessionConfiguration.attendeePresenceTimeoutMs>0;this.logger.info("Needs to wait for attendee presence? "+n);let r=this.connectWithPromises(n);try{yield r.run(),this.connectionHealthData.setConnectionStartTime(),this._mediaStreamBroker.addMediaStreamBrokerObserver(this),this.sessionStateController.perform(_.default.FinishConnecting,()=>{this.eventController&&(this.meetingSessionContext.meetingStartDurationMs=Date.now()-this.startAudioVideoTimestamp,this.eventController.publishEvent("meetingStartSucceeded",{maxVideoTileCount:this.meetingSessionContext.maxVideoTileCount,poorConnectionCount:this.meetingSessionContext.poorConnectionCount,retryCount:this.totalRetryCount,signalingOpenDurationMs:this.meetingSessionContext.signalingOpenDurationMs,iceGatheringDurationMs:this.meetingSessionContext.iceGatheringDurationMs,meetingStartDurationMs:this.meetingSessionContext.meetingStartDurationMs})),this.meetingSessionContext.startTimeMs=Date.now(),this.actionFinishConnecting()})}catch(t){this.signalingTask=void 0;let e=new m.default(this.getMeetingStatusCode(t)||g.default.TaskFailed);if(this.logger.info(`Start failed: ${e} due to error ${t}.`),this.sessionStateController.state()===k.default.NotConnected){this.logger.info("Start failed and not connected. Not cleaning up.");return}this.sessionStateController.perform(_.default.Fail,()=>o(this,void 0,void 0,function*(){yield this.actionDisconnect(e,!0,t),this.handleMeetingSessionStatus(e,t)||this.notifyStop(e,t)}))}})}createOrReuseSignalingTask(){return this.signalingTask||(this.initSignalingClient(),this.signalingTask=new ee.default(this.logger,new j.default(this.meetingSessionContext),this.configuration.connectionTimeoutMs).once()),this.signalingTask}actionFinishConnecting(){this.signalingTask=void 0,this.meetingSessionContext.videoDuplexMode=A.SdkStreamServiceType.RX,this.meetingSessionContext.enableSimulcast||(this.useUpdateTransceiverControllerForUplink?this.meetingSessionContext.videoUplinkBandwidthPolicy.updateTransceiverController():this.enforceBandwidthLimitationForSender(this.meetingSessionContext.videoCaptureAndEncodeParameter.encodeBitrates()[0])),this.forEachObserver(e=>{eo.Maybe.of(e.audioVideoDidStart).map(t=>t.bind(e)())}),this._reconnectController.reset(),this.receiveIndexTask.resumeIngestion(),this.monitorTask.resumeResubscribeCheck()}stopReturningPromise(){var e;return this.sessionStateController.state()===k.default.NotConnected?(null===(e=this.meetingSessionContext.signalingClient)||void 0===e||e.closeConnection(),this.cleanUpMediaStreamsAfterStop(),Promise.resolve()):new Promise((e,t)=>{this.sessionStateController.perform(_.default.Disconnect,()=>{this._reconnectController.disableReconnect(),this.logger.info("attendee left meeting, session will not be reconnected"),this.actionDisconnect(new m.default(g.default.Left),!1,null).then(e).catch(t)})})}stop(){this.stopReturningPromise()}actionDisconnect(e,t,i){return o(this,void 0,void 0,function*(){try{yield new Z.default(this.logger,this.wrapTaskName("AudioVideoStop"),[new ee.default(this.logger,new V.default(this.meetingSessionContext),this.configuration.connectionTimeoutMs)]).run()}catch(e){this.logger.info("fail to stop")}try{let e=[new ee.default(this.logger,new D.default(this.meetingSessionContext),this.configuration.connectionTimeoutMs)];this.cleanUpMediaStreamsAfterStop(),yield new Z.default(this.logger,this.wrapTaskName("AudioVideoClean"),e).run()}catch(e){this.logger.info("fail to clean")}this.sessionStateController.perform(_.default.FinishDisconnecting,()=>{t||this.notifyStop(e,i)})})}update(e={needsRenegotiation:!0}){let t=e.needsRenegotiation;if(t||(t=void 0===this.meetingSessionContext.peer),t||(t=!this.updateRemoteVideosFromPolicy()),t||(t=!this.updateLocalVideoFromPolicy()),this.meetingSessionContext.lastVideosToReceive=this.meetingSessionContext.videosToReceive,!t)return this.logger.info("Update request does not require resubscribe"),this.actionFinishUpdating(),!0;this.logger.info("Update request requires resubscribe");let i=this.sessionStateController.perform(_.default.Update,()=>{this.actionUpdateWithRenegotiation(!0)});return i===T.default.Transitioned||i===T.default.DeferredTransition}updateRemoteVideosFromPolicy(){if(this.meetingSessionContext.videoDownlinkBandwidthPolicy&&void 0!==this.meetingSessionContext.videoDownlinkBandwidthPolicy.getVideoPreferences&&void 0!==this.meetingSessionContext.videoDownlinkBandwidthPolicy.getServerSideNetworkAdaption&&!E.serverSideNetworkAdaptionIsNoneOrDefault(this.meetingSessionContext.videoDownlinkBandwidthPolicy.getServerSideNetworkAdaption())){if(!this.sendRemoteVideoUpdate())return!1;if(this.meetingSessionContext.videoDownlinkBandwidthPolicy.getServerSideNetworkAdaption()===E.default.BandwidthProbingAndRemoteVideoQualityAdaption)return this.isNotAddingOrRemovingStreams()}return this.updateRemoteVideosIfNotAddingOrRemovingStreams()}updateRemoteVideosIfNotAddingOrRemovingStreams(){let e=this.detectChangesInVideosToReceive();if(void 0===e)return!1;let t=e.added,i=e.simulcastStreamUpdates,n=e.removed,r=this.meetingSessionContext,s=[];for(let[e,t]of i.entries()){let i=new I.default;if(i.streamId=t,i.attendeeId=r.videoStreamIndex.attendeeIdForStreamId(t),i.mid=r.transceiverController.getMidForStreamId(e),void 0===i.mid)return this.logger.info(`No MID found for stream ID ${e}, cannot update stream without renegotiation`),!1;if(s.push(i),r.transceiverController.setStreamIdForMid(i.mid,t),r.videoStreamIndex.overrideStreamIdMappings(e,t),r.videoTileController.haveVideoTileForAttendeeId(i.attendeeId)){let e=r.videoTileController.getVideoTileForAttendeeId(i.attendeeId);if(!e.setStreamId)return!1;e.setStreamId(t)}}return 0!==s.length&&r.signalingClient.remoteVideoUpdate(s,[]),0===t.length&&0===n.length&&(r.videoStreamIndex.subscribeFrameSent(),!0)}detectChangesInVideosToReceive(){let e=this.meetingSessionContext;if(null===e.videosToReceive||!e.transceiverController||!e.transceiverController.getMidForStreamId||!e.transceiverController.setStreamIdForMid||!e.videosToReceive.forEach||!e.signalingClient.remoteVideoUpdate||!e.videoStreamIndex.overrideStreamIdMappings)return;let t=[],i=new Map,n=[];if(null===e.lastVideosToReceive)t=e.videosToReceive.array();else{let r=e.videoStreamIndex;e.videosToReceive.forEach(n=>{if(e.lastVideosToReceive.contain(n))return;let s=!1;e.lastVideosToReceive.forEach(e=>{!s&&r.StreamIdsInSameGroup(e,n)&&(i.set(e,n),s=!0)}),s||t.push(n)}),n=e.lastVideosToReceive.array().filter(t=>{let n=e.videosToReceive.contain(t),r=i.has(t);return!n&&!r})}return this.logger.info(`Request to update remote videos with added: ${t}, updated: ${[...i.entries()]}, removed: ${n}`),{added:t,removed:n,simulcastStreamUpdates:i}}isNotAddingOrRemovingStreams(){let e=this.detectChangesInVideosToReceive();if(void 0===e)return!1;let t=e.added,i=e.removed;return 0===t.length&&0===i.length}sendRemoteVideoUpdate(){let e=this.meetingSessionContext;if(null===e.videosToReceive)return!1;let t=e.videosToReceive.array().map(t=>e.videoStreamIndex.groupIdForStreamId(t)),i=eu.convertVideoPreferencesToSignalingClientVideoSubscriptionConfiguration(e,t,e.videoDownlinkBandwidthPolicy.getVideoPreferences()),n=new Map,r=[];for(let t of i){let i=!1;if(e.lastVideoSubscriptionConfiguration.has(t.groupId)){let n=e.lastVideoSubscriptionConfiguration.get(t.groupId);t.equals(n)||(this.logger.debug(`${JSON.stringify(t)} does not equal ${JSON.stringify(n)}, sending update`),i=!0)}else i=!0;n.set(t.groupId,t),i&&r.push(t)}e.lastVideoSubscriptionConfiguration=n;let s=[];if(null!==e.lastVideosToReceive){let i=new Set(t);for(let t of e.lastVideosToReceive.array()){let n=e.videoStreamIndex.groupIdForStreamId(t);if(!i.has(n)){let t=e.transceiverController.getMidForGroupId(n);if(void 0===t){e.logger.warn(`Could not find MID for group ID to remove: ${n}`);continue}s.push(t)}}}return(0!==r.length||0!==s.length)&&e.signalingClient.remoteVideoUpdate(r,s),!0}updateLocalVideoFromPolicy(){if(this.meetingSessionContext.enableSimulcast){let e=this.meetingSessionContext.videoUplinkBandwidthPolicy.chooseEncodingParameters();if(this.mayNeedRenegotiationForSimulcastLayerChange&&!this.negotiatedBitrateLayersAllocationRtpHeaderExtension())return this.logger.info("Needs regenotiation for local video simulcast layer change"),this.mayNeedRenegotiationForSimulcastLayerChange=!1,!1;this.meetingSessionContext.transceiverController.setEncodingParameters(e)}else this.meetingSessionContext.videoCaptureAndEncodeParameter=this.meetingSessionContext.videoUplinkBandwidthPolicy.chooseCaptureAndEncodeParameters();return this.logger.info("Updated local video from policy without renegotiation"),!0}negotiatedBitrateLayersAllocationRtpHeaderExtension(){if(!this.meetingSessionContext.transceiverController.localVideoTransceiver())return!1;let e=this.meetingSessionContext.transceiverController.localVideoTransceiver().sender.getParameters();return!!e&&!!e.headerExtensions&&e.headerExtensions.some(e=>"http://www.webrtc.org/experiments/rtp-hdrext/video-layers-allocation00"===e.uri)}restartLocalVideo(e){let t=()=>o(this,void 0,void 0,function*(){this._videoTileController.hasStartedLocalVideoTile()&&(this.logger.info("stopping local video tile prior to local video restart"),this._videoTileController.stopLocalVideoTile(),this.logger.info("preparing local video restart update"),yield this.actionUpdateWithRenegotiation(!1),this.logger.info("starting local video tile for local video restart"),this._videoTileController.startLocalVideoTile()),this.logger.info("finalizing local video restart update"),yield this.actionUpdateWithRenegotiation(!0),e()}),i=this.sessionStateController.perform(_.default.Update,()=>{t()});return i===T.default.Transitioned||i===T.default.DeferredTransition}replaceLocalVideo(e){return o(this,void 0,void 0,function*(){if(!e||e.getVideoTracks().length<1)throw Error("could not acquire video track");if(!this.meetingSessionContext||!this.meetingSessionContext.peer)throw Error("no active meeting and peer connection");let t=this.meetingSessionContext.videoTileController.getLocalVideoTile();if(t){let i=t.state(),n=e.getVideoTracks()[0].getSettings();t.bindVideoStream(i.boundAttendeeId,!0,e,n.width,n.height,i.streamId,i.boundExternalUserId)}yield this.meetingSessionContext.transceiverController.setVideoInput(e.getVideoTracks()[0]),this.meetingSessionContext.activeVideoInput=e,this.logger.info("Local video input is updated")})}replaceLocalAudio(e){return o(this,void 0,void 0,function*(){if(!e||e.getAudioTracks().length<1)throw Error("could not acquire audio track");if(!this.meetingSessionContext||!this.meetingSessionContext.peer)throw Error("no active meeting and peer connection");if(this.connectionHealthData.reset(),this.connectionHealthData.setConnectionStartTime(),!(yield this.meetingSessionContext.transceiverController.replaceAudioTrack(e.getAudioTracks()[0])))throw Error("Failed to replace audio track");this.meetingSessionContext.activeAudioInput=e,this.logger.info("Local audio input is updated")})}actionUpdateWithRenegotiation(e){return o(this,void 0,void 0,function*(){this.monitorTask.pauseResubscribeCheck(),this.receiveIndexTask.pauseIngestion();try{yield new Z.default(this.logger,this.wrapTaskName("AudioVideoUpdate"),[new G.default(this.meetingSessionContext),new ee.default(this.logger,new Z.default(this.logger,"UpdateSession",[new x.default(this.meetingSessionContext),new F.default(this.meetingSessionContext),new Y.default(this.meetingSessionContext),new B.default(this.meetingSessionContext),new X.default(this.meetingSessionContext),new J.default(this.meetingSessionContext)]),this.configuration.connectionTimeoutMs)]).run(),e&&this.sessionStateController.perform(_.default.FinishUpdating,()=>{this.actionFinishUpdating()})}catch(e){this.sessionStateController.perform(_.default.FinishUpdating,()=>{let t=new m.default(this.getMeetingStatusCode(e)||g.default.TaskFailed);t.statusCode()!==g.default.IncompatibleSDP&&this.logger.info("failed to update audio-video session"),this.handleMeetingSessionStatus(t,e)})}})}notifyStop(e,t){var i;if(this.forEachObserver(t=>{eo.Maybe.of(t.audioVideoDidStop).map(i=>i.bind(t)(e))}),this.promotedToPrimaryMeeting&&t&&this.forEachObserver(e=>{this.promotedToPrimaryMeeting=!1,eo.Maybe.of(e.audioVideoWasDemotedFromPrimaryMeeting).map(t=>t.bind(e)(new m.default(g.default.SignalingInternalServerError)))}),this.eventController){let{signalingOpenDurationMs:n,poorConnectionCount:r,startTimeMs:s,iceGatheringDurationMs:o,attendeePresenceDurationMs:a,meetingStartDurationMs:l}=this.meetingSessionContext,d={maxVideoTileCount:this.meetingSessionContext.maxVideoTileCount,meetingDurationMs:null===s?0:Math.round(Date.now()-s),meetingStatus:g.default[e.statusCode()],signalingOpenDurationMs:n,iceGatheringDurationMs:o,attendeePresenceDurationMs:a,poorConnectionCount:r,meetingStartDurationMs:l,retryCount:this.totalRetryCount},u=t&&t.message||(null===(i=e.toString)||void 0===i?void 0:i.call(e))||"";0===d.meetingDurationMs?(d.meetingErrorMessage=u,delete d.meetingDurationMs,delete d.attendeePresenceDurationMs,delete d.meetingStartDurationMs,this.eventController.publishEvent("meetingStartFailed",d)):e.isFailure()||e.isAudioConnectionFailure()?(d.meetingErrorMessage=u,this.eventController.publishEvent("meetingFailed",d)):this.eventController.publishEvent("meetingEnded",d)}}actionFinishUpdating(){if(!this.meetingSessionContext.enableSimulcast){if(this.useUpdateTransceiverControllerForUplink)this.meetingSessionContext.videoUplinkBandwidthPolicy.updateTransceiverController();else{let e=this.meetingSessionContext.videoCaptureAndEncodeParameter.encodeBitrates()[0];this.enforceBandwidthLimitationForSender(e)}}this.monitorTask.resumeResubscribeCheck(),this.receiveIndexTask.resumeIngestion(),this.logger.info("updated audio-video session")}reconnect(e,t){let i=this._reconnectController.retryWithBackoff(()=>o(this,void 0,void 0,function*(){this.sessionStateController.state()===k.default.NotConnected?this.sessionStateController.perform(_.default.Connect,()=>{this.actionConnect(!0)}):this.sessionStateController.perform(_.default.Reconnect,()=>{this.actionReconnect(e)}),this.totalRetryCount+=1}),()=>{this.logger.info("canceled retry")});return i||this.sessionStateController.perform(_.default.Fail,()=>{this.actionDisconnect(e,!1,t)}),i}actionReconnect(e){return o(this,void 0,void 0,function*(){this._reconnectController.hasStartedConnectionAttempt()||(this._reconnectController.startedConnectionAttempt(!1),this.forEachObserver(e=>{eo.Maybe.of(e.audioVideoDidStartConnecting).map(t=>t.bind(e)(!0))})),this.meetingSessionContext.volumeIndicatorAdapter.onReconnect(),this.connectionHealthData.reset();try{yield new Z.default(this.logger,this.wrapTaskName("AudioVideoReconnect"),[new ee.default(this.logger,new Z.default(this.logger,"Media",[new O.default(this.meetingSessionContext),new Z.default(this.logger,"Signaling",[new j.default(this.meetingSessionContext),new N.default(this.meetingSessionContext)]),new L.default(this.meetingSessionContext)]),this.configuration.connectionTimeoutMs),new G.default(this.meetingSessionContext),new ee.default(this.logger,new Z.default(this.logger,"UpdateSession",[new x.default(this.meetingSessionContext),new F.default(this.meetingSessionContext),new Y.default(this.meetingSessionContext),new B.default(this.meetingSessionContext),new X.default(this.meetingSessionContext),new J.default(this.meetingSessionContext)]),this.configuration.connectionTimeoutMs)]).run(),this.sessionStateController.perform(_.default.FinishConnecting,()=>{if(this.eventController){let{signalingOpenDurationMs:t,poorConnectionCount:i,startTimeMs:n,iceGatheringDurationMs:r,attendeePresenceDurationMs:s,meetingStartDurationMs:o}=this.meetingSessionContext,a={maxVideoTileCount:this.meetingSessionContext.maxVideoTileCount,meetingDurationMs:Math.round(Date.now()-n),meetingStatus:g.default[e.statusCode()],signalingOpenDurationMs:t,iceGatheringDurationMs:r,attendeePresenceDurationMs:s,poorConnectionCount:i,meetingStartDurationMs:o,retryCount:this.totalRetryCount};this.eventController.publishEvent("meetingReconnected",a)}this.actionFinishConnecting()})}catch(e){this.sessionStateController.perform(_.default.FinishConnecting,()=>{this.logger.info("failed to reconnect audio-video session");let t=new m.default(this.getMeetingStatusCode(e)||g.default.TaskFailed);this.handleMeetingSessionStatus(t,e)})}this.connectionHealthData.setConnectionStartTime()})}wrapTaskName(e){return`${e}/${this.configuration.meetingId}/${this.configuration.credentials.attendeeId}`}cleanUpMediaStreamsAfterStop(){this._mediaStreamBroker.removeMediaStreamBrokerObserver(this),this.meetingSessionContext.activeAudioInput=void 0,this.meetingSessionContext.activeVideoInput=void 0}getMeetingStatusCode(e){let t=/the meeting status code: (\d+)/.exec(e&&e.message);return t&&t.length>1?Number.parseInt(t[1],10):null}enforceBandwidthLimitationForSender(e){return o(this,void 0,void 0,function*(){yield this.meetingSessionContext.transceiverController.setVideoSendingBitrateKbps(e)})}handleMeetingSessionStatus(e,t){if(this.logger.info(`handling status: ${g.default[e.statusCode()]}`),!e.isTerminal()&&this.meetingSessionContext.statsCollector&&this.meetingSessionContext.statsCollector.logMeetingSessionStatus(e),e.statusCode()===g.default.IncompatibleSDP)return this.restartLocalVideo(()=>{this.logger.info("handled incompatible SDP by attempting to restart video")}),!0;if(e.statusCode()===g.default.VideoCallSwitchToViewOnly)return this._videoTileController.removeLocalVideoTile(),this.forEachObserver(e=>{eo.Maybe.of(e.videoSendDidBecomeUnavailable).map(t=>t.bind(e)())}),!1;if(e.statusCode()===g.default.AudioVideoWasRemovedFromPrimaryMeeting)return this.forEachObserver(t=>{eo.Maybe.of(t.audioVideoWasDemotedFromPrimaryMeeting).map(i=>i.bind(t)(e))}),!1;if(e.isTerminal()&&(this.logger.error("session will not be reconnected"),this.meetingSessionContext.reconnectController&&this.meetingSessionContext.reconnectController.disableReconnect()),(e.isFailure()||e.isTerminal())&&this.meetingSessionContext.reconnectController){let i=this.reconnect(e,t);return i?this.logger.warn(`will retry due to status code ${g.default[e.statusCode()]}${t?` and error: ${t.message}`:""}`):this.logger.error(`failed with status code ${g.default[e.statusCode()]}${t?` and error: ${t.message}`:""}`),i}return!1}setVideoMaxBandwidthKbps(e){if(e<=0)throw Error("Max bandwidth kbps has to be greater than 0");this.meetingSessionContext&&this.meetingSessionContext.videoUplinkBandwidthPolicy&&(this.logger.info(`video send has ideal max bandwidth ${e} kbps`),this.meetingSessionContext.videoUplinkBandwidthPolicy.setIdealMaxBandwidthKbps(e)),this.maxUplinkBandwidthKbps=e}handleHasBandwidthPriority(e){return o(this,void 0,void 0,function*(){if(this.meetingSessionContext&&this.meetingSessionContext.videoUplinkBandwidthPolicy&&!this.meetingSessionContext.enableSimulcast){if(this.useUpdateTransceiverControllerForUplink){this.meetingSessionContext.videoUplinkBandwidthPolicy.setHasBandwidthPriority(e),yield this.meetingSessionContext.videoUplinkBandwidthPolicy.updateTransceiverController();return}let t=this.meetingSessionContext.videoUplinkBandwidthPolicy.maxBandwidthKbps();this.meetingSessionContext.videoUplinkBandwidthPolicy.setHasBandwidthPriority(e);let i=this.meetingSessionContext.videoUplinkBandwidthPolicy.maxBandwidthKbps();t!==i&&(this.logger.info(`video send bandwidth priority ${e} max has changed from ${t} kbps to ${i} kbps`),yield this.enforceBandwidthLimitationForSender(i))}})}pauseReceivingStream(e){this.meetingSessionContext&&this.meetingSessionContext.signalingClient&&this.meetingSessionContext.signalingClient.pause([e])}resumeReceivingStream(e){this.meetingSessionContext&&this.meetingSessionContext.signalingClient&&this.meetingSessionContext.signalingClient.resume([e])}setVideoCodecSendPreferences(e){this.videoSendCodecPreferences=e,this.meetingSessionContext.videoSendCodecPreferences=e,this.sessionStateController.state()!==k.default.NotConnected&&this.update({needsRenegotiation:!0})}getRemoteVideoSources(){let{videoStreamIndex:e}=this.meetingSessionContext;if(!e)return this.logger.info("meeting has not started"),[];let t=this.configuration.credentials.attendeeId;return e.allVideoSendingSourcesExcludingSelf(t)}encodingSimulcastLayersDidChange(e){this.mayNeedRenegotiationForSimulcastLayerChange=!0,this.forEachObserver(t=>{eo.Maybe.of(t.encodingSimulcastLayersDidChange).map(i=>i.bind(t)(e))})}promoteToPrimaryMeeting(e){return this.actionPromoteToPrimaryMeeting(e)}actionPromoteToPrimaryMeeting(e){return o(this,void 0,void 0,function*(){let t=new m.default(g.default.SignalingRequestFailed);return yield new Z.default(this.logger,this.wrapTaskName("PromoteToPrimaryMeeting"),[new ee.default(this.logger,new W.default(this.meetingSessionContext,e,e=>{t=e}),this.configuration.connectionTimeoutMs)]).run(),this.promotedToPrimaryMeeting=t.statusCode()===g.default.OK,t})}demoteFromPrimaryMeeting(){this.meetingSessionContext.signalingClient.demoteFromPrimaryMeeting(),this.forEachObserver(e=>{eo.Maybe.of(e.audioVideoWasDemotedFromPrimaryMeeting).map(t=>t.bind(e)(new m.default(g.default.OK)))})}videoInputDidChange(e){return o(this,void 0,void 0,function*(){if(this.logger.info("Receive a video input change event"),!this.meetingSessionContext||!this.meetingSessionContext.peer){this.logger.info("Skip updating video input because there is no active meeting and peer connection");return}this._videoTileController.hasStartedLocalVideoTile()&&(e?yield this.replaceLocalVideo(e):this._videoTileController.stopLocalVideoTile())})}audioInputDidChange(e){return o(this,void 0,void 0,function*(){if(this.logger.info("Receive an audio input change event"),!this.meetingSessionContext||!this.meetingSessionContext.peer){this.logger.info("Skip updating audio input because there is no active meeting and peer connection");return}if(!e)try{e=yield this.mediaStreamBroker.acquireAudioInputStream()}catch(e){this.logger.error("Could not acquire audio track from mediaStreamBroker");return}yield this.replaceLocalAudio(e)})}}t.default=ey,ey.MIN_VOLUME_DECIBELS=-42,ey.MAX_VOLUME_DECIBELS=-14,ey.PING_PONG_INTERVAL_MS=1e4},64827:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let r=n(i(2739)),s=n(i(19444)),o=n(i(65718)),a=n(i(28388)),l=n(i(38374)),d=n(i(63606)),u=n(i(57456)),c=n(i(8056)),h=n(i(64432)),f=n(i(97386)),p=n(i(14832)),m=n(i(204));class g extends m.default{constructor(e){let t=new l.default;t.meetingId="",t.externalMeetingId="",t.credentials=new d.default,t.credentials.attendeeId="",t.credentials.joinToken="",t.urls=new h.default,t.urls.turnControlURL="",t.urls.audioHostURL="",t.urls.signalingURL="wss://localhost/";let i=new o.default;super(e||t,i,new p.default(new o.default),new a.default,new f.default(0,new r.default(0,0,0)),new s.default(e||t,i))}setAudioProfile(e){}start(){}stop(){}promoteToPrimaryMeeting(e){return Promise.resolve(new u.default(c.default.OK))}demoteFromPrimaryMeeting(){}}t.default=g},34114:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});let r=i(53810);class s{constructor(e,t,i,n,r,s){this.audioVideoController=e,this.videoTileController=t,this.realtimeController=i,this.audioMixController=n,this.deviceController=r,this.contentShareController=s}addObserver(e){this.audioVideoController.addObserver(e),this.trace("addObserver")}removeObserver(e){this.audioVideoController.removeObserver(e),this.trace("removeObserver")}setAudioProfile(e){this.trace("setAudioProfile",e),this.audioVideoController.setAudioProfile(e)}start(e){this.audioVideoController.start(e),this.trace("start")}stop(){this.audioVideoController.stop(),this.trace("stop")}getRTCPeerConnectionStats(e){return this.trace("getRTCPeerConnectionStats",e?e.id:null),this.audioVideoController.getRTCPeerConnectionStats(e)}bindAudioElement(e){let t=this.audioMixController.bindAudioElement(e);return this.trace("bindAudioElement",e.id,t),t}unbindAudioElement(){this.audioMixController.unbindAudioElement(),this.trace("unbindAudioElement")}getCurrentMeetingAudioStream(){return this.trace("getCurrentConferenceStream"),this.audioMixController.getCurrentMeetingAudioStream()}addAudioMixObserver(e){this.trace("addAudioMixObserver"),this.audioMixController.addAudioMixObserver(e)}removeAudioMixObserver(e){this.trace("removeAudioMixObserver"),this.audioMixController.removeAudioMixObserver(e)}bindVideoElement(e,t){this.videoTileController.bindVideoElement(e,t),this.trace("bindVideoElement",{tileId:e,videoElementId:t.id})}unbindVideoElement(e,t=!0){this.videoTileController.unbindVideoElement(e,t),this.trace("unbindVideoElement",{tileId:e,cleanUpVideoElement:t})}startLocalVideoTile(){let e=this.videoTileController.startLocalVideoTile();return this.trace("startLocalVideoTile",null,e),e}stopLocalVideoTile(){this.videoTileController.stopLocalVideoTile(),this.trace("stopLocalVideoTile")}hasStartedLocalVideoTile(){let e=this.videoTileController.hasStartedLocalVideoTile();return this.trace("hasStartedLocalVideoTile",null,e),e}removeLocalVideoTile(){this.videoTileController.removeLocalVideoTile(),this.trace("removeLocalVideoTile")}getLocalVideoTile(){let e=this.videoTileController.getLocalVideoTile();return this.trace("getLocalVideoTile"),e}pauseVideoTile(e){this.videoTileController.pauseVideoTile(e),this.trace("pauseVideoTile",e)}unpauseVideoTile(e){this.videoTileController.unpauseVideoTile(e),this.trace("unpauseVideoTile",e)}getVideoTile(e){let t=this.videoTileController.getVideoTile(e);return this.trace("getVideoTile",e),t}getAllRemoteVideoTiles(){let e=this.videoTileController.getAllRemoteVideoTiles();return this.trace("getAllRemoteVideoTiles"),e}getAllVideoTiles(){let e=this.videoTileController.getAllVideoTiles();return this.trace("getAllVideoTiles"),e}addVideoTile(){let e=this.videoTileController.addVideoTile();return this.trace("addVideoTile",null,e.state()),e}removeVideoTile(e){this.videoTileController.removeVideoTile(e),this.trace("removeVideoTile",e)}removeVideoTilesByAttendeeId(e){let t=this.videoTileController.removeVideoTilesByAttendeeId(e);return this.trace("removeVideoTilesByAttendeeId",e,t),t}removeAllVideoTiles(){this.videoTileController.removeAllVideoTiles(),this.trace("removeAllVideoTiles")}captureVideoTile(e){let t=this.videoTileController.captureVideoTile(e);return this.trace("captureVideoTile",e),t}realtimeSubscribeToAttendeeIdPresence(e){this.realtimeController.realtimeSubscribeToAttendeeIdPresence(e),this.trace("realtimeSubscribeToAttendeeIdPresence")}realtimeUnsubscribeToAttendeeIdPresence(e){this.realtimeController.realtimeUnsubscribeToAttendeeIdPresence(e),this.trace("realtimeUnsubscribeToAttendeeIdPresence")}realtimeSetCanUnmuteLocalAudio(e){this.realtimeController.realtimeSetCanUnmuteLocalAudio(e),this.trace("realtimeSetCanUnmuteLocalAudio",e)}realtimeSubscribeToSetCanUnmuteLocalAudio(e){this.realtimeController.realtimeSubscribeToSetCanUnmuteLocalAudio(e),this.trace("realtimeSubscribeToSetCanUnmuteLocalAudio")}realtimeUnsubscribeToSetCanUnmuteLocalAudio(e){this.realtimeController.realtimeUnsubscribeToSetCanUnmuteLocalAudio(e),this.trace("realtimeUnsubscribeToSetCanUnmuteLocalAudio")}realtimeCanUnmuteLocalAudio(){let e=this.realtimeController.realtimeCanUnmuteLocalAudio();return this.trace("realtimeCanUnmuteLocalAudio",null,e),e}realtimeMuteLocalAudio(){this.realtimeController.realtimeMuteLocalAudio(),this.trace("realtimeMuteLocalAudio")}realtimeUnmuteLocalAudio(){let e=this.realtimeController.realtimeUnmuteLocalAudio();return this.trace("realtimeUnmuteLocalAudio"),e}realtimeSubscribeToMuteAndUnmuteLocalAudio(e){this.realtimeController.realtimeSubscribeToMuteAndUnmuteLocalAudio(e),this.trace("realtimeSubscribeToMuteAndUnmuteLocalAudio")}realtimeUnsubscribeToMuteAndUnmuteLocalAudio(e){this.realtimeController.realtimeUnsubscribeToMuteAndUnmuteLocalAudio(e),this.trace("realtimeUnsubscribeToMuteAndUnmuteLocalAudio")}realtimeIsLocalAudioMuted(){let e=this.realtimeController.realtimeIsLocalAudioMuted();return this.trace("realtimeIsLocalAudioMuted"),e}realtimeSubscribeToVolumeIndicator(e,t){this.realtimeController.realtimeSubscribeToVolumeIndicator(e,t),this.trace("realtimeSubscribeToVolumeIndicator",e)}realtimeUnsubscribeFromVolumeIndicator(e,t){this.realtimeController.realtimeUnsubscribeFromVolumeIndicator(e,t),this.trace("realtimeUnsubscribeFromVolumeIndicator",e,t)}realtimeSubscribeToLocalSignalStrengthChange(e){this.realtimeController.realtimeSubscribeToLocalSignalStrengthChange(e),this.trace("realtimeSubscribeToLocalSignalStrengthChange")}realtimeUnsubscribeToLocalSignalStrengthChange(e){this.realtimeController.realtimeUnsubscribeToLocalSignalStrengthChange(e),this.trace("realtimeUnsubscribeToLocalSignalStrengthChange")}realtimeSendDataMessage(e,t,i){this.realtimeController.realtimeSendDataMessage(e,t,i),this.trace("realtimeSendDataMessage")}realtimeSubscribeToReceiveDataMessage(e,t){this.realtimeController.realtimeSubscribeToReceiveDataMessage(e,t),this.trace("realtimeSubscribeToReceiveDataMessage")}realtimeUnsubscribeFromReceiveDataMessage(e){this.realtimeController.realtimeUnsubscribeFromReceiveDataMessage(e),this.trace("realtimeUnsubscribeFromReceiveDataMessage")}realtimeSubscribeToFatalError(e){this.realtimeController.realtimeSubscribeToFatalError(e),this.trace("realtimeSubscribeToFatalError")}realtimeUnsubscribeToFatalError(e){this.realtimeController.realtimeUnsubscribeToFatalError(e),this.trace("realtimeUnsubscribeToFatalError")}subscribeToActiveSpeakerDetector(e,t,i,n){this.audioVideoController.activeSpeakerDetector.subscribe(e,t,i,n),this.trace("subscribeToActiveSpeakerDetector")}unsubscribeFromActiveSpeakerDetector(e){this.audioVideoController.activeSpeakerDetector.unsubscribe(e),this.trace("unsubscribeFromActiveSpeakerDetector")}listAudioInputDevices(e=!1){return n(this,void 0,void 0,function*(){let t=yield this.deviceController.listAudioInputDevices(e);return this.trace("listAudioInputDevices",e,t),t})}listVideoInputDevices(e=!1){return n(this,void 0,void 0,function*(){let t=yield this.deviceController.listVideoInputDevices(e);return this.trace("listVideoInputDevices",e,t),t})}listAudioOutputDevices(e=!1){return n(this,void 0,void 0,function*(){let t=yield this.deviceController.listAudioOutputDevices(e);return this.trace("listAudioOutputDevices",e,t),t})}startAudioInput(e){return n(this,void 0,void 0,function*(){return this.trace("startAudioInput",e),this.deviceController.startAudioInput(e)})}stopAudioInput(){return n(this,void 0,void 0,function*(){return this.trace("stopAudioInput"),this.deviceController.stopAudioInput()})}startVideoInput(e){return n(this,void 0,void 0,function*(){return r.isVideoTransformDevice(e)?this.trace("startVideoInput with transform device"):this.trace("startVideoInput",e),this.deviceController.startVideoInput(e)})}stopVideoInput(){return n(this,void 0,void 0,function*(){return this.trace("stopVideoInput"),this.deviceController.stopVideoInput()})}chooseAudioOutput(e){let t=this.deviceController.chooseAudioOutput(e);return this.trace("chooseAudioOutput",e),t}addDeviceChangeObserver(e){this.deviceController.addDeviceChangeObserver(e),this.trace("addDeviceChangeObserver")}removeDeviceChangeObserver(e){this.deviceController.removeDeviceChangeObserver(e),this.trace("removeDeviceChangeObserver")}createAnalyserNodeForAudioInput(){let e=this.deviceController.createAnalyserNodeForAudioInput();return this.trace("createAnalyserNodeForAudioInput"),e}startVideoPreviewForVideoInput(e){this.deviceController.startVideoPreviewForVideoInput(e),this.trace("startVideoPreviewForVideoInput",e.id)}stopVideoPreviewForVideoInput(e){this.deviceController.stopVideoPreviewForVideoInput(e),this.trace("stopVideoPreviewForVideoInput",e.id)}setDeviceLabelTrigger(e){this.deviceController.setDeviceLabelTrigger(e),this.trace("setDeviceLabelTrigger")}mixIntoAudioInput(e){let t=this.deviceController.mixIntoAudioInput(e);return this.trace("mixIntoAudioInput",e.id),t}chooseVideoInputQuality(e,t,i){this.deviceController.chooseVideoInputQuality(e,t,i),this.trace("chooseVideoInputQuality",{width:e,height:t,frameRate:i})}setVideoMaxBandwidthKbps(e){this.audioVideoController.setVideoMaxBandwidthKbps(e),this.trace("setVideoMaxBandwidthKbps",e)}setVideoCodecSendPreferences(e){this.audioVideoController.setVideoCodecSendPreferences(e),this.trace("setVideoCodecSendPreferences",e)}getVideoInputQualitySettings(){let e=this.deviceController.getVideoInputQualitySettings();return this.trace("getVideoInputQualitySettings"),e}setContentAudioProfile(e){this.trace("setContentAudioProfile",e),this.contentShareController.setContentAudioProfile(e)}enableSimulcastForContentShare(e,t){this.trace("enableSimulcastForContentShare"),this.contentShareController.enableSimulcastForContentShare(e,t)}enableSVCForContentShare(e){this.trace("enableSVCForContentShare"),this.contentShareController.enableSVCForContentShare(e)}startContentShare(e){let t=this.contentShareController.startContentShare(e);return this.trace("startContentShare"),t}startContentShareFromScreenCapture(e,t){let i=this.contentShareController.startContentShareFromScreenCapture(e,t);return this.trace("startContentShareFromScreenCapture"),i}pauseContentShare(){this.contentShareController.pauseContentShare(),this.trace("pauseContentShare")}unpauseContentShare(){this.contentShareController.unpauseContentShare(),this.trace("unpauseContentShare")}stopContentShare(){this.contentShareController.stopContentShare(),this.trace("stopContentShare")}addContentShareObserver(e){this.contentShareController.addContentShareObserver(e),this.trace("addContentShareObserver")}removeContentShareObserver(e){this.contentShareController.removeContentShareObserver(e),this.trace("removeContentShareObserver")}setContentShareVideoCodecPreferences(e){this.contentShareController.setContentShareVideoCodecPreferences(e),this.trace("setContentShareVideoCodecPreferences")}trace(e,t,i){let n=this.audioVideoController.configuration.meetingId,r=this.audioVideoController.configuration.credentials.attendeeId,s=`API/DefaultAudioVideoFacade/${n}/${r}/${e}`;void 0!==t&&(s+=` ${JSON.stringify(t)}`),void 0!==i&&(s+=` -> ${JSON.stringify(i)}`),this.audioVideoController.logger.info(s)}getRemoteVideoSources(){let e=this.audioVideoController.getRemoteVideoSources();return this.trace("getRemoteVideoSources",null,e),e}get transcriptionController(){return this.realtimeController.transcriptionController}promoteToPrimaryMeeting(e){this.audioVideoController.removeObserver(this),this.audioVideoController.addObserver(this);let t=this.audioVideoController.promoteToPrimaryMeeting(e);return this.trace("promoteToPrimaryMeeting",null,t),t}demoteFromPrimaryMeeting(){this.trace("demoteFromPrimaryMeeting"),this.audioVideoController.demoteFromPrimaryMeeting()}audioVideoWasDemotedFromPrimaryMeeting(e){this.contentShareController.stopContentShare(),this.audioVideoController.removeObserver(this)}}t.default=s},51184:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=r(i(22669)),o=i(28434);class a extends s.default{constructor(e,t){super(e,t),this.blurCanvas=document.createElement("canvas"),this.blurCanvasCtx=this.blurCanvas.getContext("2d"),this.blurCanvas.width=this.spec.model.input.width,this.blurCanvas.height=this.spec.model.input.height,this.logger.info("BackgroundBlur processor using builtin blur")}drawImageWithMask(e,t){let i=this.blurredImage,{canvasCtx:n,targetCanvas:r}=this,{width:s,height:o}=r;if(!t||!i){n.clearRect(0,0,s,o);return}this.scaledCanvas.getContext("2d").putImageData(t,0,0),this.blurCanvasCtx.putImageData(this.blurredImage,0,0),n.save(),n.clearRect(0,0,s,o),n.drawImage(this.scaledCanvas,0,0,s,o),n.globalCompositeOperation="source-in",n.drawImage(e,0,0,s,o),n.globalCompositeOperation="destination-over",n.drawImage(this.blurCanvas,0,0,s,o),n.restore()}setBlurStrength(e){if(super.setBlurStrength(e),this.worker){this.modelInitialized=!1,this.worker.postMessage({msg:"destroy"});let e=this.spec.model;this.worker.postMessage({msg:"loadModel",payload:{modelUrl:e.path,inputHeight:e.input.height,inputWidth:e.input.width,inputChannels:4,modelRangeMin:e.input.range[0],modelRangeMax:e.input.range[1],blurPixels:this.blurAmount}})}}setBlurPixels(){this.blurAmount=o.BlurStrengthMapper.getBlurAmount(this._blurStrength,{height:540}),this.logger.info(`background blur amount set to ${this.blurAmount}`)}handleInitialize(e){if(this.logger.info(`received initialize message: ${this.stringify(e)}`),!e.payload){this.logger.error("failed to initialize module"),this.initWorkerPromise.reject(Error("failed to initialize the module"));return}let t=this.spec.model;this.worker.postMessage({msg:"loadModel",payload:{modelUrl:t.path,inputHeight:t.input.height,inputWidth:t.input.width,inputChannels:4,modelRangeMin:t.input.range[0],modelRangeMax:t.input.range[1],blurPixels:this.blurAmount}}),this.initWorkerPromise.resolve({})}handlePredict(e){this.blurredImage=e.payload.blurOutput,super.handlePredict(e)}destroy(){var e;let t=Object.create(null,{destroy:{get:()=>super.destroy}});return n(this,void 0,void 0,function*(){t.destroy.call(this),null===(e=this.blurCanvas)||void 0===e||e.remove(),this.blurCanvas=void 0})}}t.default=a},22669:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=r(i(20744)),o=i(28434),a=r(i(41164));class l extends s.default{constructor(e,t){super("background blur",e,t,new a.default),this.blurAmount=0,this.setBlurStrength(t.blurStrength),this.logger.info("BackgroundBlur processor successfully created"),this.logger.info(`BackgroundBlur spec: ${this.stringify(this.spec)}`),this.logger.info(`BackgroundBlur options: ${this.stringify(t)}`)}validateOptions(e){if(super.validateOptions(e),!e.blurStrength)throw Error("processor has null options - blurStrength")}initOnFirstExecution(){this.setBlurPixels()}drawImageWithMask(e,t){t||(t=new ImageData(this.spec.model.input.width,this.spec.model.input.height)),this.scaledCanvas.getContext("2d").putImageData(t,0,0);let{canvasCtx:i,targetCanvas:n}=this,{width:r,height:s}=n;i.save(),i.clearRect(0,0,r,s),i.drawImage(this.scaledCanvas,0,0,r,s),i.globalCompositeOperation="source-in",i.drawImage(e,0,0,r,s),i.globalCompositeOperation="destination-over",i.filter=`blur(${this.blurAmount}px)`,i.drawImage(e,0,0,n.width,n.height),i.restore()}setBlurStrength(e){this._blurStrength=e,this.logger.info(`blur strength set to ${this._blurStrength}`),this.setBlurPixels()}setBlurPixels(){this.blurAmount=o.BlurStrengthMapper.getBlurAmount(this._blurStrength,{height:this.sourceHeight}),this.logger.info(`background blur amount set to ${this.blurAmount}`)}addObserver(e){this.delegate.addObserver(e)}removeObserver(e){this.delegate.removeObserver(e)}static isSupported(){return n(this,void 0,void 0,function*(){let e=document.createElement("canvas"),t=void 0!==e.getContext("2d").filter;return e.remove(),t})}setEventController(e){this.eventController?this.eventController=e:(this.eventController=e,this.publishBackgroundFilterEvent())}publishBackgroundFilterEvent(){let e={backgroundBlurEnabled:"true",backgroundBlurStrength:this._blurStrength,backgroundReplacementEnabled:"false",backgroundFilterVersion:1};this.eventController.publishEvent("backgroundFilterConfigSelected",e)}}t.default=l},28434:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BlurStrengthMapper=void 0;let i={LOW:7,MEDIUM:15,HIGH:30};class n{static getBlurAmount(e,t){if(e<=0)throw Error(`invalid value for blur strength: ${e}`);return Math.round(e*t.height/this.BLUR_STRENGTH_DIVISOR)}}t.BlurStrengthMapper=n,n.BLUR_STRENGTH_DIVISOR=540,t.default=i},3922:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=r(i(93318)),o=r(i(21302)),a=r(i(35711)),l=r(i(86349)),d=r(i(51184)),u=r(i(22669)),c=r(i(28434));class h extends l.default{setBlurStrength(){}loadAssets(){return n(this,void 0,void 0,function*(){})}addObserver(){}removeObserver(){}}class f extends s.default{static create(e,t){return n(this,void 0,void 0,function*(){let i;e=f.resolveSpec(e);let{logger:n}=t=f.resolveOptions(t),r=yield f.isSupported(e,t);return(n.info(`processor is ${r?"":"not"} supported`),r)?((yield u.default.isSupported())?(n.info("Using browser-provided background blur"),i=new u.default(e,t)):(n.info("Using built-in background blur"),i=new d.default(e,t)),yield i.loadAssets(),i):(n.warn("Using no-op processor because background blur is not supported"),new h)})}static resolveOptions(e={}){let t=Object.assign({},e);return t.blurStrength||(t.blurStrength=c.default.MEDIUM),t.logger||(t.logger=new o.default("BackgroundBlurProcessor",a.default.INFO)),t=super.resolveOptions(t)}static isSupported(e,t){return e=f.resolveSpec(e),t=f.resolveOptions(t),super.isSupported(e,t)}}t.default=f},41164:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let r=n(i(39909));class s extends r.default{}t.default=s},24906:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(){this.path=null,this.input=null,this.output=null}static builder(){return new i}withDefaultModel(){return this.withSelfieSegmentationDefaults()}withSelfieSegmentationDefaults(){let e={height:144,width:256,range:[0,1],channels:3},t={height:144,width:256,range:[0,1],channels:1},i="https://static.sdkassets.chime.aws/bgblur/models/selfie_segmentation_landscape.tflite";return this.path=i,this.input=e,this.output=t,this}withPath(e){return this.path=e,this}withInput(e){return this.input=e,this}withOutput(e){return this.output=e,this}validate(){if(!this.path)throw Error("model spec path is not set");if(!this.input)throw Error("model spec input is not set");if(!this.output)throw Error("model spec output is not set")}build(){return this.validate(),{path:this.path,input:this.input,output:this.output}}}t.default=i},71843:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let i=.8;class n{constructor(e,t,i,n){this.delegate=e,this.reportingPeriodMillis=t,this.filterCPUUtilization=i,this.logger=n,this._processingFilter=!0,this.lastReportedEventTimestamp=0,this.lastFilterCompleteTimestamp=0,this.filterTotalMillis=0,this.filterCount=0,this.framerate=0,this.filterDurationNotifyMillis=0,this.setSegmentationDuration()}reportEvent(e){let t=e-this.lastReportedEventTimestamp;if(t>=this.reportingPeriodMillis){let i=this.filterCount,n=this.filterTotalMillis;if(this.filterCount=0,this.filterTotalMillis=0,this.lastReportedEventTimestamp=e,0===this.framerate||0===i)return;let r=Math.round(n/i),s=Math.round(this.framerate*(t/1e3))-i,o=Math.round(100*n/t);r>=this.filterDurationNotifyMillis&&this.delegate.filterFrameDurationHigh({framesDropped:s,avgFilterDurationMillis:r,framerate:this.framerate,periodMillis:t}),o>=this.filterCPUUtilization&&this.delegate.filterCPUUtilizationHigh({cpuUtilization:o,filterMillis:n,periodMillis:t})}}setSegmentationDuration(){this.filterDurationNotifyMillis=Math.round(1e3/this.framerate*i)}frameReceived(e){e!==this.framerate&&(this.framerate=e,this.logger.info(`frame counter setting frame rate to ${this.framerate}`),this.setSegmentationDuration());let t=Date.now();this.reportEvent(t)}filterSubmitted(){this._processingFilter=!0,this.lastFilterCompleteTimestamp=Date.now()}filterComplete(){this.filterTotalMillis+=Date.now()-this.lastFilterCompleteTimestamp,this._processingFilter=!1,this.filterCount++}get processingSegment(){return this._processingFilter}}t.default=n},20744:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.BackgroundFilterMonitor=void 0;let s=i(71143),o=r(i(98400)),a=r(i(71843));class l{constructor(){this.value=void 0,this.resolve=null}whenNext(){return this.promise||(this.promise=new Promise(e=>this.resolve=e)),this.promise}next(e){this.value=e,this.resolve(e),delete this.promise}}class d{constructor(e,t,i,n,r){this.targetCanvas=document.createElement("canvas"),this.canvasCtx=this.targetCanvas.getContext("2d"),this.canvasVideoFrameBuffer=new o.default(this.targetCanvas),this.mask$=new l,this.sourceWidth=0,this.sourceHeight=0,this.frameNumber=0,this.videoFramesPerFilterUpdate=1,this.initWorkerPromise=d.createWorkerPromise(),this.loadModelPromise=d.createWorkerPromise(),this.modelInitialized=!1,this.destroyed=!1,this.filterType=e,this.validateSpec(t),this.validateOptions(i),this.spec=t,this.logger=i.logger,this.delegate=n,this.initCPUMonitor(i),this.eventController=r}static createWorkerPromise(){let e={resolve:null,reject:null,promise:null};return e.promise=new Promise((t,i)=>{e.resolve=t,e.reject=i}),e}validateSpec(e){if(!e)throw Error("processor has null spec");if(!e.model)throw Error("processor spec has null model");if(!e.paths)throw Error("processor spec has null paths")}validateOptions(e){if(!e)throw Error("processor has null options");if(!e.logger)throw Error("processor has null options - logger");if(!e.reportingPeriodMillis)throw Error("processor has null options - reportingPeriodMillis");if(!e.filterCPUUtilization)throw Error("processor has null options - filterCPUUtilization")}initCPUMonitor(e){let t=5e3,i=10,n=1;this.videoFramesPerFilterUpdate=1,this.frameCounter=new a.default(this.delegate,e.reportingPeriodMillis,e.filterCPUUtilization,this.logger),this.cpuMonitor=new u(t,{reduceCPUUtilization:()=>{this.updateVideoFramesPerFilterUpdate(Math.min(this.videoFramesPerFilterUpdate+1,i))},increaseCPUUtilization:()=>{this.updateVideoFramesPerFilterUpdate(Math.max(this.videoFramesPerFilterUpdate-1,n))}}),this.delegate.addObserver(this.cpuMonitor)}stringify(e){return JSON.stringify(e,null,2)}handleInitialize(e){if(this.logger.info(`received initialize message: ${this.stringify(e)}`),!e.payload){this.logger.error("failed to initialize module"),this.initWorkerPromise.reject(Error("failed to initialize the module"));return}let t=this.spec.model;this.worker.postMessage({msg:"loadModel",payload:{modelUrl:t.path,inputHeight:t.input.height,inputWidth:t.input.width,inputChannels:4,modelRangeMin:t.input.range[0],modelRangeMax:t.input.range[1],blurPixels:0}}),this.initWorkerPromise.resolve({})}handleLoadModel(e){if(this.logger.info(`received load model message: ${this.stringify(e)}`),2!==e.payload){this.logger.error("failed to load model! status: "+e.payload),this.loadModelPromise.reject(Error("failed to load model! status: "+e.payload));return}this.modelInitialized=!0,this.loadModelPromise.resolve({})}handlePredict(e){this.mask$.next(e.payload.output)}handleWorkerEvent(e){let t=e.data;switch(t.msg){case"initialize":this.handleInitialize(t);break;case"loadModel":this.handleLoadModel(t);break;case"predict":this.handlePredict(t);break;default:this.logger.info(`unexpected event msg: ${this.stringify(t)}`)}}loadAssets(){return n(this,void 0,void 0,function*(){this.logger.info("start initializing the processor");try{this.worker=yield s.loadWorker(this.spec.paths.worker,"BackgroundFilterWorker",{},null),this.worker.addEventListener("message",e=>this.handleWorkerEvent(e)),this.worker.postMessage({msg:"initialize",payload:{wasmPath:this.spec.paths.wasm,simdPath:this.spec.paths.simd}}),yield this.initWorkerPromise.promise,this.logger.info(`successfully initialized the ${this.filterType} worker`),yield this.loadModelPromise.promise,this.logger.info(`successfully loaded ${this.filterType} worker segmentation model`)}catch(e){throw Error(`could not initialize the ${this.filterType} video frame processor due to '${e.message}'`)}this.logger.info(`successfully initialized the ${this.filterType} processor`)})}process(e){return n(this,void 0,void 0,function*(){if(this.destroyed)return e;this.frameCounter.frameReceived(e[0].framerate),this.cpuMonitor.frameReceived();let t=e[0].asCanvasElement();if(!t)return e;if(!this.modelInitialized)return e[0]=this.canvasVideoFrameBuffer,e;let i=t.width,n=t.height;if(0===i||0===n)return e;0===this.sourceWidth&&(this.sourceWidth=i,this.sourceHeight=n,this.targetCanvas.width=this.sourceWidth,this.targetCanvas.height=this.sourceHeight,this.logger.info(`${this.filterType} source width: ${this.sourceWidth}`),this.logger.info(`${this.filterType} source height: ${this.sourceHeight}`),this.initOnFirstExecution()),(this.sourceWidth!==i||this.sourceHeight!==n)&&(this.sourceWidth=i,this.sourceHeight=n,this.targetCanvas.width=this.sourceWidth,this.targetCanvas.height=this.sourceHeight);try{this.frameCounter.filterSubmitted();let e=this.mask$.value,i=this.spec.model.input.width/t.width,n=this.spec.model.input.height/t.height;void 0===this.scaledCanvas&&(this.scaledCanvas=document.createElement("canvas"),this.scaledCanvas.width=this.spec.model.input.width,this.scaledCanvas.height=this.spec.model.input.height);let r=this.scaledCanvas.getContext("2d");r.save(),r.scale(i,n),r.drawImage(t,0,0),r.restore();let s=r.getImageData(0,0,this.scaledCanvas.width,this.scaledCanvas.height);if(this.frameNumber%this.videoFramesPerFilterUpdate==0){let t=this.mask$.whenNext();this.worker.postMessage({msg:"predict",payload:s},[s.data.buffer]),e=yield t}this.destroyed||this.drawImageWithMask(t,e)}catch(t){return this.logger.error(`could not process ${this.filterType} frame buffer due to ${t}`),e}finally{this.frameCounter.filterComplete(),this.frameNumber++}return e[0]=this.canvasVideoFrameBuffer,e})}updateVideoFramesPerFilterUpdate(e){e!==this.videoFramesPerFilterUpdate&&(this.videoFramesPerFilterUpdate=e,this.logger.info(`Adjusting filter rate to compensate for CPU utilization. Filter rate is ${this.videoFramesPerFilterUpdate} video frames per filter.`))}destroy(){var e,t,i,r;return n(this,void 0,void 0,function*(){this.destroyed=!0,this.delegate.removeObserver(this.cpuMonitor),this.canvasVideoFrameBuffer.destroy(),null===(e=this.worker)||void 0===e||e.postMessage({msg:"destroy"}),null===(t=this.worker)||void 0===t||t.postMessage({msg:"stop"}),null===(i=this.targetCanvas)||void 0===i||i.remove(),this.targetCanvas=void 0,null===(r=this.scaledCanvas)||void 0===r||r.remove(),this.scaledCanvas=void 0,this.logger.info(`${this.filterType} frame process destroyed`)})}}t.default=d;class u{constructor(e,t){this.monitoringPeriodMillis=e,this.observer=t,this.lastCPUChangeTimestamp=0}filterCPUUtilizationHigh(){let e=Date.now();e-this.lastCPUChangeTimestamp>=this.monitoringPeriodMillis&&(this.lastCPUChangeTimestamp=e,this.observer.reduceCPUUtilization())}frameReceived(){let e=Date.now();e-this.lastCPUChangeTimestamp>=2*this.monitoringPeriodMillis&&(this.lastCPUChangeTimestamp=e,this.observer.increaseCPUUtilization())}}t.BackgroundFilterMonitor=u},93318:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=i(71143),o=i(70085),a=r(i(24906)),l=r(i(81341)),d=r(i(29505)),u=()=>a.default.builder().withSelfieSegmentationDefaults().build(),c="https://static.sdkassets.chime.aws",h={worker:`${c}/bgblur/workers/worker.js`,wasm:`${c}/bgblur/wasm/_cwt-wasm.wasm`,simd:`${c}/bgblur/wasm/_cwt-wasm-simd.wasm`};class f{static defaultAssetSpec(){let e=d.default.sdkVersionSemVer;return{assetGroup:`sdk-${e.major}.${e.minor}`}}static createUrlWithParams(e,t){let i=new URL(e);for(let e of Object.keys(t))void 0!==t[e]&&i.searchParams.set(e,t[e]);return i.toString()}static resolveSpec(e){let{paths:t=h,model:i=u(),assetGroup:n=this.defaultAssetSpec().assetGroup,revisionID:r=this.defaultAssetSpec().revisionID}=e||{},s={assetGroup:n,revisionID:r,sdk:encodeURIComponent(d.default.sdkVersion),ua:encodeURIComponent(d.default.sdkUserAgentLowResolution)};return t.worker=this.createUrlWithParams(t.worker,s),t.wasm=this.createUrlWithParams(t.wasm,s),t.simd=this.createUrlWithParams(t.simd,s),i.path=this.createUrlWithParams(i.path,s),{paths:t,model:i,assetGroup:n,revisionID:r}}static resolveOptions(e){e.reportingPeriodMillis||(e.reportingPeriodMillis=1e3);let t=30;return e.filterCPUUtilization?(e.filterCPUUtilization<0||e.filterCPUUtilization>100)&&(e.logger.warn(`filterCPUUtilization must be set to a range between 0 and 100 percent. Falling back to default of ${t} percent`),e.filterCPUUtilization=t):e.filterCPUUtilization=t,e}static isSupported(e,t){let{logger:i}=t;return"undefined"==typeof globalThis?(i.info("Browser does not have globalThis."),Promise.resolve(!1)):new l.default().supportsBackgroundFilter()?o.supportsWASM(globalThis,i)?this.supportsBackgroundFilter(globalThis,e,i):(i.info("Browser does not support WASM."),Promise.resolve(!1)):(i.info("Browser is not supported."),Promise.resolve(!1))}static supportsBackgroundFilter(e=globalThis,t,i){return n(this,void 0,void 0,function*(){if(!o.supportsWorker(e,i))return i.info("Browser does not support web workers."),!1;let n=t.paths.worker;try{let e=yield s.loadWorker(n,"BackgroundFilterWorker",{},null);try{e.terminate()}catch(e){i.info(`Failed to terminate worker. ${e.message}`)}return!0}catch(e){return i.info(`Failed to fetch and instantiate test worker ${e.message}`),!1}})}}t.default=f},39909:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(){this.observers=new Set}addObserver(e){this.observers.add(e)}removeObserver(e){this.observers.delete(e)}filterFrameDurationHigh(e){var t;for(let i of this.observers)null===(t=i.filterFrameDurationHigh)||void 0===t||t.call(i,e)}filterCPUUtilizationHigh(e){var t;for(let i of this.observers)null===(t=i.filterCPUUtilizationHigh)||void 0===t||t.call(i,e)}}t.default=i},12010:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=r(i(20744)),o=r(i(14010));class a extends s.default{constructor(e,t){super("background replacement",e,t,new o.default),this.replacementBlob=t.imageBlob,this.logger.info("BackgroundReplacement processor successfully created"),this.logger.info(`BackgroundReplacement spec: ${this.stringify(this.spec)}`),this.logger.info(`BackgroundReplacement options: ${this.stringify(t)}`)}setImageBlob(e){return n(this,void 0,void 0,function*(){this.replacementBlob=e,this.replacementImage=yield a.loadImage(this.createReplacementObjectUrl())})}initOnFirstExecution(){}drawImageWithMask(e,t){t||(t=new ImageData(this.spec.model.input.width,this.spec.model.input.height)),this.scaledCanvas.getContext("2d").putImageData(t,0,0);let{canvasCtx:i,targetCanvas:n}=this,{width:r,height:s}=n;i.save(),i.clearRect(0,0,r,s),i.drawImage(this.scaledCanvas,0,0,r,s),i.globalCompositeOperation="source-in",i.drawImage(e,0,0,r,s),i.globalCompositeOperation="destination-over",i.drawImage(this.replacementImage,0,0,n.width,n.height),i.restore()}static loadImageExecutor(e,t,i){let n=new Image;n.crossOrigin="Anonymous",n.addEventListener("load",()=>{e(n)},!1),n.addEventListener("error",e=>{t(Error(`Could not load replacement image ${n.src}: ${e.message}`))},!1),n.src=i}static loadImage(e){return n(this,void 0,void 0,function*(){return new Promise((t,i)=>this.loadImageExecutor(t,i,e))})}revokeReplacementObjectUrl(){this.replacementObjectUrl&&URL.revokeObjectURL(this.replacementObjectUrl)}createReplacementObjectUrl(){return this.revokeReplacementObjectUrl(),this.replacementObjectUrl=URL.createObjectURL(this.replacementBlob),this.replacementObjectUrl}loadAssets(){let e=Object.create(null,{loadAssets:{get:()=>super.loadAssets}});return n(this,void 0,void 0,function*(){this.replacementImage=yield a.loadImage(this.createReplacementObjectUrl()),e.loadAssets.call(this)})}addObserver(e){this.delegate.addObserver(e)}removeObserver(e){this.delegate.removeObserver(e)}destroy(){let e=Object.create(null,{destroy:{get:()=>super.destroy}});return n(this,void 0,void 0,function*(){e.destroy.call(this),this.revokeReplacementObjectUrl()})}setEventController(e){this.eventController?this.eventController=e:(this.eventController=e,this.publishBackgroundFilterEvent())}publishBackgroundFilterEvent(){let e={backgroundBlurEnabled:"false",backgroundBlurStrength:"low",backgroundReplacementEnabled:"true",backgroundFilterVersion:1};this.eventController.publishEvent("backgroundFilterConfigSelected",e)}}t.default=a},12011:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=r(i(93318)),o=r(i(21302)),a=r(i(35711)),l=r(i(86349)),d=r(i(12010));class u extends l.default{loadAssets(){return n(this,void 0,void 0,function*(){})}addObserver(){}removeObserver(){}setImageBlob(){return n(this,void 0,void 0,function*(){})}}class c extends s.default{static create(e,t){return n(this,void 0,void 0,function*(){e=this.resolveSpec(e),t=this.resolveOptions(t),yield this.resolveOptionsAsync(t);let{logger:i}=t;if(!(yield c.isSupported(e,t)))return i.warn("Using no-op processor because background replacement is not supported"),new u;i.info("Using background replacement filter");let n=new d.default(e,t);return yield n.loadAssets(),n})}static resolveOptions(e={}){let t=Object.assign({},e);return t.logger||(t.logger=new o.default("BackgroundReplacementProcessor",a.default.INFO)),super.resolveOptions(t)}static resolveOptionsAsync(e){return n(this,void 0,void 0,function*(){if(!e.imageBlob){let t=document.createElement("canvas");t.width=100,t.height=100;let i=t.getContext("2d");i.fillStyle="blue",i.fillRect(0,0,100,100);let n=yield new Promise(e=>{t.toBlob(e)});e.imageBlob=n}})}static isSupported(e,t){let i=Object.create(null,{isSupported:{get:()=>super.isSupported}});return n(this,void 0,void 0,function*(){e=this.resolveSpec(e),t=this.resolveOptions(t),yield this.resolveOptionsAsync(t);let n=t.imageBlob,r=URL.createObjectURL(n);try{yield d.default.loadImage(r)}catch(e){return t.logger.info(`Failed to fetch load replacement image ${e.message}`),!1}finally{URL.revokeObjectURL(r)}return i.isSupported.call(this,e,t)})}}t.default=c},14010:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let r=n(i(39909));class s extends r.default{}t.default=s},2739:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(e,t,i){this.fixedWaitMs=e,this.shortBackoffMs=t,this.longBackoffMs=i,this.currentRetry=0,this.fixedWaitMs<0&&(this.fixedWaitMs=0),this.shortBackoffMs<0&&(this.shortBackoffMs=0),this.longBackoffMs<0&&(this.longBackoffMs=0),this.reset()}reset(){this.currentRetry=0}nextBackoffAmountMs(){let e=Math.random()*Math.min(this.longBackoffMs,this.shortBackoffMs*Math.pow(2,this.currentRetry))+this.fixedWaitMs;return this.currentRetry+=1,e}}t.default=i},1377:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let r=n(i(2739)),s=n(i(89395));class o{constructor(e,t,i){this.fixedWaitMs=e,this.shortBackoffMs=t,this.longBackoffMs=i}create(){return new r.default(this.fixedWaitMs,this.shortBackoffMs,this.longBackoffMs)}createWithLimit(e){return new s.default(this.fixedWaitMs,this.shortBackoffMs,this.longBackoffMs,e)}}t.default=o},89395:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let r=n(i(2739));class s extends r.default{constructor(e,t,i,n){super(e,t,i),this.limit=n,this.attempts=0}nextBackoffAmountMs(){if(this.attempts++,this.attempts>this.limit)throw Error("retry limit exceeded");return super.nextBackoffAmountMs()}}t.default=s},81341:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});let r=i(52159),s=i(26088);class o{constructor(){this.FALLBACK_BROWSER={type:"browser",name:"unknown",version:"unknown",os:"unknown"},this.browser=r.detect()||this.FALLBACK_BROWSER,this.uaParserResult=navigator&&navigator.userAgent?new s.UAParser(navigator.userAgent).getResult():null,this.browserSupport={chrome:78,"edge-chromium":79,electron:7,firefox:75,ios:13,safari:13,opera:66,samsung:12,crios:86,fxios:23,"ios-webview":605,"chromium-webview":92},this.browserName={chrome:"Google Chrome","edge-chromium":"Microsoft Edge",electron:"Electron",firefox:"Mozilla Firefox",ios:"Safari iOS",safari:"Safari",opera:"Opera",samsung:"Samsung Internet",crios:"Chrome iOS",fxios:"Firefox iOS","ios-webview":"WKWebView iOS","chromium-webview":"Chrome WebView"},this.chromeLike=["chrome","edge-chromium","chromium-webview","opera","samsung"],this.webkitBrowsers=["crios","fxios","safari","ios","ios-webview","edge-ios"]}version(){return this.browser.version}majorVersion(){return null!==this.version()?parseInt(this.version().split(".")[0]):-1}osMajorVersion(){return parseInt(this.uaParserResult.os.version.split(".")[0])}engine(){return this.uaParserResult.engine.name}engineMajorVersion(){return parseInt(this.uaParserResult.engine.version.split(".")[0])}name(){return this.browser.name}hasChromiumWebRTC(){for(let e of this.chromeLike)if(e===this.browser.name)return!0;return!1}hasWebKitWebRTC(){for(let e of this.webkitBrowsers)if(e===this.browser.name)return!0;return!1}hasFirefoxWebRTC(){return this.isFirefox()}requiresPlaybackLatencyHintForAudioContext(){return -1!==navigator.userAgent.indexOf("Windows")}supportsCanvasCapturedStreamPlayback(){return!this.isIOSSafari()&&!this.isIOSChrome()&&!this.isIOSFirefox()&&!this.isIOSEdge()||this.isIOSSafari()&&this.majorVersion()>=o.MIN_IOS_SUPPORT_CANVAS_STREAM_PLAYBACK||this.majorVersion()>=o.MIN_IOS_NON_SAFARI_SUPPORT_CANVAS_STREAM_PLAYBACK}supportsBackgroundFilter(){return!!(("safari"!==this.name()||15!==this.majorVersion())&&this.supportsCanvasCapturedStreamPlayback())}supportsVideoLayersAllocationRtpHeaderExtension(){return this.hasChromiumWebRTC()}supportsDependencyDescriptorRtpHeaderExtension(){return this.hasChromiumWebRTC()}supportsScalableVideoCoding(){return this.hasChromiumWebRTC()&&"Blink"===this.engine()&&this.engineMajorVersion()>=111}supportsAudioRedundancy(){return this.hasChromiumWebRTC()?this.engineMajorVersion()>=107:!this.hasFirefoxWebRTC()}requiresResolutionAlignment(e,t){return this.isAndroid()&&this.isPixel3()?[64*Math.ceil(e/64),64*Math.ceil(t/64)]:[e,t]}requiresCheckForSdpConnectionAttributes(){return!this.isIOSSafari()&&!this.isIOSChrome()&&!this.isIOSFirefox()}requiresIceCandidateGatheringTimeoutWorkaround(){return this.hasChromiumWebRTC()}requiresBundlePolicy(){return"max-bundle"}requiresNoExactMediaStreamConstraints(){return this.isSamsungInternet()}requiresGroupIdMediaStreamConstraints(){return this.isSamsungInternet()}getDisplayMediaAudioCaptureSupport(){return this.isChrome()||this.isEdge()}doesNotSupportMediaDeviceLabels(){return"chromium-webview"===this.browser.name}isSupported(){return!(!this.browserSupport[this.browser.name]||this.majorVersion()<this.browserSupport[this.browser.name]||"firefox"===this.browser.name&&this.isAndroid())}isSimulcastSupported(){return this.hasChromiumWebRTC()}supportDownlinkBandwidthEstimation(){return!this.isFirefox()}supportString(){if(this.isAndroid())return`${this.browserName.chrome} ${this.browserSupport.chrome}+, ${this.browserName.samsung} ${this.browserSupport.samsung}+`;let e=[];for(let t in this.browserSupport)e.push(`${this.browserName[t]} ${this.browserSupport[t]}+`);return e.join(", ")}supportedVideoCodecs(){return n(this,void 0,void 0,function*(){let e=new RTCPeerConnection;return e.addTransceiver("video",{direction:"inactive",streams:[]}),(yield e.createOffer({offerToReceiveVideo:!0})).sdp.split("\r\n").filter(e=>e.includes("a=rtpmap:")).map(e=>e.replace(/.* /,"").replace(/\/.*/,"")).filter((e,t,i)=>i.indexOf(e)===t).filter(e=>"rtx"!==e&&"red"!==e&&"ulpfec"!==e)})}supportsSetSinkId(){return"setSinkId"in HTMLAudioElement.prototype}disableResolutionScaleDown(){return this.isAndroid()}disable480pResolutionScaleDown(){return/( Chrome\/98\.)/i.test(navigator.userAgent)&&this.browser.os.startsWith("Windows")}requiresDisablingH264Encoding(){return(this.isIOSSafari()||this.isIOSChrome()||this.isIOSFirefox())&&("15.1.0"===this.version()||/( OS 15_1)/i.test(navigator.userAgent))}requiresVideoPlayWorkaround(){return this.isSafari()}isVideoFxSupportedBrowser(){return this.supportsBackgroundFilter()}isIOSSafari(){return"ios"===this.browser.name||"ios-webview"===this.browser.name||"safari"===this.browser.name&&/( Mac )/i.test(navigator.userAgent)&&navigator.maxTouchPoints>1}isSafari(){return"safari"===this.browser.name||this.isIOSSafari()}isFirefox(){return"firefox"===this.browser.name}isIOSFirefox(){return"fxios"===this.browser.name}isIOSChrome(){return"crios"===this.browser.name}isChrome(){return"chrome"===this.browser.name}isEdge(){return"edge-chromium"===this.browser.name}isIOSEdge(){return"edge-ios"===this.browser.name}isSamsungInternet(){return"samsung"===this.browser.name}isAndroid(){return/(android)/i.test(navigator.userAgent)}isPixel3(){return/( pixel 3)/i.test(navigator.userAgent)}}t.default=o,o.MIN_IOS_SUPPORT_CANVAS_STREAM_PLAYBACK=16,o.MIN_IOS_NON_SAFARI_SUPPORT_CANVAS_STREAM_PLAYBACK=106},28439:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let r=i(39163),s=n(i(89496)),o=n(i(57192)),a=n(i(30928));class l{constructor(e,t,i){this.logger=e,this.videoStreamIndex=t,this.selfAttendeeId=i,this.globalMetricReport=new a.default,this.streamMetricReports={},this.rtcStatsReport={},this.customStatsReports=[],this.currentTimestampMs=0,this.previousTimestampMs=0,this.currentSsrcs={},this.overriddenObservableMetrics=new Map,this.identityValue=(e,t)=>Number((t?this.streamMetricReports[t]:this.globalMetricReport).currentMetrics[e]),this.decoderLossPercent=(e,t)=>{let i=this.streamMetricReports[t],n=i.currentMetrics.concealedSamples-(i.previousMetrics.concealedSamples||0),r=i.currentMetrics.totalSamplesReceived-(i.previousMetrics.totalSamplesReceived||0);return r<=0||r-n<=0?0:n/r*100},this.packetLossPercent=(e,t)=>{let i=this.streamMetricReports[t],n=i.currentMetrics[e]-(i.previousMetrics[e]||0),r=i.currentMetrics.packetsLost-(i.previousMetrics.packetsLost||0),s=n+r;return s<=0||r<=0?0:100*r/s},this.jitterBufferMs=(e,t)=>{let i=this.streamMetricReports[t],n=i.currentMetrics.jitterBufferDelay-(i.previousMetrics.jitterBufferDelay||0),r=i.currentMetrics.jitterBufferEmittedCount-(i.previousMetrics.jitterBufferEmittedCount||0);return n<=0||r<=0?0:n/r*1e3},this.countPerSecond=(e,t)=>{let i=t?this.streamMetricReports[t]:this.globalMetricReport,n=(this.currentTimestampMs-this.previousTimestampMs)/1e3;if(n<=0)return 0;this.previousTimestampMs<=0&&(n=1);let r=i.currentMetrics[e]-(i.previousMetrics[e]||0);return r<=0?0:Math.trunc(r/n)},this.bitsPerSecond=(e,t)=>{let i=t?this.streamMetricReports[t]:this.globalMetricReport,n=(this.currentTimestampMs-this.previousTimestampMs)/1e3;if(n<=0)return 0;this.previousTimestampMs<=0&&(n=1);let r=(i.currentMetrics[e]-(i.previousMetrics[e]||0))*8;return r<=0?0:Math.trunc(r/n)},this.secondsToMilliseconds=(e,t)=>Number(1e3*(t?this.streamMetricReports[t]:this.globalMetricReport).currentMetrics[e]),this.averageTimeSpentPerSecondInMilliseconds=(e,t)=>{let i=t?this.streamMetricReports[t]:this.globalMetricReport,n=(this.currentTimestampMs-this.previousTimestampMs)/1e3;if(n<=0)return 0;this.previousTimestampMs<=0&&(n=1);let r=i.currentMetrics[e]-(i.previousMetrics[e]||0);return r<=0?0:1e3*r/n},this.averageCpuQualityLimitationDurationPerSecondInMilliseconds=(e,t)=>{let i=this.streamMetricReports[t],n=(this.currentTimestampMs-this.previousTimestampMs)/1e3;if(n<=0)return 0;this.previousTimestampMs<=0&&(n=1);let r=0,s=0;for(let[t,n]of Object.entries(i.previousObjectMetrics[e]))"cpu"===t&&(r=n);for(let[t,n]of Object.entries(i.currentObjectMetrics[e]))"cpu"===t&&(s=n);let o=s-r;return o<=0?0:1e3*o/n},this.isHardwareImplementation=(e,t)=>{let i=String(this.streamMetricReports[t].currentStringMetrics[e]),n=i.includes("ExternalDecoder")||i.includes("ExternalEncoder")||i.includes("EncodeAccelerator")||i.includes("DecodeAccelerator"),r=i.includes("fallback from");return n&&!r?1:0},this.globalMetricMap={retransmittedBytesSent:{transform:this.identityValue,type:r.SdkMetric.Type.VIDEO_RETRANSMIT_BITRATE},totalEncodedBytesTarget:{transform:this.identityValue,type:r.SdkMetric.Type.VIDEO_TARGET_ENCODER_BITRATE},totalPacketSendDelay:{transform:this.identityValue,type:r.SdkMetric.Type.VIDEO_BUCKET_DELAY_MS},packetsDiscardedOnSend:{transform:this.countPerSecond,type:r.SdkMetric.Type.SOCKET_DISCARDED_PPS},availableIncomingBitrate:{transform:this.identityValue,type:r.SdkMetric.Type.VIDEO_AVAILABLE_RECEIVE_BANDWIDTH},availableOutgoingBitrate:{transform:this.identityValue,type:r.SdkMetric.Type.VIDEO_AVAILABLE_SEND_BANDWIDTH},currentRoundTripTime:{transform:this.secondsToMilliseconds,type:r.SdkMetric.Type.STUN_RTT_MS},audioLevel:{transform:this.identityValue,type:r.SdkMetric.Type.RTC_MIC_AUDIO_LEVEL,source:"audioLevel"}},this.audioUpstreamMetricMap={jitter:{transform:this.secondsToMilliseconds,type:r.SdkMetric.Type.RTC_MIC_JITTER_MS},packetsSent:{transform:this.countPerSecond,type:r.SdkMetric.Type.RTC_MIC_PPS},bytesSent:{transform:this.bitsPerSecond,type:r.SdkMetric.Type.RTC_MIC_BITRATE},roundTripTime:{transform:this.secondsToMilliseconds,type:r.SdkMetric.Type.RTC_MIC_RTT_MS},packetsLost:{transform:this.packetLossPercent,type:r.SdkMetric.Type.RTC_MIC_FRACTION_PACKET_LOST_PERCENT,source:"packetsSent"}},this.audioDownstreamMetricMap={concealedSamples:{transform:this.countPerSecond},totalSamplesReceived:{transform:this.countPerSecond},decoderLoss:{transform:this.decoderLossPercent,type:r.SdkMetric.Type.RTC_SPK_FRACTION_DECODER_LOSS_PERCENT},packetsReceived:{transform:this.countPerSecond,type:r.SdkMetric.Type.RTC_SPK_PPS},packetsLost:{transform:this.packetLossPercent,type:r.SdkMetric.Type.RTC_SPK_FRACTION_PACKET_LOST_PERCENT,source:"packetsReceived"},jitter:{transform:this.secondsToMilliseconds,type:r.SdkMetric.Type.RTC_SPK_JITTER_MS},jitterBufferDelay:{transform:this.countPerSecond},jitterBufferEmittedCount:{transform:this.countPerSecond},jitterBufferMs:{transform:this.jitterBufferMs,type:r.SdkMetric.Type.RTC_SPK_JITTER_BUFFER_MS},bytesReceived:{transform:this.bitsPerSecond,type:r.SdkMetric.Type.RTC_SPK_BITRATE},audioLevel:{transform:this.identityValue,type:r.SdkMetric.Type.RTC_SPK_AUDIO_LEVEL},totalAudioPacketsLost:{transform:this.identityValue,type:r.SdkMetric.Type.RTC_SPK_TOTAL_LOST},totalAudioPacketsExpected:{transform:this.identityValue,type:r.SdkMetric.Type.RTC_SPK_TOTAL_EXPECTED},totalAudioPacketsRecoveredRed:{transform:this.identityValue,type:r.SdkMetric.Type.RTC_SPK_TOTAL_RECOVERED_RED},totalAudioPacketsRecoveredFec:{transform:this.identityValue,type:r.SdkMetric.Type.RTC_SPK_TOTAL_RECOVERED_FEC}},this.videoUpstreamMetricMap={roundTripTime:{transform:this.secondsToMilliseconds,type:r.SdkMetric.Type.VIDEO_SENT_RTT_MS},nackCount:{transform:this.countPerSecond,type:r.SdkMetric.Type.VIDEO_NACKS_RECEIVED},pliCount:{transform:this.countPerSecond,type:r.SdkMetric.Type.VIDEO_PLIS_RECEIVED},firCount:{transform:this.countPerSecond,type:r.SdkMetric.Type.VIDEO_FIRS_RECEIVED},framesPerSecond:{transform:this.identityValue,type:r.SdkMetric.Type.VIDEO_INPUT_FPS},framesEncoded:{transform:this.countPerSecond,type:r.SdkMetric.Type.VIDEO_ENCODE_FPS},packetsSent:{transform:this.countPerSecond,type:r.SdkMetric.Type.VIDEO_SENT_PPS},packetsLost:{transform:this.packetLossPercent,type:r.SdkMetric.Type.VIDEO_SENT_FRACTION_PACKET_LOST_PERCENT,source:"packetsSent"},bytesSent:{transform:this.bitsPerSecond,type:r.SdkMetric.Type.VIDEO_SENT_BITRATE},qpSum:{transform:this.countPerSecond,type:r.SdkMetric.Type.VIDEO_SENT_QP_SUM},frameHeight:{transform:this.identityValue,type:r.SdkMetric.Type.VIDEO_ENCODE_HEIGHT},frameWidth:{transform:this.identityValue,type:r.SdkMetric.Type.VIDEO_ENCODE_WIDTH},jitter:{transform:this.secondsToMilliseconds},totalEncodeTime:{transform:this.averageTimeSpentPerSecondInMilliseconds,type:r.SdkMetric.Type.VIDEO_ENCODE_MS},encoderImplementation:{transform:this.isHardwareImplementation,type:r.SdkMetric.Type.VIDEO_ENCODER_IS_HARDWARE},qualityLimitationDurations:{transform:this.averageCpuQualityLimitationDurationPerSecondInMilliseconds,type:r.SdkMetric.Type.VIDEO_QUALITY_LIMITATION_DURATION_CPU}},this.videoDownstreamMetricMap={packetsReceived:{transform:this.countPerSecond,type:r.SdkMetric.Type.VIDEO_RECEIVED_PPS},packetsLost:{transform:this.packetLossPercent,type:r.SdkMetric.Type.VIDEO_RECEIVED_FRACTION_PACKET_LOST_PERCENT,source:"packetsReceived"},framesReceived:{transform:this.identityValue,type:r.SdkMetric.Type.VIDEO_RECEIVED_FPS},framesDecoded:{transform:this.countPerSecond,type:r.SdkMetric.Type.VIDEO_DECODE_FPS},nackCount:{transform:this.countPerSecond,type:r.SdkMetric.Type.VIDEO_NACKS_SENT},firCount:{transform:this.countPerSecond,type:r.SdkMetric.Type.VIDEO_FIRS_SENT},pliCount:{transform:this.countPerSecond,type:r.SdkMetric.Type.VIDEO_PLIS_SENT},bytesReceived:{transform:this.bitsPerSecond,type:r.SdkMetric.Type.VIDEO_RECEIVED_BITRATE},jitter:{transform:this.secondsToMilliseconds,type:r.SdkMetric.Type.VIDEO_RECEIVED_JITTER_MS},jitterBufferDelay:{transform:this.countPerSecond},jitterBufferEmittedCount:{transform:this.countPerSecond},jitterBufferMs:{transform:this.jitterBufferMs,type:r.SdkMetric.Type.VIDEO_JITTER_BUFFER_MS},qpSum:{transform:this.countPerSecond,type:r.SdkMetric.Type.VIDEO_RECEIVED_QP_SUM},frameHeight:{transform:this.identityValue,type:r.SdkMetric.Type.VIDEO_DECODE_HEIGHT},frameWidth:{transform:this.identityValue,type:r.SdkMetric.Type.VIDEO_DECODE_WIDTH},totalDecodeTime:{transform:this.averageTimeSpentPerSecondInMilliseconds,type:r.SdkMetric.Type.VIDEO_DECODE_MS},decoderImplementation:{transform:this.isHardwareImplementation,type:r.SdkMetric.Type.VIDEO_DECODER_IS_HARDWARE},totalFreezesDuration:{transform:this.averageTimeSpentPerSecondInMilliseconds,type:r.SdkMetric.Type.VIDEO_FREEZE_DURATION},freezeCount:{transform:this.countPerSecond,type:r.SdkMetric.Type.VIDEO_FREEZE_COUNT},totalPausesDuration:{transform:this.averageTimeSpentPerSecondInMilliseconds,type:r.SdkMetric.Type.VIDEO_PAUSE_DURATION},pauseCount:{transform:this.countPerSecond,type:r.SdkMetric.Type.VIDEO_PAUSE_COUNT},framesDropped:{transform:this.countPerSecond,type:r.SdkMetric.Type.VIDEO_DROPPED_FPS}},this.streamDimensionMap={encoderImplementation:r.SdkStreamDimension.Type.VIDEO_ENCODER_NAME,decoderImplementation:r.SdkStreamDimension.Type.VIDEO_DECODER_NAME},this.observableVideoMetricSpec={videoUpstreamBitrate:{source:"bytesSent",media:o.default.VIDEO,dir:s.default.UPSTREAM},videoUpstreamPacketsSent:{source:"packetsSent",media:o.default.VIDEO,dir:s.default.UPSTREAM},videoUpstreamPacketLossPercent:{source:"packetsLost",media:o.default.VIDEO,dir:s.default.UPSTREAM},videoUpstreamFramesEncodedPerSecond:{source:"framesEncoded",media:o.default.VIDEO,dir:s.default.UPSTREAM},videoUpstreamFrameHeight:{source:"frameHeight",media:o.default.VIDEO,dir:s.default.UPSTREAM},videoUpstreamFrameWidth:{source:"frameWidth",media:o.default.VIDEO,dir:s.default.UPSTREAM},videoUpstreamJitterMs:{source:"jitter",media:o.default.VIDEO,dir:s.default.UPSTREAM},videoUpstreamRoundTripTimeMs:{source:"roundTripTime",media:o.default.VIDEO,dir:s.default.UPSTREAM},videoDownstreamBitrate:{source:"bytesReceived",media:o.default.VIDEO,dir:s.default.DOWNSTREAM},videoDownstreamPacketLossPercent:{source:"packetsLost",media:o.default.VIDEO,dir:s.default.DOWNSTREAM},videoDownstreamPacketsReceived:{source:"packetsReceived",media:o.default.VIDEO,dir:s.default.DOWNSTREAM},videoDownstreamFramesDecodedPerSecond:{source:"framesDecoded",media:o.default.VIDEO,dir:s.default.DOWNSTREAM},videoDownstreamFrameHeight:{source:"frameHeight",media:o.default.VIDEO,dir:s.default.DOWNSTREAM},videoDownstreamFrameWidth:{source:"frameWidth",media:o.default.VIDEO,dir:s.default.DOWNSTREAM},videoDownstreamJitterMs:{source:"jitter",media:o.default.VIDEO,dir:s.default.DOWNSTREAM},videoDownstreamDelayMs:{source:"jitterBufferMs",media:o.default.VIDEO,dir:s.default.DOWNSTREAM}},this.observableMetricSpec={audioPacketsReceived:{source:"packetsReceived",media:o.default.AUDIO,dir:s.default.DOWNSTREAM},audioPacketsReceivedFractionLoss:{source:"packetsLost",media:o.default.AUDIO,dir:s.default.DOWNSTREAM},audioDecoderLoss:{source:"decoderLoss",media:o.default.AUDIO,dir:s.default.DOWNSTREAM},audioPacketsSent:{source:"packetsSent",media:o.default.AUDIO,dir:s.default.UPSTREAM},audioPacketLossPercent:{source:"packetsLost",media:o.default.AUDIO,dir:s.default.UPSTREAM},audioUpstreamRoundTripTimeMs:{source:"roundTripTime",media:o.default.AUDIO,dir:s.default.UPSTREAM},videoUpstreamBitrate:{source:"bytesSent",media:o.default.VIDEO,dir:s.default.UPSTREAM},videoPacketSentPerSecond:{source:"packetsSent",media:o.default.VIDEO,dir:s.default.UPSTREAM},audioSpeakerDelayMs:{source:"jitterBufferMs",media:o.default.AUDIO,dir:s.default.DOWNSTREAM},audioUpstreamJitterMs:{source:"jitter",media:o.default.AUDIO,dir:s.default.UPSTREAM},audioDownstreamJitterMs:{source:"jitter",media:o.default.AUDIO,dir:s.default.DOWNSTREAM},nackCountReceivedPerSecond:{source:"nackCount",media:o.default.VIDEO,dir:s.default.UPSTREAM},availableOutgoingBitrate:{source:"availableOutgoingBitrate"},availableIncomingBitrate:{source:"availableIncomingBitrate"},currentRoundTripTimeMs:{source:"currentRoundTripTime"},audioDownstreamLevel:{source:"audioLevel",media:o.default.AUDIO,dir:s.default.DOWNSTREAM},audioUpstreamLevel:{source:"audioLevel"}}}getMetricMap(e,t){switch(e){case o.default.AUDIO:switch(t){case s.default.UPSTREAM:return this.audioUpstreamMetricMap;case s.default.DOWNSTREAM:return this.audioDownstreamMetricMap}case o.default.VIDEO:switch(t){case s.default.UPSTREAM:return this.videoUpstreamMetricMap;case s.default.DOWNSTREAM:return this.videoDownstreamMetricMap}default:return this.globalMetricMap}}getStreamDimensionMap(){return this.streamDimensionMap}getObservableMetricValue(e){if(this.overriddenObservableMetrics.has(e))return this.overriddenObservableMetrics.get(e);let t=this.observableMetricSpec[e],{transform:i,source:n}=this.getMetricMap(t.media,t.dir)[t.source];if(!t.hasOwnProperty("media"))return i(n||t.source);for(let e in this.streamMetricReports){let r=this.streamMetricReports[e];if(r.direction===t.dir&&r.mediaType===t.media)return i(n||t.source,Number(e))}return 0}getObservableVideoMetricValue(e,t){let i=this.observableVideoMetricSpec[e],{transform:n,source:r}=this.getMetricMap(i.media,i.dir)[i.source];return n(r||i.source,t)}getObservableMetrics(){let e={};for(let t in this.observableMetricSpec)e[t]=this.getObservableMetricValue(t);return e}getObservableVideoMetrics(){let e={};if(!this.videoStreamIndex||!this.selfAttendeeId)return this.logger.error("Need to define VideoStreamIndex and selfAttendeeId if using getObservableVideoMetrics API"),e;for(let t in this.streamMetricReports)if(this.streamMetricReports[t].mediaType===o.default.VIDEO){let i={};for(let e in this.observableVideoMetricSpec)if(this.observableVideoMetricSpec[e].dir===this.streamMetricReports[t].direction){let n=this.getObservableVideoMetricValue(e,Number(t));isNaN(n)||(i[e]=n)}let n=this.streamMetricReports[t].groupId,r=this.streamMetricReports[t].streamId,s="";e[s=void 0!==this.videoStreamIndex.attendeeIdForGroupId?n?this.videoStreamIndex.attendeeIdForGroupId(n):this.selfAttendeeId:r?this.videoStreamIndex.attendeeIdForStreamId(r):this.selfAttendeeId]=e[s]?e[s]:{},e[s][t]=i}return e}getRTCStatsReport(){return this.rtcStatsReport}clone(){let e=new l(this.logger,this.videoStreamIndex,this.selfAttendeeId);return e.globalMetricReport=this.globalMetricReport,e.streamMetricReports=this.streamMetricReports,e.rtcStatsReport=this.rtcStatsReport,e.customStatsReports=this.customStatsReports,e.currentTimestampMs=this.currentTimestampMs,e.previousTimestampMs=this.previousTimestampMs,e.overriddenObservableMetrics=this.overriddenObservableMetrics,e}print(){let e={globalMetricReport:this.globalMetricReport,streamMetricReports:this.streamMetricReports,currentTimestampMs:this.currentTimestampMs,previousTimestampMs:this.previousTimestampMs};this.logger.debug(()=>`Client Metric Report: ${JSON.stringify(e)}`)}removeDestroyedSsrcs(){for(let e in this.streamMetricReports)this.currentSsrcs[e]||delete this.streamMetricReports[e]}overrideObservableMetric(e,t){this.overriddenObservableMetrics.set(e,t)}}t.default=l},89496:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.ClientMetricReportDirection=void 0,function(e){e[e.UPSTREAM=0]="UPSTREAM",e[e.DOWNSTREAM=1]="DOWNSTREAM"}(i=t.ClientMetricReportDirection||(t.ClientMetricReportDirection={})),t.default=i},57192:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.ClientMetricReportMediaType=void 0,function(e){e[e.AUDIO=0]="AUDIO",e[e.VIDEO=1]="VIDEO"}(i=t.ClientMetricReportMediaType||(t.ClientMetricReportMediaType={})),t.default=i},31654:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{}t.default=i},30928:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(){this.previousMetrics={},this.currentMetrics={},this.currentStringMetrics={},this.previousObjectMetrics={},this.currentObjectMetrics={}}}t.default=i},54281:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(){this.currentTimestampMs=0,this.ssrc=0,this.totalAudioPacketsLost=0,this.totalAudioPacketsExpected=0,this.totalAudioPacketsRecoveredRed=0,this.totalAudioPacketsRecoveredFec=0}}t.default=i},43366:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(){this.previousMetrics={},this.currentMetrics={},this.currentStringMetrics={},this.previousObjectMetrics={},this.currentObjectMetrics={}}}t.default=i},71391:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(e,t,i){this.minHealth=e.minHealth,this.maxHealth=e.maxHealth,this.currentHealth=e.initialHealth,this.currentData=t.clone(),this.name=i}minimumHealth(){return this.minHealth}maximumHealth(){return this.maxHealth}health(){return this.maximumHealth()}update(e){this.currentData=e}getConnectionHealthData(){return this.currentData.clone()}healthy(){return this.health()>this.minimumHealth()}healthIfChanged(){let e=this.health();return e!==this.currentHealth?(this.currentHealth=e,e):null}}t.default=i},41405:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(){this.connectionStartTimestampMs=0,this.consecutiveStatsWithNoPackets=0,this.consecutiveStatsWithNoAudioPacketsSent=0,this.lastPacketLossInboundTimestampMs=0,this.lastGoodSignalTimestampMs=0,this.lastWeakSignalTimestampMs=0,this.lastNoSignalTimestampMs=0,this.consecutiveMissedPongs=0,this.packetsReceivedInLastMinute=[],this.fractionPacketsLostInboundInLastMinute=[],this.audioSpeakerDelayMs=0,this.connectionStartTimestampMs=Date.now(),this.lastGoodSignalTimestampMs=Date.now()}static isTimestampRecent(e,t){return Date.now()<e+t}setConnectionStartTime(){this.connectionStartTimestampMs=Date.now(),this.lastGoodSignalTimestampMs=Date.now()}reset(){this.connectionStartTimestampMs=0,this.consecutiveStatsWithNoPackets=0,this.consecutiveStatsWithNoAudioPacketsSent=0,this.lastPacketLossInboundTimestampMs=0,this.lastGoodSignalTimestampMs=0,this.lastWeakSignalTimestampMs=0,this.lastNoSignalTimestampMs=0,this.consecutiveMissedPongs=0,this.packetsReceivedInLastMinute=[],this.fractionPacketsLostInboundInLastMinute=[],this.audioSpeakerDelayMs=0,this.connectionStartTimestampMs=Date.now(),this.lastGoodSignalTimestampMs=Date.now()}isConnectionStartRecent(e){return i.isTimestampRecent(this.connectionStartTimestampMs,e)}isLastPacketLossRecent(e){return i.isTimestampRecent(this.lastPacketLossInboundTimestampMs,e)}isGoodSignalRecent(e){return i.isTimestampRecent(this.lastGoodSignalTimestampMs,e)}isWeakSignalRecent(e){return i.isTimestampRecent(this.lastWeakSignalTimestampMs,e)}isNoSignalRecent(e){return i.isTimestampRecent(this.lastNoSignalTimestampMs,e)}clone(){let e=new i;return e.connectionStartTimestampMs=this.connectionStartTimestampMs,e.consecutiveStatsWithNoPackets=this.consecutiveStatsWithNoPackets,e.consecutiveStatsWithNoAudioPacketsSent=this.consecutiveStatsWithNoAudioPacketsSent,e.lastPacketLossInboundTimestampMs=this.lastPacketLossInboundTimestampMs,e.lastGoodSignalTimestampMs=this.lastGoodSignalTimestampMs,e.lastWeakSignalTimestampMs=this.lastWeakSignalTimestampMs,e.lastNoSignalTimestampMs=this.lastNoSignalTimestampMs,e.consecutiveMissedPongs=this.consecutiveMissedPongs,e.packetsReceivedInLastMinute=this.packetsReceivedInLastMinute.slice(0),e.fractionPacketsLostInboundInLastMinute=this.fractionPacketsLostInboundInLastMinute.slice(0),e.audioSpeakerDelayMs=this.audioSpeakerDelayMs,e}setConsecutiveMissedPongs(e){this.consecutiveMissedPongs=e}setConsecutiveStatsWithNoPackets(e){this.consecutiveStatsWithNoPackets=e}setConsecutiveStatsWithNoAudioPacketsSent(e){this.consecutiveStatsWithNoAudioPacketsSent=e}setLastPacketLossInboundTimestampMs(e){this.lastPacketLossInboundTimestampMs=e}setLastNoSignalTimestampMs(e){this.lastNoSignalTimestampMs=e}setLastWeakSignalTimestampMs(e){this.lastWeakSignalTimestampMs=e}setLastGoodSignalTimestampMs(e){this.lastGoodSignalTimestampMs=e}setAudioSpeakerDelayMs(e){this.audioSpeakerDelayMs=e}}t.default=i},81107:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(){this.minHealth=0,this.maxHealth=1,this.initialHealth=1,this.connectionUnhealthyThreshold=25,this.noSignalThresholdTimeMs=1e4,this.connectionWaitTimeMs=1e4,this.zeroBarsNoSignalTimeMs=5e3,this.oneBarWeakSignalTimeMs=5e3,this.twoBarsTimeMs=5e3,this.threeBarsTimeMs=1e4,this.fourBarsTimeMs=2e4,this.fiveBarsTimeMs=6e4,this.cooldownTimeMs=6e4,this.pastSamplesToConsider=15,this.goodSignalTimeMs=15e3,this.fractionalLoss=.5,this.packetsExpected=50,this.maximumTimesToWarn=2,this.missedPongsLowerThreshold=1,this.missedPongsUpperThreshold=4,this.maximumAudioDelayMs=6e4,this.maximumAudioDelayDataPoints=10,this.sendingAudioFailureSamplesToConsider=2,this.sendingAudioFailureInitialWaitTimeMs=3e3}}t.default=i},53129:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let r=n(i(71391));class s extends r.default{constructor(e,t,i){super(t,i,"Reconnection Health"),this.logger=e,this.audioDelayPointsOverMaximum=0,s.CONNECTION_UNHEALTHY_THRESHOLD=t.connectionUnhealthyThreshold,s.CONNECTION_WAIT_TIME_MS=t.connectionWaitTimeMs,s.MISSED_PONGS_THRESHOLD=t.missedPongsUpperThreshold,s.MAXIMUM_AUDIO_DELAY_MS=t.maximumAudioDelayMs,s.MAXIMUM_AUDIO_DELAY_DATA_POINTS=t.maximumAudioDelayDataPoints}health(){if(this.currentData.isConnectionStartRecent(s.CONNECTION_WAIT_TIME_MS))return 1;let e=this.currentData.consecutiveStatsWithNoPackets>=s.CONNECTION_UNHEALTHY_THRESHOLD,t=this.currentData.consecutiveMissedPongs>=s.MISSED_PONGS_THRESHOLD;this.currentData.audioSpeakerDelayMs>s.MAXIMUM_AUDIO_DELAY_MS?this.audioDelayPointsOverMaximum+=1:this.audioDelayPointsOverMaximum=0;let i=this.audioDelayPointsOverMaximum>s.MAXIMUM_AUDIO_DELAY_DATA_POINTS;return(i&&(this.audioDelayPointsOverMaximum=0),e||t||i)?(this.logger.warn(`reconnection recommended due to: no packets received: ${e}, missed pongs: ${t}, bad audio delay: ${i}`),0):1}}t.default=s},78946:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let r=n(i(71391));class s extends r.default{constructor(e,t,i){super(t,i,"Sending Audio Health"),this.logger=e,this.sendingAudioFailureSamplesToConsider=t.sendingAudioFailureSamplesToConsider>0?t.sendingAudioFailureSamplesToConsider:1,this.sendingAudioFailureInitialWaitTimeMs=t.sendingAudioFailureInitialWaitTimeMs,this.maximumTimesToWarn=t.maximumTimesToWarn,this.coolDownTimeMs=t.cooldownTimeMs,this.lastWarnTimestampMs=0,this.warnCount=0}isSendingAudioUnhealthy(){let e=!this.currentData.isConnectionStartRecent(this.sendingAudioFailureInitialWaitTimeMs),t=this.currentData.consecutiveStatsWithNoAudioPacketsSent>=this.sendingAudioFailureSamplesToConsider;return e&&t}health(){if(this.isSendingAudioUnhealthy()){let e=Date.now()-this.lastWarnTimestampMs<this.coolDownTimeMs;return!(this.currentHealth>this.minimumHealth())||e?this.currentHealth:(this.logger.warn(`Sending Audio is unhealthy for ${this.sendingAudioFailureSamplesToConsider} seconds consecutively.`),this.warnCount++,this.warnCount>this.maximumTimesToWarn)?(this.logger.warn("SendingAudioFailure health policy maximum warnings breached. Falling back to reporting healthy."),this.maximumHealth()):(this.lastWarnTimestampMs=Date.now(),this.minimumHealth())}return this.maximumHealth()}}t.default=s},3590:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let r=n(i(71391));class s extends r.default{constructor(e,t){super(e,t,"Unusable Audio Warning"),this.coolDownTimeMs=e.cooldownTimeMs,this.pastSamplesToConsider=e.pastSamplesToConsider,this.fractionalLoss=e.fractionalLoss,this.packetsExpected=e.packetsExpected,this.maximumTimesToWarn=e.maximumTimesToWarn,this.lastWarnTimestampMs=0,this.warnCount=0}calculateFractionalLoss(){if(this.currentData.packetsReceivedInLastMinute.length<this.pastSamplesToConsider)return 0;let e=this.pastSamplesToConsider,t=e*this.packetsExpected,i=0;for(let t=0;t<e;t++)i+=this.currentData.packetsReceivedInLastMinute[t];return Math.min(Math.max(1-i/t,0),1)}health(){return Date.now()-this.lastWarnTimestampMs<this.coolDownTimeMs?this.currentHealth:this.calculateFractionalLoss()>=this.fractionalLoss?0!==this.currentHealth&&(this.lastWarnTimestampMs=Date.now(),this.warnCount++,this.warnCount>this.maximumTimesToWarn)?1:0:1}}t.default=s},61239:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=i(71906);class r{constructor(e,t,i,n,r){this.audioVideoController=e,this.realtimeController=t,this.connectionHealthData=i,this.pingPong=n,this.statsCollector=r,this.isActive=!1,this.hasSeenValidCandidatePairMetricsBefore=!1,this.lastTotalBytesReceived=0,this.realtimeController.realtimeSubscribeToLocalSignalStrengthChange(e=>{this.isActive&&this.receiveSignalStrengthChange(e)})}start(){this.isActive=!0,this.pingPong.addObserver(this),this.pingPong.start(),this.audioVideoController.addObserver(this)}stop(){this.isActive=!1,this.pingPong.removeObserver(this),this.pingPong.stop(),this.audioVideoController.removeObserver(this)}receiveSignalStrengthChange(e){0===e?this.connectionHealthData.setLastNoSignalTimestampMs(Date.now()):e<=.5?this.connectionHealthData.setLastWeakSignalTimestampMs(Date.now()):this.connectionHealthData.setLastGoodSignalTimestampMs(Date.now()),this.updateConnectionHealth()}didReceivePong(e,t,i){this.connectionHealthData.setConsecutiveMissedPongs(0),this.statsCollector.logLatency("ping_pong",t),this.statsCollector.logLatency("ping_pong_clock_skew",i),this.updateConnectionHealth()}didMissPongs(){this.connectionHealthData.setConsecutiveMissedPongs(this.connectionHealthData.consecutiveMissedPongs+1),this.updateConnectionHealth()}metricsDidReceive(e){let t=0,i=0,n=e.getObservableMetrics(),r=n.audioPacketsReceived,s=n.audioPacketsReceivedFractionLoss,o=n.audioSpeakerDelayMs;"number"!=typeof o||isNaN(o)||this.connectionHealthData.setAudioSpeakerDelayMs(o);let a=e.getRTCStatsReport(),l=0;a.forEach(e=>{"candidate-pair"===e.type&&e.bytesReceived&&(l+=e.bytesReceived)});let d=l-this.lastTotalBytesReceived;this.lastTotalBytesReceived=l,"number"==typeof r&&"number"==typeof s&&(t=r,i=s,t<0||i<0||d<0||(this.addToMinuteWindow(this.connectionHealthData.packetsReceivedInLastMinute,t),this.addToMinuteWindow(this.connectionHealthData.fractionPacketsLostInboundInLastMinute,i),d>0?(this.hasSeenValidCandidatePairMetricsBefore=!0,this.connectionHealthData.setConsecutiveStatsWithNoPackets(0)):this.hasSeenValidCandidatePairMetricsBefore&&this.connectionHealthData.setConsecutiveStatsWithNoPackets(this.connectionHealthData.consecutiveStatsWithNoPackets+1),(0===t||i>0)&&this.connectionHealthData.setLastPacketLossInboundTimestampMs(Date.now()),"number"==typeof n.audioPacketsSent&&this.updateAudioPacketsSentInConnectionHealth(n.audioPacketsSent),this.updateConnectionHealth()))}updateAudioPacketsSentInConnectionHealth(e){e>0?this.connectionHealthData.setConsecutiveStatsWithNoAudioPacketsSent(0):this.connectionHealthData.setConsecutiveStatsWithNoAudioPacketsSent(this.connectionHealthData.consecutiveStatsWithNoAudioPacketsSent+1)}addToMinuteWindow(e,t){e.unshift(t),e.length>60&&e.pop()}updateConnectionHealth(){this.audioVideoController.forEachObserver(e=>{n.Maybe.of(e.connectionHealthDidChange).map(t=>t.bind(e)(this.connectionHealthData.clone()))})}}t.default=r},11807:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Modality="#content"}(i||(i={})),t.default=i},92240:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=r(i(81341)),o=r(i(28623));class a{constructor(e){this.logger=e}get mediaStream(){return this._mediaStream}set mediaStream(e){this._mediaStream=e}acquireAudioInputStream(){return n(this,void 0,void 0,function*(){return 0===this._mediaStream.getAudioTracks().length?(this.logger.info("No audio stream available. Synthesizing an audio stream."),o.default.synthesizeAudioDevice(0)):this._mediaStream})}acquireVideoInputStream(){return n(this,void 0,void 0,function*(){return this._mediaStream})}acquireDisplayInputStream(e){return n(this,void 0,void 0,function*(){return e&&e.video&&e.video.mandatory&&e.video.mandatory.chromeMediaSource&&e.video.mandatory.chromeMediaSourceId?navigator.mediaDevices.getUserMedia(e):navigator.mediaDevices.getDisplayMedia(e)})}acquireScreenCaptureDisplayInputStream(e,t){return n(this,void 0,void 0,function*(){return this.acquireDisplayInputStream(this.screenCaptureDisplayMediaConstraints(e,t))})}screenCaptureDisplayMediaConstraints(e,t){return{audio:!!(!e&&new s.default().getDisplayMediaAudioCaptureSupport()),video:Object.assign(Object.assign({},!e&&{frameRate:{max:t||a.defaultFrameRate}}),e&&{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:e,maxFrameRate:t||a.defaultFrameRate}})}}toggleMediaStream(e){let t=!1;if(this.mediaStream)for(let i=0;i<this.mediaStream.getTracks().length;i++)this.mediaStream.getTracks()[i].enabled!==e&&(this.mediaStream.getTracks()[i].enabled=e,t=!0);return t}cleanup(){if(this.mediaStream)for(let e=0;e<this.mediaStream.getTracks().length;e++)this.mediaStream.getTracks()[e].stop();this.mediaStream=null}muteLocalAudioInputStream(){throw Error("unsupported")}unmuteLocalAudioInputStream(){throw Error("unsupported")}addMediaStreamBrokerObserver(e){}removeMediaStreamBrokerObserver(e){}}t.default=a,a.defaultFrameRate=15},98220:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=r(i(55510)),o=r(i(38374)),a=r(i(63606)),l=r(i(77041)),d=r(i(45619)),u=i(71906),c=r(i(23995)),h=r(i(49357)),f=r(i(11807));class p{constructor(e,t,i){this.mediaStreamBroker=e,this.contentAudioVideo=t,this.attendeeAudioVideo=i,this.observerQueue=new Set,this.destroyed=!1,this.contentAudioVideo.addObserver(this),this.setupContentShareEvents()}static createContentShareMeetingSessionConfigure(e){let t=new o.default;return t.meetingId=e.meetingId,t.externalMeetingId=e.externalMeetingId,t.urls=e.urls,t.disablePeriodicKeyframeRequestOnContentSender=e.disablePeriodicKeyframeRequestOnContentSender,t.credentials=new a.default,t.credentials.attendeeId=e.credentials.attendeeId+f.default.Modality,t.credentials.externalUserId=e.credentials.externalUserId,t.credentials.joinToken=e.credentials.joinToken+f.default.Modality,t.meetingFeatures=e.meetingFeatures.clone(),t.videoDownlinkBandwidthPolicy=new c.default,t}setContentAudioProfile(e){this.contentAudioVideo.setAudioProfile(e)}enableSimulcastForContentShare(e,t){e?(this.contentAudioVideo.configuration.enableSimulcastForUnifiedPlanChromiumBasedBrowsers=!0,this.contentAudioVideo.configuration.videoUplinkBandwidthPolicy=new h.default(this.contentAudioVideo.logger,t)):(this.contentAudioVideo.configuration.enableSimulcastForUnifiedPlanChromiumBasedBrowsers=!1,this.contentAudioVideo.configuration.videoUplinkBandwidthPolicy=void 0)}enableSVCForContentShare(e){e?this.contentAudioVideo.configuration.enableSVC=!0:this.contentAudioVideo.configuration.enableSVC=!1}startContentShare(e){return n(this,void 0,void 0,function*(){if(e){if(this.contentAudioVideo.configuration.meetingFeatures.contentMaxResolution===s.default.VideoDisabled){this.contentAudioVideo.logger.info("Could not start content because max content resolution was set to None");return}this.mediaStreamBroker.mediaStream=e;for(let e=0;e<this.mediaStreamBroker.mediaStream.getTracks().length;e++)this.mediaStreamBroker.mediaStream.getTracks()[e].addEventListener("ended",()=>{this.stopContentShare()});this.contentAudioVideo.start()}})}startContentShareFromScreenCapture(e,t){return n(this,void 0,void 0,function*(){let i=yield this.mediaStreamBroker.acquireScreenCaptureDisplayInputStream(e,t);return yield this.startContentShare(i),i})}pauseContentShare(){this.mediaStreamBroker.toggleMediaStream(!1)&&this.forEachContentShareObserver(e=>{u.Maybe.of(e.contentShareDidPause).map(t=>t.call(e))})}unpauseContentShare(){this.mediaStreamBroker.toggleMediaStream(!0)&&this.forEachContentShareObserver(e=>{u.Maybe.of(e.contentShareDidUnpause).map(t=>t.call(e))})}setContentShareVideoCodecPreferences(e){this.contentAudioVideo.setVideoCodecSendPreferences(e)}destroy(){return n(this,void 0,void 0,function*(){this.contentAudioVideo&&(this.destroyed=!0,this.contentAudioVideo.removeObserver(this),this.stopContentShare(),this.observerQueue.clear(),this.contentAudioVideo=void 0,this.attendeeAudioVideo=void 0,this.mediaStreamBroker=void 0)})}stopContentShare(){this.contentAudioVideo.stop(),this.mediaStreamBroker.cleanup()}addContentShareObserver(e){this.observerQueue.add(e)}removeContentShareObserver(e){this.observerQueue.delete(e)}forEachContentShareObserver(e){for(let t of this.observerQueue)d.default.nextTick(()=>{this.observerQueue.has(t)&&e(t)})}audioVideoDidStart(){var e;(null===(e=this.mediaStreamBroker.mediaStream)||void 0===e?void 0:e.getVideoTracks().length)>0&&this.contentAudioVideo.videoTileController.startLocalVideoTile()}audioVideoDidStop(e){this.mediaStreamBroker.cleanup(),this.contentShareTile&&(this.attendeeAudioVideo.videoTileController.removeVideoTile(this.contentShareTile.id()),this.contentShareTile=null),this.forEachContentShareObserver(e=>{u.Maybe.of(e.contentShareDidStop).map(t=>t.call(e))})}setupContentShareEvents(){this.attendeeAudioVideo.realtimeController.realtimeSubscribeToAttendeeIdPresence((e,t,i,n)=>{let r=new l.default(e).hasModality(l.default.MODALITY_CONTENT),s=new l.default(e).base()===this.attendeeAudioVideo.configuration.credentials.attendeeId;if(!r||!s||!t||this.contentShareTile)return;let o=this.mediaStreamBroker.mediaStream;if(null==o?void 0:o.getVideoTracks().length){let e,t;this.contentShareTile=this.attendeeAudioVideo.videoTileController.addVideoTile();let i=o.getVideoTracks()[0];if(i.getSettings){let n=i.getSettings();e=n.width,t=n.height}else{let n=i.getCapabilities();e=n.width,t=n.height}this.contentShareTile.bindVideoStream(this.contentAudioVideo.configuration.credentials.attendeeId,!1,o,e,t,null,this.contentAudioVideo.configuration.credentials.externalUserId)}this.forEachContentShareObserver(e=>{u.Maybe.of(e.contentShareDidStart).map(t=>t.call(e))})})}}t.default=p},52781:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n{static register(){"document"in i.g&&document.addEventListener&&n.shouldRegisterCSPMonitor&&!n.added&&(document.addEventListener("securitypolicyviolation",n.listener),n.added=!0)}static unregister(){"document"in i.g&&document.removeEventListener&&(document.removeEventListener("securitypolicyviolation",n.listener),n.loggers=new Set,n.added=!1)}static disable(){n.shouldRegisterCSPMonitor=!1,n.unregister()}static addLogger(e){e&&n.loggers.add(e)}static removeLogger(e){e&&n.loggers.delete(e)}}t.default=n,n.loggers=new Set,n.shouldRegisterCSPMonitor=!0,n.added=!1,n.listener=e=>{let t=`Security Policy Violation
Blocked URI: ${e.blockedURI}
Violated Directive: ${e.violatedDirective}
Original Policy: ${e.originalPolicy}
Document URI: ${e.documentURI}
Source File: ${e.sourceFile}
Line No.: ${e.lineNumber}
`;for(let e of n.loggers)e.error(t);0===n.loggers.size&&console.error(t)}},87271:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(e,t,i,n,r,s){this.timestampMs=e,this.topic=t,this.data=i,this.senderAttendeeId=n,this.senderExternalUserId=r,this.throttled=!!s}text(){return new TextDecoder().decode(this.data)}json(){return JSON.parse(new TextDecoder().decode(this.data))}}t.default=i},71307:function(e,t){"use strict";function i(e){return e&&"destroy"in e}Object.defineProperty(t,"__esModule",{value:!0}),t.isDestroyable=void 0,t.isDestroyable=i},21117:function(e,t){"use strict";function i(e){return!!e&&"object"==typeof e&&"mute"in e&&"stop"in e&&"intrinsicDevice"in e}Object.defineProperty(t,"__esModule",{value:!0}),t.isAudioTransformDevice=void 0,t.isAudioTransformDevice=i},28623:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=r(i(81341)),o=r(i(98557)),a=r(i(45619)),l=r(i(33137)),d=i(71906),u=r(i(63062)),c=r(i(82905)),h=i(21117),f=r(i(26646)),p=r(i(47442)),m=r(i(55318)),g=r(i(93535)),v=r(i(91763)),b=r(i(45724)),S=r(i(48465)),y=r(i(55510)),w=i(53810);class C{constructor(e,t,i=new s.default,n){this.logger=e,this.browserBehavior=i,this.eventController=n,this.deviceInfoCache=null,this.activeDevices={audio:null,video:null},this.chosenVideoTransformDevice=null,this.audioOutputDeviceId=void 0,this.deviceChangeObservers=new Set,this.mediaStreamBrokerObservers=new Set,this.deviceLabelTrigger=()=>navigator.mediaDevices.getUserMedia({audio:!0,video:!0}),this.audioInputDestinationNode=null,this.audioInputSourceNode=null,this.videoInputQualitySettings=null,this.useWebAudio=!1,this.useMediaConstraintsFallback=!0,this.audioInputTaskQueue=new l.default,this.videoInputTaskQueue=new l.default,this.muted=!1,this.mediaStreamMuteObserver=(e,t)=>{for(let i of this.deviceChangeObservers)a.default.nextTick(()=>{this.deviceChangeObservers.has(i)&&i.audioInputMuteStateChanged&&i.audioInputMuteStateChanged(e,t)})},this.alreadyHandlingDeviceChange=!1;let{enableWebAudio:r=!1,useMediaConstraintsFallback:d=!0}=t||{};this.useWebAudio=r,this.useMediaConstraintsFallback=d,this.videoInputQualitySettings=new y.default(C.defaultVideoWidth,C.defaultVideoHeight,C.defaultVideoFrameRate);let u=this.browserBehavior.requiresResolutionAlignment(this.videoInputQualitySettings.videoWidth,this.videoInputQualitySettings.videoHeight);this.videoInputQualitySettings.videoWidth=u[0],this.videoInputQualitySettings.videoHeight=u[1],this.logger.info(`DefaultDeviceController video dimension ${this.videoInputQualitySettings.videoWidth} x ${this.videoInputQualitySettings.videoHeight}`);try{this.mediaDeviceWrapper=new o.default().create();let e=navigator.mediaDevices.getSupportedConstraints();this.logger.info(`Supported Constraints in this browser ${JSON.stringify(e)}`)}catch(t){e.error(t.message)}}isWatchingForDeviceChanges(){return!!this.onDeviceChangeCallback}ensureWatchingDeviceChanges(){var e;this.isWatchingForDeviceChanges()||(this.logger.info("Starting devicechange listener."),this.onDeviceChangeCallback=()=>{this.logger.info("Device change event callback is triggered"),this.handleDeviceChange()},null===(e=this.mediaDeviceWrapper)||void 0===e||e.addEventListener("devicechange",this.onDeviceChangeCallback))}stopWatchingDeviceChanges(){var e;this.isWatchingForDeviceChanges()&&(this.logger.info("Stopping devicechange listener."),null===(e=this.mediaDeviceWrapper)||void 0===e||e.removeEventListener("devicechange",this.onDeviceChangeCallback),this.onDeviceChangeCallback=void 0)}shouldObserveDeviceChanges(){return!!this.deviceChangeObservers.size||this.activeDevices.audio&&null!==this.activeDevices.audio.constraints||this.activeDevices.video&&null!==this.activeDevices.video.constraints||!!this.audioOutputDeviceId}watchForDeviceChangesIfNecessary(){this.shouldObserveDeviceChanges()?this.ensureWatchingDeviceChanges():this.stopWatchingDeviceChanges()}destroy(){return n(this,void 0,void 0,function*(){this.stopWatchingDeviceChanges(),yield this.stopAudioInput(),yield this.stopVideoInput()})}listAudioInputDevices(e=!1){return n(this,void 0,void 0,function*(){let t=yield this.listDevicesOfKind("audioinput",e);return this.trace("listAudioInputDevices",e,t),t})}listVideoInputDevices(e=!1){return n(this,void 0,void 0,function*(){let t=yield this.listDevicesOfKind("videoinput",e);return this.trace("listVideoInputDevices",e,t),t})}listAudioOutputDevices(e=!1){return n(this,void 0,void 0,function*(){let t=yield this.listDevicesOfKind("audiooutput",e);return this.trace("listAudioOutputDevices",e,t),t})}pushAudioMeetingStateForPermissions(e){var t;null===(t=this.eventController)||void 0===t||t.publishEvent(void 0===e?"audioInputUnselected":"audioInputSelected")}pushVideoMeetingStateForPermissions(e){var t;null===(t=this.eventController)||void 0===t||t.publishEvent(void 0===e?"videoInputUnselected":"videoInputSelected")}startAudioInput(e){return n(this,void 0,void 0,function*(){return yield this.audioInputTaskQueue.add(()=>this.startAudioInputTask(e))})}startAudioInputTask(e){var t;return n(this,void 0,void 0,function*(){if(void 0===e){this.logger.error("Audio input device cannot be undefined");return}try{if(h.isAudioTransformDevice(e)?(this.logger.info(`Choosing transform input device ${e}`),yield this.chooseAudioTransformInputDevice(e)):(this.logger.info(`Choosing intrinsic audio input device ${e}`),this.removeTransform(),yield this.chooseInputIntrinsicDevice("audio",e)),this.trace("startAudioInputDevice",e,"success"),this.useWebAudio)return this.attachAudioInputStreamToAudioContext(this.activeDevices.audio.stream),this.pushAudioMeetingStateForPermissions(this.getMediaStreamDestinationNode().stream),yield null===(t=this.transform)||void 0===t?void 0:t.device.mute(this.muted),this.getMediaStreamDestinationNode().stream;return this.publishAudioInputDidChangeEvent(this.activeDevices.audio.stream),this.activeDevices.audio.stream}catch(e){throw e}})}stopAudioInput(){return n(this,void 0,void 0,function*(){return this.audioInputTaskQueue.add(()=>this.stopAudioInputTask())})}stopAudioInputTask(){return n(this,void 0,void 0,function*(){try{if(this.useWebAudio){this.releaseAudioTransformStream();return}this.stopTracksAndRemoveCallbacks("audio")}finally{this.watchForDeviceChangesIfNecessary(),this.publishAudioInputDidChangeEvent(void 0)}})}chooseAudioTransformInputDevice(e){var t;return n(this,void 0,void 0,function*(){let i;if((null===(t=this.transform)||void 0===t?void 0:t.device)===e)return;if(!this.useWebAudio)throw Error("Cannot apply transform device without enabling Web Audio.");let n=C.getAudioContext();if(n instanceof OfflineAudioContext);else switch(n.state){case"running":break;case"closed":throw Error("Cannot choose a transform device with a closed audio context.");case"suspended":yield n.resume()}try{i=yield e.createAudioNode(n)}catch(e){throw this.logger.error(`Unable to create transform device node: ${e}.`),e}let r=yield e.intrinsicDevice();yield this.chooseInputIntrinsicDevice("audio",r),this.logger.debug(`Got inner stream: ${r}.`),this.setTransform(e,i)})}chooseVideoTransformInputDevice(e){var t;return n(this,void 0,void 0,function*(){if(this.eventController&&e instanceof u.default&&e.passEventControllerToProcessors(this.eventController),e===this.chosenVideoTransformDevice){this.logger.info("Reselecting same VideoTransformDevice");return}let i=this.chosenVideoTransformDevice;i&&this.logger.info("Switched from previous VideoTransformDevice");let n=!!i,r=yield e.intrinsicDevice();if(!this.isMediaStreamReusableByDeviceId(null===(t=this.activeDevices.video)||void 0===t?void 0:t.stream,r)){this.logger.info("video transform device needs new intrinsic device"),n&&i.onOutputStreamDisconnect(),this.chosenVideoTransformDevice=e,this.activeDevices.video=null,yield this.chooseInputIntrinsicDevice("video",r),this.logger.info("apply processors to transform"),yield this.chosenVideoTransformDevice.transformStream(this.activeDevices.video.stream);return}this.chosenVideoTransformDevice=e,this.logger.info("video transform device uses previous stream"),this.logger.info("apply processors to transform"),yield e.transformStream(this.activeDevices.video.stream)})}startVideoInput(e){return n(this,void 0,void 0,function*(){return yield this.videoInputTaskQueue.add(()=>this.startVideoInputTask(e))})}startVideoInputTask(e){return n(this,void 0,void 0,function*(){if(!e){this.logger.error("Invalid video input device");return}try{if(w.isVideoTransformDevice(e))return this.logger.info(`Choosing video transform device ${e}`),yield this.chooseVideoTransformInputDevice(e),this.publishVideoInputDidChangeEvent(this.chosenVideoTransformDevice.outputMediaStream),this.chosenVideoTransformDevice.outputMediaStream;return this.chosenVideoInputIsTransformDevice()&&(this.chosenVideoTransformDevice.onOutputStreamDisconnect(),this.chosenVideoTransformDevice=null),yield this.chooseInputIntrinsicDevice("video",e),this.trace("startVideoInputDevice",e),this.publishVideoInputDidChangeEvent(this.activeDevices.video.stream),this.activeDevices.video.stream}catch(e){throw e}})}stopVideoInput(){return n(this,void 0,void 0,function*(){return this.videoInputTaskQueue.add(()=>this.stopVideoInputTask())})}stopVideoInputTask(){return n(this,void 0,void 0,function*(){try{if(this.chosenVideoInputIsTransformDevice()){this.releaseVideoTransformStream();return}this.stopTracksAndRemoveCallbacks("video")}finally{this.watchForDeviceChangesIfNecessary(),this.publishVideoInputDidChangeEvent(void 0)}})}chooseAudioOutput(e){return n(this,void 0,void 0,function*(){this.audioOutputDeviceId=e,this.watchForDeviceChangesIfNecessary();let t=this.deviceInfoFromDeviceId("audiooutput",this.audioOutputDeviceId);this.publishAudioOutputDidChangeEvent(t),this.trace("chooseAudioOutput",e,null)})}addDeviceChangeObserver(e){this.logger.info("adding device change observer"),this.deviceChangeObservers.add(e),this.watchForDeviceChangesIfNecessary(),this.trace("addDeviceChangeObserver")}removeDeviceChangeObserver(e){this.logger.info("removing device change observer"),this.deviceChangeObservers.delete(e),this.watchForDeviceChangesIfNecessary(),this.trace("removeDeviceChangeObserver")}createAnalyserNodeForAudioInput(){var e,t;if(!this.activeDevices.audio)return null;let i=null===(t=null===(e=this.transform)||void 0===e?void 0:e.nodes)||void 0===t?void 0:t.end;if(i){let e=i.context.createAnalyser();return e.removeOriginalInputs=()=>{try{i.disconnect(e)}catch(e){}},i.connect(e),e}return this.createAnalyserNodeForRawAudioInput()}createAnalyserNodeForRawAudioInput(){return this.activeDevices.audio?this.createAnalyserNodeForStream(this.activeDevices.audio.stream):null}createAnalyserNodeForStream(e){let t=C.getAudioContext(),i=t.createAnalyser(),n=t.createMediaStreamSource(e);return n.connect(i),this.trace("createAnalyserNodeForAudioInput"),i.removeOriginalInputs=()=>{try{n.disconnect(i)}catch(e){}},i}startVideoPreviewForVideoInput(e){if(!this.activeDevices.video){this.logger.warn("cannot bind video preview since video input device has not been chosen"),this.trace("startVideoPreviewForVideoInput",e.id);return}c.default.connectVideoStreamToVideoElement(this.chosenVideoTransformDevice?this.chosenVideoTransformDevice.outputMediaStream:this.activeDevices.video.stream,e,!0),this.trace("startVideoPreviewForVideoInput",e.id)}stopVideoPreviewForVideoInput(e){c.default.disconnectVideoStreamFromVideoElement(e,!1),this.trace("stopVideoPreviewForVideoInput",e.id)}setDeviceLabelTrigger(e){if(this.deviceInfoCache){for(let e of this.deviceInfoCache)if(!e.label){this.deviceInfoCache=null;break}}this.deviceLabelTrigger=e,this.trace("setDeviceLabelTrigger")}mixIntoAudioInput(e){let t=null;return this.useWebAudio?(t=C.getAudioContext().createMediaStreamSource(e)).connect(this.getMediaStreamOutputNode()):this.logger.warn("WebAudio is not enabled, mixIntoAudioInput will not work"),this.trace("mixIntoAudioInput",e.id),t}chooseVideoInputQuality(e,t,i){let n=this.browserBehavior.requiresResolutionAlignment(e,t);this.videoInputQualitySettings=new y.default(n[0],n[1],i)}getVideoInputQualitySettings(){return this.videoInputQualitySettings}acquireAudioInputStream(){return n(this,void 0,void 0,function*(){return(this.activeDevices.audio||(this.logger.info("No audio device chosen, creating empty audio device"),yield this.startAudioInput(null)),this.useWebAudio)?this.getMediaStreamDestinationNode().stream:this.activeDevices.audio.stream})}acquireVideoInputStream(){return n(this,void 0,void 0,function*(){if(!this.activeDevices.video)throw Error("No video device chosen");return this.chosenVideoInputIsTransformDevice()?this.chosenVideoTransformDevice.outputMediaStream:this.activeDevices.video.stream})}acquireDisplayInputStream(e){return n(this,void 0,void 0,function*(){throw Error("unsupported")})}releaseAudioTransformStream(){this.logger.info("Stopping audio track for Web Audio graph"),this.stopTracksAndRemoveCallbacks("audio"),this.logger.info("Removing audio transform, if there is one."),this.removeTransform(),this.audioInputSourceNode&&(this.audioInputSourceNode.disconnect(),this.audioInputSourceNode=void 0),this.audioInputDestinationNode&&(this.audioInputDestinationNode.disconnect(),this.audioInputDestinationNode=void 0)}releaseVideoTransformStream(){this.logger.info("Stopping video track for transform"),this.stopTracksAndRemoveCallbacks("video"),this.logger.info("Disconnecting video transform"),this.chosenVideoTransformDevice.onOutputStreamDisconnect(),this.chosenVideoTransformDevice=null}stopTracksAndRemoveCallbacks(e){let t=this.activeDevices[e];if(!t)return;let i=t.endedCallback,n=t.trackMuteCallback,r=t.trackUnmuteCallback;for(let s of t.stream.getTracks())s.stop(),i&&s.removeEventListener("ended",i),n&&s.removeEventListener("mute",n),r&&s.removeEventListener("unmute",r),delete t.endedCallback,delete t.trackMuteCallback,delete t.trackUnmuteCallback,delete this.activeDevices[e]}chosenVideoInputIsTransformDevice(){return!!this.chosenVideoTransformDevice}muteLocalAudioInputStream(){this.toggleLocalAudioInputStream(!1)}unmuteLocalAudioInputStream(){this.toggleLocalAudioInputStream(!0)}toggleLocalAudioInputStream(e){var t;let i=this.activeDevices.audio;if(this.useWebAudio&&(i=this.getMediaStreamDestinationNode()),i){for(let t of i.stream.getTracks())t.enabled!==e&&(t.enabled=e);!e!==this.muted&&(this.muted=!e,null===(t=this.transform)||void 0===t||t.device.mute(this.muted))}}static getIntrinsicDeviceId(e){if(!e)return;if("string"==typeof e)return e;if(e.id)return e.id;let t=e.deviceId;if(!t)return;if("string"==typeof t||Array.isArray(t))return t;let i=t;if("string"==typeof i.exact||Array.isArray(i.exact))return i.exact}static createEmptyAudioDevice(){return C.synthesizeAudioDevice(0)}static synthesizeAudioDevice(e){let t=C.getAudioContext(),i=t.createMediaStreamDestination();if(e){let n=t.createGain();n.gain.value=.1,n.connect(i);let r=t.createOscillator();r.frequency.value=e,r.connect(n),r.start()}else{let e=t.createBufferSource();try{e.buffer=t.createBuffer(1,5*t.sampleRate,t.sampleRate)}catch(i){if(i&&"NotSupportedError"===i.name)e.buffer=t.createBuffer(1,5*C.defaultSampleRate,C.defaultSampleRate);else throw i}e.buffer.getChannelData(0)[0]=3e-4,e.loop=!0,e.connect(i),e.start()}return i.stream}listDevicesOfKind(e,t){return n(this,void 0,void 0,function*(){return(t||null===this.deviceInfoCache||!this.isWatchingForDeviceChanges())&&(yield this.updateDeviceInfoCacheFromBrowser()),this.listCachedDevicesOfKind(e)})}updateDeviceInfoCacheFromBrowser(){var e;return n(this,void 0,void 0,function*(){if("undefined"==typeof MediaDeviceInfo){this.deviceInfoCache=[];return}let t=yield navigator.mediaDevices.enumerateDevices(),i=!0;for(let e of t)if(!e.label){i=!1;break}if(!i)try{this.logger.info("attempting to trigger media device labels since they are hidden");let e=yield this.deviceLabelTrigger();for(let i of(t=yield navigator.mediaDevices.enumerateDevices(),e.getTracks()))i.stop()}catch(t){this.logger.info("unable to get media device labels"),null===(e=this.eventController)||void 0===e||e.publishEvent("deviceLabelTriggerFailed",{deviceLabelTriggerErrorMessage:this.getErrorMessage(t)})}this.logger.debug(`Update device info cache with devices: ${JSON.stringify(t)}`),this.deviceInfoCache=t})}listCachedDevicesOfKind(e){let t=[];if(this.deviceInfoCache)for(let i of this.deviceInfoCache)i.kind===e&&t.push(i);return t}handleDeviceChange(){return n(this,void 0,void 0,function*(){if(null===this.deviceInfoCache)return;if(this.alreadyHandlingDeviceChange){a.default.nextTick(()=>{this.handleDeviceChange()});return}this.alreadyHandlingDeviceChange=!0;let e=this.listCachedDevicesOfKind("audioinput"),t=this.listCachedDevicesOfKind("videoinput"),i=this.listCachedDevicesOfKind("audiooutput");yield this.updateDeviceInfoCacheFromBrowser();let n=this.listCachedDevicesOfKind("audioinput"),r=this.listCachedDevicesOfKind("videoinput"),s=this.listCachedDevicesOfKind("audiooutput");this.forEachObserver(o=>{this.areDeviceListsEqual(e,n)||d.Maybe.of(o.audioInputsChanged).map(e=>e.bind(o)(n)),this.areDeviceListsEqual(t,r)||d.Maybe.of(o.videoInputsChanged).map(e=>e.bind(o)(r)),this.areDeviceListsEqual(i,s)||d.Maybe.of(o.audioOutputsChanged).map(e=>e.bind(o)(s))}),this.alreadyHandlingDeviceChange=!1})}handleDeviceStreamEnded(e,t){return n(this,void 0,void 0,function*(){try{"audio"===e?(this.logger.warn("Audio input device which was active is no longer available, resetting to null device"),yield this.startAudioInput(null)):(this.logger.warn("Video input device which was active is no longer available, stopping video"),yield this.stopVideoInput())}catch(e){this.logger.error("Failed to choose null device after stream ended.")}"audio"===e?this.forEachObserver(e=>{d.Maybe.of(e.audioInputStreamEnded).map(i=>i.bind(e)(t))}):this.forEachObserver(e=>{d.Maybe.of(e.videoInputStreamEnded).map(i=>i.bind(e)(t))})})}forEachObserver(e){for(let t of this.deviceChangeObservers)a.default.nextTick(()=>{this.deviceChangeObservers.has(t)&&e(t)})}forEachMediaStreamBrokerObserver(e){for(let t of this.mediaStreamBrokerObservers)a.default.nextTick(()=>{this.mediaStreamBrokerObservers.has(t)&&e(t)})}areDeviceListsEqual(e,t){return JSON.stringify(e.map(e=>JSON.stringify(e)).sort())===JSON.stringify(t.map(e=>JSON.stringify(e)).sort())}intrinsicDeviceAsMediaStream(e){return e&&e.id?e:null}hasSameMediaStreamId(e,t,i){var n,r,s,o;let a;return"audio"===e?!!(a=null==i?void 0:i.audio.streamId)&&a===(null===(r=null===(n=t.constraints)||void 0===n?void 0:n.audio)||void 0===r?void 0:r.streamId):!!(a=null==i?void 0:i.video.streamId)&&a===(null===(o=null===(s=null==t?void 0:t.constraints)||void 0===s?void 0:s.video)||void 0===o?void 0:o.streamId)}hasSameGroupId(e,t,i){if(""===e)return!0;let n=C.getIntrinsicDeviceId(i);return this.logger.debug(`Checking deviceIds ${n} of type ${typeof n} with groupId ${e}`),"string"==typeof n&&e===this.getGroupIdFromDeviceId(t,n)}getGroupIdFromDeviceId(e,t){if(null!==this.deviceInfoCache){let i=this.listCachedDevicesOfKind(`${e}input`).find(e=>e.deviceId===t);if(i&&i.groupId)return this.logger.debug(`GroupId of deviceId ${t} found in cache is ${i.groupId}`),i.groupId}return this.logger.debug(`GroupId of deviceId ${t} found in cache is empty`),""}handleGetUserMediaError(e,t){if(!e)throw new p.default(e);switch(e.name){case"NotReadableError":case"TrackStartError":throw new g.default(e);case"NotFoundError":case"DevicesNotFoundError":throw new m.default(e);case"NotAllowedError":case"PermissionDeniedError":case"SecurityError":if(t&&t<C.permissionDeniedOriginDetectionThresholdMs)throw new b.default(e,"Permission denied by browser");throw new b.default(e,"Permission denied by user");case"OverconstrainedError":case"ConstraintNotSatisfiedError":throw new v.default(e);case"TypeError":throw new S.default(e);default:throw new p.default(e)}}matchesDeviceSelection(e,t,i,n){return!!(i&&i.stream.active&&(this.hasSameMediaStreamId(e,i,n)||null!==i.groupId&&this.hasSameGroupId(i.groupId,e,t)))&&(this.logger.debug(`Compare current device constraint ${JSON.stringify(i.constraints)} to proposed constraints ${JSON.stringify(n)}`),i.matchesConstraints(n))}chooseInputIntrinsicDevice(e,t){var i,r;return n(this,void 0,void 0,function*(){let n=this.getMediaStreamConstraints(e,t);if(this.matchesDeviceSelection(e,t,this.activeDevices[e],n)){this.logger.info(`reusing existing ${e} input device`);return}this.activeDevices[e]&&this.activeDevices[e].stream&&this.stopTracksAndRemoveCallbacks(e);let s=Date.now(),o=new f.default;try{this.logger.info(`requesting new ${e} device with constraint ${JSON.stringify(n)}`);let i=this.intrinsicDeviceAsMediaStream(t);"audio"===e&&null===t?(o.stream=C.createEmptyAudioDevice(),o.constraints=null):(i?(this.logger.info(`using media stream ${i.id} for ${e} device`),o.stream=i):o.stream=yield navigator.mediaDevices.getUserMedia(n),o.constraints=n),yield this.handleNewInputDevice(e,o)}catch(d){let a=this.getErrorMessage(d);"audio"===e?null===(i=this.eventController)||void 0===i||i.publishEvent("audioInputFailed",{audioInputErrorMessage:a}):null===(r=this.eventController)||void 0===r||r.publishEvent("videoInputFailed",{videoInputErrorMessage:a}),this.logger.error(`failed to get ${e} device for constraints ${JSON.stringify(n)}: ${a}`);let l=!0;if(d&&"constraint"in d&&(this.logger.error(`Over-constrained by constraint: ${d.constraint}`),this.useMediaConstraintsFallback)){let i=this.getMediaStreamConstraints(e,t,!0),r=JSON.stringify(i);if(r!==JSON.stringify(n)){this.logger.info(`retry requesting new ${e} device with minimal constraint ${r}`);try{o.stream=yield navigator.mediaDevices.getUserMedia(i),o.constraints=i,yield this.handleNewInputDevice(e,o),l=!1}catch(t){this.logger.error(`failed to get ${e} device for constraints ${r}: ${this.getErrorMessage(t)}`)}}}if(l){if("audio"===e){this.logger.info(`choosing null ${e} device instead`);try{o.stream=C.createEmptyAudioDevice(),o.constraints=null,yield this.handleNewInputDevice(e,o)}catch(t){this.logger.error(`failed to choose null ${e} device. ${t.name}: ${t.message}`)}}this.handleGetUserMediaError(d,Date.now()-s)}}finally{this.watchForDeviceChangesIfNecessary()}})}getErrorMessage(e){return e?e.name&&e.message?`${e.name}: ${e.message}`:e.name?e.name:e.message?e.message:"UnknownError":"UnknownError"}handleNewInputDevice(e,t){var i;return n(this,void 0,void 0,function*(){this.logger.info(`got ${e} device for constraints ${JSON.stringify(t.constraints)}`);let n=null===(i=this.getMediaTrackSettings(t.stream))||void 0===i?void 0:i.deviceId;t.groupId=n?this.getGroupIdFromDeviceId(e,n):"",this.activeDevices[e]=t,this.logger.debug(`Set activeDevice to ${JSON.stringify(t)}`),this.watchForDeviceChangesIfNecessary();let r=t.stream.getTracks()[0];if(r&&(t.endedCallback=()=>{this.activeDevices[e]&&this.activeDevices[e].stream===t.stream&&(this.handleDeviceStreamEnded(e,n),delete t.endedCallback)},r.addEventListener("ended",t.endedCallback,{once:!0})),"audio"===e){let e=t.stream.getAudioTracks()[0];if(e){let i=e.getSettings().deviceId||t.stream;t.trackMuteCallback=()=>{this.mediaStreamMuteObserver(i,!0)},t.trackUnmuteCallback=()=>{this.mediaStreamMuteObserver(i,!1)},e.addEventListener("mute",t.trackMuteCallback,{once:!1}),e.addEventListener("unmute",t.trackUnmuteCallback,{once:!1}),this.logger.debug("Notifying mute state after selection"),e.muted?t.trackMuteCallback():t.trackUnmuteCallback()}}})}calculateMediaStreamConstraints(e,t,i,n){if(n&&1===this.listCachedDevicesOfKind(`${e}input`).length)return!0;let r={};return(this.browserBehavior.requiresNoExactMediaStreamConstraints()?r.deviceId=t:r.deviceId={exact:t},i&&(r.groupId=i),n)?r:"video"===e?(r.width={ideal:this.videoInputQualitySettings.videoWidth},r.height={ideal:this.videoInputQualitySettings.videoHeight},r.frameRate={ideal:this.videoInputQualitySettings.videoFrameRate},r):(this.supportSampleRateConstraint()&&(r.sampleRate={ideal:C.defaultSampleRate}),this.supportSampleSizeConstraint()&&(r.sampleSize={ideal:C.defaultSampleSize}),this.supportChannelCountConstraint()&&(r.channelCount={ideal:C.defaultChannelCount}),Object.assign({echoCancellation:!0,googEchoCancellation:!0,googEchoCancellation2:!0,googAutoGainControl:!0,googAutoGainControl2:!0,googNoiseSuppression:!0,googNoiseSuppression2:!0,googHighpassFilter:!0},r))}getMediaStreamConstraintsFromTrackConstraints(e,t){return"audio"===e?{audio:t}:{video:t}}getMediaStreamConstraints(e,t,i=!1){let n={};if(!t)return null;let r=this.intrinsicDeviceAsMediaStream(t);if(r)return n.streamId=r.id,this.getMediaStreamConstraintsFromTrackConstraints(e,n);if("string"==typeof t){let r="";return this.browserBehavior.requiresGroupIdMediaStreamConstraints()&&(null!==this.deviceInfoCache?r=this.getGroupIdFromDeviceId(e,t):this.logger.error("Device cache is not populated. Please make sure to call list devices first")),n=this.calculateMediaStreamConstraints(e,t,r,i),this.getMediaStreamConstraintsFromTrackConstraints(e,n)}return n=_(t)?this.calculateMediaStreamConstraints(e,t.deviceId,t.groupId,i):t,this.getMediaStreamConstraintsFromTrackConstraints(e,n)}deviceInfoFromDeviceId(e,t){if(null===this.deviceInfoCache)return null;for(let i of this.deviceInfoCache)if(i.kind===e&&i.deviceId===t)return i;return null}hasAppliedTransform(){return!!this.transform}isMediaStreamReusableByDeviceId(e,t){if(!e||!e.active||!t)return!1;if(t.id)return e.id===t.id;let i=this.getMediaTrackSettings(e);if(!i.deviceId)return!1;let n=C.getIntrinsicDeviceId(t);return"string"==typeof n&&i.deviceId===n}getMediaTrackSettings(e){var t;return null===(t=e.getTracks()[0])||void 0===t?void 0:t.getSettings()}reconnectAudioInputs(){if(!this.audioInputSourceNode)return;this.audioInputSourceNode.disconnect();let e=this.getMediaStreamOutputNode();this.audioInputSourceNode.connect(e)}setTransform(e,t){var i,n;null===(n=null===(i=this.transform)||void 0===i?void 0:i.nodes)||void 0===n||n.end.disconnect(),this.transform={nodes:t,device:e};let r=null==t?void 0:t.end,s=this.getMediaStreamDestinationNode();this.logger.debug(`Connecting transform node ${r} to destination ${s}.`),null==r||r.connect(s),this.reconnectAudioInputs()}removeTransform(){var e;let t=this.transform;if(t)return null===(e=this.transform.nodes)||void 0===e||e.end.disconnect(),this.transform=void 0,this.reconnectAudioInputs(),t}attachAudioInputStreamToAudioContext(e){var t;null===(t=this.audioInputSourceNode)||void 0===t||t.disconnect(),this.audioInputSourceNode=C.getAudioContext().createMediaStreamSource(e);let i=this.getMediaStreamOutputNode();this.audioInputSourceNode.connect(i)}getMediaStreamDestinationNode(){return this.audioInputDestinationNode||(this.audioInputDestinationNode=C.getAudioContext().createMediaStreamDestination()),this.audioInputDestinationNode}getMediaStreamOutputNode(){var e,t;return(null===(t=null===(e=this.transform)||void 0===e?void 0:e.nodes)||void 0===t?void 0:t.start)||this.getMediaStreamDestinationNode()}static setDefaultLatencyHint(e){C.defaultLatencyHint=e}static getAudioContext(){if(!C.audioContext){let e={};navigator.mediaDevices.getSupportedConstraints().sampleRate&&(e.sampleRate=C.defaultSampleRate),new s.default().requiresPlaybackLatencyHintForAudioContext()&&(e.latencyHint="playback"),C.defaultLatencyHint&&(e.latencyHint=C.defaultLatencyHint),C.audioContext=new(window.AudioContext||window.webkitAudioContext)(e)}return C.audioContext}static closeAudioContext(){if(C.audioContext)try{C.audioContext.close()}catch(e){}C.audioContext=null}addMediaStreamBrokerObserver(e){this.mediaStreamBrokerObservers.add(e)}removeMediaStreamBrokerObserver(e){this.mediaStreamBrokerObservers.delete(e)}publishVideoInputDidChangeEvent(e){this.forEachMediaStreamBrokerObserver(t=>{t.videoInputDidChange&&t.videoInputDidChange(e)}),this.pushVideoMeetingStateForPermissions(e)}publishAudioInputDidChangeEvent(e){this.forEachMediaStreamBrokerObserver(t=>{t.audioInputDidChange&&t.audioInputDidChange(e)}),this.pushAudioMeetingStateForPermissions(e)}publishAudioOutputDidChangeEvent(e){this.forEachMediaStreamBrokerObserver(t=>{t.audioOutputDidChange&&t.audioOutputDidChange(e)})}supportSampleRateConstraint(){return this.useWebAudio&&!!navigator.mediaDevices.getSupportedConstraints().sampleRate}supportSampleSizeConstraint(){return this.useWebAudio&&!!navigator.mediaDevices.getSupportedConstraints().sampleSize}supportChannelCountConstraint(){return this.useWebAudio&&!!navigator.mediaDevices.getSupportedConstraints().channelCount}trace(e,t,i){let n=`API/DefaultDeviceController/${e}`;void 0!==t&&(n+=` ${JSON.stringify(t)}`),void 0!==i&&(n+=` -> ${JSON.stringify(i)}`),this.logger.info(n)}}function _(e){return"object"==typeof e&&"deviceId"in e&&"groupId"in e&&"kind"in e&&"label"in e}t.default=C,C.permissionDeniedOriginDetectionThresholdMs=500,C.defaultVideoWidth=960,C.defaultVideoHeight=540,C.defaultVideoFrameRate=15,C.defaultSampleRate=48e3,C.defaultSampleSize=16,C.defaultChannelCount=1,C.audioContext=null},26646:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(){this.groupId=""}matchesConstraints(e){return JSON.stringify(this.constraints)===JSON.stringify(e)}}t.default=i},47442:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i extends Error{constructor(e,t){super(t||"Error fetching device."),this.cause=e,this.name="GetUserMediaError"}}t.default=i},92588:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.NoOpDeviceControllerWithEventController=void 0;let s=r(i(28388)),o=r(i(55510));class a extends s.default{constructor(e){super(),this.destroyed=!1}destroy(){return n(this,void 0,void 0,function*(){this.destroyed=!0})}listAudioInputDevices(){return Promise.resolve([])}listVideoInputDevices(){return Promise.resolve([])}listAudioOutputDevices(){return Promise.resolve([])}startAudioInput(e){return Promise.reject()}stopAudioInput(){return Promise.resolve()}startVideoInput(e){return Promise.reject()}stopVideoInput(){return Promise.resolve()}chooseAudioOutput(e){return Promise.reject()}addDeviceChangeObserver(e){}removeDeviceChangeObserver(e){}createAnalyserNodeForAudioInput(){return null}startVideoPreviewForVideoInput(e){}stopVideoPreviewForVideoInput(e){}setDeviceLabelTrigger(e){}mixIntoAudioInput(e){return null}chooseVideoInputQuality(e,t,i){}getVideoInputQualitySettings(){return o.default.VideoDisabled}}t.default=a;class l extends a{constructor(e){super(),this.eventController=e}}t.NoOpDeviceControllerWithEventController=l},55318:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let r=n(i(47442));class s extends r.default{constructor(e){super(e),this.name="NotFoundError"}}t.default=s},93535:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let r=n(i(47442));class s extends r.default{constructor(e){super(e),this.name="NotReadableError"}}t.default=s},91763:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let r=n(i(47442));class s extends r.default{constructor(e,t){super(e),this.constraint=t,this.name="OverconstrainedError"}}t.default=s},45724:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let r=n(i(47442));class s extends r.default{constructor(e,t){super(e,t),this.name="PermissionDeniedError"}}t.default=s},68074:function(e,t){"use strict";var i=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});class n{constructor(e){this.inner=e}mute(e){return i(this,void 0,void 0,function*(){})}stop(){var e;return i(this,void 0,void 0,function*(){null===(e=this.node)||void 0===e||e.disconnect()})}intrinsicDevice(){return i(this,void 0,void 0,function*(){return this.inner})}createAudioNode(e){var t;return i(this,void 0,void 0,function*(){return null===(t=this.node)||void 0===t||t.disconnect(),this.node=yield this.createSingleAudioNode(e),{start:this.node,end:this.node}})}}t.default=n},48465:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let r=n(i(47442));class s extends r.default{constructor(e){super(e),this.name="TypeError"}}t.default=s},55510:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(e,t,i){this.videoWidth=e,this.videoHeight=t,this.videoFrameRate=i}equals(e){return this.videoWidth===e.videoWidth&&this.videoHeight===e.videoHeight&&this.videoFrameRate===e.videoFrameRate}}t.default=i,i.VideoDisabled=new i(0,0,0),i.VideoResolutionHD=new i(1280,720,30),i.VideoResolutionFHD=new i(1920,1080,30),i.VideoResolutionUHD=new i(3840,2160,30)},53810:function(e,t){"use strict";function i(e){return!!e&&"object"==typeof e&&"transformStream"in e&&"stop"in e&&"intrinsicDevice"in e}Object.defineProperty(t,"__esModule",{value:!0}),t.isVideoTransformDevice=void 0,t.isVideoTransformDevice=i},37188:function(e,t){"use strict";var i=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});class n{constructor(e,t){if(this.devicePixelRatioSource=e,this.observerQueue=new Set,this.mediaQueryListener=()=>{this.observerQueue.forEach(e=>{e.devicePixelRatioChanged(this.devicePixelRatioSource.devicePixelRatio())})},"undefined"==typeof window)return;let i=matchMedia(`(resolution: ${this.devicePixelRatioSource.devicePixelRatio()}dppx)`);"function"==typeof i.addEventListener?(i.addEventListener("change",this.mediaQueryListener),this.mediaQueryList=i):"function"==typeof i.addListener?(i.addListener(this.mediaQueryListener),this.mediaQueryList=i):t.warn("ignoring DefaultDevicePixelRatioMonitor")}destroy(){return i(this,void 0,void 0,function*(){this.mediaQueryList&&("function"==typeof this.mediaQueryList.addEventListener?this.mediaQueryList.removeEventListener("change",this.mediaQueryListener):this.mediaQueryList.removeListener(this.mediaQueryListener)),delete this.mediaQueryListener,this.observerQueue.clear()})}registerObserver(e){this.observerQueue.add(e),e.devicePixelRatioChanged(this.devicePixelRatioSource.devicePixelRatio())}removeObserver(e){this.observerQueue.delete(e)}}t.default=n},51064:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{devicePixelRatio(){return"undefined"!=typeof window&&window&&window.devicePixelRatio?window.devicePixelRatio:1}}t.default=i},74669:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__rest||function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(e);r<n.length;r++)0>t.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]]);return i},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=s(i(2739)),a=s(i(81211)),l=s(i(48013)),d=i(17201);class u{constructor(e,t,i,s,o){this.buffer=[],this.bufferSize=0,this.maxBufferItemCapacityBytes=0,this.ingestionEventSize=0,this.flushIntervalMs=0,this.flushSize=0,this.failedIngestionEvents=[],this.retryCountLimit=15,this.lock=!1,this.cancellableEvents=new Map,this.attributesToFilter=["externalUserId","externalMeetingId","timestampMs"],this.deepCopyCurrentIngestionEvent=e=>({type:e.type,v:e.v,payloads:[...e.payloads]}),this.sendEvents=()=>n(this,void 0,void 0,function*(){if(this.lock)return;let e=this.getItems(this.flushSize);if(0===e.length)return;this.lock=!0;let t=this.makeRequestBody(e),i=!1,n=Date.now();"firefox"===this.metadata.browserName.toLowerCase()&&this.cancellableEvents.set(n,e);try{this.logger.debug(`Event Reporting - InMemoryJSONEventBuffer - sendEvents - sending body ${t}`);let e=yield this.send(t);if(this.cancellableEvents.delete(n),e.ok)try{let i=yield e.json();this.logger.debug(`Event Reporting - InMemoryJSONEventBuffer - sendEvents - send successful events: ${t} message: ${JSON.stringify(i)}`)}catch(e){this.logger.warn(`Event Reporting - InMemoryJSONEventBuffer - sendEvents error reading OK response ${e} for events ${t}`)}else this.logger.error(`Event Reporting - InMemoryJSONEventBuffer - sendEvents - Failed to send events ${t} with response status ${e.status}`),i=!0}catch(e){i=!0,this.logger.warn(`Event Reporting - InMemoryJSONEventBuffer - sendEvents - Error in sending events ${t} to the ingestion endpoint ${e}`)}finally{this.lock=!1}i&&(this.cancellableEvents.delete(n),this.failedIngestionEvents.push(...e))});let a=new l.default(o).getParserResult(),{browserMajorVersion:d}=a,u=r(a,["browserMajorVersion"]),c=t.toJSON(),{type:h,v:f}=c,p=r(c,["type","v"]);this.authenticationToken=t.getAuthenticationToken(),this.metadata=Object.assign(Object.assign({},u),p),Object.keys(this.metadata).forEach(e=>this.attributesToFilter.push(e)),this.type=h,this.v=f,this.ingestionURL=i,this.logger=o,this.importantEvents=new Set(s);let{maxBufferCapacityKb:m,totalBufferItems:g,flushSize:v,flushIntervalMs:b,retryCountLimit:S}=e;this.maxBufferCapacityBytes=1024*m,this.totalBufferItems=g,this.maxBufferItemCapacityBytes=Math.round(this.maxBufferCapacityBytes/g),this.flushIntervalMs=b,this.flushSize=v,this.retryCountLimit=S,this.currentIngestionEvent=this.initializeAndGetCurrentIngestionEvent(),this.beaconEventListener=e=>this.beaconEventHandler(e),this.addEventListeners()}addEventListeners(){this.beaconEventListener&&"window"in i.g&&window.addEventListener&&"document"in i.g&&document.addEventListener&&(this.logger.debug("Event Reporting - InMemoryJSONEventBuffer - addEventListeners - adding pagehide and visibility change event listeners"),window.addEventListener("pagehide",this.beaconEventListener),document.addEventListener("visibilitychange",this.beaconEventListener))}beaconEventHandler(e){("visibilitychange"===e.type&&"hidden"===document.visibilityState||"pagehide"===e.type)&&(this.logger.debug("Event Reporting - InMemoryJSONEventBuffer - beaconEventHandler is triggered calling sendBeacon"),this.sendBeacon())}removeEventListeners(){this.beaconEventListener&&"window"in i.g&&window.removeEventListener&&"document"in i.g&&document.removeEventListener&&(window.removeEventListener("pagehide",this.beaconEventListener),document.removeEventListener("visibilitychange",this.beaconEventListener),this.logger.debug("Event Reporting - InMemoryJSONEventBuffer - removeEventListeners - removing pagehide and visibility change event listeners"))}start(){var e;this.removeEventListeners(),this.addEventListeners(),null===(e=this.intervalScheduler)||void 0===e||e.stop(),this.intervalScheduler=new a.default(this.flushIntervalMs),this.intervalScheduler.start(()=>this.sendEvents())}stop(){var e;null===(e=this.intervalScheduler)||void 0===e||e.stop(),this.intervalScheduler=void 0,this.sendBeacon(),this.removeEventListeners()}addItem(e){return n(this,void 0,void 0,function*(){this.logger.debug(`Event Reporting - InMemoryJSONEventBuffer - addItem - received event ${JSON.stringify(e)}`);let{name:t,ts:i,attributes:n}=e,r=n&&this.filterAttributes(n,this.attributesToFilter),s=Object.assign({name:t,ts:i},r);this.logger.debug(`Event Reporting - InMemoryJSONEventBuffer - addItem - event after filtering attributes ${JSON.stringify(s)}`);let o=this.getSize(s);if(o>u.MAX_ITEM_SIZE_BYTES_ALLOWED)throw Error(`Event Reporting - Item to be added has size ${o} bytes. Item cannot exceed max item size allowed of ${u.MAX_ITEM_SIZE_BYTES_ALLOWED} bytes.`);if(this.importantEvents.has(t)){this.logger.debug(`Event Reporting - InMemoryJSONEventBuffer - addItem - sending important event ${JSON.stringify(s)}`),this.sendEventImmediately({name:t,ts:i,attributes:r});return}if(this.isFull())throw this.logger.warn("Event Reporting - Event buffer is full"),Error("Buffer full");if(this.currentIngestionEvent.payloads.push(s),this.ingestionEventSize+=o,this.bufferItemThresholdReached(o)){let e=this.deepCopyCurrentIngestionEvent(this.currentIngestionEvent);this.buffer.push(e),this.bufferSize+=this.ingestionEventSize,this.currentIngestionEvent=this.initializeAndGetCurrentIngestionEvent(),this.logger.debug(`Event Reporting - InMemoryJSONEventBuffer - addItem - buffer item threshold reached updated buffer ${JSON.stringify(this.buffer)}`)}})}filterAttributes(e,t){let i=new Set(t);return Object.keys(e).filter(e=>i.has(e)).forEach(t=>delete e[t]),e}initializeAndGetCurrentIngestionEvent(){let e={type:this.type,v:this.v,payloads:[]};return this.ingestionEventSize=this.getSize(e),e}bufferItemThresholdReached(e){return e+this.ingestionEventSize>=this.maxBufferItemCapacityBytes||this.currentIngestionEvent.payloads.length===u.MAX_PAYLOAD_ITEMS}getSize(e){let t=0;if("object"==typeof e)for(let[i,n]of Object.entries(e))t+=this.getPrimitiveSize(i)+this.getSize(n);else t+=this.getPrimitiveSize(e);return t}getPrimitiveSize(e){let t=0;return"string"==typeof e?t+=2*e.length:"number"==typeof e&&(t+=8),t}isFull(){return this.bufferSize===this.maxBufferCapacityBytes||this.buffer.length===this.totalBufferItems}isEmpty(){return 0===this.buffer.length||0===this.bufferSize}getItems(e,t=0){return this.isEmpty()?[]:(e=Math.min(this.buffer.length,e+1),this.buffer.splice(t,e))}makeBeaconRequestBody(e){return JSON.stringify({metadata:this.metadata,events:e,authorization:this.authenticationToken})}makeRequestBody(e){return JSON.stringify({metadata:this.metadata,events:e})}sendEventImmediately(e){return n(this,void 0,void 0,function*(){this.logger.debug(`Event Reporting - InMemoryJSONEventBuffer - sendEventImmediately - important event received ${JSON.stringify(e)}`);let{name:t,ts:i,attributes:n}=e,r={type:this.type,v:this.v,payloads:[Object.assign({name:t,ts:i},n)]},s=!1,o=null,a=this.makeRequestBody([r]);try{if((o=yield this.send(a)).ok){try{let e=yield o.json();this.logger.debug(`Event Reporting - InMemoryJSONEventBuffer - sendEventImmediately - send successful event: ${a}, message: ${JSON.stringify(e)}`)}catch(e){this.logger.warn(`Event Reporting - InMemoryJSONEventBuffer - sendEventImmediately - Error reading OK response ${e} for event ${a}`)}return}this.logger.error(`Event Reporting - InMemoryJSONEventBuffer - sendEventImmediately - Failed to send an important event ${a} with response status ${o.status}`),s=!0}catch(e){this.logger.warn(`Event Reporting - There may be a failure in sending an important event ${a} to the ingestion endpoint ${e}.`),s=!0;try{if("firefox"===this.metadata.browserName.toLowerCase()){let e=this.makeBeaconRequestBody([r]);this.logger.debug(`Event Reporting - InMemoryJSONEventBuffer - sendEventImmediately - beaconing data out ${e}`),navigator.sendBeacon(`${this.ingestionURL}?beacon=1`,e)?s=!1:s=!0}}catch(e){this.logger.warn(`Event Reporting - Error sending beacon for an important event ${a}`),s=!0}}s&&(this.logger.debug(`Event Reporting - InMemoryJSONEventBuffer - sendEventImmediately - pushing to failed events ${a}`),this.failedIngestionEvents.push(r))})}send(e){return n(this,void 0,void 0,function*(){let t=new o.default(u.RETRY_FIXED_BACKOFF_WAIT_MS,u.RETRY_SHORT_BACKOFF_MS,u.RETRY_LONG_BACKOFF_MS);try{let i=0;for(;i<this.retryCountLimit;){let n=yield fetch(this.ingestionURL,{method:"POST",headers:{Authorization:`Bearer ${this.authenticationToken}`},body:e});if(n.ok||!u.SENDING_FAILURE_CODES.has(n.status))return n;if(this.logger.warn(`Will retry sending failure for ${e} due to status code ${n.status}.`),++i<this.retryCountLimit){let e=t.nextBackoffAmountMs();yield d.wait(e)}}if(i===this.retryCountLimit)throw Error(`Retry count limit reached for ${e}`)}catch(e){throw e}})}sendBeacon(){return n(this,void 0,void 0,function*(){let e=this.buffer;if(this.logger.debug(`Event Reporting - InMemoryJSONEventBuffer - sendBeacon - clearing out buffer events ${JSON.stringify(e)}`),this.buffer=[],this.currentIngestionEvent.payloads.length>0){let t=this.deepCopyCurrentIngestionEvent(this.currentIngestionEvent);e.push(t),this.logger.debug(`Event Reporting - InMemoryJSONEventBuffer - sendBeacon - clearing out current ingestion event ${JSON.stringify(t)}`),this.currentIngestionEvent=this.initializeAndGetCurrentIngestionEvent()}if(this.failedIngestionEvents.length>0){let t=this.failedIngestionEvents.map(e=>this.deepCopyCurrentIngestionEvent(e));e.push(...t),this.logger.debug(`Event Reporting - InMemoryJSONEventBuffer - sendBeacon - clearing out any failed ingestion event ${JSON.stringify(t)}`),this.failedIngestionEvents=[]}if(this.cancellableEvents.size>0&&(this.cancellableEvents.forEach(t=>{e.push(...t),this.logger.debug(`Event Reporting - InMemoryJSONEventBuffer - sendBeacon - clearing out each cancellable event ${JSON.stringify(t)}`)}),this.cancellableEvents.clear()),0===e.length)return;let t=this.makeBeaconRequestBody(e);this.logger.debug(`Event Reporting - InMemoryJSONEventBuffer - sendBeacon - beacon data to send ${t}`);try{navigator.sendBeacon(`${this.ingestionURL}?beacon=1`,t)||this.logger.warn(`Event Reporting - Browser failed to queue beacon data ${t}`)}catch(e){this.logger.warn(`Event Reporting - Sending beacon data ${t} failed with error ${e}`)}})}reset(){this.maxBufferCapacityBytes=0,this.totalBufferItems=0,this.buffer=[],this.bufferSize=0,this.maxBufferItemCapacityBytes=0,this.ingestionEventSize=0,this.flushIntervalMs=0,this.flushSize=0,this.failedIngestionEvents=[],this.lock=!1,this.beaconEventListener=void 0,this.cancellableEvents.clear()}destroy(){return n(this,void 0,void 0,function*(){this.stop(),this.reset()})}}t.default=u,u.SENDING_FAILURE_CODES=new Set([408,429,500,502,503,504]),u.RETRY_FIXED_BACKOFF_WAIT_MS=0,u.RETRY_SHORT_BACKOFF_MS=1e3,u.RETRY_LONG_BACKOFF_MS=15e3,u.MAX_PAYLOAD_ITEMS=2,u.MAX_ITEM_SIZE_BYTES_ALLOWED=3e3},81682:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(e=5e3,t=2,i=64,n=100,r=15){this.flushIntervalMs=e,this.flushSize=t,this.maxBufferCapacityKb=i,this.totalBufferItems=n,this.retryCountLimit=r}}t.default=i},19444:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=i(26088),o=i(71307),a=r(i(48222)),l=r(i(81339)),d=r(i(61008)),u=r(i(45619)),c=r(i(29505)),h=r(i(62698));class f{constructor(e,t,i){var n,r,o,a,l,d,u;this.meetingHistoryStates=[],this.observerSet=new Set,this.destroyed=!1,this.logger=t,this.configuration=e,this.setupEventReporter(e,t,i);try{this.parserResult=navigator&&navigator.userAgent?new s.UAParser(navigator.userAgent).getResult():null}catch(e){this.logger.error(e.message)}this.browserMajorVersion=(null===(o=null===(r=null===(n=this.parserResult)||void 0===n?void 0:n.browser)||void 0===r?void 0:r.version)||void 0===o?void 0:o.split(".")[0])||f.UNAVAILABLE,this.browserName=(null===(a=this.parserResult)||void 0===a?void 0:a.browser.name)||f.UNAVAILABLE,this.browserVersion=(null===(l=this.parserResult)||void 0===l?void 0:l.browser.version)||f.UNAVAILABLE,this.deviceName=[(null===(d=this.parserResult)||void 0===d?void 0:d.device.vendor)||"",(null===(u=this.parserResult)||void 0===u?void 0:u.device.model)||""].join(" ").trim()||f.UNAVAILABLE}addObserver(e){this.observerSet.add(e)}removeObserver(e){this.observerSet.delete(e)}forEachObserver(e){for(let t of this.observerSet)u.default.nextTick(()=>{this.observerSet.has(t)&&e(t)})}publishEvent(e,t){return n(this,void 0,void 0,function*(){let i=Date.now();this.meetingHistoryStates.push({name:e,timestampMs:i});let n=Object.freeze(Object.assign(this.getAttributes(i),t));this.forEachObserver(t=>{t.eventDidReceive(e,n)}),this.reportEvent(e,i,t)})}reportEvent(e,t,i){var r;return n(this,void 0,void 0,function*(){let n;try{i&&(n=h.default(i)),yield null===(r=this.eventReporter)||void 0===r?void 0:r.reportEvent(t,e,n)}catch(e){this.logger.error(`Error reporting event ${e}`)}})}setupEventReporter(e,t,i){if(i)this._eventReporter=i;else if(e.urls){let i=e.urls.eventIngestionURL;if(i){this.logger.info("Event ingestion URL is present in the configuration");let{meetingId:n,credentials:{attendeeId:r,joinToken:s}}=e,o=new d.default(n,r,s),u=new a.default(o,i);this._eventReporter=new l.default(u,t)}}}getAttributes(e){var t,i;return{attendeeId:this.configuration.credentials.attendeeId,browserMajorVersion:this.browserMajorVersion,browserName:this.browserName,browserVersion:this.browserVersion,deviceName:this.deviceName,externalMeetingId:"string"==typeof this.configuration.externalMeetingId?this.configuration.externalMeetingId:"",externalUserId:this.configuration.credentials.externalUserId,meetingHistory:this.meetingHistoryStates,meetingId:this.configuration.meetingId,osName:(null===(t=this.parserResult)||void 0===t?void 0:t.os.name)||f.UNAVAILABLE,osVersion:(null===(i=this.parserResult)||void 0===i?void 0:i.os.version)||f.UNAVAILABLE,sdkVersion:c.default.sdkVersion,sdkName:c.default.sdkName,timestampMs:e}}get eventReporter(){return this._eventReporter}destroy(){return n(this,void 0,void 0,function*(){o.isDestroyable(this.eventReporter)&&(yield this.eventReporter.destroy()),this.logger=void 0,this.configuration=void 0,this._eventReporter=void 0,this.destroyed=!0})}}t.default=f,f.UNAVAILABLE="Unavailable"},62698:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let i=e=>{let t={};for(let[i,n]of Object.entries(e))if(null!=n&&""!==n){if("number"==typeof n||"string"==typeof n)t[i]=n;else throw TypeError("Unhandled type received while flattening attributes.")}return t};t.default=i},48222:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let r=n(i(81682));class s{constructor(e,t,i=new r.default){this.eventsClientConfiguration=e,this.ingestionURL=t,this.eventBufferConfiguration=i}}t.default=s},81339:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=i(71307),o=r(i(74669));class a{constructor(e,t){this.reportingEvents=!1,this.importantEvents=["meetingEnded","meetingFailed","meetingStartFailed","audioInputFailed","videoInputFailed","meetingStartSucceeded","deviceLabelTriggerFailed"],this.destroyed=!1;let{eventsClientConfiguration:i,ingestionURL:n,eventBufferConfiguration:r}=e,{eventsToIgnore:s}=i;this.eventBuffer=new o.default(r,i,n,this.importantEvents,t),this.logger=t,this.eventsToIgnore=s,this.start()}start(){if(!this.reportingEvents)try{this.eventBuffer.start(),this.logger.info("Event reporting started"),this.reportingEvents=!0}catch(e){this.logger.error(`Event Reporting - Error starting the event buffer ${e}`)}}stop(){if(this.reportingEvents)try{this.eventBuffer.stop(),this.logger.info("Event reporting stopped"),this.reportingEvents=!1}catch(e){this.logger.error(`Event Reporting - Error stopping the event buffer ${e}`)}}reportEvent(e,t,i){return n(this,void 0,void 0,function*(){if(this.logger.debug(`Event Reporting - DefaultMeetingEventReporter - event received in reportEvent ${e}, ${t}, ${JSON.stringify(i)}`),this.eventsToIgnore.includes(t)){this.logger.debug(`Event Reporting - DefaultMeetingEventReporter - ${t} event will be ignored as it is in events to ignore`);return}try{this.logger.debug("Event Reporting - DefaultMeetingEventReporter - adding item to event buffer"),yield this.eventBuffer.addItem({ts:e,name:t,attributes:i})}catch(e){this.logger.error(`Event Reporting - Error adding event to buffer ${e}`)}})}destroy(){return n(this,void 0,void 0,function*(){this.destroyed=!0,this.stop(),s.isDestroyable(this.eventBuffer)&&this.eventBuffer.destroy(),this.eventBuffer=void 0})}}t.default=a},91083:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(){}reportEvent(e,t,i){}start(){}stop(){}}t.default=i},61008:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(e,t,i,n=[]){this.type="Meet",this.v=1,this.meetingId=e,this.attendeeId=t,this.eventsToIgnore=n,this.authenticationToken=i}getAuthenticationToken(){return this.authenticationToken}toJSON(){let e={};return e.type=this.type,e.v=this.v,e.meetingId=this.meetingId,e.attendeeId=this.attendeeId,e}}t.default=i},8963:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultEventController=t.DefaultDevicePixelRatioMonitor=t.DefaultDeviceController=t.DefaultContentShareController=t.DefaultBrowserBehavior=t.DefaultAudioVideoFacade=t.DefaultAudioVideoController=t.DefaultAudioMixController=t.DefaultActiveSpeakerPolicy=t.DefaultActiveSpeakerDetector=t.DataMessage=t.CreateSDPTask=t.CreatePeerConnectionTask=t.ContentShareMediaStreamBroker=t.ContentShareConstants=t.ConsoleLogger=t.ConnectionHealthPolicyConfiguration=t.ConnectionHealthData=t.ClientVideoStreamReceivingReport=t.ClientMetricReportMediaType=t.ClientMetricReportDirection=t.ClientMetricReport=t.CleanStoppedSessionTask=t.CleanRestartedSessionTask=t.CheckVideoInputFeedback=t.CheckVideoConnectivityFeedback=t.CheckNetworkUDPConnectivityFeedback=t.CheckNetworkTCPConnectivityFeedback=t.CheckContentShareConnectivityFeedback=t.CheckCameraResolutionFeedback=t.CheckAudioOutputFeedback=t.CheckAudioInputFeedback=t.CheckAudioConnectivityFeedback=t.CanvasVideoFrameBuffer=t.CSPMonitor=t.BitrateParameters=t.BaseTask=t.BaseConnectionHealthPolicy=t.BackgroundReplacementVideoFrameProcessor=t.BackgroundFilterVideoFrameProcessor=t.BackgroundBlurVideoFrameProcessor=t.BackgroundBlurStrength=t.AudioVideoControllerState=t.AudioProfile=t.AudioLogEvent=t.Attendee=t.AttachMediaInputTask=t.AsyncScheduler=t.ApplicationMetadata=t.AllHighestVideoBandwidthPolicy=void 0,t.MeetingReadinessCheckerConfiguration=t.MeetingFeatures=t.MeetingEventsClientConfiguration=t.MediaDeviceProxyHandler=t.Maybe=t.LogLevel=t.Log=t.ListenForVolumeIndicatorsTask=t.LeaveAndReceiveLeaveAckTask=t.JoinAndReceiveIndexTask=t.IntervalScheduler=t.InMemoryJSONEventBuffer=t.GlobalMetricReport=t.GetUserMediaError=t.FullJitterLimitedBackoff=t.FullJitterBackoffFactory=t.FullJitterBackoff=t.FinishGatheringICECandidatesTask=t.EventIngestionConfiguration=t.EventBufferConfiguration=t.DeviceSelection=t.DevicePixelRatioWindowSource=t.DefaultWebSocketAdapter=t.DefaultVolumeIndicatorAdapter=t.DefaultVideoTransformDevice=t.DefaultVideoTileFactory=t.DefaultVideoTileController=t.DefaultVideoTile=t.DefaultVideoStreamIndex=t.DefaultVideoStreamIdSet=t.DefaultVideoFrameProcessorTimer=t.DefaultVideoFrameProcessorPipeline=t.DefaultVideoCaptureAndEncodeParameter=t.DefaultUserAgentParser=t.DefaultTranscriptionController=t.DefaultTransceiverController=t.DefaultSimulcastUplinkPolicyForContentShare=t.DefaultSimulcastUplinkPolicy=t.DefaultSignalingClient=t.DefaultSigV4=t.DefaultSessionStateController=t.DefaultReconnectController=t.DefaultRealtimeController=t.DefaultPingPong=t.DefaultModality=t.DefaultMessagingSession=t.DefaultMeetingSession=t.DefaultMeetingReadinessChecker=t.DefaultMeetingEventReporter=t.DefaultMediaDeviceFactory=void 0,t.RedundantAudioEncoderWorkerCode=t.RedundantAudioEncoder=t.ReconnectionHealthPolicy=t.ReceiveVideoStreamIndexTask=t.ReceiveVideoInputTask=t.ReceiveRemoteVideoPauseResumeTask=t.ReceiveAudioInputTask=t.RealtimeVolumeIndicator=t.RealtimeState=t.RealtimeAttendeePositionInFrame=t.PromoteToPrimaryMeetingTask=t.PromiseQueue=t.PrefetchSortBy=t.PrefetchOn=t.PermissionDeniedError=t.ParallelGroupTask=t.POSTLogger=t.OverconstrainedError=t.OpenSignalingConnectionTask=t.OnceTask=t.NotReadableError=t.NotFoundError=t.None=t.NoVideoUplinkBandwidthPolicy=t.NoVideoDownlinkBandwidthPolicy=t.NoOpVideoFrameProcessor=t.NoOpVideoElementFactory=t.NoOpTask=t.NoOpMediaStreamBroker=t.NoOpLogger=t.NoOpEventReporter=t.NoOpDeviceController=t.NoOpDebugLogger=t.NoOpAudioVideoController=t.NScaleVideoUplinkBandwidthPolicy=t.MutableVideoPreferences=t.MultiLogger=t.MonitorTask=t.ModelSpecBuilder=t.MessagingSessionConfiguration=t.Message=t.MeetingSessionVideoAvailability=t.MeetingSessionURLs=t.MeetingSessionTURNCredentials=t.MeetingSessionStatusCode=t.MeetingSessionStatus=t.MeetingSessionLifecycleEventCondition=t.MeetingSessionLifecycleEvent=t.MeetingSessionCredentials=t.MeetingSessionConfiguration=void 0,t.VideoLogEvent=t.VideoFxProcessor=t.VideoCodecCapability=t.VideoAdaptiveProbePolicy=t.Versioning=t.UnusableAudioWarningConnectionHealthPolicy=t.TypeError=t.TranscriptionStatusType=t.TranscriptionStatus=t.TranscriptResult=t.TranscriptLanguageWithScore=t.TranscriptItemType=t.TranscriptItem=t.TranscriptEntity=t.TranscriptAlternative=t.Transcript=t.TimeoutTask=t.TimeoutScheduler=t.TaskStatus=t.TargetDisplaySize=t.SubscribeAndReceiveSubscribeAckTask=t.StreamMetricReport=t.Some=t.SingleNodeAudioTransformDevice=t.SimulcastVideoStreamIndex=t.SimulcastTransceiverController=t.SimulcastLayers=t.SimulcastContentShareTransceiverController=t.SignalingClientVideoSubscriptionConfiguration=t.SignalingClientSubscribe=t.SignalingClientJoin=t.SignalingClientEventType=t.SignalingClientEvent=t.SignalingClientConnectionRequest=t.SignalingAndMetricsConnectionMonitor=t.SetRemoteDescriptionTask=t.SetLocalDescriptionTask=t.SessionStateControllerTransitionResult=t.SessionStateControllerState=t.SessionStateControllerDeferPriority=t.SessionStateControllerAction=t.ServerSideNetworkAdaption=t.SerialGroupTask=t.SendingAudioFailureConnectionHealthPolicy=t.SendAndReceiveDataMessagesTask=t.SDPMediaSection=t.SDPCandidateType=t.SDP=t.RunnableTask=t.RedundantAudioRecoveryMetricReport=void 0,t.isVideoTransformDevice=t.isDestroyable=t.isAudioTransformDevice=t.ZLIBTextCompressor=t.WebSocketReadyState=t.WaitForAttendeePresenceTask=t.VoiceFocusTransformDevice=t.VoiceFocusDeviceTransformer=t.VideoTileState=t.VideoStreamDescription=t.VideoSource=t.VideoQualitySettings=t.VideoQualityAdaptationPreference=t.VideoPriorityBasedPolicyConfig=t.VideoPriorityBasedPolicy=t.VideoPreferences=t.VideoPreference=t.VideoOnlyTransceiverController=void 0;let r=n(i(12019));t.AllHighestVideoBandwidthPolicy=r.default;let s=n(i(85546));t.ApplicationMetadata=s.default;let o=n(i(45619));t.AsyncScheduler=o.default;let a=n(i(14194));t.AttachMediaInputTask=a.default;let l=n(i(49717));t.Attendee=l.default;let d=n(i(35102));t.AudioLogEvent=d.default;let u=n(i(96665));t.AudioProfile=u.default;let c=n(i(43316));t.AudioVideoControllerState=c.default;let h=n(i(28434));t.BackgroundBlurStrength=h.default;let f=n(i(3922));t.BackgroundBlurVideoFrameProcessor=f.default;let p=n(i(93318));t.BackgroundFilterVideoFrameProcessor=p.default;let m=n(i(12011));t.BackgroundReplacementVideoFrameProcessor=m.default;let g=n(i(71391));t.BaseConnectionHealthPolicy=g.default;let v=n(i(49288));t.BaseTask=v.default;let b=n(i(47739));t.BitrateParameters=b.default;let S=n(i(52781));t.CSPMonitor=S.default;let y=n(i(98400));t.CanvasVideoFrameBuffer=y.default;let w=n(i(22984));t.CheckAudioConnectivityFeedback=w.default;let C=n(i(34419));t.CheckAudioInputFeedback=C.default;let _=n(i(17739));t.CheckAudioOutputFeedback=_.default;let k=n(i(21216));t.CheckCameraResolutionFeedback=k.default;let T=n(i(97716));t.CheckContentShareConnectivityFeedback=T.default;let P=n(i(71743));t.CheckNetworkTCPConnectivityFeedback=P.default;let E=n(i(49702));t.CheckNetworkUDPConnectivityFeedback=E.default;let M=n(i(69214));t.CheckVideoConnectivityFeedback=M.default;let I=n(i(93183));t.CheckVideoInputFeedback=I.default;let A=n(i(44525));t.CleanRestartedSessionTask=A.default;let R=n(i(84209));t.CleanStoppedSessionTask=R.default;let x=n(i(28439));t.ClientMetricReport=x.default;let O=n(i(89496));t.ClientMetricReportDirection=O.default;let D=n(i(57192));t.ClientMetricReportMediaType=D.default;let L=n(i(31654));t.ClientVideoStreamReceivingReport=L.default;let F=n(i(41405));t.ConnectionHealthData=F.default;let B=n(i(81107));t.ConnectionHealthPolicyConfiguration=B.default;let N=n(i(21302));t.ConsoleLogger=N.default;let V=n(i(11807));t.ContentShareConstants=V.default;let U=n(i(92240));t.ContentShareMediaStreamBroker=U.default;let z=n(i(4307));t.CreatePeerConnectionTask=z.default;let j=n(i(9500));t.CreateSDPTask=j.default;let $=n(i(87271));t.DataMessage=$.default;let W=n(i(70544));t.DefaultActiveSpeakerDetector=W.default;let H=n(i(75827));t.DefaultActiveSpeakerPolicy=H.default;let K=n(i(97241));t.DefaultAudioMixController=K.default;let G=n(i(204));t.DefaultAudioVideoController=G.default;let q=n(i(34114));t.DefaultAudioVideoFacade=q.default;let Q=n(i(81341));t.DefaultBrowserBehavior=Q.default;let Z=n(i(98220));t.DefaultContentShareController=Z.default;let Y=n(i(28623));t.DefaultDeviceController=Y.default;let J=n(i(37188));t.DefaultDevicePixelRatioMonitor=J.default;let X=n(i(19444));t.DefaultEventController=X.default;let ee=n(i(98557));t.DefaultMediaDeviceFactory=ee.default;let et=n(i(81339));t.DefaultMeetingEventReporter=et.default;let ei=n(i(93156));t.DefaultMeetingReadinessChecker=ei.default;let en=n(i(44583));t.DefaultMeetingSession=en.default;let er=n(i(19671));t.DefaultMessagingSession=er.default;let es=n(i(77041));t.DefaultModality=es.default;let eo=n(i(91930));t.DefaultPingPong=eo.default;let ea=n(i(20311));t.DefaultRealtimeController=ea.default;let el=n(i(97386));t.DefaultReconnectController=el.default;let ed=n(i(99521));t.DefaultSessionStateController=ed.default;let eu=n(i(22533));t.DefaultSigV4=eu.default;let ec=n(i(94839));t.DefaultSignalingClient=ec.default;let eh=n(i(88576));t.DefaultSimulcastUplinkPolicy=eh.default;let ef=n(i(49357));t.DefaultSimulcastUplinkPolicyForContentShare=ef.default;let ep=n(i(33301));t.DefaultTransceiverController=ep.default;let em=n(i(25094));t.DefaultTranscriptionController=em.default;let eg=n(i(48013));t.DefaultUserAgentParser=eg.default;let ev=n(i(48786));t.DefaultVideoCaptureAndEncodeParameter=ev.default;let eb=n(i(44739));t.DefaultVideoFrameProcessorPipeline=eb.default;let eS=n(i(15706));t.DefaultVideoFrameProcessorTimer=eS.default;let ey=n(i(47569));t.DefaultVideoStreamIdSet=ey.default;let ew=n(i(44550));t.DefaultVideoStreamIndex=ew.default;let eC=n(i(82905));t.DefaultVideoTile=eC.default;let e_=n(i(54008));t.DefaultVideoTileController=e_.default;let ek=n(i(86351));t.DefaultVideoTileFactory=ek.default;let eT=n(i(63062));t.DefaultVideoTransformDevice=eT.default;let eP=n(i(75762));t.DefaultVolumeIndicatorAdapter=eP.default;let eE=n(i(14832));t.DefaultWebSocketAdapter=eE.default;let eM=n(i(51064));t.DevicePixelRatioWindowSource=eM.default;let eI=n(i(26646));t.DeviceSelection=eI.default;let eA=n(i(81682));t.EventBufferConfiguration=eA.default;let eR=n(i(48222));t.EventIngestionConfiguration=eR.default;let ex=n(i(4347));t.FinishGatheringICECandidatesTask=ex.default;let eO=n(i(2739));t.FullJitterBackoff=eO.default;let eD=n(i(1377));t.FullJitterBackoffFactory=eD.default;let eL=n(i(89395));t.FullJitterLimitedBackoff=eL.default;let eF=n(i(47442));t.GetUserMediaError=eF.default;let eB=n(i(30928));t.GlobalMetricReport=eB.default;let eN=n(i(74669));t.InMemoryJSONEventBuffer=eN.default;let eV=n(i(81211));t.IntervalScheduler=eV.default;let eU=n(i(32908));t.JoinAndReceiveIndexTask=eU.default;let ez=n(i(75583));t.LeaveAndReceiveLeaveAckTask=ez.default;let ej=n(i(86581));t.ListenForVolumeIndicatorsTask=ej.default;let e$=n(i(51928));t.Log=e$.default;let eW=n(i(35711));t.LogLevel=eW.default;let eH=n(i(13774));t.MediaDeviceProxyHandler=eH.default;let eK=n(i(61008));t.MeetingEventsClientConfiguration=eK.default;let eG=n(i(30857));t.MeetingFeatures=eG.default;let eq=n(i(94308));t.MeetingReadinessCheckerConfiguration=eq.default;let eQ=n(i(38374));t.MeetingSessionConfiguration=eQ.default;let eZ=n(i(63606));t.MeetingSessionCredentials=eZ.default;let eY=n(i(27645));t.MeetingSessionLifecycleEvent=eY.default;let eJ=n(i(10441));t.MeetingSessionLifecycleEventCondition=eJ.default;let eX=n(i(57456));t.MeetingSessionStatus=eX.default;let e0=n(i(8056));t.MeetingSessionStatusCode=e0.default;let e1=n(i(25735));t.MeetingSessionTURNCredentials=e1.default;let e2=n(i(64432));t.MeetingSessionURLs=e2.default;let e3=n(i(1090));t.MeetingSessionVideoAvailability=e3.default;let e5=n(i(43399));t.Message=e5.default;let e4=n(i(82534));t.MessagingSessionConfiguration=e4.default;let e6=n(i(24906));t.ModelSpecBuilder=e6.default;let e8=n(i(17928));t.MonitorTask=e8.default;let e9=n(i(40709));t.MultiLogger=e9.default;let e7=n(i(46735));t.NScaleVideoUplinkBandwidthPolicy=e7.default;let te=n(i(64827));t.NoOpAudioVideoController=te.default;let tt=n(i(65718));t.NoOpDebugLogger=tt.default;let ti=n(i(92588));t.NoOpDeviceController=ti.default;let tn=n(i(91083));t.NoOpEventReporter=tn.default;let tr=n(i(93101));t.NoOpLogger=tr.default;let ts=n(i(28388));t.NoOpMediaStreamBroker=ts.default;let to=n(i(5899));t.NoOpTask=to.default;let ta=n(i(52363));t.NoOpVideoElementFactory=ta.default;let tl=n(i(86349));t.NoOpVideoFrameProcessor=tl.default;let td=n(i(23995));t.NoVideoDownlinkBandwidthPolicy=td.default;let tu=n(i(16643));t.NoVideoUplinkBandwidthPolicy=tu.default;let tc=n(i(55318));t.NotFoundError=tc.default;let th=n(i(93535));t.NotReadableError=th.default;let tf=n(i(40292));t.OnceTask=tf.default;let tp=n(i(61849));t.OpenSignalingConnectionTask=tp.default;let tm=n(i(91763));t.OverconstrainedError=tm.default;let tg=n(i(63588));t.POSTLogger=tg.default;let tv=n(i(522));t.ParallelGroupTask=tv.default;let tb=n(i(45724));t.PermissionDeniedError=tb.default;let tS=n(i(28116));t.PrefetchOn=tS.default;let ty=n(i(67929));t.PrefetchSortBy=ty.default;let tw=n(i(33137));t.PromiseQueue=tw.default;let tC=n(i(40708));t.PromoteToPrimaryMeetingTask=tC.default;let t_=n(i(88758));t.RealtimeAttendeePositionInFrame=t_.default;let tk=n(i(14191));t.RealtimeState=tk.default;let tT=n(i(6724));t.RealtimeVolumeIndicator=tT.default;let tP=n(i(22505));t.ReceiveAudioInputTask=tP.default;let tE=n(i(91604));t.ReceiveRemoteVideoPauseResumeTask=tE.default;let tM=n(i(55960));t.ReceiveVideoInputTask=tM.default;let tI=n(i(60519));t.ReceiveVideoStreamIndexTask=tI.default;let tA=n(i(53129));t.ReconnectionHealthPolicy=tA.default;let tR=n(i(91687));t.RedundantAudioEncoder=tR.default;let tx=n(i(2026));t.RedundantAudioEncoderWorkerCode=tx.default;let tO=n(i(54281));t.RedundantAudioRecoveryMetricReport=tO.default;let tD=n(i(53282));t.RunnableTask=tD.default;let tL=n(i(87444));t.SDP=tL.default;let tF=n(i(27786));t.SDPCandidateType=tF.default;let tB=n(i(5039));t.SDPMediaSection=tB.default;let tN=n(i(34395));t.SendAndReceiveDataMessagesTask=tN.default;let tV=n(i(78946));t.SendingAudioFailureConnectionHealthPolicy=tV.default;let tU=n(i(38521));t.SerialGroupTask=tU.default;let tz=n(i(45377));t.ServerSideNetworkAdaption=tz.default;let tj=n(i(1265));t.SessionStateControllerAction=tj.default;let t$=n(i(60858));t.SessionStateControllerDeferPriority=t$.default;let tW=n(i(97618));t.SessionStateControllerState=tW.default;let tH=n(i(75745));t.SessionStateControllerTransitionResult=tH.default;let tK=n(i(44970));t.SetLocalDescriptionTask=tK.default;let tG=n(i(9478));t.SetRemoteDescriptionTask=tG.default;let tq=n(i(61239));t.SignalingAndMetricsConnectionMonitor=tq.default;let tQ=n(i(67406));t.SignalingClientConnectionRequest=tQ.default;let tZ=n(i(35316));t.SignalingClientEvent=tZ.default;let tY=n(i(62811));t.SignalingClientEventType=tY.default;let tJ=n(i(92852));t.SignalingClientJoin=tJ.default;let tX=n(i(12634));t.SignalingClientSubscribe=tX.default;let t0=n(i(75749));t.SignalingClientVideoSubscriptionConfiguration=t0.default;let t1=n(i(1529));t.SimulcastContentShareTransceiverController=t1.default;let t2=n(i(73920));t.SimulcastLayers=t2.default;let t3=n(i(14055));t.SimulcastTransceiverController=t3.default;let t5=n(i(62073));t.SimulcastVideoStreamIndex=t5.default;let t4=n(i(68074));t.SingleNodeAudioTransformDevice=t4.default;let t6=n(i(43366));t.StreamMetricReport=t6.default;let t8=n(i(60653));t.SubscribeAndReceiveSubscribeAckTask=t8.default;let t9=n(i(36608));t.TargetDisplaySize=t9.default;let t7=n(i(28850));t.TaskStatus=t7.default;let ie=n(i(44307));t.TimeoutScheduler=ie.default;let it=n(i(30296));t.TimeoutTask=it.default;let ii=n(i(99550));t.Transcript=ii.default;let ir=n(i(47105));t.TranscriptAlternative=ir.default;let is=n(i(33396));t.TranscriptEntity=is.default;let io=n(i(24065));t.TranscriptItem=io.default;let ia=n(i(20905));t.TranscriptItemType=ia.default;let il=n(i(12567));t.TranscriptLanguageWithScore=il.default;let id=n(i(90035));t.TranscriptResult=id.default;let iu=n(i(60639));t.TranscriptionStatus=iu.default;let ic=n(i(43945));t.TranscriptionStatusType=ic.default;let ih=n(i(48465));t.TypeError=ih.default;let ip=n(i(3590));t.UnusableAudioWarningConnectionHealthPolicy=ip.default;let im=n(i(29505));t.Versioning=im.default;let ig=n(i(71461));t.VideoAdaptiveProbePolicy=ig.default;let iv=n(i(81342));t.VideoCodecCapability=iv.default;let ib=n(i(97677));t.VideoFxProcessor=ib.default;let iS=n(i(87879));t.VideoLogEvent=iS.default;let iy=n(i(31288));t.VideoOnlyTransceiverController=iy.default;let iw=n(i(2801));t.VideoPreference=iw.default;let iC=n(i(85336));t.VideoPreferences=iC.default;let i_=n(i(2962));t.VideoPriorityBasedPolicy=i_.default;let ik=n(i(73463));t.VideoPriorityBasedPolicyConfig=ik.default;let iT=n(i(67473));t.VideoQualityAdaptationPreference=iT.default;let iP=n(i(55510));t.VideoQualitySettings=iP.default;let iE=n(i(35879));t.VideoSource=iE.default;let iM=n(i(46376));t.VideoStreamDescription=iM.default;let iI=n(i(54695));t.VideoTileState=iI.default;let iA=n(i(37993));t.VoiceFocusDeviceTransformer=iA.default;let iR=n(i(91330));t.VoiceFocusTransformDevice=iR.default;let ix=n(i(27737));t.WaitForAttendeePresenceTask=ix.default;let iO=n(i(99983));t.WebSocketReadyState=iO.default;let iD=n(i(48693));t.ZLIBTextCompressor=iD.default;let iL=i(85336);Object.defineProperty(t,"MutableVideoPreferences",{enumerable:!0,get:function(){return iL.MutableVideoPreferences}});let iF=i(71906);Object.defineProperty(t,"Some",{enumerable:!0,get:function(){return iF.Some}}),Object.defineProperty(t,"None",{enumerable:!0,get:function(){return iF.None}}),Object.defineProperty(t,"Maybe",{enumerable:!0,get:function(){return iF.Maybe}});let iB=i(21117);Object.defineProperty(t,"isAudioTransformDevice",{enumerable:!0,get:function(){return iB.isAudioTransformDevice}});let iN=i(71307);Object.defineProperty(t,"isDestroyable",{enumerable:!0,get:function(){return iN.isDestroyable}});let iV=i(53810);Object.defineProperty(t,"isVideoTransformDevice",{enumerable:!0,get:function(){return iV.isVideoTransformDevice}})},21302:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let r=n(i(35711));class s{constructor(e,t=r.default.WARN){this.name=e,this.level=t}info(e){this.log(r.default.INFO,e)}warn(e){this.log(r.default.WARN,e)}error(e){this.log(r.default.ERROR,e)}debug(e){r.default.DEBUG<this.level||("string"==typeof e?this.log(r.default.DEBUG,e):e?this.log(r.default.DEBUG,e()):this.log(r.default.DEBUG,""+e))}setLogLevel(e){this.level=e}getLogLevel(){return this.level}log(e,t){if(e<this.level)return;let i=new Date().toISOString(),n=`${i} [${r.default[e]}] ${this.name} - ${t}`;switch(e){case r.default.ERROR:console.error(n);break;case r.default.WARN:console.warn(n);break;case r.default.DEBUG:console.debug(n.replace(/\\r\\n/g,"\n"));break;case r.default.INFO:console.info(n)}}}t.default=s},51928:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(e,t,i,n){this.sequenceNumber=e,this.message=t,this.timestampMs=i,this.logLevel=n}}t.default=i},35711:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.LogLevel=void 0,function(e){e[e.DEBUG=0]="DEBUG",e[e.INFO=1]="INFO",e[e.WARN=2]="WARN",e[e.ERROR=3]="ERROR",e[e.OFF=4]="OFF"}(i=t.LogLevel||(t.LogLevel={})),t.default=i},40709:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let r=n(i(35711));class s{constructor(...e){this._loggers=e}info(e){for(let t of this._loggers)t.info(e)}warn(e){for(let t of this._loggers)t.warn(e)}error(e){for(let t of this._loggers)t.error(e)}debug(e){let t,i;for(let n of(i="string"==typeof e?e:e?()=>(t||(t=e()),t):""+e,this._loggers))n.debug(i)}setLogLevel(e){for(let t of this._loggers)t.setLogLevel(e)}getLogLevel(){for(let e of this._loggers)return e.getLogLevel();return r.default.OFF}}t.default=s},65718:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let r=n(i(35711)),s=n(i(93101));class o extends s.default{constructor(){super(r.default.DEBUG)}}t.default=o},93101:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let r=n(i(35711));class s{constructor(e=r.default.OFF){this.level=e}info(e){}warn(e){}error(e){}debug(e){r.default.DEBUG<this.level||"string"==typeof e||e()}setLogLevel(e){this.level=e}getLogLevel(){return this.level}}t.default=s},63588:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=r(i(81211)),o=r(i(51928)),a=r(i(35711));class l{constructor(e){this.logCapture=[],this.lock=!1,this.sequenceNumber=0;let{url:t,batchSize:i=l.BATCH_SIZE,intervalMs:n=l.INTERVAL_MS,logLevel:r=a.default.WARN,metadata:s,headers:o}=e;this.url=t,this.batchSize=i,this.intervalMs=n,this.logLevel=r,this.metadata=s,this.headers=o,this.start(),this.eventListener=()=>{this.stop()},this.addEventListener()}addEventListener(){this.eventListener&&"window"in i.g&&window.addEventListener&&window.addEventListener("unload",this.eventListener)}removeEventListener(){this.eventListener&&"window"in i.g&&window.removeEventListener&&window.removeEventListener("unload",this.eventListener)}debug(e){a.default.DEBUG<this.logLevel||("string"==typeof e?this.log(a.default.DEBUG,e):e?this.log(a.default.DEBUG,e()):this.log(a.default.DEBUG,""+e))}info(e){this.log(a.default.INFO,e)}warn(e){this.log(a.default.WARN,e)}error(e){this.log(a.default.ERROR,e)}setLogLevel(e){this.logLevel=e}getLogLevel(){return this.logLevel}getLogCaptureSize(){return this.logCapture.length}start(){this.addEventListener(),this.intervalScheduler=new s.default(this.intervalMs),this.intervalScheduler.start(()=>n(this,void 0,void 0,function*(){if(!0===this.lock||0===this.getLogCaptureSize())return;this.lock=!0;let e=this.logCapture.slice(0,this.batchSize),t=this.makeRequestBody(e);try{let i=yield fetch(this.url,Object.assign({method:"POST",body:t},this.headers?{headers:this.headers}:{}));200===i.status&&(this.logCapture=this.logCapture.slice(e.length))}catch(e){console.warn("[POSTLogger] "+e.message)}finally{this.lock=!1}}))}stop(){var e;null===(e=this.intervalScheduler)||void 0===e||e.stop(),this.intervalScheduler=void 0,this.removeEventListener();let t=this.makeRequestBody(this.logCapture);navigator.sendBeacon(this.url,t)}destroy(){return n(this,void 0,void 0,function*(){this.stop(),this.metadata=void 0,this.headers=void 0,this.logCapture=[],this.sequenceNumber=0,this.lock=!1,this.batchSize=0,this.intervalMs=0,this.url=void 0})}makeRequestBody(e){return JSON.stringify(Object.assign(Object.assign({},this.metadata),{logs:e}))}log(e,t){if(e<this.logLevel)return;let i=Date.now();this.logCapture.push(new o.default(this.sequenceNumber,t,i,a.default[e])),this.sequenceNumber+=1}}t.default=l,l.BATCH_SIZE=85,l.INTERVAL_MS=2e3},98557:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let r=n(i(13774));class s{constructor(){this.isMediaDevicesSupported="undefined"!=typeof navigator&&!!navigator.mediaDevices}create(){if(this.isMediaDevicesSupported)return new Proxy(navigator.mediaDevices,new r.default);throw Error("navigator.mediaDevices is not supported")}}t.default=s},13774:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=r(i(45619)),o=r(i(81211));class a{constructor(){this.scheduler=null,this.devices=null,this.deviceChangeListeners=new Set,this.get=(e,t,i)=>{if(!Reflect.has(e,t))return;if(!("ondevicechange"in navigator.mediaDevices)){if("addEventListener"===t)return this.patchAddEventListener(e,t,i);if("removeEventListener"===t)return this.patchRemoveEventListener(e,t,i)}let n=Reflect.get(e,t,i);return"function"==typeof n?n.bind(e):n},this.patchAddEventListener=(e,t,i)=>{let n=Reflect.get(e,t,i);return(t,i,r)=>{if("devicechange"!==t)return Reflect.apply(n,e,[t,i,r]);this.deviceChangeListeners.add(i),this.scheduler||(this.scheduler=new o.default(a.INTERVAL_MS),this.scheduler.start(this.pollDeviceLists))}},this.patchRemoveEventListener=(e,t,i)=>{let n=Reflect.get(e,t,i);return(t,i,r)=>{if("devicechange"!==t)return Reflect.apply(n,e,[t,i,r]);this.deviceChangeListeners.delete(i),0===this.deviceChangeListeners.size&&this.scheduler&&(this.scheduler.stop(),this.scheduler=null)}},this.pollDeviceLists=()=>n(this,void 0,void 0,function*(){let e=yield this.sortedDeviceList();this.devices&&(e.length!==this.devices.length||e.some((e,t)=>e.deviceId!==this.devices[t].deviceId))&&this.handleDeviceChangeEvent(),this.devices=e})}sortedDeviceList(){return n(this,void 0,void 0,function*(){return(yield navigator.mediaDevices.enumerateDevices()).sort((e,t)=>e.deviceId<t.deviceId?1:e.deviceId>t.deviceId?-1:0)})}handleDeviceChangeEvent(){for(let e of this.deviceChangeListeners)s.default.nextTick(()=>{if(this.deviceChangeListeners.has(e)){let t=new Event("devicechange");"function"==typeof e?e(t):e.handleEvent(t)}})}}t.default=a,a.INTERVAL_MS=1e3},28388:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{acquireAudioInputStream(){return Promise.reject()}acquireVideoInputStream(){return Promise.reject()}acquireDisplayInputStream(e){return Promise.reject()}muteLocalAudioInputStream(){}unmuteLocalAudioInputStream(){}addMediaStreamBrokerObserver(e){}removeMediaStreamBrokerObserver(e){}}t.default=i},22984:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.CheckAudioConnectivityFeedback=void 0,function(e){e[e.Succeeded=0]="Succeeded",e[e.AudioInputRequestFailed=1]="AudioInputRequestFailed",e[e.AudioInputPermissionDenied=2]="AudioInputPermissionDenied",e[e.ConnectionFailed=3]="ConnectionFailed",e[e.AudioNotReceived=4]="AudioNotReceived"}(i=t.CheckAudioConnectivityFeedback||(t.CheckAudioConnectivityFeedback={})),t.default=i},34419:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.CheckAudioInputFeedback=void 0,function(e){e[e.Succeeded=0]="Succeeded",e[e.Failed=1]="Failed",e[e.PermissionDenied=2]="PermissionDenied"}(i=t.CheckAudioInputFeedback||(t.CheckAudioInputFeedback={})),t.default=i},17739:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.CheckAudioOutputFeedback=void 0,function(e){e[e.Succeeded=0]="Succeeded",e[e.Failed=1]="Failed"}(i=t.CheckAudioOutputFeedback||(t.CheckAudioOutputFeedback={})),t.default=i},21216:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.CheckCameraResolutionFeedback=void 0,function(e){e[e.Succeeded=0]="Succeeded",e[e.Failed=1]="Failed",e[e.ResolutionNotSupported=2]="ResolutionNotSupported",e[e.PermissionDenied=3]="PermissionDenied"}(i=t.CheckCameraResolutionFeedback||(t.CheckCameraResolutionFeedback={})),t.default=i},97716:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.CheckContentShareConnectivityFeedback=void 0,function(e){e[e.Succeeded=0]="Succeeded",e[e.Failed=1]="Failed",e[e.PermissionDenied=2]="PermissionDenied",e[e.TimedOut=3]="TimedOut",e[e.ConnectionFailed=4]="ConnectionFailed"}(i=t.CheckContentShareConnectivityFeedback||(t.CheckContentShareConnectivityFeedback={})),t.default=i},71743:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.CheckNetworkTCPConnectivityFeedback=void 0,function(e){e[e.Succeeded=0]="Succeeded",e[e.MeetingSessionURLsNotInitialized=1]="MeetingSessionURLsNotInitialized",e[e.ConnectionFailed=2]="ConnectionFailed",e[e.ICENegotiationFailed=3]="ICENegotiationFailed"}(i=t.CheckNetworkTCPConnectivityFeedback||(t.CheckNetworkTCPConnectivityFeedback={})),t.default=i},49702:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.CheckNetworkUDPConnectivityFeedback=void 0,function(e){e[e.Succeeded=0]="Succeeded",e[e.MeetingSessionURLsNotInitialized=1]="MeetingSessionURLsNotInitialized",e[e.ConnectionFailed=2]="ConnectionFailed",e[e.ICENegotiationFailed=3]="ICENegotiationFailed"}(i=t.CheckNetworkUDPConnectivityFeedback||(t.CheckNetworkUDPConnectivityFeedback={})),t.default=i},69214:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.CheckVideoConnectivityFeedback=void 0,function(e){e[e.Succeeded=0]="Succeeded",e[e.VideoInputRequestFailed=1]="VideoInputRequestFailed",e[e.VideoInputPermissionDenied=2]="VideoInputPermissionDenied",e[e.ConnectionFailed=3]="ConnectionFailed",e[e.VideoNotSent=4]="VideoNotSent"}(i=t.CheckVideoConnectivityFeedback||(t.CheckVideoConnectivityFeedback={})),t.default=i},93183:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.CheckVideoInputFeedback=void 0,function(e){e[e.Succeeded=0]="Succeeded",e[e.Failed=1]="Failed",e[e.PermissionDenied=2]="PermissionDenied"}(i=t.CheckVideoInputFeedback||(t.CheckVideoInputFeedback={})),t.default=i},93156:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=r(i(97241)),o=r(i(81341)),a=r(i(28623)),l=r(i(45724)),d=r(i(49288)),u=r(i(30296)),c=r(i(22984)),h=r(i(34419)),f=r(i(17739)),p=r(i(21216)),m=r(i(97716)),g=r(i(71743)),v=r(i(49702)),b=r(i(69214)),S=r(i(93183)),y=r(i(94308));class w{constructor(e,t,i=new y.default){this.logger=e,this.meetingSession=t,this.configuration=i,this.browserBehavior=new o.default}static delay(e){return n(this,void 0,void 0,function*(){return new Promise(t=>setTimeout(t,e))})}checkAudioInput(e){return n(this,void 0,void 0,function*(){try{return yield this.meetingSession.audioVideo.startAudioInput(e),yield this.meetingSession.audioVideo.stopAudioInput(),h.default.Succeeded}catch(e){if(this.logger.error(`MeetingReadinessChecker: Audio input check failed with error ${e}`),e instanceof l.default)return h.default.PermissionDenied;return h.default.Failed}})}checkAudioOutput(e,t,i=null){return n(this,void 0,void 0,function*(){try{let n=e?a.default.getIntrinsicDeviceId(e):"";if(yield this.playTone(n,this.configuration.audioOutputFrequency,i),yield t())return f.default.Succeeded;return f.default.Failed}catch(e){return this.logger.error(`MeetingReadinessChecker: Audio output check failed with error: ${e}`),f.default.Failed}finally{this.stopTone()}})}playTone(e,t,i){return n(this,void 0,void 0,function*(){let n=.1,r=this.configuration.audioOutputGain;this.oscillatorNode&&this.stopTone(),this.audioContext=a.default.getAudioContext(),this.gainNode=this.audioContext.createGain(),this.gainNode.gain.value=0,this.oscillatorNode=this.audioContext.createOscillator(),this.oscillatorNode.frequency.value=t,this.oscillatorNode.connect(this.gainNode),this.destinationStream=this.audioContext.createMediaStreamDestination(),this.gainNode.connect(this.destinationStream);let o=this.audioContext.currentTime+.1;this.gainNode.gain.linearRampToValueAtTime(0,o),this.gainNode.gain.linearRampToValueAtTime(r,o+n),this.oscillatorNode.start();let l=new s.default(this.logger);try{this.browserBehavior.supportsSetSinkId()&&(yield l.bindAudioDevice({deviceId:e}))}catch(e){this.logger.error(`Failed to bind audio device: ${e}`)}try{yield l.bindAudioElement(i||new Audio)}catch(e){this.logger.error(`Failed to bind audio element: ${e}`)}yield l.bindAudioStream(this.destinationStream.stream)})}stopTone(){if(!this.audioContext||!this.gainNode||!this.oscillatorNode||!this.destinationStream)return;let e=1,t=.1,i=this.configuration.audioOutputGain,n=this.audioContext.currentTime;this.gainNode.gain.linearRampToValueAtTime(i,n+t+e),this.gainNode.gain.linearRampToValueAtTime(0,n+2*t+e),this.oscillatorNode.stop(),this.oscillatorNode.disconnect(this.gainNode),this.gainNode.disconnect(this.destinationStream),this.oscillatorNode=null,this.gainNode=null,this.destinationStream=null}checkVideoInput(e){return n(this,void 0,void 0,function*(){try{return yield this.meetingSession.audioVideo.startVideoInput(e),yield this.meetingSession.audioVideo.stopVideoInput(),S.default.Succeeded}catch(e){if(this.logger.error(`MeetingReadinessChecker: Video check failed with error ${e}`),e instanceof l.default)return S.default.PermissionDenied;return S.default.Failed}})}checkCameraResolution(e,t,i){return n(this,void 0,void 0,function*(){let n;try{let r=a.default.getIntrinsicDeviceId(e),s={video:this.calculateVideoConstraint(r,t,i)};n=yield navigator.mediaDevices.getUserMedia(s)}catch(e){if(this.logger.error(`MeetingReadinessChecker: Camera resolution check with width: ${t} height ${i} failed with error ${e}`),e&&"OverconstrainedError"===e.name)return p.default.ResolutionNotSupported;if(e&&"NotAllowedError"===e.name)return p.default.PermissionDenied;return p.default.Failed}finally{n&&n.getTracks().forEach(function(e){e.stop()})}return p.default.Succeeded})}calculateVideoConstraint(e,t,i){let n=this.browserBehavior.requiresResolutionAlignment(t,i),r={};return this.browserBehavior.requiresNoExactMediaStreamConstraints()?(r.deviceId=e,r.width=t,r.height=i):(r.deviceId={exact:e},r.width={exact:n[0]},r.height={exact:n[1]}),r}checkContentShareConnectivity(e){return n(this,void 0,void 0,function*(){let t=!1,i=!1,r={contentShareDidStart:()=>{t=!0}},s={audioVideoDidStart:()=>{i=!0}};try{if(this.meetingSession.audioVideo.addObserver(s),this.meetingSession.audioVideo.start(),this.meetingSession.audioVideo.addContentShareObserver(r),yield this.meetingSession.audioVideo.startContentShareFromScreenCapture(e),yield this.executeTimeoutTask(()=>n(this,void 0,void 0,function*(){return i&&t})),!i)return m.default.ConnectionFailed;return yield this.stopMeeting(),t?m.default.Succeeded:m.default.TimedOut}catch(e){if(this.logger.error(`MeetingReadinessChecker: Content share check failed with error ${e}`),"NotAllowedError"===e.name)return m.default.PermissionDenied;return m.default.Failed}finally{this.meetingSession.audioVideo.removeObserver(s),this.meetingSession.audioVideo.stopContentShare(),this.meetingSession.audioVideo.removeContentShareObserver(r)}})}checkAudioConnectivity(e){return n(this,void 0,void 0,function*(){let t=!1,i={packetsReceived:0},r=this.meetingSession.audioVideo,s={metricsDidReceive(e){e.getRTCStatsReport().forEach(e=>{"inbound-rtp"===e.type&&("audio"===e.mediaType||"audio"===e.kind)&&(i.packetsReceived=e.packetsReceived)})}},o=(e,i,n,r)=>{e===this.meetingSession.configuration.credentials.attendeeId&&i&&(t=!0)};try{yield r.startAudioInput(e)}catch(e){if(this.logger.error(`MeetingReadinessChecker: Failed to get audio input device with error ${e}`),e instanceof l.default)return c.default.AudioInputPermissionDenied;return c.default.AudioInputRequestFailed}return(r.realtimeSubscribeToAttendeeIdPresence(o),r.addObserver(s),yield this.startMeeting())?(yield this.executeTimeoutTask(()=>n(this,void 0,void 0,function*(){return this.isAudioConnectionSuccessful(t,i)})),r.removeObserver(s),r.realtimeUnsubscribeToAttendeeIdPresence(o),yield this.stopMeeting(),yield this.meetingSession.audioVideo.stopAudioInput(),this.isAudioConnectionSuccessful(t,i)?c.default.Succeeded:c.default.AudioNotReceived):(r.removeObserver(s),r.realtimeUnsubscribeToAttendeeIdPresence(o),yield this.meetingSession.audioVideo.stopAudioInput(),c.default.ConnectionFailed)})}checkVideoConnectivity(e){return n(this,void 0,void 0,function*(){let t=this.meetingSession.audioVideo,i=0,r={metricsDidReceive(e){e.getRTCStatsReport().forEach(e=>{"outbound-rtp"===e.type&&("video"===e.mediaType||"video"===e.kind)&&(i=e.packetsSent)})}};try{yield t.startVideoInput(e)}catch(e){if(this.logger.error(`MeetingReadinessChecker: Failed to get video input device with error ${e}`),e instanceof l.default)return b.default.VideoInputPermissionDenied;return b.default.VideoInputRequestFailed}return(t.addObserver(r),yield this.startMeeting())?(t.startLocalVideoTile(),yield this.executeTimeoutTask(()=>n(this,void 0,void 0,function*(){return i>0})),yield t.stopVideoInput(),yield this.stopMeeting(),t.removeObserver(r),i<=0)?b.default.VideoNotSent:b.default.Succeeded:b.default.ConnectionFailed})}checkNetworkUDPConnectivity(){return n(this,void 0,void 0,function*(){let e=!1,t={metricsDidReceive(t){t.getRTCStatsReport().forEach(t=>{"candidate-pair"===t.type&&"succeeded"===t.state&&(e=!0)})}};try{this.originalURLRewriter=this.meetingSession.configuration.urls.urlRewriter}catch(e){return this.logger.error(`MeetingSessionConfiguration.urls doesn't exist. Error: ${e}`),v.default.MeetingSessionURLsNotInitialized}this.meetingSession.configuration.urls.urlRewriter=e=>{let t=this.originalURLRewriter(e);return t.includes("transport=tcp")?"":t};let i=this.meetingSession.audioVideo;return(i.addObserver(t),yield this.startMeeting())?(yield this.executeTimeoutTask(()=>n(this,void 0,void 0,function*(){return e})),this.meetingSession.configuration.urls.urlRewriter=this.originalURLRewriter,yield this.stopMeeting(),i.removeObserver(t),e)?v.default.Succeeded:v.default.ICENegotiationFailed:(this.meetingSession.configuration.urls.urlRewriter=this.originalURLRewriter,v.default.ConnectionFailed)})}checkNetworkTCPConnectivity(){return n(this,void 0,void 0,function*(){let e=!1,t={metricsDidReceive(t){t.getRTCStatsReport().forEach(t=>{"candidate-pair"===t.type&&"succeeded"===t.state&&(e=!0)})}};try{this.originalURLRewriter=this.meetingSession.configuration.urls.urlRewriter}catch(e){return this.logger.error(`MeetingSessionConfiguration.urls doesn't exist. Error: ${e}`),g.default.MeetingSessionURLsNotInitialized}this.meetingSession.configuration.urls.urlRewriter=e=>{let t=this.originalURLRewriter(e);return t.includes("transport=udp")?"":t};let i=this.meetingSession.audioVideo;return(i.addObserver(t),yield this.startMeeting())?(yield this.executeTimeoutTask(()=>n(this,void 0,void 0,function*(){return e})),this.meetingSession.configuration.urls.urlRewriter=this.originalURLRewriter,yield this.stopMeeting(),i.removeObserver(t),e)?g.default.Succeeded:g.default.ICENegotiationFailed:(this.meetingSession.configuration.urls.urlRewriter=this.originalURLRewriter,g.default.ConnectionFailed)})}startMeeting(){return n(this,void 0,void 0,function*(){let e=!1,t={audioVideoDidStart:()=>{e=!0}};return this.meetingSession.audioVideo.addObserver(t),this.meetingSession.audioVideo.start(),yield this.executeTimeoutTask(()=>n(this,void 0,void 0,function*(){return e})),this.meetingSession.audioVideo.removeObserver(t),e})}stopMeeting(){return n(this,void 0,void 0,function*(){let e=!1,t={audioVideoDidStop:t=>{e=!0}};return this.meetingSession.audioVideo.addObserver(t),this.meetingSession.audioVideo.stop(),yield this.executeTimeoutTask(()=>n(this,void 0,void 0,function*(){return e})),this.meetingSession.audioVideo.removeObserver(t),e})}executeTimeoutTask(e){return n(this,void 0,void 0,function*(){let t=!1;class i extends d.default{constructor(e,t){super(e),this.waitDurationMs=t,this.isCancelled=!1}cancel(){this.isCancelled=!0}run(){return n(this,void 0,void 0,function*(){for(;!this.isCancelled;){if(yield e()){t=!0;break}yield w.delay(this.waitDurationMs)}})}}let r=new u.default(this.logger,new i(this.logger,this.configuration.waitDurationMs),this.configuration.timeoutMs);return yield r.run(),t})}isAudioConnectionSuccessful(e,t){return e&&t.packetsReceived>0}}t.default=w},94308:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(){this.timeoutMs=1e4,this.waitDurationMs=3e3,this.audioOutputFrequency=440,this.audioOutputGain=.1}}t.default=i},44583:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=r(i(204)),o=r(i(34114)),a=r(i(2739)),l=r(i(81341)),d=r(i(92240)),u=r(i(98220)),c=r(i(52781)),h=i(71307),f=r(i(19444)),p=r(i(97386)),m=r(i(14832));class g{constructor(e,t,i,n){this._eventController=n,this._configuration=e,this._logger=t,this.checkBrowserSupportAndFeatureConfiguration(),c.default.addLogger(this._logger),c.default.register(),this._eventController||(this._eventController=new f.default(e,t)),i.eventController||(i.eventController=this.eventController),this.audioVideoController=new s.default(this._configuration,this._logger,new m.default(this._logger),i,new p.default(this._configuration.reconnectTimeoutMs,new a.default(this._configuration.reconnectFixedWaitMs,this._configuration.reconnectShortBackOffMs,this._configuration.reconnectLongBackOffMs)),this.eventController),this._deviceController=i,this.logger.info(`MeetingFeatures: ${JSON.stringify(e.meetingFeatures)}`);let r=new d.default(this._logger);this.contentShareController=new u.default(r,new s.default(u.default.createContentShareMeetingSessionConfigure(this._configuration),this._logger,new m.default(this._logger),r,new p.default(this._configuration.reconnectTimeoutMs,new a.default(this._configuration.reconnectFixedWaitMs,this._configuration.reconnectShortBackOffMs,this._configuration.reconnectLongBackOffMs))),this.audioVideoController),this.audioVideoFacade=new o.default(this.audioVideoController,this.audioVideoController.videoTileController,this.audioVideoController.realtimeController,this.audioVideoController.audioMixController,this._deviceController,this.contentShareController)}get configuration(){return this._configuration}get logger(){return this._logger}get audioVideo(){return this.audioVideoFacade}get contentShare(){return this.contentShareController}get deviceController(){return this._deviceController}get eventController(){return this._eventController}destroy(){return n(this,void 0,void 0,function*(){h.isDestroyable(this.contentShareController)&&(yield this.contentShareController.destroy()),h.isDestroyable(this.audioVideoController)&&(yield this.audioVideoController.destroy()),h.isDestroyable(this.eventController)&&(yield this.eventController.destroy()),c.default.removeLogger(this._logger),this._logger=void 0,this._configuration=void 0,this._deviceController=void 0,this.audioVideoFacade=void 0,this.audioVideoController=void 0,this.contentShareController=void 0,this._eventController=void 0})}checkBrowserSupportAndFeatureConfiguration(){let e=new l.default,t=`${e.name()} ${e.majorVersion()} (${e.version()})`;if(this.logger.info(`browser is ${t}`),e.isSupported()||this.logger.warn(`this browser is not currently supported. Stability may suffer. Supported browsers are: ${e.supportString()}.`),this._configuration.videoUplinkBandwidthPolicy){if(this.isSimulcastUplinkPolicy(this._configuration.videoUplinkBandwidthPolicy)){if(!e.hasChromiumWebRTC())throw Error("Simulcast is only supported on Chromium-based browsers");this._configuration.enableSimulcastForUnifiedPlanChromiumBasedBrowsers=!0}else this._configuration.enableSimulcastForUnifiedPlanChromiumBasedBrowsers=!1}this._configuration.enableSimulcastForUnifiedPlanChromiumBasedBrowsers&&(e.hasChromiumWebRTC()?this.logger.info(`Simulcast is enabled for ${e.name()}`):(this._configuration.enableSimulcastForUnifiedPlanChromiumBasedBrowsers=!1,this.logger.info("Simulcast is only supported on Chromium-based browsers")),this._configuration.enableSVC&&(this._configuration.enableSVC=!1,this.logger.info("SVC is not successfully enabled since simulcast is enabled"))),this._configuration.enableSVC&&!e.supportsScalableVideoCoding()&&(this._configuration.enableSVC=!1,this.logger.info("SVC is only supported on Chromium-based browsers with version 111 or above"))}isSimulcastUplinkPolicy(e){return!!(e&&e.addObserver)}}t.default=g},30857:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let r=n(i(55510));class s{constructor(e=r.default.VideoResolutionHD,t=r.default.VideoResolutionFHD){this.videoMaxResolution=e,this.contentMaxResolution=t}clone(){return new s(this.videoMaxResolution,this.contentMaxResolution)}}t.default=s},38374:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let r=n(i(81107)),s=n(i(55510)),o=i(17201),a=n(i(30857)),l=n(i(63606)),d=n(i(64432));class u{constructor(e,t){var i,n;if(this.meetingId=null,this.externalMeetingId=null,this.credentials=null,this.urls=null,this.connectionTimeoutMs=15e3,this.attendeePresenceTimeoutMs=0,this.connectionHealthPolicyConfiguration=new r.default,this.reconnectTimeoutMs=12e4,this.reconnectFixedWaitMs=0,this.reconnectShortBackOffMs=1e3,this.reconnectLongBackOffMs=5e3,this.enableSimulcastForUnifiedPlanChromiumBasedBrowsers=!1,this.enableSVC=!1,this.videoDownlinkBandwidthPolicy=null,this.videoUplinkBandwidthPolicy=null,this.keepLastFrameWhenPaused=!1,this.disablePeriodicKeyframeRequestOnContentSender=!1,this.meetingFeatures=new a.default,e){(e=o.toLowerCasePropertyNames(e)).meeting&&(e=e.meeting),this.meetingId=e.meetingid,this.externalMeetingId=e.externalmeetingid,this.urls=new d.default,this.urls.audioHostURL=e.mediaplacement.audiohosturl,this.urls.signalingURL=e.mediaplacement.signalingurl,this.urls.turnControlURL=e.mediaplacement.turncontrolurl,e.mediaplacement.eventingestionurl&&(this.urls.eventIngestionURL=e.mediaplacement.eventingestionurl);let t=(e,t)=>{switch(e){case"None":return s.default.VideoDisabled;case"HD":return s.default.VideoResolutionHD;case"FHD":return s.default.VideoResolutionFHD;case"UHD":return s.default.VideoResolutionUHD;default:return t}};if((null===(i=e.meetingfeatures)||void 0===i?void 0:i.video)!==void 0||(null===(n=e.meetingfeatures)||void 0===n?void 0:n.content)!==void 0){let i=void 0===e.meetingfeatures.video?"HD":e.meetingfeatures.video.maxresolution,n=void 0===e.meetingfeatures.content?"FHD":e.meetingfeatures.content.maxresolution;this.meetingFeatures=new a.default(t(i,s.default.VideoResolutionHD),t(n,s.default.VideoResolutionFHD))}}t&&((t=o.toLowerCasePropertyNames(t)).attendee&&(t=t.attendee),this.credentials=new l.default,this.credentials.attendeeId=t.attendeeid,this.credentials.externalUserId=t.externaluserid,this.credentials.joinToken=t.jointoken)}}t.default=u},63606:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(){this.attendeeId=null,this.externalUserId=null,this.joinToken=null}toJSON(){return{attendeeId:this.attendeeId,joinToken:null===this.joinToken?null:"<redacted>"}}}t.default=i},27645:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.MeetingSessionLifecycleEvent=void 0,function(e){e[e.Connecting=0]="Connecting",e[e.Started=1]="Started",e[e.Stopped=2]="Stopped"}(i=t.MeetingSessionLifecycleEvent||(t.MeetingSessionLifecycleEvent={})),t.default=i},10441:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.MeetingSessionLifecycleEventCondition=void 0,function(e){e[e.ConnectingNew=0]="ConnectingNew",e[e.ReconnectingExisting=1]="ReconnectingExisting",e[e.StartedNew=2]="StartedNew",e[e.StartedExisting=3]="StartedExisting",e[e.StartedAfterReconnect=4]="StartedAfterReconnect",e[e.StoppedCleanly=5]="StoppedCleanly",e[e.StoppedWithFailure=6]="StoppedWithFailure"}(i=t.MeetingSessionLifecycleEventCondition||(t.MeetingSessionLifecycleEventCondition={})),t.default=i},57456:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let r=i(39163),s=n(i(8056));class o{constructor(e){this._statusCode=e}statusCode(){return this._statusCode}isFailure(){switch(this._statusCode){case s.default.AudioAuthenticationRejected:case s.default.AudioCallAtCapacity:case s.default.AudioInternalServerError:case s.default.AudioServiceUnavailable:case s.default.AudioDisconnected:case s.default.VideoCallAtSourceCapacity:case s.default.SignalingBadRequest:case s.default.SignalingInternalServerError:case s.default.SignalingRequestFailed:case s.default.ICEGatheringTimeoutWorkaround:case s.default.ConnectionHealthReconnect:case s.default.RealtimeApiFailed:case s.default.TaskFailed:case s.default.NoAttendeePresent:return!0;default:return!1}}isTerminal(){switch(this._statusCode){case s.default.Left:case s.default.AudioJoinedFromAnotherDevice:case s.default.AudioAuthenticationRejected:case s.default.AudioCallAtCapacity:case s.default.MeetingEnded:case s.default.AudioDisconnected:case s.default.TURNCredentialsForbidden:case s.default.SignalingBadRequest:case s.default.SignalingRequestFailed:case s.default.VideoCallAtSourceCapacity:case s.default.RealtimeApiFailed:case s.default.AudioAttendeeRemoved:return!0;default:return!1}}isAudioConnectionFailure(){switch(this._statusCode){case s.default.AudioAuthenticationRejected:case s.default.AudioInternalServerError:case s.default.AudioServiceUnavailable:case s.default.ICEGatheringTimeoutWorkaround:case s.default.SignalingBadRequest:case s.default.SignalingInternalServerError:case s.default.SignalingRequestFailed:case s.default.RealtimeApiFailed:case s.default.NoAttendeePresent:return!0;default:return!1}}toString(){switch(this._statusCode){case s.default.OK:return"Everything is OK so far.";case s.default.Left:return"The attendee left the meeting.";case s.default.AudioJoinedFromAnotherDevice:return"The attendee joined from another device.";case s.default.AudioAuthenticationRejected:return"The meeting rejected the attendee.";case s.default.AudioCallAtCapacity:return"The attendee couldn't join because the meeting was at capacity.";case s.default.MeetingEnded:return"The meeting ended.";case s.default.AudioInternalServerError:case s.default.AudioServiceUnavailable:case s.default.AudioDisconnected:return"The audio connection failed.";case s.default.VideoCallSwitchToViewOnly:return"The attendee couldn't start the local video because the maximum video capacity was reached.";case s.default.VideoCallAtSourceCapacity:return"The connection failed due to an internal server error.";case s.default.SignalingBadRequest:case s.default.SignalingInternalServerError:case s.default.SignalingRequestFailed:return"The signaling connection failed.";case s.default.ICEGatheringTimeoutWorkaround:return"Gathering ICE candidates timed out. In Chrome, this might indicate that the browser is in a bad state after reconnecting to VPN.";case s.default.ConnectionHealthReconnect:return"The meeting was reconnected.";case s.default.RealtimeApiFailed:return"The real-time API failed. This status code might indicate that the callback you passed to the real-time API threw an exception.";case s.default.TaskFailed:return"The connection failed. See the error message for more details.";case s.default.IncompatibleSDP:return"The connection failed due to incompatible SDP.";case s.default.TURNCredentialsForbidden:return"The meeting ended, or the attendee was removed.";case s.default.NoAttendeePresent:return"The attendee was not present.";case s.default.AudioAttendeeRemoved:return"The meeting ended because attendee removed.";case s.default.AudioVideoWasRemovedFromPrimaryMeeting:return"The Primary meeting credentials provided are no longer valid. chime::DeleteAttendee may have been called on them.";case s.default.AudioDisconnectAudio:return"The audio connection failed.";default:{let e=this._statusCode;throw Error(`Unhandled case: ${e}`)}}}static fromSignalFrame(e){return e.error&&e.error.status?this.fromSignalingStatus(e.error.status):e.type===r.SdkSignalFrame.Type.AUDIO_STATUS?e.audioStatus?this.fromAudioStatus(e.audioStatus.audioStatus):new o(s.default.SignalingRequestFailed):new o(e.type===r.SdkSignalFrame.Type.PRIMARY_MEETING_LEAVE?s.default.AudioVideoWasRemovedFromPrimaryMeeting:s.default.OK)}static fromAudioStatus(e){switch(e){case 200:return new o(s.default.OK);case 301:return new o(s.default.AudioJoinedFromAnotherDevice);case 302:return new o(s.default.AudioDisconnectAudio);case 403:return new o(s.default.AudioAuthenticationRejected);case 409:return new o(s.default.AudioCallAtCapacity);case 410:return new o(s.default.MeetingEnded);case 411:return new o(s.default.AudioAttendeeRemoved);case 500:return new o(s.default.AudioInternalServerError);case 503:return new o(s.default.AudioServiceUnavailable);default:if(2===Math.floor(e/100))return new o(s.default.OK);return new o(s.default.AudioDisconnected)}}static fromSignalingStatus(e){switch(e){case 206:return new o(s.default.VideoCallSwitchToViewOnly);case 509:return new o(s.default.VideoCallAtSourceCapacity);case 403:return new o(s.default.AudioAuthenticationRejected);case 409:return new o(s.default.AudioCallAtCapacity);default:switch(Math.floor(e/100)){case 2:return new o(s.default.OK);case 4:return new o(s.default.SignalingBadRequest);case 5:return new o(s.default.SignalingInternalServerError);default:return new o(s.default.SignalingRequestFailed)}}}}t.default=o},8056:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.MeetingSessionStatusCode=void 0,function(e){e[e.OK=0]="OK",e[e.Left=1]="Left",e[e.AudioJoinedFromAnotherDevice=2]="AudioJoinedFromAnotherDevice",e[e.AudioAuthenticationRejected=3]="AudioAuthenticationRejected",e[e.AudioCallAtCapacity=4]="AudioCallAtCapacity",e[e.MeetingEnded=5]="MeetingEnded",e[e.AudioInternalServerError=6]="AudioInternalServerError",e[e.AudioServiceUnavailable=7]="AudioServiceUnavailable",e[e.AudioDisconnected=8]="AudioDisconnected",e[e.VideoCallSwitchToViewOnly=9]="VideoCallSwitchToViewOnly",e[e.VideoCallAtSourceCapacity=10]="VideoCallAtSourceCapacity",e[e.SignalingBadRequest=11]="SignalingBadRequest",e[e.SignalingInternalServerError=12]="SignalingInternalServerError",e[e.SignalingRequestFailed=13]="SignalingRequestFailed",e[e.ICEGatheringTimeoutWorkaround=14]="ICEGatheringTimeoutWorkaround",e[e.ConnectionHealthReconnect=15]="ConnectionHealthReconnect",e[e.RealtimeApiFailed=16]="RealtimeApiFailed",e[e.TaskFailed=17]="TaskFailed",e[e.IncompatibleSDP=18]="IncompatibleSDP",e[e.TURNCredentialsForbidden=19]="TURNCredentialsForbidden",e[e.NoAttendeePresent=20]="NoAttendeePresent",e[e.AudioAttendeeRemoved=21]="AudioAttendeeRemoved",e[e.AudioVideoWasRemovedFromPrimaryMeeting=22]="AudioVideoWasRemovedFromPrimaryMeeting",e[e.AudioDisconnectAudio=23]="AudioDisconnectAudio"}(i=t.MeetingSessionStatusCode||(t.MeetingSessionStatusCode={})),t.default=i},25735:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(){this.username=null,this.password=null,this.ttl=null,this.uris=null}}t.default=i},64432:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(){this._audioHostURL=null,this._signalingURL=null,this._turnControlURL=null,this._eventIngestionURL=null,this.urlRewriter=e=>e}get audioHostURL(){return this.urlRewriter(this._audioHostURL)}set audioHostURL(e){this._audioHostURL=e}get signalingURL(){return this.urlRewriter(this._signalingURL)}set signalingURL(e){this._signalingURL=e}get turnControlURL(){return this.urlRewriter(this._turnControlURL)}set turnControlURL(e){this._turnControlURL=e}get eventIngestionURL(){return this.urlRewriter(this._eventIngestionURL)}set eventIngestionURL(e){this._eventIngestionURL=e}}t.default=i},1090:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(){this.remoteVideoAvailable=!1,this.canStartLocalVideo=!1}equal(e){return this.remoteVideoAvailable===e.remoteVideoAvailable&&this.canStartLocalVideo===e.canStartLocalVideo}clone(){let e=new i;return e.remoteVideoAvailable=this.remoteVideoAvailable,e.canStartLocalVideo=this.canStartLocalVideo,e}}t.default=i},43399:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(e,t,i){this.type=e,this.headers=t,this.payload=i}}t.default=i},19671:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=i(46628),o=r(i(2739)),a=r(i(52781)),l=r(i(43399)),d=r(i(97386)),u=r(i(45619)),c=r(i(22533)),h=r(i(14832)),f=r(i(99983)),p=r(i(28116));class m{constructor(e,t,i,n,r){this.configuration=e,this.logger=t,this.webSocket=i,this.reconnectController=n,this.sigV4=r,this.observerQueue=new Set,this.webSocket||(this.webSocket=new h.default(this.logger)),this.reconnectController||(this.reconnectController=new d.default(e.reconnectTimeoutMs,new o.default(e.reconnectFixedWaitMs,e.reconnectShortBackoffMs,e.reconnectLongBackoffMs))),this.sigV4||(this.sigV4=new c.default(this.configuration.chimeClient)),a.default.addLogger(this.logger),a.default.register(),this.preBootstrapMessages=[]}addObserver(e){this.logger.info("adding messaging observer"),this.observerQueue.add(e)}removeObserver(e){this.logger.info("removing messaging observer"),this.observerQueue.delete(e)}start(){return n(this,void 0,void 0,function*(){this.isClosed()?yield this.startConnecting(!1):this.logger.info("messaging session already started")})}stop(){this.isClosed()?this.logger.info("no existing messaging session needs closing"):(this.isClosing=!0,this.webSocket.close(),a.default.removeLogger(this.logger))}forEachObserver(e){for(let t of this.observerQueue)u.default.nextTick(()=>{this.observerQueue.has(t)&&e(t)})}setUpEventListeners(){this.webSocket.addEventListener("open",()=>{this.openEventHandler()}),this.webSocket.addEventListener("message",e=>{this.receiveMessageHandler(e.data)}),this.webSocket.addEventListener("close",e=>{this.closeEventHandler(e)}),this.webSocket.addEventListener("error",()=>{this.logger.error("WebSocket error")})}startConnecting(e){return n(this,void 0,void 0,function*(){return yield this.startConnectingInternal(e),yield new Promise((e,t)=>{this.bootstrapResolved=e,this.bootstrapRejected=t})})}startConnectingInternal(e){var t;return n(this,void 0,void 0,function*(){let i=this.configuration.endpointUrl;if(e||this.reconnectController.reset(),this.reconnectController.hasStartedConnectionAttempt()?this.reconnectController.startedConnectionAttempt(!1):this.reconnectController.startedConnectionAttempt(!0),e||void 0===i)try{if(this.configuration.chimeClient.getMessagingSessionEndpoint instanceof Function){let e=yield this.configuration.chimeClient.getMessagingSessionEndpoint();i=(null===(t=e.Endpoint)||void 0===t?void 0:t.Url)?e.Endpoint.Url:(yield this.configuration.chimeClient.getMessagingSessionEndpoint().promise()).Endpoint.Url}else i=(yield this.configuration.chimeClient.send(new s.GetMessagingSessionEndpointCommand({}))).Endpoint.Url;this.logger.debug(`Messaging endpoint resolved to: ${i}`)}catch(t){this.logger.error(`Messaging Session failed to resolve endpoint: ${t}`);let e=new CloseEvent("close",{wasClean:!1,code:4999,reason:"Failed to get messaging session endpoint URL",bubbles:!1});this.closeEventHandler(e);return}let n=yield this.prepareWebSocketUrl(i);this.logger.info(`opening connection to ${n}`),e||this.reconnectController.reset(),this.reconnectController.hasStartedConnectionAttempt()?this.reconnectController.startedConnectionAttempt(!1):this.reconnectController.startedConnectionAttempt(!0),this.webSocket.create(n,[],!0),this.forEachObserver(t=>{t.messagingSessionDidStartConnecting&&t.messagingSessionDidStartConnecting(e)}),this.setUpEventListeners()})}prepareWebSocketUrl(e){return n(this,void 0,void 0,function*(){let t=new Map;return t.set("userArn",[this.configuration.userArn]),t.set("sessionId",[this.configuration.messagingSessionId]),this.configuration.prefetchOn===p.default.Connect&&t.set("prefetch-on",[p.default.Connect]),this.configuration.prefetchSortBy&&t.set("prefetch-sort-by",[this.configuration.prefetchSortBy]),yield this.sigV4.signURL("GET","wss","chime",e,"/connect","",t)})}isClosed(){return this.webSocket.readyState()===f.default.None||this.webSocket.readyState()===f.default.Closed}openEventHandler(){this.reconnectController.reset(),this.isSessionEstablished=!1}receiveMessageHandler(e){try{let t=JSON.parse(e),i=t.Headers["x-amz-chime-event-type"],n=new l.default(i,t.Headers,t.Payload||null);if(this.isSessionEstablished||"SESSION_ESTABLISHED"!==i){if(!this.isSessionEstablished){this.preBootstrapMessages.push(n);return}}else{this.forEachObserver(e=>{e.messagingSessionDidStart&&e.messagingSessionDidStart()}),this.bootstrapResolved(),this.isSessionEstablished=!0;let e=this.preBootstrapMessages.length;for(let t=0;t<e;t++){let e=this.preBootstrapMessages.shift();this.forEachObserver(t=>{this.sendMessageToObserver(t,e)})}}this.forEachObserver(e=>{this.sendMessageToObserver(e,n)})}catch(e){this.logger.error(`Messaging parsing failed: ${e}`)}}sendMessageToObserver(e,t){e.messagingSessionDidReceiveMessage&&e.messagingSessionDidReceiveMessage(t)}retryConnection(){return this.reconnectController.retryWithBackoff(()=>n(this,void 0,void 0,function*(){yield this.startConnecting(!0)}),null)}closeEventHandler(e){this.logger.info(`WebSocket close: ${e.code} ${e.reason}`),4999!==e.code&&this.webSocket.destroy(),!this.isClosing&&this.canReconnect(e.code)&&this.retryConnection()||(this.isClosing=!1,this.isSessionEstablished?this.forEachObserver(t=>{t.messagingSessionDidStop&&t.messagingSessionDidStop(e)}):this.bootstrapRejected(e))}canReconnect(e){return 1001===e||1006===e||e>=1011&&e<=1014||e>4e3&&4002!==e&&4003!==e&&4401!==e}}t.default=m},82534:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=i(17201);class r{constructor(e,t,i,n){this.userArn=e,this.messagingSessionId=t,this.endpointUrl=i,this.chimeClient=n,this.reconnectTimeoutMs=1e4,this.reconnectFixedWaitMs=0,this.reconnectShortBackoffMs=1e3,this.reconnectLongBackoffMs=5e3,this.prefetchOn=void 0,this.prefetchSortBy=void 0,this.messagingSessionId||(this.messagingSessionId=this.generateSessionId())}generateSessionId(){let e=new Uint32Array(1);return n.getRandomValues(e),e[0].toString()}}t.default=r},28116:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Connect="connect"}(i||(i={})),t.default=i},67929:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Unread="unread",e.LastMessageTimestamp="last-message-timestamp"}(i||(i={})),t.default=i},77041:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let r=n(i(11807));class s{constructor(e){this._id=e}id(){return this._id}base(){return this._id?this._id.split(s.MODALITY_SEPARATOR)[0]:""}modality(){if(!this._id)return"";let e=this._id.split(s.MODALITY_SEPARATOR);return 2===e.length?e[1]:""}hasModality(e){return""!==e&&this.modality()===e}withModality(e){let t=new s(this.base()+s.MODALITY_SEPARATOR+e);return""===e||""===this.base()||new s(t._id).modality()!==e?new s(this.base()):t}}t.default=s,s.MODALITY_SEPARATOR=r.default.Modality[0],s.MODALITY_CONTENT=r.default.Modality.substr(1)},91930:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let r=n(i(45619)),s=n(i(81211)),o=n(i(62811)),a=i(39163),l=i(71906);class d{constructor(e,t,i){this.signalingClient=e,this.intervalMs=t,this.logger=i,this.observerQueue=new Set,this.consecutivePongsUnaccountedFor=0,this.intervalScheduler=new s.default(this.intervalMs),this.pingId=0}addObserver(e){this.logger.info("adding a ping-pong observer"),this.observerQueue.add(e)}removeObserver(e){this.logger.info("removing a ping-pong observer"),this.observerQueue.delete(e)}forEachObserver(e){for(let t of this.observerQueue)r.default.nextTick(()=>{this.observerQueue.has(t)&&e(t)})}start(){this.stop(),this.signalingClient.registerObserver(this),this.signalingClient.ready()&&this.startPingInterval()}stop(){this.stopPingInterval(),this.signalingClient.removeObserver(this)}startPingInterval(){this.intervalScheduler.start(()=>{this.ping()}),this.ping()}stopPingInterval(){this.intervalScheduler.stop(),this.pingId=0,this.consecutivePongsUnaccountedFor=0}ping(){this.consecutivePongsUnaccountedFor>0&&(this.logger.warn(`missed pong ${this.consecutivePongsUnaccountedFor} time(s)`),this.forEachObserver(e=>{l.Maybe.of(e.didMissPongs).map(t=>t.bind(e)(this.consecutivePongsUnaccountedFor))})),this.consecutivePongsUnaccountedFor+=1,this.pingId=this.pingId+1&4294967295;let e=a.SdkPingPongFrame.create();e.pingId=this.pingId,e.type=a.SdkPingPongType.PING,this.pingTimestampLocalMs=this.signalingClient.pingPong(e),this.logger.debug(()=>`sent ping ${this.pingId}`)}pong(e){let t=a.SdkPingPongFrame.create();t.pingId=e,t.type=a.SdkPingPongType.PONG,this.signalingClient.pingPong(t)}handleSignalingClientEvent(e){switch(e.type){case o.default.WebSocketOpen:this.startPingInterval();break;case o.default.WebSocketFailed:case o.default.WebSocketError:this.logger.warn(`stopped pinging (${o.default[e.type]})`),this.stopPingInterval();break;case o.default.WebSocketClosing:case o.default.WebSocketClosed:this.logger.info(`stopped pinging (${o.default[e.type]})`),this.stopPingInterval();break;case o.default.ReceivedSignalFrame:if(e.message.type!==a.SdkSignalFrame.Type.PING_PONG)break;if(e.message.pingPong.type===a.SdkPingPongType.PONG){let t;let i=e.message.pingPong.pingId;if(i!==this.pingId){this.logger.warn(`unexpected ping id ${i} (expected ${this.pingId})`);break}if(this.consecutivePongsUnaccountedFor=0,"number"==typeof e.message.timestampMs)t=e.message.timestampMs;else break;this.logger.debug(()=>`received pong ${i} with timestamp ${t}`);let n=e.timestampMs-this.pingTimestampLocalMs,r=Math.round(t-n/2),s=this.pingTimestampLocalMs-r;this.logger.info(`local clock skew estimate=${s}ms from ping-pong time=${n}ms`),this.forEachObserver(e=>{l.Maybe.of(e.didReceivePong).map(t=>t.bind(e)(i,s,n))})}else this.pong(e.message.pingPong.pingId)}}}t.default=d},20311:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let r=n(i(25094)),s=n(i(14191)),o=n(i(6724));class a{constructor(e,t){this.mediaStreamBroker=e,this.state=new s.default,this._transcriptionController=t||new r.default(this)}realtimeSetLocalAttendeeId(e,t){this.state.localAttendeeId=e,this.state.localExternalUserId=t}realtimeSetAttendeeIdPresence(e,t,i,n,r){try{for(let s of(t&&(this.state.attendeeIdToExternalUserId[e]=i),this.state.attendeeIdChangesCallbacks))s(e,t,i,n,r)}catch(e){this.onError(e)}}realtimeSubscribeToAttendeeIdPresence(e){try{this.state.attendeeIdChangesCallbacks.push(e)}catch(e){this.onError(e)}}realtimeUnsubscribeToAttendeeIdPresence(e){try{let t=this.state.attendeeIdChangesCallbacks.indexOf(e);-1!==t&&this.state.attendeeIdChangesCallbacks.splice(t,1)}catch(e){this.onError(e)}}realtimeSetCanUnmuteLocalAudio(e){try{if(this.state.canUnmute===e)return;for(let t of(this.state.canUnmute=e,this.state.setCanUnmuteLocalAudioCallbacks))t(e)}catch(e){this.onError(e)}}realtimeSubscribeToSetCanUnmuteLocalAudio(e){try{this.state.setCanUnmuteLocalAudioCallbacks.push(e)}catch(e){this.onError(e)}}realtimeUnsubscribeToSetCanUnmuteLocalAudio(e){try{let t=this.state.setCanUnmuteLocalAudioCallbacks.indexOf(e);-1!==t&&this.state.setCanUnmuteLocalAudioCallbacks.splice(t,1)}catch(e){this.onError(e)}}realtimeCanUnmuteLocalAudio(){return this.state.canUnmute}realtimeMuteLocalAudio(){if(!this.state.muted)try{for(let e of(this.setAudioInputEnabled(!1),this.state.muted=!0,this.realtimeUpdateVolumeIndicator(this.state.localAttendeeId,null,null,null,this.state.localExternalUserId),this.state.muteAndUnmuteLocalAudioCallbacks))e(!0)}catch(e){this.onError(e)}}realtimeUnmuteLocalAudio(){if(!this.state.muted)return!0;if(!this.state.canUnmute)return!1;try{for(let e of(this.setAudioInputEnabled(!0),this.state.muted=!1,this.realtimeUpdateVolumeIndicator(this.state.localAttendeeId,null,null,null,this.state.localExternalUserId),this.state.muteAndUnmuteLocalAudioCallbacks))e(!1);return!0}catch(e){return this.onError(e),!1}}realtimeSubscribeToMuteAndUnmuteLocalAudio(e){try{this.state.muteAndUnmuteLocalAudioCallbacks.push(e)}catch(e){this.onError(e)}}realtimeUnsubscribeToMuteAndUnmuteLocalAudio(e){try{let t=this.state.muteAndUnmuteLocalAudioCallbacks.indexOf(e);-1!==t&&this.state.muteAndUnmuteLocalAudioCallbacks.splice(t,1)}catch(e){this.onError(e)}}realtimeIsLocalAudioMuted(){return this.state.muted}realtimeSubscribeToVolumeIndicator(e,t){try{this.state.volumeIndicatorCallbacks.hasOwnProperty(e)||(this.state.volumeIndicatorCallbacks[e]=[]),this.state.volumeIndicatorCallbacks[e].push(t),this.sendVolumeIndicatorChange(e,!0,!0,!0,this.state.attendeeIdToExternalUserId[e])}catch(e){this.onError(e)}}realtimeUnsubscribeFromVolumeIndicator(e,t){if(this.state.volumeIndicatorCallbacks[e]){if(t){let i=this.state.volumeIndicatorCallbacks[e].indexOf(t);i>=0&&this.state.volumeIndicatorCallbacks[e].splice(i,1)}else delete this.state.volumeIndicatorCallbacks[e]}}realtimeUpdateVolumeIndicator(e,t,i,n,r){try{i=this.applyLocalMuteOverride(e,i);let s=this.getVolumeIndicatorState(e),o=!1,a=!1,l=!1;null!==i&&s.muted!==i&&(s.muted=i,a=!0,s.muted&&0!==s.volume&&(s.volume=0,o=!0)),s.muted||null===t||(s.volume!==t&&(s.volume=t,o=!0),null!==s.muted||(s.muted=!1,a=!0)),null!==n&&s.signalStrength!==n&&(s.signalStrength=n,l=!0),this.sendVolumeIndicatorChange(e,o,a,l,r)}catch(e){this.onError(e)}}realtimeSubscribeToLocalSignalStrengthChange(e){try{if(this.state.localSignalStrengthChangeCallbacks.push(e),null===this.state.localAttendeeId)return;this.sendLocalSignalStrengthChange(this.state.localAttendeeId,!0)}catch(e){this.onError(e)}}realtimeUnsubscribeToLocalSignalStrengthChange(e){try{let t=this.state.localSignalStrengthChangeCallbacks.indexOf(e);-1!==t&&this.state.localSignalStrengthChangeCallbacks.splice(t,1)}catch(e){this.onError(e)}}realtimeSubscribeToSendDataMessage(e){try{this.state.sendDataMessageCallbacks.push(e)}catch(e){this.onError(e)}}realtimeUnsubscribeFromSendDataMessage(e){try{let t=this.state.sendDataMessageCallbacks.indexOf(e);-1!==t&&this.state.sendDataMessageCallbacks.splice(t,1)}catch(e){this.onError(e)}}realtimeSendDataMessage(e,t,i){try{for(let n of this.state.sendDataMessageCallbacks)n(e,t,i)}catch(e){this.onError(e)}}realtimeSubscribeToReceiveDataMessage(e,t){try{this.state.receiveDataMessageCallbacks.has(e)?this.state.receiveDataMessageCallbacks.get(e).push(t):this.state.receiveDataMessageCallbacks.set(e,[t])}catch(e){this.onError(e)}}realtimeUnsubscribeFromReceiveDataMessage(e){try{this.state.receiveDataMessageCallbacks.delete(e)}catch(e){this.onError(e)}}realtimeReceiveDataMessage(e){try{if(this.state.receiveDataMessageCallbacks.has(e.topic))for(let t of this.state.receiveDataMessageCallbacks.get(e.topic))t(e)}catch(e){this.onError(e)}}realtimeSubscribeToFatalError(e){try{this.state.fatalErrorCallbacks.push(e)}catch(e){this.onError(e)}}realtimeUnsubscribeToFatalError(e){try{let t=this.state.fatalErrorCallbacks.indexOf(e);-1!==t&&this.state.fatalErrorCallbacks.splice(t,1)}catch(e){this.onError(e)}}get transcriptionController(){return this._transcriptionController}setAudioInputEnabled(e){e?this.mediaStreamBroker.unmuteLocalAudioInputStream():this.mediaStreamBroker.muteLocalAudioInputStream()}applyLocalMuteOverride(e,t){let i=this.state.localAttendeeId,n=this.state.muted;return e===i&&"activeDevices"in this.mediaStreamBroker&&this.mediaStreamBroker.activeDevices.audio?n:t}sendVolumeIndicatorChange(e,t,i,n,r){if(this.sendLocalSignalStrengthChange(e,n),!this.state.volumeIndicatorCallbacks.hasOwnProperty(e))return;let s=this.getVolumeIndicatorState(e),a=new o.default;if(t&&(a.volume=s.volume),i&&(a.muted=s.muted),n&&(a.signalStrength=s.signalStrength),!this.stateIsEmpty(a))for(let t of this.state.volumeIndicatorCallbacks[e])t(e,a.volume,a.muted,a.signalStrength,r)}sendLocalSignalStrengthChange(e,t){if(!t||e!==this.state.localAttendeeId)return;let i=this.getVolumeIndicatorState(e).signalStrength;if(null!==i)for(let e of this.state.localSignalStrengthChangeCallbacks)e(i)}getVolumeIndicatorState(e){return this.state.volumeIndicatorState.hasOwnProperty(e)||(this.state.volumeIndicatorState[e]=new o.default),this.state.volumeIndicatorState[e]}stateIsEmpty(e){return null===e.volume&&null===e.muted&&null===e.signalStrength}onError(e){try{for(let t of this.state.fatalErrorCallbacks)t(e)}catch(t){try{console.error(e),console.error(t)}catch(e){}}}}t.default=a},88758:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(){this.attendeeIndex=null,this.attendeesInFrame=null}}t.default=i},14191:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(){this.localAttendeeId=null,this.localExternalUserId=null,this.attendeeIdChangesCallbacks=[],this.canUnmute=!0,this.setCanUnmuteLocalAudioCallbacks=[],this.muted=!1,this.muteAndUnmuteLocalAudioCallbacks=[],this.volumeIndicatorState={},this.attendeeIdToExternalUserId={},this.volumeIndicatorCallbacks={},this.localSignalStrengthChangeCallbacks=[],this.fatalErrorCallbacks=[],this.sendDataMessageCallbacks=[],this.receiveDataMessageCallbacks=new Map}}t.default=i},6724:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(){this.volume=null,this.muted=null,this.signalStrength=null}}t.default=i},97386:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let r=n(i(44307));class s{constructor(e,t){this.reconnectTimeoutMs=e,this.backoffPolicy=t,this.shouldReconnect=!0,this.onlyRestartPeerConnection=!1,this.firstConnectionAttempted=!1,this.firstConnectionAttemptTimestampMs=0,this.lastActiveTimestampMs=1/0,this._isFirstConnection=!0,this.backoffTimer=null,this.backoffCancel=null,this.reset()}timeSpentReconnectingMs(){return this.firstConnectionAttempted?Date.now()-this.firstConnectionAttemptTimestampMs:0}hasPastReconnectDeadline(){return Date.now()-this.lastActiveTimestampMs>=this.reconnectTimeoutMs||this.timeSpentReconnectingMs()>=this.reconnectTimeoutMs}reset(){this.cancel(),this.shouldReconnect=!0,this.onlyRestartPeerConnection=!1,this.firstConnectionAttempted=!1,this.firstConnectionAttemptTimestampMs=0,this.lastActiveTimestampMs=1/0,this.backoffPolicy.reset()}startedConnectionAttempt(e){this._isFirstConnection=e,this.firstConnectionAttempted||(this.firstConnectionAttempted=!0,this.firstConnectionAttemptTimestampMs=Date.now())}hasStartedConnectionAttempt(){return this.firstConnectionAttempted}isFirstConnection(){return this._isFirstConnection}disableReconnect(){this.shouldReconnect=!1}enableRestartPeerConnection(){this.onlyRestartPeerConnection=!0}cancel(){this.disableReconnect(),this.backoffTimer&&(this.backoffTimer.stop(),this.backoffCancel&&(this.backoffCancel(),this.backoffCancel=null))}retryWithBackoff(e,t){let i=this.shouldReconnect&&!this.hasPastReconnectDeadline();return i&&(this.backoffCancel=t,this.backoffTimer=new r.default(this.backoffPolicy.nextBackoffAmountMs()),this.backoffTimer.start(()=>{this.backoffCancel=null,e()})),i}shouldOnlyRestartPeerConnection(){return this.onlyRestartPeerConnection}clone(){return new s(this.reconnectTimeoutMs,this.backoffPolicy)}setLastActiveTimestampMs(e){this.lastActiveTimestampMs=e}}t.default=s},91687:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(){this.maxRedPacketSizeBytes=1024,this.maxAudioPayloadSizeBytes=1e3,this.maxRedTimestampOffset=16384,this.redHeaderSizeBytes=4,this.redLastHeaderSizeBytes=1,this.redPacketizationTime=960,this.redPacketDistance=2,this.maxRedEncodings=2,this.redMaxRecoveryDistance=this.redPacketDistance*this.maxRedEncodings+1,this.maxEncodingHistorySize=10,this.numRedundantEncodings=0,this.redundancyEnabled=!0,this.lossReportInterval=24e4,this.maxOutOfOrderPacketDistance=16,this.OPUS_BAD_ARG=-1,this.OPUS_INVALID_PACKET=-4,this.OPUS_MAX_OPUS_FRAMES=48,this.OPUS_MAX_FRAME_SIZE_BYTES=1275,this.encodingHistory=[],this.opusPayloadType=0,this.redPayloadType=0,this.initializePacketLogs()}static initializeWorker(){i.log("Initializing RedundantAudioEncoder");let e=new i;self.RTCRtpScriptTransformer&&(self.onrtctransform=t=>{"SenderTransform"===t.transformer.options.type?e.setupSenderTransform(t.transformer.readable,t.transformer.writable):"ReceiverTransform"===t.transformer.options.type?e.setupReceiverTransform(t.transformer.readable,t.transformer.writable):"PassthroughTransform"===t.transformer.options.type&&e.setupPassthroughTransform(t.transformer.readable,t.transformer.writable)}),self.onmessage=t=>{"StartRedWorker"===t.data.msgType?(e.setupSenderTransform(t.data.send.readable,t.data.send.writable),e.setupReceiverTransform(t.data.receive.readable,t.data.receive.writable)):"PassthroughTransform"===t.data.msgType?(e.setupPassthroughTransform(t.data.send.readable,t.data.send.writable),e.setupPassthroughTransform(t.data.receive.readable,t.data.receive.writable)):"RedPayloadType"===t.data.msgType?e.setRedPayloadType(t.data.payloadType):"OpusPayloadType"===t.data.msgType?e.setOpusPayloadType(t.data.payloadType):"UpdateNumRedundantEncodings"===t.data.msgType?e.setNumRedundantEncodings(t.data.numRedundantEncodings):"Enable"===t.data.msgType?e.setRedundancyEnabled(!0):"Disable"===t.data.msgType&&e.setRedundancyEnabled(!1)}}static log(e){i.shouldLog&&self.postMessage({type:"REDWorkerLog",log:`[AudioRed] ${e}`})}static getNumRedundantEncodingsForPacketLoss(e){let t=0,i=!1;return e<=8?t=0:e<=18?t=1:e<=75?t=2:(t=0,i=!0),[t,i]}setupPassthroughTransform(e,t){i.log("Setting up passthrough transform"),e.pipeTo(t)}setupSenderTransform(e,t){i.log("Setting up sender RED transform");let n=new TransformStream({transform:this.senderTransform.bind(this)});e.pipeThrough(n).pipeTo(t)}setupReceiverTransform(e,t){i.log("Setting up receiver RED transform");let n=new TransformStream({transform:this.receivePacketLogTransform.bind(this)});e.pipeThrough(n).pipeTo(t)}setRedPayloadType(e){this.redPayloadType=e,i.log(`red payload type set to ${this.redPayloadType}`)}setOpusPayloadType(e){this.opusPayloadType=e,i.log(`opus payload type set to ${this.opusPayloadType}`)}setNumRedundantEncodings(e){this.numRedundantEncodings=e,this.numRedundantEncodings>this.maxRedEncodings&&(this.numRedundantEncodings=this.maxRedEncodings),i.log(`Updated numRedundantEncodings to ${this.numRedundantEncodings}`)}setRedundancyEnabled(e){this.redundancyEnabled=e,i.log(`redundancy ${this.redundancyEnabled?"enabled":"disabled"}`)}enqueueAudioFrameIfPayloadSizeIsValid(e,t){e.data.byteLength>this.maxAudioPayloadSizeBytes||t.enqueue(e)}senderTransform(e,t){if(e.getMetadata().payloadType!==this.redPayloadType){this.enqueueAudioFrameIfPayloadSizeIsValid(e,t);return}let i=this.getPrimaryPayload(e.timestamp,e.data);if(!i){this.enqueueAudioFrameIfPayloadSizeIsValid(e,t);return}let n=this.encode(e.timestamp,i);if(!n){this.enqueueAudioFrameIfPayloadSizeIsValid(e,t);return}e.data=n,this.enqueueAudioFrameIfPayloadSizeIsValid(e,t)}getPrimaryPayload(e,t){let i=this.splitEncodings(e,t);return!i||i.length<1?null:i[i.length-1].payload}splitEncodings(e,t,i=!1,n){let r=new DataView(t),s=r.byteLength,o=0,a=0,l=0,d=0,u=!1,c=[],h=[],f=[];for(;s>0;){if(u=(128&r.getUint8(d))==0){if((127&r.getUint8(d))!==this.opusPayloadType||(o+=this.redLastHeaderSizeBytes,a+=this.redLastHeaderSizeBytes,o>=r.byteLength))return null;l=r.byteLength-o;break}{if(s<this.redHeaderSizeBytes)return null;let t=((3&r.getUint8(d+2))<<8)+r.getUint8(d+3);h.push(t);let i=e-(r.getUint16(d+1)>>2);f.push(i),o+=t+this.redHeaderSizeBytes,a+=this.redHeaderSizeBytes,d+=this.redHeaderSizeBytes,s-=this.redHeaderSizeBytes}}if(!u)return null;let p=a;for(let e=0;e<f.length;e++){let t=new ArrayBuffer(h[e]);new Uint8Array(t).set(new Uint8Array(r.buffer,p,h[e]),0);let n={timestamp:f[e],payload:t,isRedundant:!0};i&&(n.hasFec=this.opusPacketHasFec(new DataView(t),t.byteLength)),c.push(n),p+=h[e]}let m=r.byteLength-l,g=new ArrayBuffer(l);new Uint8Array(g).set(new Uint8Array(r.buffer,m,l),0);let v={timestamp:e,payload:g,isRedundant:!1,seq:n};return i&&(v.hasFec=this.opusPacketHasFec(new DataView(g),g.byteLength)),c.push(v),c}encode(e,t){let i=t.byteLength;if(0===i||i>=this.maxRedPacketSizeBytes||i>=this.maxAudioPayloadSizeBytes)return null;let n=this.numRedundantEncodings,r=this.redLastHeaderSizeBytes,s=i,o=this.maxAudioPayloadSizeBytes-i-r,a=[],l=[];if(this.redundancyEnabled){let t=this.uint32WrapAround(e-this.redPacketizationTime*this.redPacketDistance);for(let i=0;i<n&&!(this.uint32WrapAround(e-t)>=this.maxRedTimestampOffset);i++){let e=t,i=this.encodingHistory.find(t=>t.timestamp===e);if(i||(e=this.uint32WrapAround(t-this.redPacketizationTime),i=this.encodingHistory.find(t=>t.timestamp===e)),i){let e=i.payload.byteLength;if(o<this.redHeaderSizeBytes+e)break;o-=this.redHeaderSizeBytes+e,r+=this.redHeaderSizeBytes,s+=e,a.unshift(i.timestamp),l.unshift(i.payload)}t-=this.redPacketizationTime*this.redPacketDistance,t=this.uint32WrapAround(t)}}let d=new ArrayBuffer(r+s),u=new DataView(d),c=0;for(let t=0;t<a.length;t++){let i=e-a[t];u.setUint8(c,128|this.opusPayloadType),u.setUint16(c+1,i<<2|l[t].byteLength>>8),u.setUint8(c+3,255&l[t].byteLength),c+=this.redHeaderSizeBytes}u.setUint8(c,this.opusPayloadType),c+=this.redLastHeaderSizeBytes;let h=new Uint8Array(d);for(let e=0;e<l.length;e++)h.set(new Uint8Array(l[e]),c),c+=l[e].byteLength;return(h.set(new Uint8Array(t),c),(c+=t.byteLength)!==r+s)?null:(this.updateEncodingHistory(e,t),d)}updateEncodingHistory(e,t){for(let t of this.encodingHistory){let i=this.redPacketizationTime*this.redMaxRecoveryDistance;if(e-t.timestamp>=i)this.encodingHistory.shift();else break}let i=new DataView(t);(this.opusPacketIsCeltOnly(i)||this.opusPacketHasVoiceActivity(i,i.byteLength)>0)&&(this.encodingHistory.length+1>this.maxEncodingHistorySize&&(this.encodingHistory.length=0),this.encodingHistory.push({timestamp:e,payload:t}))}initializePacketLogs(){let e=this.maxOutOfOrderPacketDistance+this.redMaxRecoveryDistance;this.primaryPacketLog={window:Array(e),index:0,windowSize:e},this.redRecoveryLog={window:Array(e),index:0,windowSize:e},this.fecRecoveryLog={window:Array(e),index:0,windowSize:e},this.totalAudioPacketsExpected=0,this.totalAudioPacketsLost=0,this.totalAudioPacketsRecoveredRed=0,this.totalAudioPacketsRecoveredFec=0}receivePacketLogTransform(e,t){let i=e.getMetadata();if(i.payloadType!==this.redPayloadType){this.enqueueAudioFrameIfPayloadSizeIsValid(e,t);return}let n=this.splitEncodings(e.timestamp,e.data,!0,i.sequenceNumber);if(!n){this.enqueueAudioFrameIfPayloadSizeIsValid(e,t);return}for(let e=n.length-1;e>=0;e--)this.updateLossStats(n[e])&&(this.updateRedStats(n[e]),this.updateFecStats(n[e]));this.maybeReportLossStats(n[n.length-1].timestamp,i.synchronizationSource),this.enqueueAudioFrameIfPayloadSizeIsValid(e,t)}updateLossStats(e){if(e.isRedundant)return!0;let t=e.timestamp,i=e.seq;if(0===this.totalAudioPacketsExpected)return this.totalAudioPacketsExpected=1,this.newestSequenceNumber=i,this.addTimestamp(this.primaryPacketLog,t),!0;let n=this.int16(i-this.newestSequenceNumber);return!(n<-this.maxOutOfOrderPacketDistance)&&(n<0?this.hasTimestamp(this.primaryPacketLog,t)||(this.totalAudioPacketsLost>0&&this.totalAudioPacketsLost--,this.addTimestamp(this.primaryPacketLog,t),this.removeFromRecoveryWindows(t)):n>1&&(this.totalAudioPacketsLost+=n-1),n>0&&(this.totalAudioPacketsExpected+=n,this.newestSequenceNumber=e.seq,this.addTimestamp(this.primaryPacketLog,t)),!0)}updateRedStats(e){if(!e.isRedundant||0===this.totalAudioPacketsLost)return;let t=e.timestamp;!this.hasTimestamp(this.primaryPacketLog,t)&&(this.hasTimestamp(this.redRecoveryLog,t)||(this.totalAudioPacketsRecoveredRed++,this.addTimestamp(this.redRecoveryLog,t)),this.removeTimestamp(this.fecRecoveryLog,t)&&this.totalAudioPacketsRecoveredFec>0&&this.totalAudioPacketsRecoveredFec--)}updateFecStats(e){if(!e.hasFec||0===this.totalAudioPacketsLost)return;let t=e.timestamp-this.redPacketizationTime;this.hasTimestamp(this.primaryPacketLog,t)||this.hasTimestamp(this.redRecoveryLog,t)||this.hasTimestamp(this.fecRecoveryLog,t)||(this.totalAudioPacketsRecoveredFec++,this.addTimestamp(this.fecRecoveryLog,t))}maybeReportLossStats(e,t){e-this.lastLossReportTimestamp<this.lossReportInterval||(i.shouldReportStats&&self.postMessage({type:"RedundantAudioEncoderStats",ssrc:t,totalAudioPacketsLost:this.totalAudioPacketsLost,totalAudioPacketsExpected:this.totalAudioPacketsExpected,totalAudioPacketsRecoveredRed:this.totalAudioPacketsRecoveredRed,totalAudioPacketsRecoveredFec:this.totalAudioPacketsRecoveredFec}),this.lastLossReportTimestamp=e)}addTimestamp(e,t){e.window[e.index]=t,e.index=(e.index+1)%e.windowSize}hasTimestamp(e,t){return!!e.window.find(e=>e===t)}removeTimestamp(e,t){let i=e.window.indexOf(t);return i>=0&&(e.window[i]=void 0,!0)}removeFromRecoveryWindows(e){let t=this.removeTimestamp(this.redRecoveryLog,e);t&&this.totalAudioPacketsRecoveredRed>0&&this.totalAudioPacketsRecoveredRed--,(t=this.removeTimestamp(this.fecRecoveryLog,e))&&this.totalAudioPacketsRecoveredFec>0&&this.totalAudioPacketsRecoveredFec--}uint32WrapAround(e){let t=4294967296,i=e;return e>=4294967296?i=e-t:e<0&&(i=t+e),i}int16(e){return e<<16>>16}opusPacketIsCeltOnly(e){return!!(128&e.getUint8(0))}opusPacketGetSamplesPerFrame(e,t){let i,n;return t=Math.min(Math.max(t=Math.round(t),-4294967296),4294967295),this.opusPacketIsCeltOnly(e)?(n=e.getUint8(0)>>3&3,i=(t<<n)/400):i=(96&e.getUint8(0))==96?8&e.getUint8(0)?t/50:t/100:3==(n=e.getUint8(0)>>3&3)?60*t/1e3:(t<<n)/100,i}opusNumSilkFrames(e){let t=this.opusPacketGetSamplesPerFrame(e,48e3)/48;switch(t<10&&(t=10),t){case 10:case 20:return 1;case 40:return 2;case 60:return 3;default:return 0}}opusPacketGetNumChannels(e){return 4&e.getUint8(0)?2:1}opusParseSize(e,t,i,n){return i<1?(n[0]=-1,-1):252>e.getUint8(t)?(n[0]=e.getUint8(t),1):i<2?(n[0]=-1,-1):(n[0]=4*e.getUint8(t+1)+e.getUint8(t),2)}opusPacketParseImpl(e,t,i,n,r,s,o,a){let l,d;if(!s||t<0)return this.OPUS_BAD_ARG;if(0===t)return this.OPUS_INVALID_PACKET;let u=0,c=!1,h=e.getUint8(0);n&&(n[0]=h);let f=t-1,p=1,m=f;switch(3&h){case 0:l=1;break;case 1:if(l=2,c=!0,!i){if(1&f)return this.OPUS_INVALID_PACKET;m=f/2,s[0][0]=m}break;case 2:if(l=2,d=this.opusParseSize(e,p,f,s[0]),f-=d,s[0][0]<0||s[0][0]>f)return this.OPUS_INVALID_PACKET;p+=d,m=f-s[0][0];break;default:if(f<1)return this.OPUS_INVALID_PACKET;let g=e.getUint8(p++);if(--f,(l=63&g)<=0||this.opusPacketGetSamplesPerFrame(e,48e3)*l>5760)return this.OPUS_INVALID_PACKET;if(64&g){let t,i;do{if(f<=0)return this.OPUS_INVALID_PACKET;t=e.getUint8(p++),--f,f-=i=255===t?254:t,u+=i}while(255===t)}if(f<0)return this.OPUS_INVALID_PACKET;if(c=!(128&g)){if(!i){if((m=Math.trunc(f/l))*l!==f)return this.OPUS_INVALID_PACKET;for(let e=0;e<l-1;++e)s[e][0]=m}}else{m=f;for(let t=0;t<l-1;++t){if(d=this.opusParseSize(e,p,f,s[t]),f-=d,s[t][0]<0||s[t][0]>f)return this.OPUS_INVALID_PACKET;p+=d,m-=d+s[t][0]}if(m<0)return this.OPUS_INVALID_PACKET}}if(i){if(d=this.opusParseSize(e,p,f,s[l-1]),f-=d,s[l-1][0]<0||s[l-1][0]>f)return this.OPUS_INVALID_PACKET;if(p+=d,c){if(s[l-1][0]*l>f)return this.OPUS_INVALID_PACKET;for(let e=0;e<l-1;++e)s[e][0]=s[l-1][0]}else if(!(d+s[l-1][0]<=m))return this.OPUS_INVALID_PACKET}else{if(m>this.OPUS_MAX_FRAME_SIZE_BYTES)return this.OPUS_INVALID_PACKET;s[l-1][0]=m}o&&(o[0]=p);for(let e=0;e<l;++e)r&&(r[e][0]=p),p+=s[e][0];return a&&(a[0]=p+u),l}opusPacketParse(e,t,i,n,r,s){return this.opusPacketParseImpl(e,t,!1,i,n,r,s,null)}opusPacketHasVoiceActivity(e,t){if(!e||t<=0)return 0;if(this.opusPacketIsCeltOnly(e))return -1;let i=this.opusNumSilkFrames(e);if(0===i)return -1;let n=Array(this.OPUS_MAX_OPUS_FRAMES),r=Array(this.OPUS_MAX_OPUS_FRAMES);for(let e=0;e<this.OPUS_MAX_OPUS_FRAMES;++e)n[e]=[void 0],r[e]=[void 0];let s=this.opusPacketParse(e,t,null,n,r,null);if(s<0)return -1;for(let t=0;t<s;++t)if(!(r[t][0]<1)&&(e.getUint8(n[t][0])>>8-i||2===this.opusPacketGetNumChannels(e)&&e.getUint8(n[t][0])<<i+1>>8-i))return 1;return 0}opusPacketHasFec(e,t){if(!e||t<=0||this.opusPacketIsCeltOnly(e))return!1;let i=Array(this.OPUS_MAX_OPUS_FRAMES),n=Array(this.OPUS_MAX_OPUS_FRAMES);for(let e=0;e<this.OPUS_MAX_OPUS_FRAMES;++e)i[e]=[void 0],n[e]=[void 0];if(0>this.opusPacketParse(e,t,null,i,n,null)||n[0][0]<=1)return!1;let r=this.opusNumSilkFrames(e);if(0===r)return!1;let s=this.opusPacketGetNumChannels(e);if(1!==s&&2!==s)return!1;for(let t=0;t<s;t++)if(e.getUint8(i[0][0])&128>>(t+1)*(r+1)-1)return!0;return!1}}t.default=i,i.shouldLog=!1,i.shouldReportStats=!1},2026:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let i="class RedundantAudioEncoder {\n    constructor() {\n        // Each payload must be less than 1024 bytes to fit the 10 bit block length\n        this.maxRedPacketSizeBytes = 1 << 10;\n        // Limit payload to 1000 bytes to handle small MTU. 1000 is chosen because in Chromium-based browsers, writing audio\n        // payloads larger than 1000 bytes using the WebRTC Insertable Streams API (which is used to enable dynamic audio\n        // redundancy) will cause an error to be thrown and cause audio flow to permanently stop. See\n        // https://crbug.com/1248479.\n        this.maxAudioPayloadSizeBytes = 1000;\n        // Each payload can encode a timestamp delta of 14 bits\n        this.maxRedTimestampOffset = 1 << 14;\n        // 4 byte RED header\n        this.redHeaderSizeBytes = 4;\n        // reduced size for last RED header\n        this.redLastHeaderSizeBytes = 1;\n        // P-Time for Opus 20 msec packets\n        // We do not support other p-times or clock rates\n        this.redPacketizationTime = 960;\n        // distance between redundant payloads, Opus FEC handles a distance of 1\n        // TODO(https://issues.amazon.com/issues/ChimeSDKAudio-55):\n        // Consider making this dynamic\n        this.redPacketDistance = 2;\n        // maximum number of redundant payloads per RTP packet\n        this.maxRedEncodings = 2;\n        // Maximum number of encodings that can be recovered with a single RED packet, assuming the primary and redundant\n        // payloads have FEC.\n        this.redMaxRecoveryDistance = this.redPacketDistance * this.maxRedEncodings + 1;\n        // maximum history of prior payloads to keep\n        // generally we will expire old entries based on timestamp\n        // this limit is in place just to make sure the history does not\n        // grow too large in the case of erroneous timestamp inputs\n        this.maxEncodingHistorySize = 10;\n        // Current number of encodings we want to send\n        // to the remote end. This will be dynamically\n        // updated through the setNumEncodingsFromPacketloss API\n        this.numRedundantEncodings = 0;\n        // Used to enable or disable redundancy\n        // in response to very high packet loss events\n        this.redundancyEnabled = true;\n        // Loss stats are reported to the main thread every 5 seconds.\n        // Since timestamp differences between 2 consecutive packets\n        // give us the number of samples in each channel, 1 second\n        // is equivalent to 48000 samples:\n        // P-time * (1000ms/1s)\n        // = (960 samples/20ms) * (1000ms/1s)\n        // = 48000 samples/s\n        this.lossReportInterval = 48000 * 5;\n        // Maximum distance of a packet from the most recent packet timestamp\n        // that we will consider for recovery.\n        this.maxOutOfOrderPacketDistance = 16;\n        /**\n         * Below are Opus helper methods and constants.\n         */\n        this.OPUS_BAD_ARG = -1;\n        this.OPUS_INVALID_PACKET = -4;\n        // Max number of Opus frames in an Opus packet is 48 (https://www.rfc-editor.org/rfc/rfc6716#section-3.2.5).\n        this.OPUS_MAX_OPUS_FRAMES = 48;\n        // Max number of bytes that any individual Opus frame can have.\n        this.OPUS_MAX_FRAME_SIZE_BYTES = 1275;\n        this.encodingHistory = new Array();\n        this.opusPayloadType = 0;\n        this.redPayloadType = 0;\n        this.initializePacketLogs();\n    }\n    /**\n     * Creates an instance of RedundantAudioEncoder and sets up callbacks.\n     */\n    static initializeWorker() {\n        RedundantAudioEncoder.log('Initializing RedundantAudioEncoder');\n        const encoder = new RedundantAudioEncoder();\n        // RED encoding is done using WebRTC Encoded Transform\n        // https://github.com/w3c/webrtc-encoded-transform/blob/main/explainer.md\n        // Check the DedicatedWorkerGlobalScope for existence of\n        // RTCRtpScriptTransformer interface. If exists, then\n        // RTCRtpScriptTransform is supported by this browser.\n        // @ts-ignore\n        if (self.RTCRtpScriptTransformer) {\n            // @ts-ignore\n            self.onrtctransform = (event) => {\n                if (event.transformer.options.type === 'SenderTransform') {\n                    encoder.setupSenderTransform(event.transformer.readable, event.transformer.writable);\n                }\n                else if (event.transformer.options.type === 'ReceiverTransform') {\n                    encoder.setupReceiverTransform(event.transformer.readable, event.transformer.writable);\n                }\n                else if (event.transformer.options.type === 'PassthroughTransform') {\n                    encoder.setupPassthroughTransform(event.transformer.readable, event.transformer.writable);\n                }\n            };\n        }\n        self.onmessage = (event) => {\n            if (event.data.msgType === 'StartRedWorker') {\n                encoder.setupSenderTransform(event.data.send.readable, event.data.send.writable);\n                encoder.setupReceiverTransform(event.data.receive.readable, event.data.receive.writable);\n            }\n            else if (event.data.msgType === 'PassthroughTransform') {\n                encoder.setupPassthroughTransform(event.data.send.readable, event.data.send.writable);\n                encoder.setupPassthroughTransform(event.data.receive.readable, event.data.receive.writable);\n            }\n            else if (event.data.msgType === 'RedPayloadType') {\n                encoder.setRedPayloadType(event.data.payloadType);\n            }\n            else if (event.data.msgType === 'OpusPayloadType') {\n                encoder.setOpusPayloadType(event.data.payloadType);\n            }\n            else if (event.data.msgType === 'UpdateNumRedundantEncodings') {\n                encoder.setNumRedundantEncodings(event.data.numRedundantEncodings);\n            }\n            else if (event.data.msgType === 'Enable') {\n                encoder.setRedundancyEnabled(true);\n            }\n            else if (event.data.msgType === 'Disable') {\n                encoder.setRedundancyEnabled(false);\n            }\n        };\n    }\n    /**\n     * Post logs to the main thread\n     */\n    static log(msg) {\n        if (RedundantAudioEncoder.shouldLog) {\n            // @ts-ignore\n            self.postMessage({\n                type: 'REDWorkerLog',\n                log: `[AudioRed] ${msg}`,\n            });\n        }\n    }\n    /**\n     * Returns the number of encodings based on packetLoss value. This is used by `DefaultTransceiverController` to\n     * determine when to alert the encoder to update the number of encodings. It also determines if we need to\n     * turn off red in cases of very high packet loss to avoid congestion collapse.\n     */\n    static getNumRedundantEncodingsForPacketLoss(packetLoss) {\n        let recommendedRedundantEncodings = 0;\n        let shouldTurnOffRed = false;\n        if (packetLoss <= 8) {\n            recommendedRedundantEncodings = 0;\n        }\n        else if (packetLoss <= 18) {\n            recommendedRedundantEncodings = 1;\n        }\n        else if (packetLoss <= 75) {\n            recommendedRedundantEncodings = 2;\n        }\n        else {\n            recommendedRedundantEncodings = 0;\n            shouldTurnOffRed = true;\n        }\n        return [recommendedRedundantEncodings, shouldTurnOffRed];\n    }\n    /**\n     * Sets up a passthrough (no-op) transform for the given streams.\n     */\n    setupPassthroughTransform(readable, writable) {\n        RedundantAudioEncoder.log('Setting up passthrough transform');\n        readable.pipeTo(writable);\n    }\n    /**\n     * Sets up the transform stream and pipes the outgoing encoded audio frames through the transform function.\n     */\n    setupSenderTransform(readable, writable) {\n        RedundantAudioEncoder.log('Setting up sender RED transform');\n        const transformStream = new TransformStream({\n            transform: this.senderTransform.bind(this),\n        });\n        readable.pipeThrough(transformStream).pipeTo(writable);\n        return;\n    }\n    /**\n     * Sets up the transform stream and pipes the received encoded audio frames through the transform function.\n     */\n    setupReceiverTransform(readable, writable) {\n        RedundantAudioEncoder.log('Setting up receiver RED transform');\n        const transformStream = new TransformStream({\n            transform: this.receivePacketLogTransform.bind(this),\n        });\n        readable.pipeThrough(transformStream).pipeTo(writable);\n        return;\n    }\n    /**\n     * Set the RED payload type ideally obtained from local offer.\n     */\n    setRedPayloadType(payloadType) {\n        this.redPayloadType = payloadType;\n        RedundantAudioEncoder.log(`red payload type set to ${this.redPayloadType}`);\n    }\n    /**\n     * Set the opus payload type ideally obtained from local offer.\n     */\n    setOpusPayloadType(payloadType) {\n        this.opusPayloadType = payloadType;\n        RedundantAudioEncoder.log(`opus payload type set to ${this.opusPayloadType}`);\n    }\n    /**\n     * Set the number of redundant encodings\n     */\n    setNumRedundantEncodings(numRedundantEncodings) {\n        this.numRedundantEncodings = numRedundantEncodings;\n        if (this.numRedundantEncodings > this.maxRedEncodings) {\n            this.numRedundantEncodings = this.maxRedEncodings;\n        }\n        RedundantAudioEncoder.log(`Updated numRedundantEncodings to ${this.numRedundantEncodings}`);\n    }\n    /**\n     * Enable or disable redundancy in response to\n     * high packet loss event.\n     */\n    setRedundancyEnabled(enabled) {\n        this.redundancyEnabled = enabled;\n        RedundantAudioEncoder.log(`redundancy ${this.redundancyEnabled ? 'enabled' : 'disabled'}`);\n    }\n    /**\n     * Helper function to only enqueue audio frames if they do not exceed the audio payload byte limit imposed by\n     * Chromium-based browsers. Chromium will throw an error (https://crbug.com/1248479) if an audio payload larger than\n     * 1000 bytes is enqueued. Any controller that attempts to enqueue an audio payload larger than 1000 bytes will\n     * encounter this error and will permanently stop sending or receiving audio.\n     */\n    enqueueAudioFrameIfPayloadSizeIsValid(\n    // @ts-ignore\n    frame, controller) {\n        if (frame.data.byteLength > this.maxAudioPayloadSizeBytes)\n            return;\n        controller.enqueue(frame);\n    }\n    /**\n     * Receives encoded frames and modifies as needed before sending to transport.\n     */\n    senderTransform(\n    // @ts-ignore\n    frame, controller) {\n        const frameMetadata = frame.getMetadata();\n        // @ts-ignore\n        if (frameMetadata.payloadType !== this.redPayloadType) {\n            this.enqueueAudioFrameIfPayloadSizeIsValid(frame, controller);\n            return;\n        }\n        const primaryPayloadBuffer = this.getPrimaryPayload(frame.timestamp, frame.data);\n        if (!primaryPayloadBuffer) {\n            this.enqueueAudioFrameIfPayloadSizeIsValid(frame, controller);\n            return;\n        }\n        const encodedBuffer = this.encode(frame.timestamp, primaryPayloadBuffer);\n        /* istanbul ignore next */\n        if (!encodedBuffer) {\n            this.enqueueAudioFrameIfPayloadSizeIsValid(frame, controller);\n            return;\n        }\n        frame.data = encodedBuffer;\n        this.enqueueAudioFrameIfPayloadSizeIsValid(frame, controller);\n        return;\n    }\n    /**\n     * Get the primary payload from encoding\n     */\n    getPrimaryPayload(primaryTimestamp, frame) {\n        const encodings = this.splitEncodings(primaryTimestamp, frame);\n        if (!encodings || encodings.length < 1)\n            return null;\n        return encodings[encodings.length - 1].payload;\n    }\n    /**\n     * Split up the encoding received into primary and redundant encodings\n     * These will be ordered oldest to newest which is the same ordering\n     * in the RTP red payload.\n     */\n    splitEncodings(primaryTimestamp, frame, getFecInfo = false, primarySequenceNumber = undefined) {\n        // process RED headers (according to RFC 2198)\n        //   0                   1                   2                   3\n        //   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n        //  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n        //  |F|   block PT  |  timestamp offset         |   block length    |\n        //  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n        //\n        // last header\n        //   0 1 2 3 4 5 6 7\n        //  +-+-+-+-+-+-+-+-+\n        //  |0|   Block PT  |\n        //  +-+-+-+-+-+-+-+-+\n        const payload = new DataView(frame);\n        let payloadSizeBytes = payload.byteLength;\n        let totalPayloadSizeBytes = 0;\n        let totalHeaderSizeBytes = 0;\n        let primaryPayloadSizeBytes = 0;\n        let payloadOffset = 0;\n        let gotLastBlock = false;\n        const encodings = new Array();\n        const redundantEncodingBlockLengths = new Array();\n        const redundantEncodingTimestamps = new Array();\n        while (payloadSizeBytes > 0) {\n            gotLastBlock = (payload.getUint8(payloadOffset) & 0x80) === 0;\n            if (gotLastBlock) {\n                // Bits 1 through 7 are payload type\n                const payloadType = payload.getUint8(payloadOffset) & 0x7f;\n                // Unexpected payload type. This is a bad packet.\n                if (payloadType !== this.opusPayloadType) {\n                    return null;\n                }\n                totalPayloadSizeBytes += this.redLastHeaderSizeBytes;\n                totalHeaderSizeBytes += this.redLastHeaderSizeBytes;\n                // Accumulated block lengths are equal to or larger than the buffer, which means there is no primary block. This\n                // is a bad packet.\n                if (totalPayloadSizeBytes >= payload.byteLength) {\n                    return null;\n                }\n                primaryPayloadSizeBytes = payload.byteLength - totalPayloadSizeBytes;\n                break;\n            }\n            else {\n                if (payloadSizeBytes < this.redHeaderSizeBytes) {\n                    return null;\n                }\n                // Bits 22 through 31 are payload length\n                const blockLength = ((payload.getUint8(payloadOffset + 2) & 0x03) << 8) + payload.getUint8(payloadOffset + 3);\n                redundantEncodingBlockLengths.push(blockLength);\n                const timestampOffset = payload.getUint16(payloadOffset + 1) >> 2;\n                const timestamp = primaryTimestamp - timestampOffset;\n                redundantEncodingTimestamps.push(timestamp);\n                totalPayloadSizeBytes += blockLength + this.redHeaderSizeBytes;\n                totalHeaderSizeBytes += this.redHeaderSizeBytes;\n                payloadOffset += this.redHeaderSizeBytes;\n                payloadSizeBytes -= this.redHeaderSizeBytes;\n            }\n        }\n        // The last block was never found. This is a bad packet.\n        if (!gotLastBlock) {\n            return null;\n        }\n        let redundantPayloadOffset = totalHeaderSizeBytes;\n        for (let i = 0; i < redundantEncodingTimestamps.length; i++) {\n            const redundantPayloadBuffer = new ArrayBuffer(redundantEncodingBlockLengths[i]);\n            const redundantPayloadArray = new Uint8Array(redundantPayloadBuffer);\n            redundantPayloadArray.set(new Uint8Array(payload.buffer, redundantPayloadOffset, redundantEncodingBlockLengths[i]), 0);\n            const encoding = {\n                timestamp: redundantEncodingTimestamps[i],\n                payload: redundantPayloadBuffer,\n                isRedundant: true,\n            };\n            if (getFecInfo) {\n                encoding.hasFec = this.opusPacketHasFec(new DataView(redundantPayloadBuffer), redundantPayloadBuffer.byteLength);\n            }\n            encodings.push(encoding);\n            redundantPayloadOffset += redundantEncodingBlockLengths[i];\n        }\n        const primaryPayloadOffset = payload.byteLength - primaryPayloadSizeBytes;\n        const primaryPayloadBuffer = new ArrayBuffer(primaryPayloadSizeBytes);\n        const primaryArray = new Uint8Array(primaryPayloadBuffer);\n        primaryArray.set(new Uint8Array(payload.buffer, primaryPayloadOffset, primaryPayloadSizeBytes), 0);\n        const encoding = {\n            timestamp: primaryTimestamp,\n            payload: primaryPayloadBuffer,\n            isRedundant: false,\n            seq: primarySequenceNumber,\n        };\n        if (getFecInfo) {\n            encoding.hasFec = this.opusPacketHasFec(new DataView(primaryPayloadBuffer), primaryPayloadBuffer.byteLength);\n        }\n        encodings.push(encoding);\n        return encodings;\n    }\n    /**\n     * Create a new encoding with current primary payload and the older payloads of choice.\n     */\n    encode(primaryTimestamp, primaryPayload) {\n        const primaryPayloadSize = primaryPayload.byteLength;\n        // Payload size needs to be valid.\n        if (primaryPayloadSize === 0 ||\n            primaryPayloadSize >= this.maxRedPacketSizeBytes ||\n            primaryPayloadSize >= this.maxAudioPayloadSizeBytes) {\n            return null;\n        }\n        const numRedundantEncodings = this.numRedundantEncodings;\n        let headerSizeBytes = this.redLastHeaderSizeBytes;\n        let payloadSizeBytes = primaryPayloadSize;\n        let bytesAvailable = this.maxAudioPayloadSizeBytes - primaryPayloadSize - headerSizeBytes;\n        const redundantEncodingTimestamps = new Array();\n        const redundantEncodingPayloads = new Array();\n        // If redundancy is disabled then only send the primary payload\n        if (this.redundancyEnabled) {\n            // Determine how much redundancy we can fit into our packet\n            let redundantTimestamp = this.uint32WrapAround(primaryTimestamp - this.redPacketizationTime * this.redPacketDistance);\n            for (let i = 0; i < numRedundantEncodings; i++) {\n                // Do not add redundant encodings that are beyond the maximum timestamp offset.\n                if (this.uint32WrapAround(primaryTimestamp - redundantTimestamp) >= this.maxRedTimestampOffset) {\n                    break;\n                }\n                let findTimestamp = redundantTimestamp;\n                let encoding = this.encodingHistory.find(e => e.timestamp === findTimestamp);\n                if (!encoding) {\n                    // If not found or not important then look for the previous packet.\n                    // The current packet may have included FEC for the previous, so just\n                    // use the previous packet instead provided that it has voice activity.\n                    findTimestamp = this.uint32WrapAround(redundantTimestamp - this.redPacketizationTime);\n                    encoding = this.encodingHistory.find(e => e.timestamp === findTimestamp);\n                }\n                if (encoding) {\n                    const redundantEncodingSizeBytes = encoding.payload.byteLength;\n                    // Only add redundancy if there are enough bytes available.\n                    if (bytesAvailable < this.redHeaderSizeBytes + redundantEncodingSizeBytes)\n                        break;\n                    bytesAvailable -= this.redHeaderSizeBytes + redundantEncodingSizeBytes;\n                    headerSizeBytes += this.redHeaderSizeBytes;\n                    payloadSizeBytes += redundantEncodingSizeBytes;\n                    redundantEncodingTimestamps.unshift(encoding.timestamp);\n                    redundantEncodingPayloads.unshift(encoding.payload);\n                }\n                redundantTimestamp -= this.redPacketizationTime * this.redPacketDistance;\n                redundantTimestamp = this.uint32WrapAround(redundantTimestamp);\n            }\n        }\n        const redPayloadBuffer = new ArrayBuffer(headerSizeBytes + payloadSizeBytes);\n        const redPayloadView = new DataView(redPayloadBuffer);\n        // Add redundant encoding header(s) to new buffer\n        let redPayloadOffset = 0;\n        for (let i = 0; i < redundantEncodingTimestamps.length; i++) {\n            const timestampDelta = primaryTimestamp - redundantEncodingTimestamps[i];\n            redPayloadView.setUint8(redPayloadOffset, this.opusPayloadType | 0x80);\n            redPayloadView.setUint16(redPayloadOffset + 1, (timestampDelta << 2) | (redundantEncodingPayloads[i].byteLength >> 8));\n            redPayloadView.setUint8(redPayloadOffset + 3, redundantEncodingPayloads[i].byteLength & 0xff);\n            redPayloadOffset += this.redHeaderSizeBytes;\n        }\n        // Add primary encoding header to new buffer\n        redPayloadView.setUint8(redPayloadOffset, this.opusPayloadType);\n        redPayloadOffset += this.redLastHeaderSizeBytes;\n        // Add redundant payload(s) to new buffer\n        const redPayloadArray = new Uint8Array(redPayloadBuffer);\n        for (let i = 0; i < redundantEncodingPayloads.length; i++) {\n            redPayloadArray.set(new Uint8Array(redundantEncodingPayloads[i]), redPayloadOffset);\n            redPayloadOffset += redundantEncodingPayloads[i].byteLength;\n        }\n        // Add primary payload to new buffer\n        redPayloadArray.set(new Uint8Array(primaryPayload), redPayloadOffset);\n        redPayloadOffset += primaryPayload.byteLength;\n        /* istanbul ignore next */\n        // Sanity check that we got the expected total payload size.\n        if (redPayloadOffset !== headerSizeBytes + payloadSizeBytes)\n            return null;\n        this.updateEncodingHistory(primaryTimestamp, primaryPayload);\n        return redPayloadBuffer;\n    }\n    /**\n     * Update the encoding history with the latest primary encoding\n     */\n    updateEncodingHistory(primaryTimestamp, primaryPayload) {\n        // Remove encodings from the history if they are too old.\n        for (const encoding of this.encodingHistory) {\n            const maxTimestampDelta = this.redPacketizationTime * this.redMaxRecoveryDistance;\n            if (primaryTimestamp - encoding.timestamp >= maxTimestampDelta) {\n                this.encodingHistory.shift();\n            }\n            else {\n                break;\n            }\n        }\n        // Only add an encoding to the history if the encoding is deemed to be important. An encoding is important if it is\n        // a CELT-only packet or contains voice activity.\n        const packet = new DataView(primaryPayload);\n        if (this.opusPacketIsCeltOnly(packet) ||\n            this.opusPacketHasVoiceActivity(packet, packet.byteLength) > 0) {\n            // Check if adding an encoding will cause the length of the encoding history to exceed the maximum history size.\n            // This is not expected to happen but could occur if we get incorrect timestamps. We want to make sure our memory\n            // usage is bounded. In this case, just clear the history and start over from empty.\n            if (this.encodingHistory.length + 1 > this.maxEncodingHistorySize)\n                this.encodingHistory.length = 0;\n            this.encodingHistory.push({ timestamp: primaryTimestamp, payload: primaryPayload });\n        }\n    }\n    /**\n     * Initialize packet logs and metric values.\n     */\n    initializePacketLogs() {\n        // The extra space from the max RED recovery distance is to ensure that we do not incorrectly count recovery for\n        // packets that have already been received but are outside of the max out-of-order distance.\n        const packetLogSize = this.maxOutOfOrderPacketDistance + this.redMaxRecoveryDistance;\n        this.primaryPacketLog = {\n            window: new Array(packetLogSize),\n            index: 0,\n            windowSize: packetLogSize,\n        };\n        this.redRecoveryLog = {\n            window: new Array(packetLogSize),\n            index: 0,\n            windowSize: packetLogSize,\n        };\n        this.fecRecoveryLog = {\n            window: new Array(packetLogSize),\n            index: 0,\n            windowSize: packetLogSize,\n        };\n        this.totalAudioPacketsExpected = 0;\n        this.totalAudioPacketsLost = 0;\n        this.totalAudioPacketsRecoveredRed = 0;\n        this.totalAudioPacketsRecoveredFec = 0;\n    }\n    /**\n     * Receives encoded frames from the server\n     * and adds the timestamps to a packet log\n     * to calculate an approximate recovery metric.\n     */\n    receivePacketLogTransform(\n    // @ts-ignore\n    frame, controller) {\n        const frameMetadata = frame.getMetadata();\n        // @ts-ignore\n        if (frameMetadata.payloadType !== this.redPayloadType) {\n            this.enqueueAudioFrameIfPayloadSizeIsValid(frame, controller);\n            return;\n        }\n        // @ts-ignore\n        const encodings = this.splitEncodings(frame.timestamp, frame.data, \n        /*getFecInfo*/ true, frameMetadata.sequenceNumber);\n        if (!encodings) {\n            this.enqueueAudioFrameIfPayloadSizeIsValid(frame, controller);\n            return;\n        }\n        for (let i = encodings.length - 1; i >= 0; i--) {\n            if (this.updateLossStats(encodings[i])) {\n                this.updateRedStats(encodings[i]);\n                this.updateFecStats(encodings[i]);\n            }\n        }\n        this.maybeReportLossStats(encodings[encodings.length - 1].timestamp, frameMetadata.synchronizationSource);\n        this.enqueueAudioFrameIfPayloadSizeIsValid(frame, controller);\n    }\n    /**\n     * Adds a timestamp to the primary packet log.\n     * This also updates totalAudioPacketsLost and totalAudioPacketsExpected by looking\n     * at the difference between timestamps.\n     *\n     * @param encoding : The encoding to be analyzed\n     * @returns false if sequence number was greater than max out of order distance\n     *          true otherwise\n     */\n    updateLossStats(encoding) {\n        if (encoding.isRedundant)\n            return true;\n        const timestamp = encoding.timestamp;\n        const seq = encoding.seq;\n        if (this.totalAudioPacketsExpected === 0) {\n            this.totalAudioPacketsExpected = 1;\n            this.newestSequenceNumber = seq;\n            this.addTimestamp(this.primaryPacketLog, timestamp);\n            return true;\n        }\n        const diff = this.int16(seq - this.newestSequenceNumber);\n        if (diff < -this.maxOutOfOrderPacketDistance)\n            return false;\n        if (diff < 0) {\n            if (!this.hasTimestamp(this.primaryPacketLog, timestamp)) {\n                if (this.totalAudioPacketsLost > 0)\n                    this.totalAudioPacketsLost--;\n                this.addTimestamp(this.primaryPacketLog, timestamp);\n                this.removeFromRecoveryWindows(timestamp);\n            }\n        }\n        else if (diff > 1) {\n            this.totalAudioPacketsLost += diff - 1;\n        }\n        if (diff > 0) {\n            this.totalAudioPacketsExpected += diff;\n            this.newestSequenceNumber = encoding.seq;\n            this.addTimestamp(this.primaryPacketLog, timestamp);\n        }\n        return true;\n    }\n    /**\n     * Adds a timestamp to the red recovery log if it is not present in\n     * the primary packet log and if it's not too old.\n     *\n     * @param encoding : The encoding to be analyzed\n     */\n    updateRedStats(encoding) {\n        if (!encoding.isRedundant || this.totalAudioPacketsLost === 0)\n            return;\n        const timestamp = encoding.timestamp;\n        if (!this.hasTimestamp(this.primaryPacketLog, timestamp)) {\n            if (!this.hasTimestamp(this.redRecoveryLog, timestamp)) {\n                this.totalAudioPacketsRecoveredRed++;\n                this.addTimestamp(this.redRecoveryLog, timestamp);\n            }\n            if (this.removeTimestamp(this.fecRecoveryLog, timestamp)) {\n                /* istanbul ignore else */\n                if (this.totalAudioPacketsRecoveredFec > 0)\n                    this.totalAudioPacketsRecoveredFec--;\n            }\n        }\n    }\n    /**\n     * Adds a timestamp to the fec recovery log if it is not present in\n     * the primary packet log and red recovery log and if it is not too old.\n     *\n     * @param encoding : The encoding to be analyzed\n     */\n    updateFecStats(encoding) {\n        if (!encoding.hasFec || this.totalAudioPacketsLost === 0)\n            return;\n        const fecTimestamp = encoding.timestamp - this.redPacketizationTime;\n        if (this.hasTimestamp(this.primaryPacketLog, fecTimestamp) ||\n            this.hasTimestamp(this.redRecoveryLog, fecTimestamp) ||\n            this.hasTimestamp(this.fecRecoveryLog, fecTimestamp)) {\n            return;\n        }\n        this.totalAudioPacketsRecoveredFec++;\n        this.addTimestamp(this.fecRecoveryLog, fecTimestamp);\n    }\n    /**\n     * Reports loss metrics to DefaultTransceiverController\n     *\n     * @param timestamp : Timestamp of most recent primary packet\n     */\n    maybeReportLossStats(timestamp, ssrc) {\n        if (timestamp - this.lastLossReportTimestamp < this.lossReportInterval)\n            return;\n        /* istanbul ignore next */\n        if (RedundantAudioEncoder.shouldReportStats) {\n            // @ts-ignore\n            self.postMessage({\n                type: 'RedundantAudioEncoderStats',\n                ssrc,\n                totalAudioPacketsLost: this.totalAudioPacketsLost,\n                totalAudioPacketsExpected: this.totalAudioPacketsExpected,\n                totalAudioPacketsRecoveredRed: this.totalAudioPacketsRecoveredRed,\n                totalAudioPacketsRecoveredFec: this.totalAudioPacketsRecoveredFec,\n            });\n        }\n        this.lastLossReportTimestamp = timestamp;\n    }\n    /**\n     * Adds a timestamp to a packet log\n     *\n     * @param packetLog : The packetlog to add the timestamp to\n     * @param timestamp : The timestamp that should be added\n     */\n    addTimestamp(packetLog, timestamp) {\n        packetLog.window[packetLog.index] = timestamp;\n        packetLog.index = (packetLog.index + 1) % packetLog.windowSize;\n    }\n    /**\n     * Checks if a timestamp is in a packetlog\n     *\n     * @param packetLog : The packetlog to search\n     * @param timestamp : The timestamp to search for\n     * @returns true if timestamp is present, false otherwise\n     */\n    hasTimestamp(packetLog, timestamp) {\n        const element = packetLog.window.find(t => t === timestamp);\n        return !!element;\n    }\n    /**\n     * Removes a timestamp from a packet log\n     *\n     * @param packetLog : The packetlog from which the timestamp should be removed\n     * @param timestamp : The timestamp to be removed\n     * @returns true if timestamp was present in the log and removed, false otherwise\n     */\n    removeTimestamp(packetLog, timestamp) {\n        const index = packetLog.window.indexOf(timestamp);\n        if (index >= 0) {\n            packetLog.window[index] = undefined;\n            return true;\n        }\n        return false;\n    }\n    /**\n     * Removes a timestamp from red and fec recovery windows.\n     *\n     * @param timestamp : The timestamp to be removed\n     */\n    removeFromRecoveryWindows(timestamp) {\n        let removed = this.removeTimestamp(this.redRecoveryLog, timestamp);\n        if (removed) {\n            if (this.totalAudioPacketsRecoveredRed > 0)\n                this.totalAudioPacketsRecoveredRed--;\n        }\n        removed = this.removeTimestamp(this.fecRecoveryLog, timestamp);\n        if (removed) {\n            if (this.totalAudioPacketsRecoveredFec > 0)\n                this.totalAudioPacketsRecoveredFec--;\n        }\n    }\n    /**\n     * Converts the supplied argument to 32-bit unsigned integer\n     */\n    uint32WrapAround(num) {\n        const mod = 4294967296; // 2^32\n        let res = num;\n        if (num >= mod) {\n            res = num - mod;\n        }\n        else if (num < 0) {\n            res = mod + num;\n        }\n        return res;\n    }\n    /**\n     * Converts the supplied argument to 16-bit signed integer\n     */\n    int16(num) {\n        return (num << 16) >> 16;\n    }\n    /**\n     * Determines if an Opus packet is in CELT-only mode.\n     *\n     * @param packet Opus packet.\n     * @returns `true` if the packet is in CELT-only mode.\n     */\n    opusPacketIsCeltOnly(packet) {\n        // TOC byte format (https://www.rfc-editor.org/rfc/rfc6716#section-3.1):\n        //  0\n        //  0 1 2 3 4 5 6 7\n        // +-+-+-+-+-+-+-+-+\n        // | config  |s| c |\n        // +-+-+-+-+-+-+-+-+\n        // Since CELT-only packets are represented using configurations 16 to 31, the highest 'config' bit will always be 1\n        // for CELT-only packets.\n        return !!(packet.getUint8(0) & 0x80);\n    }\n    /**\n     * Gets the number of samples per frame from an Opus packet.\n     *\n     * @param packet Opus packet. This must contain at least one byte of data.\n     * @param sampleRateHz 32-bit integer sampling rate in Hz. This must be a multiple of 400 or inaccurate results will\n     *                     be returned.\n     * @returns Number of samples per frame.\n     */\n    opusPacketGetSamplesPerFrame(packet, sampleRateHz) {\n        // Sample rate must be a 32-bit integer.\n        sampleRateHz = Math.round(sampleRateHz);\n        sampleRateHz = Math.min(Math.max(sampleRateHz, -(Math.pow(2, 32))), Math.pow(2, 32) - 1);\n        // TOC byte format (https://www.rfc-editor.org/rfc/rfc6716#section-3.1):\n        //  0\n        //  0 1 2 3 4 5 6 7\n        // +-+-+-+-+-+-+-+-+\n        // | config  |s| c |\n        // +-+-+-+-+-+-+-+-+\n        let numSamples;\n        let frameSizeOption;\n        // Case for CELT-only packet.\n        if (this.opusPacketIsCeltOnly(packet)) {\n            // The lower 3 'config' bits indicate the frame size option.\n            frameSizeOption = (packet.getUint8(0) >> 3) & 0x3;\n            // The frame size options 0, 1, 2, 3 correspond to frame sizes of 2.5, 5, 10, 20 ms. Notice that the frame sizes\n            // can be represented as (2.5 * 2^0), (2.5 * 2^1), (2.5 * 2^2), (2.5 * 2^3) ms. So, the number of samples can be\n            // calculated as follows:\n            // (sample/s) * (1s/1000ms) * (2.5ms) * 2^(frameSizeOption)\n            // = (sample/s) * (1s/400) * 2^(frameSizeOption)\n            // = (sample/s) * 2^(frameSizeOption) * (1s/400)\n            numSamples = (sampleRateHz << frameSizeOption) / 400;\n        }\n        // Case for Hybrid packet. Since Hybrid packets are represented using configurations 12 to 15, bits 1 and 2 in the\n        // above TOC byte diagram will both be 1.\n        else if ((packet.getUint8(0) & 0x60) === 0x60) {\n            // In the case of configuration 13 or 15, bit 4 in the above TOC byte diagram will be 1. Configurations 13 and 15\n            // correspond to a 20ms frame size, so the number of samples is calculated as follows:\n            // (sample/s) * (1s/1000ms) * (20ms)\n            // = (sample/s) * (1s/50)\n            //\n            // In the case of configuration 12 or 14, bit 4 in the above TOC byte diagram will be 0. Configurations 12 and 14\n            // correspond to a 10ms frame size, so the number of samples is calculated as follows:\n            // (sample/s) * (1s/1000ms) * (10ms)\n            // = (sample/s) * (1s/100)\n            numSamples = packet.getUint8(0) & 0x08 ? sampleRateHz / 50 : sampleRateHz / 100;\n        }\n        // Case for SILK-only packet.\n        else {\n            // The lower 3 'config' bits indicate the frame size option for SILK-only packets.\n            frameSizeOption = (packet.getUint8(0) >> 3) & 0x3;\n            if (frameSizeOption === 3) {\n                // Frame size option 3 corresponds to a frame size of 60ms, so the number of samples is calculated as follows:\n                // (sample/s) * (1s/1000ms) * (60ms)\n                // = (sample/s) * (60ms) * (1s/1000ms)\n                numSamples = (sampleRateHz * 60) / 1000;\n            }\n            else {\n                // The frame size options 0, 1, 2 correspond to frame sizes of 10, 20, 40 ms. Notice that the frame sizes can be\n                // represented as (10 * 2^0), (10 * 2^1), (10 * 2^2) ms. So, the number of samples can be calculated as follows:\n                // (sample/s) * (1s/1000ms) * (10ms) * 2^(frameSizeOption)\n                // = (sample/s) * (1s/100) * 2^(frameSizeOption)\n                // = (sample/s) * 2^(frameSizeOption) * (1s/100)\n                numSamples = (sampleRateHz << frameSizeOption) / 100;\n            }\n        }\n        return numSamples;\n    }\n    /**\n     * Gets the number of SILK frames per Opus frame.\n     *\n     * @param packet Opus packet.\n     * @returns Number of SILK frames per Opus frame.\n     */\n    opusNumSilkFrames(packet) {\n        // For computing the frame length in ms, the sample rate is not important since it cancels out. We use 48 kHz, but\n        // any valid sample rate would work.\n        //\n        // To calculate the length of a frame (with a 48kHz sample rate) in ms:\n        // (samples/frame) * (1s/48000 samples) * (1000ms/s)\n        // = (samples/frame) * (1000ms/48000 samples)\n        // = (samples/frame) * (1ms/48 samples)\n        let frameLengthMs = this.opusPacketGetSamplesPerFrame(packet, 48000) / 48;\n        if (frameLengthMs < 10)\n            frameLengthMs = 10;\n        // The number of SILK frames per Opus frame is described in https://www.rfc-editor.org/rfc/rfc6716#section-4.2.2.\n        switch (frameLengthMs) {\n            case 10:\n            case 20:\n                return 1;\n            case 40:\n                return 2;\n            case 60:\n                return 3;\n            // It is not possible to reach the default case since an Opus packet can only encode sizes of 2.5, 5, 10, 20, 40,\n            // or 60 ms, so we ignore the default case for test coverage.\n            /* istanbul ignore next */\n            default:\n                return 0;\n        }\n    }\n    /**\n     * Gets the number of channels from an Opus packet.\n     *\n     * @param packet Opus packet.\n     * @returns Number of channels.\n     */\n    opusPacketGetNumChannels(packet) {\n        // TOC byte format (https://www.rfc-editor.org/rfc/rfc6716#section-3.1):\n        //  0\n        //  0 1 2 3 4 5 6 7\n        // +-+-+-+-+-+-+-+-+\n        // | config  |s| c |\n        // +-+-+-+-+-+-+-+-+\n        // The 's' bit indicates mono or stereo audio, with 0 indicating mono and 1 indicating stereo.\n        return packet.getUint8(0) & 0x4 ? 2 : 1;\n    }\n    /**\n     * Determine the size (in bytes) of an Opus frame.\n     *\n     * @param packet Opus packet.\n     * @param byteOffset Offset (from the start of the packet) to the byte containing the size information.\n     * @param remainingBytes Remaining number of bytes to parse from the Opus packet.\n     * @param sizeBytes Variable to store the parsed frame size (in bytes).\n     * @returns Number of bytes that were parsed to determine the frame size.\n     */\n    opusParseSize(packet, byteOffset, remainingBytes, sizeBytes) {\n        // See https://www.rfc-editor.org/rfc/rfc6716#section-3.2.1 for an explanation of how frame size is represented.\n        // If there are no remaining bytes to parse the size from, then the size cannot be determined.\n        if (remainingBytes < 1) {\n            sizeBytes[0] = -1;\n            return -1;\n        }\n        // If the first byte is in the range 0...251, then this value is the size of the frame.\n        else if (packet.getUint8(byteOffset) < 252) {\n            sizeBytes[0] = packet.getUint8(byteOffset);\n            return 1;\n        }\n        // If the first byte is in the range 252...255, a second byte is needed. If there is no second byte, then the size\n        // cannot be determined.\n        else if (remainingBytes < 2) {\n            sizeBytes[0] = -1;\n            return -1;\n        }\n        // The total size of the frame given two size bytes is:\n        // (4 * secondSizeByte) + firstSizeByte\n        else {\n            sizeBytes[0] = 4 * packet.getUint8(byteOffset + 1) + packet.getUint8(byteOffset);\n            return 2;\n        }\n    }\n    /**\n     * Parse binary data containing an Opus packet into one or more Opus frames.\n     *\n     * @param data Binary data containing an Opus packet to be parsed. The data should begin with the first byte (i.e the\n     *             TOC byte) of an Opus packet. Note that the size of the data does not have to equal the size of the\n     *             contained Opus packet.\n     * @param lenBytes Size of the data (in bytes).\n     * @param selfDelimited Indicates if the Opus packet is self-delimiting\n     *                      (https://www.rfc-editor.org/rfc/rfc6716#appendix-B).\n     * @param tocByte Optional variable to store the TOC (table of contents) byte.\n     * @param frameOffsets Optional variable to store the offsets (from the start of the data) to the first bytes of each\n     *                     Opus frame.\n     * @param frameSizes Required variable to store the sizes (in bytes) of each Opus frame.\n     * @param payloadOffset Optional variable to store the offset (from the start of the data) to the first byte of the\n     *                      payload.\n     * @param packetLenBytes Optional variable to store the length of the Opus packet (in bytes).\n     * @returns Number of Opus frames.\n     */\n    opusPacketParseImpl(data, lenBytes, selfDelimited, tocByte, frameOffsets, frameSizes, payloadOffset, packetLenBytes) {\n        if (!frameSizes || lenBytes < 0)\n            return this.OPUS_BAD_ARG;\n        if (lenBytes === 0)\n            return this.OPUS_INVALID_PACKET;\n        // The number of Opus frames in the packet.\n        let numFrames;\n        // Intermediate storage for the number of bytes parsed to determine the size of a frame.\n        let numBytesParsed;\n        // The number of the padding bytes (excluding the padding count bytes) in the packet.\n        let paddingBytes = 0;\n        // Indicates whether CBR (constant bitrate) framing is used.\n        let cbr = false;\n        // The TOC (table of contents) byte (https://www.rfc-editor.org/rfc/rfc6716#section-3.1).\n        const toc = data.getUint8(0);\n        // Store the TOC byte.\n        if (tocByte)\n            tocByte[0] = toc;\n        // The remaining number of bytes to parse from the packet. Note that the TOC byte has already been parsed, hence the\n        // minus 1.\n        let remainingBytes = lenBytes - 1;\n        // This keeps track of where we are in the packet. This starts at 1 since the TOC byte has already been read.\n        let byteOffset = 1;\n        // The size of the last Opus frame in bytes.\n        let lastSizeBytes = remainingBytes;\n        // Read the `c` bits (i.e. code bits) from the TOC byte.\n        switch (toc & 0x3) {\n            // A code 0 packet (https://www.rfc-editor.org/rfc/rfc6716#section-3.2.2) has one frame.\n            case 0:\n                numFrames = 1;\n                break;\n            // A code 1 packet (https://www.rfc-editor.org/rfc/rfc6716#section-3.2.3) has two CBR (constant bitrate) frames.\n            case 1:\n                numFrames = 2;\n                cbr = true;\n                if (!selfDelimited) {\n                    // Undelimited code 1 packets must be an even number of data bytes, otherwise the packet is invalid.\n                    if (remainingBytes & 0x1)\n                        return this.OPUS_INVALID_PACKET;\n                    // The sizes of both frames are equal (i.e. half of the number of data bytes).\n                    lastSizeBytes = remainingBytes / 2;\n                    // If `lastSizeBytes` is too large, we will catch it later.\n                    frameSizes[0][0] = lastSizeBytes;\n                }\n                break;\n            // A code 2 packet (https://www.rfc-editor.org/rfc/rfc6716#section-3.2.4) has two VBR (variable bitrate) frames.\n            case 2:\n                numFrames = 2;\n                numBytesParsed = this.opusParseSize(data, byteOffset, remainingBytes, frameSizes[0]);\n                remainingBytes -= numBytesParsed;\n                // The parsed size of the first frame cannot be larger than the number of remaining bytes in the packet.\n                if (frameSizes[0][0] < 0 || frameSizes[0][0] > remainingBytes) {\n                    return this.OPUS_INVALID_PACKET;\n                }\n                byteOffset += numBytesParsed;\n                // The size of the second frame is the remaining number of bytes after the first frame.\n                lastSizeBytes = remainingBytes - frameSizes[0][0];\n                break;\n            // A code 3 packet (https://www.rfc-editor.org/rfc/rfc6716#section-3.2.5) has multiple CBR/VBR frames (from 0 to\n            // 120 ms).\n            default:\n                // Code 3 packets must have at least 2 bytes (i.e. at least 1 byte after the TOC byte).\n                if (remainingBytes < 1)\n                    return this.OPUS_INVALID_PACKET;\n                // Frame count byte format:\n                //  0\n                //  0 1 2 3 4 5 6 7\n                // +-+-+-+-+-+-+-+-+\n                // |v|p|     M     |\n                // +-+-+-+-+-+-+-+-+\n                //\n                // Read the frame count byte, which immediately follows the TOC byte.\n                const frameCountByte = data.getUint8(byteOffset++);\n                --remainingBytes;\n                // Read the 'M' bits of the frame count byte, which encode the number of frames.\n                numFrames = frameCountByte & 0x3f;\n                // The number of frames in a code 3 packet must not be 0.\n                if (numFrames <= 0)\n                    return this.OPUS_INVALID_PACKET;\n                const samplesPerFrame = this.opusPacketGetSamplesPerFrame(data, 48000);\n                // A single frame can have at most 2880 samples, which happens in the case where 60ms of 48kHz audio is encoded\n                // per frame. A code 3 packet cannot contain more than 120ms of audio, so the total number of samples cannot\n                // exceed 2880 * 2 = 5760.\n                if (samplesPerFrame * numFrames > 5760)\n                    return this.OPUS_INVALID_PACKET;\n                // Parse padding bytes if the 'p' bit is 1.\n                if (frameCountByte & 0x40) {\n                    let paddingCountByte;\n                    let numPaddingBytes;\n                    // Remove padding bytes (including padding count bytes) from the remaining byte count.\n                    do {\n                        // Sanity check that there are enough bytes to parse and remove the padding.\n                        if (remainingBytes <= 0)\n                            return this.OPUS_INVALID_PACKET;\n                        // Get the next padding count byte.\n                        paddingCountByte = data.getUint8(byteOffset++);\n                        --remainingBytes;\n                        // If the padding count byte has a value in the range 0...254, then the total size of the padding is the\n                        // value in the padding count byte.\n                        //\n                        // If the padding count byte has value 255, then the total size of the padding is 254 plus the value in the\n                        // next padding count byte. Therefore, keep reading padding count bytes while the value is 255.\n                        numPaddingBytes = paddingCountByte === 255 ? 254 : paddingCountByte;\n                        remainingBytes -= numPaddingBytes;\n                        paddingBytes += numPaddingBytes;\n                    } while (paddingCountByte === 255);\n                }\n                // Sanity check that the remaining number of bytes is not negative after removing the padding.\n                if (remainingBytes < 0)\n                    return this.OPUS_INVALID_PACKET;\n                // Read the 'v' bit (i.e. VBR bit).\n                cbr = !(frameCountByte & 0x80);\n                // VBR case\n                if (!cbr) {\n                    lastSizeBytes = remainingBytes;\n                    // Let M be the number of frames. There will be M - 1 frame length indicators (which can be 1 or 2 bytes)\n                    // corresponding to the lengths of frames 0 to M - 2. The size of the last frame (i.e. frame M - 1) is the\n                    // number of data bytes after the end of frame M - 2 and before the start of the padding bytes.\n                    for (let i = 0; i < numFrames - 1; ++i) {\n                        numBytesParsed = this.opusParseSize(data, byteOffset, remainingBytes, frameSizes[i]);\n                        remainingBytes -= numBytesParsed;\n                        // The remaining number of data bytes must be enough to contain each frame.\n                        if (frameSizes[i][0] < 0 || frameSizes[i][0] > remainingBytes) {\n                            return this.OPUS_INVALID_PACKET;\n                        }\n                        byteOffset += numBytesParsed;\n                        lastSizeBytes -= numBytesParsed + frameSizes[i][0];\n                    }\n                    // Sanity check that the size of the last frame is not negative.\n                    if (lastSizeBytes < 0)\n                        return this.OPUS_INVALID_PACKET;\n                }\n                // CBR case\n                else if (!selfDelimited) {\n                    // The size of each frame is the number of data bytes divided by the number of frames.\n                    lastSizeBytes = Math.trunc(remainingBytes / numFrames);\n                    // The number of data bytes must be a non-negative integer multiple of the number of frames.\n                    if (lastSizeBytes * numFrames !== remainingBytes)\n                        return this.OPUS_INVALID_PACKET;\n                    // All frames have equal size in the undelimited CBR case.\n                    for (let i = 0; i < numFrames - 1; ++i) {\n                        frameSizes[i][0] = lastSizeBytes;\n                    }\n                }\n        }\n        // Self-delimited framing uses an extra 1 or 2 bytes, immediately preceding the data bytes, to indicate either the\n        // size of the last frame (for code 0, code 2, and VBR code 3 packets) or the size of all the frames (for code 1 and\n        // CBR code 3 packets). See https://www.rfc-editor.org/rfc/rfc6716#appendix-B.\n        if (selfDelimited) {\n            // The extra frame size byte(s) will always indicate the size of the last frame.\n            numBytesParsed = this.opusParseSize(data, byteOffset, remainingBytes, frameSizes[numFrames - 1]);\n            remainingBytes -= numBytesParsed;\n            // There must be enough data bytes for the last frame.\n            if (frameSizes[numFrames - 1][0] < 0 || frameSizes[numFrames - 1][0] > remainingBytes) {\n                return this.OPUS_INVALID_PACKET;\n            }\n            byteOffset += numBytesParsed;\n            // For CBR packets, the sizes of all the frames are equal.\n            if (cbr) {\n                // There must be enough data bytes for all the frames.\n                if (frameSizes[numFrames - 1][0] * numFrames > remainingBytes) {\n                    return this.OPUS_INVALID_PACKET;\n                }\n                for (let i = 0; i < numFrames - 1; ++i) {\n                    frameSizes[i][0] = frameSizes[numFrames - 1][0];\n                }\n            }\n            // At this point, `lastSizeBytes` contains the size of the last frame plus the size of the extra frame size\n            // byte(s), so sanity check that `lastSizeBytes` is the upper bound for the size of the last frame.\n            else if (!(numBytesParsed + frameSizes[numFrames - 1][0] <= lastSizeBytes)) {\n                return this.OPUS_INVALID_PACKET;\n            }\n        }\n        // Undelimited case\n        else {\n            // Because the size of the last packet is not encoded explicitly, it is possible that the size of the last packet\n            // (or of all the packets, for the CBR case) is larger than maximum frame size.\n            if (lastSizeBytes > this.OPUS_MAX_FRAME_SIZE_BYTES)\n                return this.OPUS_INVALID_PACKET;\n            frameSizes[numFrames - 1][0] = lastSizeBytes;\n        }\n        // Store the offset to the start of the payload.\n        if (payloadOffset)\n            payloadOffset[0] = byteOffset;\n        // Store the offsets to the start of each frame.\n        for (let i = 0; i < numFrames; ++i) {\n            if (frameOffsets)\n                frameOffsets[i][0] = byteOffset;\n            byteOffset += frameSizes[i][0];\n        }\n        // Store the length of the Opus packet.\n        if (packetLenBytes)\n            packetLenBytes[0] = byteOffset + paddingBytes;\n        return numFrames;\n    }\n    /**\n     * Parse a single undelimited Opus packet into one or more Opus frames.\n     *\n     * @param packet Opus packet to be parsed.\n     * @param lenBytes Size of the packet (in bytes).\n     * @param tocByte Optional variable to store the TOC (table of contents) byte.\n     * @param frameOffsets Optional variable to store the offsets (from the start of the packet) to the first bytes of\n     *                     each Opus frame.\n     * @param frameSizes Required variable to store the sizes (in bytes) of each Opus frame.\n     * @param payloadOffset Optional variable to store the offset (from the start of the packet) to the first byte of the\n     *                      payload.\n     * @returns Number of Opus frames.\n     */\n    opusPacketParse(packet, lenBytes, tocByte, frameOffsets, frameSizes, payloadOffset) {\n        return this.opusPacketParseImpl(packet, lenBytes, \n        /* selfDelimited */ false, tocByte, frameOffsets, frameSizes, payloadOffset, null);\n    }\n    /**\n     * This function returns the SILK VAD (voice activity detection) information encoded in the Opus packet. For CELT-only\n     * packets that do not have VAD information, it returns -1.\n     *\n     * @param packet Opus packet.\n     * @param lenBytes Size of the packet (in bytes).\n     * @returns  0: no frame had the VAD flag set.\n     *           1: at least one frame had the VAD flag set.\n     *          -1: VAD status could not be determined.\n     */\n    opusPacketHasVoiceActivity(packet, lenBytes) {\n        if (!packet || lenBytes <= 0)\n            return 0;\n        // In CELT-only mode, we can not determine whether there is VAD.\n        if (this.opusPacketIsCeltOnly(packet))\n            return -1;\n        const numSilkFrames = this.opusNumSilkFrames(packet);\n        // It is not possible for `opusNumSilkFrames()` to return 0, so we ignore the next sanity check for test coverage.\n        /* istanbul ignore next */\n        if (numSilkFrames === 0)\n            return -1;\n        const opusFrameOffsets = new Array(this.OPUS_MAX_OPUS_FRAMES);\n        const opusFrameSizes = new Array(this.OPUS_MAX_OPUS_FRAMES);\n        for (let i = 0; i < this.OPUS_MAX_OPUS_FRAMES; ++i) {\n            opusFrameOffsets[i] = [undefined];\n            opusFrameSizes[i] = [undefined];\n        }\n        // Parse packet to get the Opus frames.\n        const numOpusFrames = this.opusPacketParse(packet, lenBytes, null, opusFrameOffsets, opusFrameSizes, null);\n        // VAD status cannot be determined for invalid packets.\n        if (numOpusFrames < 0)\n            return -1;\n        // Iterate over all Opus frames, which may contain multiple SILK frames, to determine the VAD status.\n        for (let i = 0; i < numOpusFrames; ++i) {\n            if (opusFrameSizes[i][0] < 1)\n                continue;\n            // LP layer header bits format (https://www.rfc-editor.org/rfc/rfc6716#section-4.2.3):\n            //\n            // Mono case:\n            // +-----------------+----------+\n            // | 1 to 3 VAD bits | LBRR bit |\n            // +-----------------+----------+\n            //\n            // Stereo case:\n            // +---------------------+--------------+----------------------+---------------+\n            // | 1 to 3 mid VAD bits | mid LBRR bit | 1 to 3 side VAD bits | side LBRR bit |\n            // +---------------------+--------------+----------------------+---------------+\n            // The upper 1 to 3 bits (dependent on the number of SILK frames) of the LP layer contain VAD bits. If any of\n            // these VAD bits are 1, then voice activity is present.\n            if (packet.getUint8(opusFrameOffsets[i][0]) >> (8 - numSilkFrames))\n                return 1;\n            // In the stereo case, there is a second set of 1 to 3 VAD bits, so also check these VAD bits.\n            const channels = this.opusPacketGetNumChannels(packet);\n            if (channels === 2 &&\n                (packet.getUint8(opusFrameOffsets[i][0]) << (numSilkFrames + 1)) >> (8 - numSilkFrames)) {\n                return 1;\n            }\n        }\n        // No voice activity was detected.\n        return 0;\n    }\n    /**\n     * This method is based on Definition of the Opus Audio Codec\n     * (https://tools.ietf.org/html/rfc6716). Basically, this method is based on\n     * parsing the LP layer of an Opus packet, particularly the LBRR flag.\n     *\n     * @param packet Opus packet.\n     * @param lenBytes Size of the packet (in bytes).\n     * @returns  true: packet has fec encoding about previous packet.\n     *           false: no fec encoding present.\n     */\n    opusPacketHasFec(packet, lenBytes) {\n        if (!packet || lenBytes <= 0)\n            return false;\n        // In CELT-only mode, packets should not have FEC.\n        if (this.opusPacketIsCeltOnly(packet))\n            return false;\n        const opusFrameOffsets = new Array(this.OPUS_MAX_OPUS_FRAMES);\n        const opusFrameSizes = new Array(this.OPUS_MAX_OPUS_FRAMES);\n        for (let i = 0; i < this.OPUS_MAX_OPUS_FRAMES; ++i) {\n            opusFrameOffsets[i] = [undefined];\n            opusFrameSizes[i] = [undefined];\n        }\n        // Parse packet to get the Opus frames.\n        const numOpusFrames = this.opusPacketParse(packet, lenBytes, null, opusFrameOffsets, opusFrameSizes, null);\n        if (numOpusFrames < 0)\n            return false;\n        /* istanbul ignore next */\n        if (opusFrameSizes[0][0] <= 1)\n            return false;\n        const numSilkFrames = this.opusNumSilkFrames(packet);\n        /* istanbul ignore next */\n        if (numSilkFrames === 0)\n            return false;\n        const channels = this.opusPacketGetNumChannels(packet);\n        /* istanbul ignore next */\n        if (channels !== 1 && channels !== 2)\n            return false;\n        // A frame starts with the LP layer. The LP layer begins with two to eight\n        // header bits.These consist of one VAD bit per SILK frame (up to 3),\n        // followed by a single flag indicating the presence of LBRR frames.\n        // For a stereo packet, these first flags correspond to the mid channel, and\n        // a second set of flags is included for the side channel. Because these are\n        // the first symbols decoded by the range coder and because they are coded\n        // as binary values with uniform probability, they can be extracted directly\n        // from the most significant bits of the first byte of compressed data.\n        for (let i = 0; i < channels; i++) {\n            if (packet.getUint8(opusFrameOffsets[0][0]) & (0x80 >> ((i + 1) * (numSilkFrames + 1) - 1)))\n                return true;\n        }\n        return false;\n    }\n}\nRedundantAudioEncoder.shouldLog = true;\nRedundantAudioEncoder.shouldReportStats = true;\nRedundantAudioEncoder.initializeWorker();\n";t.default=i},45619:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let r=n(i(44307));class s extends r.default{constructor(){super(0)}static nextTick(e){setTimeout(e,0)}}t.default=s},81211:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(e){this.intervalMs=e}start(e){this.stop(),this.timer=setInterval(e,this.intervalMs)}stop(){void 0!==this.timer&&(clearInterval(this.timer),this.timer=void 0)}running(){return void 0!==this.timer}}t.default=i},44307:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(e){this.timeoutMs=e,this.timer=null}start(e){this.stop(),this.timer=setTimeout(()=>{clearTimeout(this.timer),e()},this.timeoutMs)}stop(){null!==this.timer&&(clearTimeout(this.timer),this.timer=null)}}t.default=i},87444:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let r=n(i(27786)),s=n(i(5039)),o=n(i(81342));class a{constructor(e){this.sdp=e}clone(){return new a(this.sdp)}static isRTPCandidate(e){let t=/candidate[:](\S+) (\d+)/g.exec(e);return null!==t&&"1"===t[2]}static linesToSDP(e){return new a(e.join(a.CRLF))}static candidateTypeFromString(e){switch(e){case r.default.Host:return r.default.Host;case r.default.ServerReflexive:return r.default.ServerReflexive;case r.default.PeerReflexive:return r.default.PeerReflexive;case r.default.Relay:return r.default.Relay}return null}static candidateType(e){let t=/a[=]candidate[:].* typ ([a-z]+) /g.exec(e);return null===t?null:a.candidateTypeFromString(t[1])}static mediaType(e){let t=/m=(audio|video)/g.exec(e);if(null!==t)return t[1]}static mid(e){if(e.includes("a=mid:"))return e.replace(/^(a=mid:)/,"")}static direction(e){let t=/a=(sendrecv|sendonly|recvonly|inactive)/g.exec(e);if(null!==t)return t[1]}static splitLines(e){return e.trim().split("\n").map(e=>e.trim())}static splitSections(e){return e.split("\nm=").map((e,t)=>(t>0?"m="+e:e).trim()+a.CRLF)}static findActiveCameraSection(e){let t=0,i=!1;for(let n of e){if(/^m=video/.test(n)&&(n.indexOf("sendrecv")>-1||-1===n.indexOf("sendonly")&&-1===n.indexOf("recvonly")&&-1===n.indexOf("inactive"))){i=!0;break}t++}return!1===i&&(t=-1),t}static extractSSRCsFromFIDGroupLine(e){return/^a=ssrc-group:FID\s(.+)/.exec(e)[1]}static matchPrefix(e,t){return a.splitLines(e).filter(e=>0===e.indexOf(t))}lines(){return this.sdp.split(a.CRLF)}hasVideo(){return null!==/^m=video/gm.exec(this.sdp)}hasCandidates(){return null!==/a[=]candidate[:]/g.exec(this.sdp)}hasCandidatesForAllMLines(){return!(this.sdp.indexOf("c=IN IP4 0.0.0.0")>-1)}withoutCandidateType(e){return a.linesToSDP(this.lines().filter(t=>a.candidateType(t)!==e))}withoutServerReflexiveCandidates(){return this.withoutCandidateType(r.default.ServerReflexive)}withAudioMaxAverageBitrate(e){if(!e)return this.clone();e=Math.trunc(Math.min(Math.max(e,a.rfc7587LowestBitrate),a.rfc7587HighestBitrate));let t=this.lines(),i=a.findOpusFmtpAttributes(t),n=a.updateOpusFmtpAttributes(t,i,[`maxaveragebitrate=${e}`]);return a.linesToSDP(n)}withStereoAudio(){let e=this.lines(),t=a.findOpusFmtpAttributes(e),i=a.updateOpusFmtpAttributes(e,t,["stereo=1","sprop-stereo=1"]);return a.linesToSDP(i)}static findOpusFmtpAttributes(e){let t=/^a=rtpmap:\s*(\d+)\s+opus\/48000/,i=!1,n=[];for(let r of e)if(r.startsWith("m=audio")&&(n.push(null),i=!0),r.startsWith("m=video")&&(i=!1),i){let e=t.exec(r);null!==e&&(n[n.length-1]=`a=fmtp:${e[1]} `)}return n}static updateOpusFmtpAttributes(e,t,i){let n=[],r=0,s=null;for(let o of e)if(o.startsWith("m=audio")&&(s=t[r],r++),o.startsWith("m=video")&&(s=null),s&&o.startsWith(s)){let e=o.slice(s.length).split(";"),t=[];for(let n of e)0>i.findIndex(e=>e.startsWith(n.split("=")[0]))&&t.push(n);for(let e of i)t.push(e);n.push(s+t.join(";"))}else n.push(o);return n}withUnifiedPlanFormat(){let e=this.sdp;return e.includes("mozilla")?this.clone():new a(e=e.replace("o=-","o=mozilla-chrome"))}getUniqueRtpHeaderExtensionId(e){let t=[];for(let i of e)if(/^a=extmap:/.test(i.trim())){let e=+i.split("a=extmap:")[1].split(" ")[0];t.includes(e)||t.push(e)}t.sort((e,t)=>e-t);let i=0;for(let e of t){if(e-i>1)return i+1;i=e}return 14===i?-1:i+1}withVideoLayersAllocationRtpHeaderExtension(e){return this.withRtpHeaderExtension(e,a.videoLayersAllocationRtpHeaderExtensionUrl)}withDependencyDescriptorRtpHeaderExtension(e){return this.withRtpHeaderExtension(e,a.dependencyDescriptorRtpHeaderExtensionUrl)}withoutDependencyDescriptorRtpHeaderExtension(){let e=a.splitLines(this.sdp).filter(e=>!e.includes(a.dependencyDescriptorRtpHeaderExtensionUrl));return new a(e.join(a.CRLF)+a.CRLF)}withRtpHeaderExtension(e,t){let i=e?e.getRtpHeaderExtensionId(t):-1,n=-1===i?this.getUniqueRtpHeaderExtensionId(a.splitLines(this.sdp)):i,r=a.splitSections(this.sdp),s=[];for(let e of r){if(/^m=video/.test(e)&&-1===a.getRtpHeaderExtensionIdInSection(e,t)){let i=a.splitLines(e),r=[];if(-1===n||this.hasRtpHeaderExtensionId(n)){s.push(e);continue}for(let e of i)if(r.push(e),/^a=sendrecv/.test(e.trim())){let e="a=extmap:"+n+" "+t;r.push(e)}e=r.join(a.CRLF)+a.CRLF}else if(-1!==i&&/^m=video/.test(e)&&a.getRtpHeaderExtensionIdInSection(e,t)!==i){let n=a.splitLines(e),r=[];for(let e of n){if(/^a=extmap:/.test(e.trim())&&e.split("a=extmap:")[1].split(" ")[1]===t){if(!this.hasRtpHeaderExtensionId(i)){let e="a=extmap:"+i+" "+t;r.push(e)}continue}r.push(e)}e=r.join(a.CRLF)+a.CRLF}s.push(e)}return new a(s.join(""))}ssrcForVideoSendingSection(){let e=this.sdp,t=a.splitSections(e);if(t.length<2)return"";let i=a.findActiveCameraSection(t);if(-1===i)return"";let n=a.matchPrefix(t[i],"a=ssrc-group:FID ");if(n.length<1)return"";let[r]=a.extractSSRCsFromFIDGroupLine(n[0]).split(" ").map(e=>parseInt(e,10));return r.toString()}videoSendSectionHasDifferentSSRC(e){let t=this.ssrcForVideoSendingSection(),i=e.ssrcForVideoSendingSection();return""!==t&&""!==i&&parseInt(t,10)!==parseInt(i,10)}removeH264SupportFromSendSection(){let e=this.sdp,t=a.splitSections(e),i=a.findActiveCameraSection(t);if(-1===i)return new a(this.sdp);let n=t[i],r=a.splitLines(n),s=[],o=new Map;r.forEach(e=>{if(/^a=rtpmap:/.test(e)){let t=/^a=rtpmap:([0-9]+)\s/.exec(e);t&&e.toLowerCase().includes("h264")&&s.push(parseInt(t[1],10))}if(/^a=fmtp:/.test(e)){let t=/^a=fmtp:([0-9]+) apt=([0-9]+)/.exec(e);if(t&&3===t.length){let e=parseInt(t[1],10),i=parseInt(t[2],10);o.has(i)?o.get(i).push(e):o.set(i,[e])}}});let l=new Set;for(let e of s){l.add(e);let t=o.get(e);if(t)for(let e of t)l.add(e)}if(s.length>0){let e=r[0].split(" ");r[0]=e.filter(e=>!l.has(parseInt(e))).join(" ")}let d=r.filter(e=>{if(!e.includes("rtpmap")&&!e.includes("rtcp-fb")&&!e.includes("fmtp"))return!0;for(let t of l)if(e.includes(t.toString()))return!1;return!0});return t[i]=d.join(a.CRLF)+a.CRLF,new a(t.join(""))}mediaSections(){let e=a.splitSections(this.sdp);if(e.length<2)return[];let t=[];for(let i=1;i<e.length;i++){let n=new s.default;for(let t of a.splitLines(e[i])){let e=a.mediaType(t);if(void 0!==e){n.mediaType=e;continue}let i=a.direction(t);if(void 0!==i){n.direction=i;continue}let r=a.mid(t);if(void 0!==r){n.mid=r;continue}}t.push(n)}return t}static getRtpHeaderExtensionIdInSection(e,t){for(let i of a.splitLines(e))if(/^a=extmap:/.test(i.trim())){let e=i.split("a=extmap:")[1].split(" "),n=+e[0];if(e[1]===t)return n}return -1}getRtpHeaderExtensionId(e){for(let t of a.splitSections(this.sdp))if(/^m=video/.test(t)){let i=a.getRtpHeaderExtensionIdInSection(t,e);if(-1!==i)return i}return -1}hasRtpHeaderExtensionId(e){for(let t of a.splitLines(this.sdp))if(/^a=extmap:/.test(t.trim())&&+t.split("a=extmap:")[1].split(" ")[0]===e)return!0;return!1}withVideoSendCodecPreferences(e){let t=this.sdp,i=a.splitSections(t),n=a.findActiveCameraSection(i);return -1===n?new a(this.sdp):(i[n]=this.sectionWithCodecPreferences(i[n],e),new a(i.join("")))}sectionWithCodecPreferences(e,t){let i=new Map,n=a.splitLines(e);n.forEach(e=>{if(!e.startsWith("a=rtpmap:"))return;let r=/^a=rtpmap:(\d+)\s/.exec(e);if(!r)return;let s=r[1];for(let r of t){if(!e.includes(`${r.codecName}/${r.codecCapability.clockRate}`))continue;let t=!1;if(void 0!==r.codecCapability.sdpFmtpLine){let e=!1;for(let i of n){if(r.fmtpLineMatches(i,parseInt(s))){t=!0;break}e||(e=i.startsWith(`a=fmtp:${s} profile-id=`))}r.equals(o.default.vp9Profile0())&&!e&&(t=!0)}else t=!0;if(t){i.set(s,r);break}}});let r=new Set(i.keys()),s=n[0].split(" ").filter(e=>!r.has(e)),l=Array.from(i.entries()).sort(([e,i],[n,r])=>t.indexOf(i)-t.indexOf(r)).map(([e,t])=>e);return s.splice(3,0,...l),n[0]=s.join(" "),n.join(a.CRLF)+a.CRLF}highestPriorityVideoSendCodec(){let e=this.prioritizedSendVideoCodecCapabilities();return e.length>0?e[0]:void 0}prioritizedSendVideoCodecCapabilities(){let e=this.sdp,t=a.splitSections(e),i=a.findActiveCameraSection(t);if(-1===i)return[];let n=a.splitLines(t[i]),r=n[0].split(" ");return r.length<4?[]:r.slice(3).map(e=>this.videoCodecCapabilityForPayloadType(n,e)).filter(e=>void 0!==e&&["VP8","H264","VP9","AV1"].includes(e.codecName))}videoCodecCapabilityForPayloadType(e,t){let i,n,r;for(let s of e){let e=/^a=rtpmap:([0-9]+)\s/.exec(s);if(e&&e[1]===t){let e=s.split(" ")[1].split("/");e.length>=2&&(i=e[0],n=e[1])}s.startsWith(`a=fmtp:${t} `)&&(r=s.split(" ")[1])}if(void 0!==i)return new o.default(i,{clockRate:parseInt(n),mimeType:`video/${i}`,sdpFmtpLine:r})}getAudioPayloadTypes(){let e=new Map,t=this.sdp,i=a.splitSections(t);return e.set("opus",a.findAudioPayloadType("opus",i)),e.set("red",a.findAudioPayloadType("red",i)),e}static findAudioPayloadType(e,t){let i=RegExp(`a=rtpmap:\\s*(\\d+)\\s+${e}\\/48000`);for(let e of t)if(/^m=audio/.test(e)){let t=i.exec(e);if(null!==t)return Number(t[1])}return 0}withStartingVideoSendBitrate(e){let t=a.splitSections(this.sdp),i=a.findActiveCameraSection(t);if(-1===i)return this;let n=a.splitLines(t[i]),r=[];for(let t of n)if(/^a=fmtp:\d*/.test(t)){let i=t+`;x-google-start-bitrate=${1e3*e}`;r.push(i)}else r.push(t);return t[i]=r.join(a.CRLF)+a.CRLF,new a(t.join(""))}}t.default=a,a.CRLF="\r\n",a.rfc7587LowestBitrate=6e3,a.rfc7587HighestBitrate=51e4,a.dependencyDescriptorRtpHeaderExtensionUrl="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension",a.videoLayersAllocationRtpHeaderExtensionUrl="http://www.webrtc.org/experiments/rtp-hdrext/video-layers-allocation00"},27786:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.SDPCandidateType=void 0,function(e){e.Host="host",e.ServerReflexive="srflx",e.PeerReflexive="prflx",e.Relay="relay"}(i=t.SDPCandidateType||(t.SDPCandidateType={})),t.default=i},5039:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{}t.default=i},81342:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=i(39163);class r{constructor(e,t){this.codecName=e,this.codecCapability=t}equals(e){return void 0!==e&&this.codecName===e.codecName&&this.codecCapability.mimeType===e.codecCapability.mimeType&&this.codecCapability.clockRate===e.codecCapability.clockRate&&this.codecCapability.sdpFmtpLine===e.codecCapability.sdpFmtpLine}fmtpLineMatches(e,t){let i=this.codecCapability.sdpFmtpLine;if(!i)return!1;if("H264"===this.codecName){let n=/profile-level-id=([0-9a-f]{4})[0-9a-f]{2}/i,r=i.replace(n,"profile-level-id=$1");return e.replace(n,"profile-level-id=$1").startsWith(`a=fmtp:${t} ${r}`)}return e.startsWith(`a=fmtp:${t} ${i}`)}static vp8(){return new r("VP8",{clockRate:9e4,mimeType:"video/VP8"})}static h264BaselineProfile(){return new r("H264",{clockRate:9e4,mimeType:"video/H264",sdpFmtpLine:"level-asymmetry-allowed=1;packetization-mode=1;profile-level-id=42001f"})}static h264ConstrainedBaselineProfile(){return new r("H264",{clockRate:9e4,mimeType:"video/H264",sdpFmtpLine:"level-asymmetry-allowed=1;packetization-mode=1;profile-level-id=42e01f"})}static h264MainProfile(){return new r("H264",{clockRate:9e4,mimeType:"video/H264",sdpFmtpLine:"level-asymmetry-allowed=1;packetization-mode=1;profile-level-id=4d001f"})}static h264HighProfile(){return new r("H264",{clockRate:9e4,mimeType:"video/H264",sdpFmtpLine:"level-asymmetry-allowed=1;packetization-mode=1;profile-level-id=64001f"})}static h264ConstrainedHighProfile(){return new r("H264",{clockRate:9e4,mimeType:"video/H264",sdpFmtpLine:"level-asymmetry-allowed=1;packetization-mode=1;profile-level-id=640c1f"})}static h264(){return r.h264ConstrainedBaselineProfile()}static vp9Profile0(){return new r("VP9",{clockRate:9e4,mimeType:"video/VP9",sdpFmtpLine:"profile-id=0"})}static vp9(){return r.vp9Profile0()}static av1Main(){return new r("AV1",{clockRate:9e4,mimeType:"video/AV1"})}static av1(){return r.av1Main()}static fromSignaled(e){switch(e){case n.SdkVideoCodecCapability.VP8:return r.vp8();case n.SdkVideoCodecCapability.H264_BASELINE_PROFILE:return r.h264BaselineProfile();case n.SdkVideoCodecCapability.H264_CONSTRAINED_BASELINE_PROFILE:return r.h264ConstrainedBaselineProfile();case n.SdkVideoCodecCapability.H264_MAIN_PROFILE:return r.h264MainProfile();case n.SdkVideoCodecCapability.H264_HIGH_PROFILE:return r.h264HighProfile();case n.SdkVideoCodecCapability.H264_CONSTRAINED_HIGH_PROFILE:return r.h264ConstrainedHighProfile();case n.SdkVideoCodecCapability.VP9_PROFILE_0:return r.vp9Profile0();case n.SdkVideoCodecCapability.AV1_MAIN_PROFILE:return r.av1Main();default:return}}}t.default=r},48693:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=i(25090);class r{constructor(e){this.logger=e}compress(e,t){if(t.length>0){let e=Math.min(t.length,r.MAX_DICTIONARY_SIZE);t=t.slice(0,e)}let i={memLevel:r.Z_MEM_LEVEL,dictionary:t};return n.deflateRaw(e,i)}decompress(e,t){if(t.length>0){let e=Math.min(t.length,r.MAX_DICTIONARY_SIZE);t=t.slice(0,e)}let i={to:"string",dictionary:t,chunkSize:4096},s="";try{s=n.inflateRaw(e,i)}catch(e){this.logger.error(`failed to decompress the string with error: [${e}]`)}return s}}t.default=r,r.Z_MEM_LEVEL=9,r.MAX_DICTIONARY_SIZE=31744},99521:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=i(1265),r=i(60858),s=i(97618),o=i(75745);class a{constructor(e){this.logger=e,this.currentState=s.SessionStateControllerState.NotConnected,this.deferredAction=null,this.deferredWork=null}perform(e,t){let i=this.currentState;if(i===s.SessionStateControllerState.NotConnected&&e===n.SessionStateControllerAction.Connect)this.transition(s.SessionStateControllerState.Connecting,e);else if(i===s.SessionStateControllerState.Connecting&&e===n.SessionStateControllerAction.Fail)this.transition(s.SessionStateControllerState.Disconnecting,e);else if(i===s.SessionStateControllerState.Connecting&&e===n.SessionStateControllerAction.FinishConnecting)this.transition(s.SessionStateControllerState.Connected,e);else if(i===s.SessionStateControllerState.Connected&&e===n.SessionStateControllerAction.Disconnect)this.transition(s.SessionStateControllerState.Disconnecting,e);else if(i===s.SessionStateControllerState.Connected&&e===n.SessionStateControllerAction.Reconnect)this.transition(s.SessionStateControllerState.Connecting,e);else if(i===s.SessionStateControllerState.Connected&&e===n.SessionStateControllerAction.Fail)this.transition(s.SessionStateControllerState.Disconnecting,e);else if(i===s.SessionStateControllerState.Connected&&e===n.SessionStateControllerAction.Update)this.transition(s.SessionStateControllerState.Updating,e);else if(i===s.SessionStateControllerState.Updating&&e===n.SessionStateControllerAction.Fail)this.transition(s.SessionStateControllerState.Disconnecting,e);else if(i===s.SessionStateControllerState.Updating&&e===n.SessionStateControllerAction.FinishUpdating)this.transition(s.SessionStateControllerState.Connected,e);else if(i===s.SessionStateControllerState.Disconnecting&&e===n.SessionStateControllerAction.FinishDisconnecting)this.transition(s.SessionStateControllerState.NotConnected,e);else if(this.canDefer(e))return this.logger.info(`deferring transition from ${s.SessionStateControllerState[this.currentState]} with ${n.SessionStateControllerAction[e]}`),this.deferAction(e,t),o.SessionStateControllerTransitionResult.DeferredTransition;else return this.logger.warn(`no transition found from ${s.SessionStateControllerState[this.currentState]} with ${n.SessionStateControllerAction[e]}`),o.SessionStateControllerTransitionResult.NoTransitionAvailable;try{t()}catch(t){return this.logger.error(`error during state ${s.SessionStateControllerState[this.currentState]} with action ${n.SessionStateControllerAction[e]}: ${t}`),this.logger.info(`rolling back transition to ${s.SessionStateControllerState[i]}`),this.currentState=i,o.SessionStateControllerTransitionResult.TransitionFailed}return this.performDeferredAction(),o.SessionStateControllerTransitionResult.Transitioned}state(){return this.currentState}transition(e,t){this.logger.info(`transitioning from ${s.SessionStateControllerState[this.currentState]} to ${s.SessionStateControllerState[e]} with ${n.SessionStateControllerAction[t]}`),this.currentState=e}deferPriority(e){switch(e){case n.SessionStateControllerAction.Disconnect:return r.SessionStateControllerDeferPriority.VeryHigh;case n.SessionStateControllerAction.Fail:return r.SessionStateControllerDeferPriority.High;case n.SessionStateControllerAction.Reconnect:return r.SessionStateControllerDeferPriority.Medium;case n.SessionStateControllerAction.Update:return r.SessionStateControllerDeferPriority.Low;default:return r.SessionStateControllerDeferPriority.DoNotDefer}}deferAction(e,t){null!==this.deferredAction&&this.deferPriority(this.deferredAction)>this.deferPriority(e)||(this.deferredAction=e,this.deferredWork=t)}canDefer(e){return this.deferPriority(e)!==r.SessionStateControllerDeferPriority.DoNotDefer&&(this.currentState===s.SessionStateControllerState.Connecting||this.currentState===s.SessionStateControllerState.Updating)}performDeferredAction(){if(!this.deferredAction)return;let e=this.deferredAction,t=this.deferredWork;this.deferredAction=null,this.deferredWork=null,this.logger.info(`performing deferred action ${n.SessionStateControllerAction[e]}`),this.perform(e,t)!==o.SessionStateControllerTransitionResult.Transitioned&&this.logger.info(`unable to perform deferred action ${n.SessionStateControllerAction[e]} in state ${s.SessionStateControllerState[this.currentState]}`)}}t.default=a},1265:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.SessionStateControllerAction=void 0,function(e){e[e.Connect=0]="Connect",e[e.FinishConnecting=1]="FinishConnecting",e[e.Update=2]="Update",e[e.FinishUpdating=3]="FinishUpdating",e[e.Reconnect=4]="Reconnect",e[e.Disconnect=5]="Disconnect",e[e.Fail=6]="Fail",e[e.FinishDisconnecting=7]="FinishDisconnecting"}(i=t.SessionStateControllerAction||(t.SessionStateControllerAction={})),t.default=i},60858:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.SessionStateControllerDeferPriority=void 0,function(e){e[e.DoNotDefer=0]="DoNotDefer",e[e.Low=1]="Low",e[e.Medium=2]="Medium",e[e.High=3]="High",e[e.VeryHigh=4]="VeryHigh"}(i=t.SessionStateControllerDeferPriority||(t.SessionStateControllerDeferPriority={})),t.default=i},97618:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.SessionStateControllerState=void 0,function(e){e[e.NotConnected=0]="NotConnected",e[e.Connecting=1]="Connecting",e[e.Connected=2]="Connected",e[e.Updating=3]="Updating",e[e.Disconnecting=4]="Disconnecting"}(i=t.SessionStateControllerState||(t.SessionStateControllerState={})),t.default=i},75745:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.SessionStateControllerTransitionResult=void 0,function(e){e[e.Transitioned=0]="Transitioned",e[e.NoTransitionAvailable=1]="NoTransitionAvailable",e[e.DeferredTransition=2]="DeferredTransition",e[e.TransitionFailed=3]="TransitionFailed"}(i=t.SessionStateControllerTransitionResult||(t.SessionStateControllerTransitionResult={})),t.default=i},94839:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let r=n(i(81341)),s=n(i(44307)),o=i(39163),a=i(17201),l=n(i(29505)),d=n(i(67473)),u=n(i(99983)),c=i(45377),h=n(i(35316)),f=n(i(62811));class p{constructor(e,t){this.webSocket=e,this.logger=t,this.unloadHandler=null,this.closeEventHandler=e=>{this.deactivatePageUnloadHandler(),this.resetConnection(),this.sendEvent(new h.default(this,f.default.WebSocketClosed,null,e.code,e.reason)),this.serviceConnectionRequestQueue()},this.observerQueue=new Set,this.connectionRequestQueue=[],this.resetConnection(),this.logger.debug(()=>"signaling client init"),this.audioSessionId=this.generateNewAudioSessionId()}registerObserver(e){this.logger.debug(()=>"registering signaling client observer"),this.observerQueue.add(e)}removeObserver(e){this.logger.debug(()=>"removing signaling client observer"),this.observerQueue.delete(e)}openConnection(e){this.logger.info("adding connection request to queue: "+e.url()),this.connectionRequestQueue.push(e),this.closeConnection()}pingPong(e){this.logger.debug(()=>"sending ping");let t=o.SdkSignalFrame.create();return t.type=o.SdkSignalFrame.Type.PING_PONG,t.pingPong=e,this.sendMessage(t),t.timestampMs}join(e){this.logger.info("sending join");let t=o.SdkJoinFrame.create();t.protocolVersion=2,t.flags=o.SdkJoinFlags.HAS_STREAM_UPDATE;let i=new r.default,n={platformName:i.name(),platformVersion:i.version(),clientSource:l.default.sdkName,chimeSdkVersion:l.default.sdkVersion,clientUtcOffset:a.getFormattedOffset(new Date().getTimezoneOffset())};if(e.applicationMetadata){let{appName:t,appVersion:i}=e.applicationMetadata;n.appName=t,n.appVersion=i}t.clientDetails=o.SdkClientDetails.create(n),t.audioSessionId=this.audioSessionId,t.wantsCompressedSdp=p.CLIENT_SUPPORTS_COMPRESSION,t.disablePeriodicKeyframeRequestOnContentSender=e.disablePeriodicKeyframeRequestOnContentSender,t.serverSideNetworkAdaption=c.convertServerSideNetworkAdaptionEnumToSignaled(e.serverSideNetworkAdaption),t.supportedServerSideNetworkAdaptions=e.supportedServerSideNetworkAdaptions.map(c.convertServerSideNetworkAdaptionEnumToSignaled),t.wantsAllTemporalLayersInIndex=e.wantsAllTemporalLayersInIndex;let s=o.SdkSignalFrame.create();s.type=o.SdkSignalFrame.Type.JOIN,s.join=t,this.sendMessage(s)}subscribe(e){let t=o.SdkSubscribeFrame.create();if(t.sendStreams=[],t.sdpOffer=e.sdpOffer,e.connectionTypeHasVideo&&(t.receiveStreamIds=e.receiveStreamIds),e.audioHost&&(t.audioCheckin=e.audioCheckin,t.audioHost=e.audioHost,t.audioMuted=e.audioMuted,!e.audioCheckin)){let i=o.SdkStreamDescriptor.create();i.mediaType=o.SdkStreamMediaType.AUDIO,i.trackLabel="AmazonChimeExpressAudio",i.attendeeId=e.attendeeId,i.streamId=1,i.groupId=1,i.framerate=15,i.maxBitrateKbps=600,i.avgBitrateBps=4e5,t.sendStreams.push(i)}if(t.compressedSdpOffer=e.compressedSdpOffer,t.duplex=o.SdkStreamServiceType.RX,e.localVideoEnabled){t.duplex=o.SdkStreamServiceType.DUPLEX;for(let i=0;i<e.videoStreamDescriptions.length;i++){let n=e.videoStreamDescriptions[i].clone();n.attendeeId=e.attendeeId,t.sendStreams.push(n.toStreamDescriptor())}}e.videoSubscriptionConfiguration.length>0&&(t.videoSubscriptionConfiguration=e.videoSubscriptionConfiguration.map(this.convertSignalingClientVideoSubscriptionConfiguration));let i=o.SdkSignalFrame.create();i.type=o.SdkSignalFrame.Type.SUBSCRIBE,i.sub=t,this.sendMessage(i)}remoteVideoUpdate(e,t){let i=o.SdkRemoteVideoUpdateFrame.create();i.addedOrUpdatedVideoSubscriptions=e.map(this.convertSignalingClientVideoSubscriptionConfiguration),i.removedVideoSubscriptionMids=t;let n=o.SdkSignalFrame.create();n.type=o.SdkSignalFrame.Type.REMOTE_VIDEO_UPDATE,n.remoteVideoUpdate=i,this.sendMessage(n)}convertSignalingClientVideoSubscriptionConfiguration(e){let t=new o.SdkVideoSubscriptionConfiguration;switch(t.mid=e.mid,t.attendeeId=e.attendeeId,t.streamId=e.streamId,t.groupId=e.groupId,t.priority=e.priority,t.targetBitrateKbps=e.targetBitrateKbps,e.qualityAdaptationPreference){case d.default.Balanced:t.qualityAdaptationPreference=o.SdkVideoQualityAdaptationPreference.BALANCED;break;case d.default.MaintainFramerate:t.qualityAdaptationPreference=o.SdkVideoQualityAdaptationPreference.MAINTAIN_FRAMERATE;break;case d.default.MaintainResolution:t.qualityAdaptationPreference=o.SdkVideoQualityAdaptationPreference.MAINTAIN_RESOLUTION;break;default:t.qualityAdaptationPreference=o.SdkVideoQualityAdaptationPreference.BALANCED}return t}leave(){let e=o.SdkSignalFrame.create();e.type=o.SdkSignalFrame.Type.LEAVE,e.leave=o.SdkLeaveFrame.create(),this.sendMessage(e),this.logger.debug(()=>"sent leave")}sendClientMetrics(e){let t=o.SdkSignalFrame.create();t.type=o.SdkSignalFrame.Type.CLIENT_METRIC,t.clientMetric=e,this.sendMessage(t)}sendDataMessage(e){let t=o.SdkSignalFrame.create();t.type=o.SdkSignalFrame.Type.DATA_MESSAGE,t.dataMessage=e,this.sendMessage(t)}closeConnection(){var e,t;if(this.webSocket.readyState()!==u.default.None&&this.webSocket.readyState()!==u.default.Closed){this.isClosing=!0,this.sendEvent(new h.default(this,f.default.WebSocketClosing,null));let i=new s.default(p.CLOSE_EVENT_TIMEOUT_MS),n=e=>{var t,r;null===(r=(t=this.webSocket).removeEventListener)||void 0===r||r.call(t,"close",n),i.stop(),this.closeEventHandler(e)};null===(t=(e=this.webSocket).removeEventListener)||void 0===t||t.call(e,"close",this.closeEventHandler),this.webSocket.addEventListener("close",n),i.start(()=>{n(new CloseEvent("close",{wasClean:!1,code:1006,reason:"",bubbles:!1}))}),this.webSocket.close(),this.deactivatePageUnloadHandler()}else this.logger.info("no existing signaling client connection needs closing"),this.serviceConnectionRequestQueue()}ready(){return this.webSocket.readyState()===u.default.Open&&!this.isClosing&&this.wasOpened}mute(e){let t=o.SdkSignalFrame.create();t.type=o.SdkSignalFrame.Type.AUDIO_CONTROL;let i=o.SdkAudioControlFrame.create();i.muted=e,t.audioControl=i,this.sendMessage(t)}pause(e){let t=o.SdkSignalFrame.create();t.type=o.SdkSignalFrame.Type.PAUSE,t.pause=o.SdkPauseResumeFrame.create(),t.pause.streamIds=e,this.sendMessage(t)}resume(e){let t=o.SdkSignalFrame.create();t.type=o.SdkSignalFrame.Type.RESUME,t.pause=o.SdkPauseResumeFrame.create(),t.pause.streamIds=e,this.sendMessage(t)}resetConnection(){this.webSocket.destroy(),this.wasOpened=!1}sendMessage(e){e.timestampMs=Date.now(),this.logger.debug(()=>`sending: ${JSON.stringify(e)}`);let t=this.prependWithFrameTypeRTC(o.SdkSignalFrame.encode(e).finish());if(this.ready()){if(!this.webSocket.send(t)){this.sendEvent(new h.default(this,f.default.WebSocketSendMessageFailure,null));return}this.sendEvent(new h.default(this,f.default.WebSocketSentMessage,null))}else this.sendEvent(new h.default(this,f.default.WebSocketSkippedMessage,null))}receiveMessage(e){let t;try{t=o.SdkSignalFrame.decode(e)}catch(t){this.logger.info(`failed to decode: ${e}`),this.sendEvent(new h.default(this,f.default.ProtocolDecodeFailure,null));return}this.logger.debug(()=>`received: ${JSON.stringify(t)}`),this.webSocket.readyState()===u.default.Open?this.sendEvent(new h.default(this,f.default.ReceivedSignalFrame,t)):this.logger.info(`skipping notification of message since WebSocket is not open: ${JSON.stringify(t)}`)}stripFrameTypeRTC(e){let t=e[0];return t!==p.FRAME_TYPE_RTC&&2!==t&&this.logger.warn(`expected FrameTypeRTC for message but got ${t}`),e.slice(1)}prependWithFrameTypeRTC(e){let t=new Uint8Array(e.length+1);return t[0]=p.FRAME_TYPE_RTC,t.set(e,1),t}serviceConnectionRequestQueue(){if(0===this.connectionRequestQueue.length){this.logger.info("no connection requests to service");return}let e=this.connectionRequestQueue.shift();this.logger.info(`opening connection to ${e.url()}`),this.isClosing=!1,this.webSocket.create(e.url(),e.protocols()),this.setUpEventListeners(),this.sendEvent(new h.default(this,f.default.WebSocketConnecting,null))}sendEvent(e){switch(e.type){case f.default.WebSocketMessage:case f.default.ReceivedSignalFrame:case f.default.WebSocketSentMessage:this.logger.debug(()=>`notifying event: ${f.default[e.type]}`);break;case f.default.WebSocketSkippedMessage:this.logger.debug(()=>`notifying event: ${f.default[e.type]}, websocket state=${u.default[this.webSocket.readyState()]}`);break;default:this.logger.info(`notifying event: ${f.default[e.type]}`)}for(let t of this.observerQueue)t.handleSignalingClientEvent(e)}setUpEventListeners(){this.webSocket.addEventListener("open",()=>{this.activatePageUnloadHandler(),this.wasOpened=!0,this.sendEvent(new h.default(this,f.default.WebSocketOpen,null))}),this.webSocket.addEventListener("message",e=>{this.sendEvent(new h.default(this,f.default.WebSocketMessage,null)),this.receiveMessage(this.stripFrameTypeRTC(new Uint8Array(e.data)))}),this.webSocket.addEventListener("close",this.closeEventHandler),this.webSocket.addEventListener("error",()=>{if(this.isClosing&&!this.wasOpened){this.logger.info("ignoring error closing signaling while connecting");return}this.wasOpened?(this.logger.error("received error while connected"),this.sendEvent(new h.default(this,f.default.WebSocketError,null))):(this.logger.error("failed to connect"),this.sendEvent(new h.default(this,f.default.WebSocketFailed,null)))})}activatePageUnloadHandler(){this.unloadHandler=()=>{this.leave()};let e=i.g;e.window&&e.window.addEventListener&&window.addEventListener("unload",this.unloadHandler)}deactivatePageUnloadHandler(){let e=i.g;e.window&&e.window.removeEventListener&&window.removeEventListener("unload",this.unloadHandler),this.unloadHandler=null}generateNewAudioSessionId(){let e=new Uint32Array(1);return a.getRandomValues(e),e[0]}promoteToPrimaryMeeting(e){let t=o.SdkMeetingSessionCredentials.create();t.attendeeId=e.attendeeId,t.externalUserId=e.externalUserId,t.joinToken=e.joinToken;let i=o.SdkPrimaryMeetingJoinFrame.create();i.credentials=t;let n=o.SdkSignalFrame.create();n.type=o.SdkSignalFrame.Type.PRIMARY_MEETING_JOIN,n.primaryMeetingJoin=i,this.sendMessage(n)}demoteFromPrimaryMeeting(){let e=o.SdkPrimaryMeetingLeaveFrame.create(),t=o.SdkSignalFrame.create();t.type=o.SdkSignalFrame.Type.PRIMARY_MEETING_LEAVE,t.primaryMeetingLeave=e,this.sendMessage(t)}}t.default=p,p.FRAME_TYPE_RTC=5,p.CLOSE_EVENT_TIMEOUT_MS=2e3,p.CLIENT_SUPPORTS_COMPRESSION=!0},45377:function(e,t,i){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.convertServerSideNetworkAdaptionEnumToSignaled=t.convertServerSideNetworkAdaptionEnumFromSignaled=t.serverSideNetworkAdaptionIsNoneOrDefault=t.ServerSideNetworkAdaption=void 0;let r=i(39163);function s(e){return e===n.None||e===n.Default}function o(e){switch(e){case r.SdkServerSideNetworkAdaption.DEFAULT:return n.Default;case r.SdkServerSideNetworkAdaption.NONE:return n.None;case r.SdkServerSideNetworkAdaption.BANDWIDTH_PROBING:return n.BandwidthProbing;case r.SdkServerSideNetworkAdaption.BANDWIDTH_PROBING_AND_VIDEO_QUALITY_ADAPTION:return n.BandwidthProbingAndRemoteVideoQualityAdaption}}function a(e){switch(e){case n.Default:return r.SdkServerSideNetworkAdaption.DEFAULT;case n.None:return r.SdkServerSideNetworkAdaption.NONE;case n.BandwidthProbing:return r.SdkServerSideNetworkAdaption.BANDWIDTH_PROBING;case n.BandwidthProbingAndRemoteVideoQualityAdaption:return r.SdkServerSideNetworkAdaption.BANDWIDTH_PROBING_AND_VIDEO_QUALITY_ADAPTION}}!function(e){e[e.Default=0]="Default",e[e.None=1]="None",e[e.BandwidthProbing=2]="BandwidthProbing",e[e.BandwidthProbingAndRemoteVideoQualityAdaption=3]="BandwidthProbingAndRemoteVideoQualityAdaption"}(n=t.ServerSideNetworkAdaption||(t.ServerSideNetworkAdaption={})),t.default=n,t.serverSideNetworkAdaptionIsNoneOrDefault=s,t.convertServerSideNetworkAdaptionEnumFromSignaled=o,t.convertServerSideNetworkAdaptionEnumToSignaled=a},67406:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(e,t){this.signalingURL=e,this.joinToken=t}url(){return this.signalingURL+"?X-Chime-Control-Protocol-Version=3&X-Amzn-Chime-Send-Close-On-Error=1"}protocols(){return["_aws_wt_session",this.joinToken]}}t.default=i},35316:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let r=n(i(62811));class s{constructor(e,t,i,n,r){this.client=e,this.type=t,this.message=i,this.closeCode=n,this.closeReason=r,this.timestampMs=Date.now()}isConnectionTerminated(){switch(this.type){case r.default.WebSocketFailed:case r.default.WebSocketError:case r.default.WebSocketClosing:case r.default.WebSocketClosed:return!0;default:return!1}}}t.default=s},62811:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.SignalingClientEventType=void 0,function(e){e[e.WebSocketConnecting=0]="WebSocketConnecting",e[e.WebSocketOpen=1]="WebSocketOpen",e[e.WebSocketError=2]="WebSocketError",e[e.WebSocketClosing=3]="WebSocketClosing",e[e.WebSocketClosed=4]="WebSocketClosed",e[e.WebSocketFailed=5]="WebSocketFailed",e[e.WebSocketMessage=6]="WebSocketMessage",e[e.WebSocketSendMessageFailure=7]="WebSocketSendMessageFailure",e[e.WebSocketSentMessage=8]="WebSocketSentMessage",e[e.ProtocolDecodeFailure=9]="ProtocolDecodeFailure",e[e.ReceivedSignalFrame=10]="ReceivedSignalFrame",e[e.WebSocketSkippedMessage=11]="WebSocketSkippedMessage"}(i=t.SignalingClientEventType||(t.SignalingClientEventType={})),t.default=i},92852:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let r=n(i(45377));class s{constructor(e){this.applicationMetadata=e,this.serverSideNetworkAdaption=r.default.Default,this.supportedServerSideNetworkAdaptions=[],this.wantsAllTemporalLayersInIndex=!1,this.disablePeriodicKeyframeRequestOnContentSender=!1}}t.default=s},12634:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(e,t,i,n,r,s,o,a,l,d){this.attendeeId=e,this.sdpOffer=t,this.audioHost=i,this.audioMuted=n,this.audioCheckin=r,this.receiveStreamIds=s,this.localVideoEnabled=o,this.videoStreamDescriptions=a,this.connectionTypeHasVideo=l,this.compressedSdpOffer=d,this.videoSubscriptionConfiguration=[]}}t.default=i},75749:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{equals(e){return void 0!==e&&this.mid===e.mid&&this.attendeeId===e.attendeeId&&this.streamId===e.streamId&&this.groupId===e.groupId&&this.priority===e.priority&&this.targetBitrateKbps===e.targetBitrateKbps&&this.qualityAdaptationPreference===e.qualityAdaptationPreference}}t.default=i},22533:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=i(99131),o=i(61430),a=r(i(29505));class l{constructor(e){this.chimeClient=e}makeTwoDigits(e){return e>9?e.toString():"0"+e.toString()}hmac(e,t){let i=new s.Sha256(t);return i.update(e),i.digest()}getDateTimeString(){let e=new Date;return e.getUTCFullYear()+this.makeTwoDigits(e.getUTCMonth()+1)+this.makeTwoDigits(e.getUTCDate())+"T"+this.makeTwoDigits(e.getUTCHours())+this.makeTwoDigits(e.getUTCMinutes())+this.makeTwoDigits(e.getUTCSeconds())+"Z"}getDateString(e){return e.substring(0,e.indexOf("T"))}getSignatureKey(e,t,i,r){return n(this,void 0,void 0,function*(){let n=yield this.hmac(t,"AWS4"+e),s=yield this.hmac(i,n),o=yield this.hmac(r,s);return yield this.hmac("aws4_request",o)})}signURL(e,t,i,r,s,l,d){return n(this,void 0,void 0,function*(){let n;let u=this.getDateTimeString(),c=this.getDateString(u),h="AWS4-HMAC-SHA256",f="";f=this.chimeClient.config.region instanceof Function?yield this.chimeClient.config.region():this.chimeClient.config.region;let p="host",m="host:"+r.toLowerCase()+"\n",g=c+"/"+f+"/"+i+"/aws4_request";n=this.chimeClient.config.credentials instanceof Function?yield this.chimeClient.config.credentials():this.chimeClient.config.credentials;let v=new Map;v.set("X-Amz-Algorithm",[h]),v.set("X-Amz-Credential",[encodeURIComponent(n.accessKeyId+"/"+g)]),v.set("X-Amz-Date",[u]),v.set("X-Amz-Expires",["10"]),v.set("X-Amz-SignedHeaders",["host"]),n.sessionToken&&v.set("X-Amz-Security-Token",[encodeURIComponent(n.sessionToken)]),v.set(a.default.X_AMZN_VERSION,[encodeURIComponent(a.default.sdkVersion)]),v.set(a.default.X_AMZN_USER_AGENT,[encodeURIComponent(a.default.sdkUserAgentLowResolution)]),null==d||d.forEach((e,t)=>{let i=encodeURIComponent(t);e.sort().forEach(e=>{v.has(i)||v.set(i,[]),v.get(i).push(encodeURIComponent(e))})});let b="";(v=new Map([...v.entries()].sort())).forEach((e,t)=>{e.forEach(e=>{b.length&&(b+="&"),b+=t+"="+e})});let S=e+"\n"+s+"\n"+b+"\n"+m+"\n"+p+"\n"+o.toHex((yield this.hmac(l))),y="AWS4-HMAC-SHA256\n"+u+"\n"+c+"/"+f+"/"+i+"/aws4_request\n"+o.toHex((yield this.hmac(S))),w=yield this.getSignatureKey(n.secretAccessKey,c,f,i),C=o.toHex((yield this.hmac(y,w)));return t+"://"+r+s+"?"+b+"&X-Amz-Signature="+C})}}t.default=l},73920:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.SimulcastLayers=void 0,function(e){e[e.Low=0]="Low",e[e.LowAndMedium=1]="LowAndMedium",e[e.LowAndHigh=2]="LowAndHigh",e[e.Medium=3]="Medium",e[e.MediumAndHigh=4]="MediumAndHigh",e[e.High=5]="High"}(i=t.SimulcastLayers||(t.SimulcastLayers={})),t.default=i},35102:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.AudioLogEvent=void 0,function(e){e[e.DeviceChanged=0]="DeviceChanged",e[e.MutedLocal=1]="MutedLocal",e[e.UnmutedLocal=2]="UnmutedLocal",e[e.Connected=3]="Connected",e[e.ConnectFailed=4]="ConnectFailed",e[e.RedmicStartLoss=5]="RedmicStartLoss",e[e.RedmicEndLoss=6]="RedmicEndLoss"}(i=t.AudioLogEvent||(t.AudioLogEvent={})),t.default=i},36851:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=r(i(28439)),o=r(i(89496)),a=r(i(57192)),l=r(i(54281)),d=r(i(43366)),u=r(i(27645)),c=r(i(10441)),h=r(i(81211)),f=i(39163),p=i(71906),m=r(i(35102)),g=r(i(87879));class v{constructor(e,t,i=v.INTERVAL_MS){this.audioVideoController=e,this.logger=t,this.interval=i,this.intervalScheduler=null,this.redRecoveryMetricReport=new l.default,this.lastRedRecoveryMetricReportConsumedTimestampMs=0,this.metricsAddTime=(e,t,i)=>{},this.metricsLogEvent=(e,t)=>{}}toAttribute(e){return this.toSuffix(e).substring(1)}toSuffix(e){return e.toLowerCase()===e?`_${e}`:e.toUpperCase()===e?`_${e.toLowerCase()}`:e.replace(/([A-Z][a-z]+)/g,function(e){return`_${e}`}).replace(/([A-Z][A-Z]+)/g,function(e){return`_${e}`}).toLowerCase()}logLatency(e,t,i){let n=this.toSuffix(e);this.logEventTime("meeting"+n,t,i)}logStateTimeout(e,t){let i=this.toSuffix(e);this.logEvent("meeting_session_state_timeout",Object.assign(Object.assign({},t),{state:`state${i}`}))}logAudioEvent(e,t){let i="audio"+this.toSuffix(m.default[e]);this.logEvent(i,t)}logVideoEvent(e,t){let i="video"+this.toSuffix(g.default[e]);this.logEvent(i,t)}logEventTime(e,t,i={}){let n=Object.assign(Object.assign({},i),{call_id:this.audioVideoController.configuration.meetingId,client_type:v.CLIENT_TYPE,metric_type:"latency"});this.logger.debug(()=>`[StatsCollector] ${e}: ${JSON.stringify(n)}`),this.metricsAddTime(e,t,n)}logMeetingSessionStatus(e){let t=`${e.statusCode()}`;this.logEvent(t);let i={status:t,status_code:`${e.statusCode()}`};this.logEvent("meeting_session_status",i),e.isTerminal()&&this.logEvent("meeting_session_stopped",i),e.isAudioConnectionFailure()&&this.logEvent("meeting_session_audio_failed",i),e.isFailure()&&this.logEvent("meeting_session_failed",i)}logLifecycleEvent(e,t){let i={lifecycle_event:`lifecycle${this.toSuffix(u.default[e])}`,lifecycle_event_code:`${e}`,lifecycle_event_condition:`condition${this.toSuffix(c.default[t])}`,lifecycle_event_condition_code:`${t}`};this.logEvent("meeting_session_lifecycle",i)}logEvent(e,t={}){let i=Object.assign(Object.assign({},t),{call_id:this.audioVideoController.configuration.meetingId,client_type:v.CLIENT_TYPE});this.logger.debug(()=>`[StatsCollector] ${e}: ${JSON.stringify(i)}`),this.metricsLogEvent(e,i)}start(e,t){return!this.intervalScheduler&&(this.logger.info("Starting StatsCollector"),this.signalingClient=e,this.videoStreamIndex=t,this.clientMetricReport=new s.default(this.logger,this.videoStreamIndex,this.audioVideoController.configuration.credentials.attendeeId),this.intervalScheduler=new h.default(this.interval),this.intervalScheduler.start(()=>n(this,void 0,void 0,function*(){yield this.getStatsWrapper()})),!0)}stop(){this.logger.info("Stopping StatsCollector"),this.intervalScheduler&&this.intervalScheduler.stop(),this.intervalScheduler=null}updateMetricValues(e,t){let i;let n=t?this.clientMetricReport.streamMetricReports[Number(e.ssrc)]:this.clientMetricReport.globalMetricReport;for(let r in i=t?this.clientMetricReport.getMetricMap(n.mediaType,n.direction):this.clientMetricReport.getMetricMap(),e)r in i&&("number"==typeof e[r]?(n.previousMetrics[r]=n.currentMetrics[r],n.currentMetrics[r]=e[r]):"string"==typeof e[r]?n.currentStringMetrics[r]=e[r]:"object"==typeof e[r]?(n.previousObjectMetrics[r]=void 0===n.currentObjectMetrics[r]?e[r]:n.currentObjectMetrics[r],n.currentObjectMetrics[r]=e[r]):this.logger.error(`Unknown metric value type ${typeof e[r]} for metric ${r}`))}processRawMetricReports(e){this.clientMetricReport.currentSsrcs={};let t=Date.now();for(let t of e){let e=this.isStreamRawMetricReport(t.type);if(e){let e=this.clientMetricReport.streamMetricReports[Number(t.ssrc)];if(e)e.mediaType===a.default.VIDEO&&e.direction===o.default.UPSTREAM?e.streamId=this.videoStreamIndex.sendVideoStreamIdFromRid(t.rid):e.streamId=this.videoStreamIndex.streamIdForSSRC(Number(t.ssrc));else{let e=new d.default;e.mediaType=this.getMediaType(t),e.direction=this.getDirectionType(t),e.mediaType===a.default.VIDEO&&e.direction===o.default.UPSTREAM?e.streamId=this.videoStreamIndex.sendVideoStreamIdFromRid(t.rid):this.videoStreamIndex.allStreams().empty()||(e.streamId=this.videoStreamIndex.streamIdForSSRC(Number(t.ssrc)),void 0!==this.videoStreamIndex.groupIdForSSRC&&(e.groupId=this.videoStreamIndex.groupIdForSSRC(Number(t.ssrc)))),this.clientMetricReport.streamMetricReports[Number(t.ssrc)]=e}this.clientMetricReport.currentSsrcs[Number(t.ssrc)]=1}this.updateMetricValues(t,e)}this.clientMetricReport.removeDestroyedSsrcs(),this.clientMetricReport.previousTimestampMs=this.clientMetricReport.currentTimestampMs,this.clientMetricReport.currentTimestampMs=t,this.clientMetricReport.print()}addStreamMetricDimensionFrames(e,t){let i=this.clientMetricReport.getStreamDimensionMap();for(let n in t.currentStringMetrics)if(n in i){let r=f.SdkStreamDimension.create();r.type=i[n];let s=f.SdkDimensionValue.create();s.stringValue=t.currentStringMetrics[n],r.value=s,e.dimensions.push(r)}}addMetricFrame(e,t,i,n){let r=i.type,s=i.transform,o=i.source,a=t.streamMetricFrames.length,l=t.streamMetricFrames[a-1];if(r){let i=f.SdkMetric.create();i.type=r,i.value=s(o||e,n),n?l.metrics.push(i):t.globalMetrics.push(i)}}addGlobalMetricsToProtobuf(e){let t=this.clientMetricReport.getMetricMap();for(let i in this.clientMetricReport.globalMetricReport.currentMetrics)this.addMetricFrame(i,e,t[i])}addStreamMetricsToProtobuf(e){for(let t in this.clientMetricReport.streamMetricReports){let i=this.clientMetricReport.streamMetricReports[t],n=f.SdkStreamMetricFrame.create();n.streamId=i.streamId,n.metrics=[],this.addStreamMetricDimensionFrames(n,i),e.streamMetricFrames.push(n);let r=this.clientMetricReport.getMetricMap(i.mediaType,i.direction);for(let n in i.currentMetrics)this.addMetricFrame(n,e,r[n],Number(t));for(let n in i.currentStringMetrics)this.addMetricFrame(n,e,r[n],Number(t));for(let n in i.currentObjectMetrics)this.addMetricFrame(n,e,r[n],Number(t))}}makeClientMetricProtobuf(){let e=f.SdkClientMetricFrame.create();return e.globalMetrics=[],e.streamMetricFrames=[],this.addGlobalMetricsToProtobuf(e),this.addStreamMetricsToProtobuf(e),e}sendClientMetricProtobuf(e){this.signalingClient.sendClientMetrics(e)}isStreamRawMetricReport(e){return["inbound-rtp","inbound-rtp-red","outbound-rtp","remote-inbound-rtp","remote-outbound-rtp"].includes(e)}getMediaType(e){return"audio"===e.kind?a.default.AUDIO:a.default.VIDEO}getDirectionType(e){let{type:t}=e;return"inbound-rtp"===t||"remote-outbound-rtp"===t||"inbound-rtp-red"===t?o.default.DOWNSTREAM:o.default.UPSTREAM}isValidStandardRawMetric(e){return"inbound-rtp"===e.type||"inbound-rtp-red"===e.type||"outbound-rtp"===e.type||"remote-inbound-rtp"===e.type||"remote-outbound-rtp"===e.type||"candidate-pair"===e.type&&"succeeded"===e.state||"media-source"===e.type&&"audio"===e.kind}isValidSsrc(e){let t=!0;return this.isStreamRawMetricReport(e.type)&&this.getDirectionType(e)===o.default.DOWNSTREAM&&this.getMediaType(e)===a.default.VIDEO&&(t=this.videoStreamIndex.streamIdForSSRC(Number(e.ssrc))>0),t}isValidRawMetricReport(e){return this.isValidStandardRawMetric(e)&&this.isValidSsrc(e)}filterRawMetricReports(e){let t=[];for(let i of e)this.isValidRawMetricReport(i)&&t.push(i);return t}handleRawMetricReports(e){let t=this.filterRawMetricReports(e);this.logger.debug(()=>`Filtered raw metrics : ${JSON.stringify(t)}`);let i=[];this.maybeAddRedRecoveryMetrics(i),this.clientMetricReport.customStatsReports=i,t.push(...i),this.processRawMetricReports(t);let n=this.makeClientMetricProtobuf();this.sendClientMetricProtobuf(n),this.audioVideoController.forEachObserver(e=>{p.Maybe.of(e.metricsDidReceive).map(t=>t.bind(e)(this.clientMetricReport.clone()))})}getStatsWrapper(){return n(this,void 0,void 0,function*(){if(!this.audioVideoController.rtcPeerConnection)return;let e=[];try{let t=yield this.audioVideoController.rtcPeerConnection.getStats();this.clientMetricReport.rtcStatsReport=t,t.forEach(t=>{e.push(t)}),this.handleRawMetricReports(e)}catch(e){this.logger.error(e.message)}})}overrideObservableMetric(e,t){this.clientMetricReport.overrideObservableMetric(e,t)}recoveryMetricsDidReceive(e){this.redRecoveryMetricReport=e}maybeAddRedRecoveryMetrics(e){this.redRecoveryMetricReport.currentTimestampMs!==this.lastRedRecoveryMetricReportConsumedTimestampMs&&(e.push({kind:"audio",type:"inbound-rtp-red",ssrc:this.redRecoveryMetricReport.ssrc,timestamp:this.redRecoveryMetricReport.currentTimestampMs,totalAudioPacketsLost:this.redRecoveryMetricReport.totalAudioPacketsLost,totalAudioPacketsExpected:this.redRecoveryMetricReport.totalAudioPacketsExpected,totalAudioPacketsRecoveredRed:this.redRecoveryMetricReport.totalAudioPacketsRecoveredRed,totalAudioPacketsRecoveredFec:this.redRecoveryMetricReport.totalAudioPacketsRecoveredFec}),this.lastRedRecoveryMetricReportConsumedTimestampMs=this.redRecoveryMetricReport.currentTimestampMs)}}t.default=v,v.INTERVAL_MS=1e3,v.CLIENT_TYPE="amazon-chime-sdk-js"},87879:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.VideoLogEvent=void 0,function(e){e[e.InputAttached=0]="InputAttached",e[e.SendingFailed=1]="SendingFailed",e[e.SendingSuccess=2]="SendingSuccess"}(i=t.VideoLogEvent||(t.VideoLogEvent={})),t.default=i},14194:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=r(i(87879)),o=r(i(49288));class a extends o.default{constructor(e){super(e.logger),this.context=e,this.taskName="AttachMediaInputTask"}run(){return n(this,void 0,void 0,function*(){let e=this.context.transceiverController;e.setPeer(this.context.peer),e.setupLocalTransceivers();let t=this.context.activeAudioInput;if(t){let i=t.getAudioTracks();this.context.logger.info("attaching audio track to peer connection"),yield e.setAudioInput(i.length?i[0]:null)}else yield e.setAudioInput(null),this.context.logger.info("no audio track");this.setAudioCodecPreferences();let i=this.context.activeVideoInput;if(i){let t=i.getVideoTracks(),n=t.length?t[0]:null;if(this.context.logger.info("attaching video track to peer connection"),yield e.setVideoInput(n),this.context.enableSimulcast&&this.context.videoUplinkBandwidthPolicy){let t=this.context.videoUplinkBandwidthPolicy.chooseEncodingParameters();e.setEncodingParameters(t)}n&&this.context.statsCollector.logVideoEvent(s.default.InputAttached,this.context.videoDeviceInformation)}else yield e.setVideoInput(null),this.context.logger.info("no video track");this.context.videoSubscriptions=e.updateVideoTransceivers(this.context.videoStreamIndex,this.context.videosToReceive)})}setAudioCodecPreferences(){let e=window.RTCRtpTransceiver&&"setCodecPreferences"in window.RTCRtpTransceiver.prototype,t=this.context.audioProfile.hasRedundancyEnabled();if(!e){this.context.logger.warn("Setting codec preferences not supported");return}let i=this.context.transceiverController.localAudioTransceiver(),{codecs:n}=RTCRtpSender.getCapabilities("audio");this.context.logger.debug(`Available audio codecs ${JSON.stringify(n,null,4)}`);let r=n.findIndex(e=>"audio/red"===e.mimeType);if(!i){this.context.logger.error("audio transceiver is null");return}if(r>=0){let e=n[r];n.splice(r,1),t?(n.unshift(e),this.context.logger.info("audio/red set as preferred codec")):this.context.logger.info("audio/red removed from preferred codec"),i.setCodecPreferences(n);return}this.context.logger.info("audio/red codec not supported")}}t.default=a},49288:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=r(i(40292)),o=r(i(28850));class a{constructor(e){this.logger=e,this.taskName="BaseTask",this.parentTask=null,this.status=o.default.IDLE,this.run=this.baseRun.bind(this,this.run),this.cancel=this.baseCancel.bind(this,this.cancel)}once(...e){return new s.default(this.logger,this,e)}cancel(){}name(){return this.parentTask?`${this.parentTask.name()}/${this.taskName}`:this.taskName}setParent(e){this.parentTask=e}getStatus(){return this.status}logAndThrow(e){throw this.logger.info(e),Error(e)}baseRun(e){return n(this,void 0,void 0,function*(){try{let t=Date.now();switch(this.logger.info(`running task ${this.name()}`),this.status){case o.default.RUNNING:this.logAndThrow(`${this.name()} is already running`);case o.default.CANCELED:this.logAndThrow(`${this.name()} was canceled before running`);case o.default.FINISHED:this.logAndThrow(`${this.name()} was already finished`)}this.status=o.default.RUNNING,yield e.call(this),this.logger.info(`${this.name()} took ${Math.round(Date.now()-t)} ms`)}catch(e){throw e}finally{this.status!==o.default.CANCELED&&(this.status=o.default.FINISHED)}})}baseCancel(e){if(this.status===o.default.CANCELED||this.status===o.default.FINISHED){this.logger.info(`Not canceling ${this.name()}: state is ${this.status}`);return}this.logger.info(`canceling task ${this.name()}`),this.status=o.default.CANCELED,e.call(this)}}t.default=a},44525:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=r(i(49288));class o extends s.default{constructor(e){super(e.logger),this.context=e,this.taskName="CleanRestartedSessionTask"}run(){return n(this,void 0,void 0,function*(){this.context.resetConnectionSpecificState()})}}t.default=o},84209:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=r(i(62811)),o=r(i(49288));class a extends o.default{constructor(e){super(e.logger),this.context=e,this.taskName="CleanStoppedSessionTask",this.taskCanceler=null}cancel(){this.taskCanceler&&(this.taskCanceler.cancel(),this.taskCanceler=null)}run(){return n(this,void 0,void 0,function*(){try{this.context.signalingClient.ready()&&(this.context.signalingClient.closeConnection(),yield this.receiveWebSocketClosedEvent())}catch(e){throw e}finally{for(let e of this.context.removableObservers)e.removeObserver();this.context.resetConnectionSpecificState(),this.context.statsCollector.stop(),this.context.statsCollector=null,this.context.connectionMonitor.stop(),this.context.connectionMonitor=null,this.context.videoUplinkBandwidthPolicy.setTransceiverController&&this.context.videoUplinkBandwidthPolicy.setTransceiverController(void 0),this.context.videoDownlinkBandwidthPolicy.bindToTileController&&this.context.videoDownlinkBandwidthPolicy.bindToTileController(void 0);let e=this.context.videoTileController.getLocalVideoTile();e&&e.bindVideoStream("",!0,null,null,null,null),this.context.videoTileController.removeAllVideoTiles()}})}receiveWebSocketClosedEvent(){return new Promise((e,t)=>{class i{constructor(e){this.signalingClient=e}cancel(){this.signalingClient.removeObserver(this),t(Error("CleanStoppedSessionTask got canceled while waiting for the WebSocket closed event"))}handleSignalingClientEvent(t){t.type===s.default.WebSocketClosed&&(this.signalingClient.removeObserver(this),e())}}let n=new i(this.context.signalingClient);this.taskCanceler=n,this.context.signalingClient.registerObserver(n)})}}t.default=a},4307:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=r(i(49288));class o extends s.default{constructor(e){super(e.logger),this.context=e,this.taskName="CreatePeerConnectionTask",this.removeTrackAddedEventListener=null,this.removeTrackRemovedEventListeners={},this.trackEvents=["ended","mute","unmute","isolationchange","overconstrained"],this.removeVideoTrackEventListeners={},this.trackAddedHandler=e=>{let t=e.track;if(this.context.logger.info(`received track event: kind=${t.kind} id=${t.id} label=${t.label}`),e.transceiver&&"inactive"===e.transceiver.currentDirection)return;if(0===e.streams.length){this.context.logger.warn("Track event but no stream");return}let i=e.streams[0];"audio"===t.kind?this.context.audioMixController.bindAudioStream(i):"video"!==t.kind||this.trackIsVideoInput(t)||this.addRemoteVideoTrack(t,i)}}removeObserver(){for(let e in this.removeTrackAddedEventListener&&this.removeTrackAddedEventListener(),this.removeTrackRemovedEventListeners)this.removeTrackRemovedEventListeners[e]()}addPeerConnectionEventLogger(){let e=this.context.peer;e.addEventListener("connectionstatechange",()=>{this.context.logger.info(`peer connection state changed: ${e.connectionState}`)}),e.addEventListener("negotiationneeded",()=>{this.context.logger.info("peer connection negotiation is needed")}),e.addEventListener("icegatheringstatechange",()=>{this.context.logger.info(`peer connection ice gathering state changed: ${e.iceGatheringState}`)}),e.addEventListener("icecandidate",e=>{this.context.logger.info(`peer connection ice candidate: ${e.candidate?e.candidate.candidate:"(null)"}`)}),e.addEventListener("iceconnectionstatechange",()=>{this.context.logger.info(`peer connection ice connection state changed: ${e.iceConnectionState}`)})}run(){return n(this,void 0,void 0,function*(){this.context.removableObservers.push(this);let e=this.context.turnCredentials&&this.context.turnCredentials.uris.length>0?{iceServers:[{urls:this.context.turnCredentials.uris,username:this.context.turnCredentials.username,credential:this.context.turnCredentials.password,credentialType:"password"}],iceTransportPolicy:"relay"}:{};e.bundlePolicy=this.context.browserBehavior.requiresBundlePolicy(),e.sdpSemantics="unified-plan",e.encodedInsertableStreams=this.context.audioProfile.hasRedundancyEnabled(),this.context.peer?this.context.logger.info("reusing peer connection"):(this.context.logger.info("creating new peer connection"),this.context.peer=new RTCPeerConnection(e),this.addPeerConnectionEventLogger()),this.removeTrackAddedEventListener=()=>{this.context.peer&&this.context.peer.removeEventListener("track",this.trackAddedHandler),this.removeTrackAddedEventListener=null},this.context.peer.addEventListener("track",this.trackAddedHandler)})}trackIsVideoInput(e){return!!this.context.transceiverController.useTransceivers()&&(this.logger.debug(()=>"getting video track type"),this.context.transceiverController.trackIsVideoInput(e))}addRemoteVideoTrack(e,t){var i;let n,r,s,o;let a=t.id,l=this.context.videoStreamIndex.attendeeIdForTrack(a);if(n=this.context.videoTileController.getVideoTileForAttendeeId?!!(null===(i=null==(r=this.context.videoTileController.getVideoTileForAttendeeId(l))?void 0:r.state())||void 0===i?void 0:i.boundVideoStream):this.context.videoTileController.haveVideoTileForAttendeeId(l)){this.context.logger.info(`Not adding remote track. Already have tile for attendeeId:  ${l}`);return}r||(r=this.context.videoTileController.addVideoTile(),this.logger.info(`Created video tile ${r.id()}`));let d=this.context.videoStreamIndex.streamIdForTrack(a);void 0===d&&(this.logger.warn(`stream not found for tile=${r.id()} track=${a}`),d=null);for(let i=0;i<this.trackEvents.length;i++){let n=this.trackEvents[i],s=t.getVideoTracks();if(s&&s.length){let t=s[0],i=()=>{this.context.logger.info(`received the ${n} event for tile=${r.id()} id=${e.id} streamId=${d}`),"ended"===n&&this.removeRemoteVideoTrack(e,r.state())};t.addEventListener(n,i),this.removeVideoTrackEventListeners[e.id]||(this.removeVideoTrackEventListeners[e.id]=[]),this.removeVideoTrackEventListeners[e.id].push(()=>{t.removeEventListener(n,i)})}}if(e.getSettings){let t=e.getSettings();s=t.width,o=t.height}else{let t=e.getCapabilities();s=t.width,o=t.height}let u=this.context.videoStreamIndex.externalUserIdForTrack(a);r.bindVideoStream(l,!1,t,s,o,d,u),this.logger.info(`video track added, use tile=${r.id()} track=${a} streamId=${d}`);let c="removetrack",h=t,f=()=>this.removeRemoteVideoTrack(e,r.state());this.removeTrackRemovedEventListeners[e.id]=()=>{h.removeEventListener(c,f),delete this.removeTrackRemovedEventListeners[e.id]},h.addEventListener(c,f)}removeRemoteVideoTrack(e,t){if(this.removeTrackRemovedEventListeners.hasOwnProperty(e.id)){for(let t of(this.removeTrackRemovedEventListeners[e.id](),this.removeVideoTrackEventListeners[e.id]))t();delete this.removeVideoTrackEventListeners[e.id]}this.logger.info(`video track ended, removing tile=${t.tileId} id=${e.id} stream=${t.streamId}`),t.streamId?this.context.videosPaused.remove(t.streamId):this.logger.warn(`no stream found for tile=${t.tileId}`),this.context.videoTileController.removeVideoTile(t.tileId)}}t.default=o,o.REMOVE_HANDLER_INTERVAL_MS=1e4},9500:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=r(i(8056)),o=r(i(87444)),a=r(i(49288));class l extends a.default{constructor(e){super(e.logger),this.context=e,this.taskName="CreateSDPTask"}cancel(){if(this.cancelPromise){let e=Error(`canceling ${this.name()}`);this.cancelPromise(e),delete this.cancelPromise}}sessionUsesAudio(){var e,t;return!!(null===(t=null===(e=this.context.meetingSessionConfiguration)||void 0===e?void 0:e.urls)||void 0===t?void 0:t.audioHostURL)}sessionUsesVideo(){let e;let t=!0;e=this.context.transceiverController.useTransceivers()?this.context.transceiverController.hasVideoInput():this.context.videoTileController.hasStartedLocalVideoTile();let i=!!this.context.videosToReceive&&!this.context.videosToReceive.empty(),n=t&&(e||i);return this.context.logger.info(`uses video: ${n} (enabled: ${t}, sending: ${e}, receiving: ${i})`),n}run(){return n(this,void 0,void 0,function*(){let e={offerToReceiveAudio:this.sessionUsesAudio(),offerToReceiveVideo:this.sessionUsesVideo()};this.logger.info(`peer connection offerOptions: ${JSON.stringify(e)}`),yield new Promise((t,i)=>n(this,void 0,void 0,function*(){this.cancelPromise=e=>{i(e)};try{if(this.context.sdpOfferInit=yield this.context.peer.createOffer(e),this.context.logger.info("peer connection created offer"),this.context.previousSdpOffer&&new o.default(this.context.sdpOfferInit.sdp).videoSendSectionHasDifferentSSRC(this.context.previousSdpOffer)){let e=Error(`canceling ${this.name()} due to the meeting status code: ${s.default.IncompatibleSDP}`);this.context.previousSdpOffer=null,i(e);return}t()}catch(e){i(e)}finally{delete this.cancelPromise}}))})}}t.default=l},4347:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=r(i(8056)),o=r(i(87444)),a=r(i(49288));class l extends a.default{constructor(e,t=l.CHROME_VPN_TIMEOUT_MS){super(e.logger),this.context=e,this.chromeVpnTimeoutMs=t,this.taskName="FinishGatheringICECandidatesTask"}removeEventListener(){this.context.peer&&(this.context.peer.removeEventListener("icecandidate",this.context.iceCandidateHandler),this.context.turnCredentials||this.context.peer.removeEventListener("icegatheringstatechange",this.context.iceGatheringStateEventHandler))}cancel(){let e;this.context.browserBehavior.requiresIceCandidateGatheringTimeoutWorkaround()&&this.chromeVpnTimeoutMs<this.context.meetingSessionConfiguration.connectionTimeoutMs&&Date.now()-this.startTimestampMs>this.chromeVpnTimeoutMs&&(e=Error(`canceling ${this.name()} due to the meeting status code: ${s.default.ICEGatheringTimeoutWorkaround}`)),this.cancelPromise&&(e=e||Error(`canceling ${this.name()}`),this.cancelPromise(e),delete this.cancelPromise)}run(){return n(this,void 0,void 0,function*(){if(this.context.peer||this.logAndThrow("session does not have peer connection; bypass ice gathering"),this.context.browserBehavior.requiresCheckForSdpConnectionAttributes()){if(new o.default(this.context.peer.localDescription.sdp).hasCandidatesForAllMLines()){this.context.logger.info(`ice gathering already complete; bypass gathering, current local description ${this.context.peer.localDescription.sdp}`);return}}else this.context.logger.info(`iOS device does not require checking for connection attributes in SDP, current local description ${this.context.peer.localDescription.sdp}`);if((this.context.browserBehavior.hasFirefoxWebRTC()||"complete"===this.context.peer.iceGatheringState)&&new o.default(this.context.peer.localDescription.sdp).hasCandidates()){this.context.logger.info("ice gathering state is complete and candidates are in SDP; bypass gathering");return}try{yield new Promise((e,t)=>{this.cancelPromise=e=>{this.removeEventListener(),t(e)},this.context.turnCredentials||(this.context.iceGatheringStateEventHandler=()=>{if("complete"===this.context.peer.iceGatheringState){this.removeEventListener(),e(),delete this.cancelPromise;return}},this.context.peer.addEventListener("icegatheringstatechange",this.context.iceGatheringStateEventHandler)),this.context.iceCandidateHandler=i=>{if(this.context.logger.info(`ice candidate: ${i.candidate?i.candidate.candidate:"(null)"} state: ${this.context.peer.iceGatheringState}`),i.candidate&&(o.default.isRTPCandidate(i.candidate.candidate)&&this.context.iceCandidates.push(i.candidate),this.context.turnCredentials&&this.context.iceCandidates.length>=1)){this.context.logger.info("gathered at least one relay candidate"),this.removeEventListener(),e(),delete this.cancelPromise;return}"complete"===this.context.peer.iceGatheringState&&(this.context.logger.info("done gathering ice candidates"),this.removeEventListener(),new o.default(this.context.peer.localDescription.sdp).hasCandidates()&&0!==this.context.iceCandidates.length?e():t(Error("no ice candidates were gathered")),delete this.cancelPromise)},this.context.peer.addEventListener("icecandidate",this.context.iceCandidateHandler),this.startTimestampMs=Date.now()})}catch(e){throw e}finally{this.startTimestampMs&&(this.context.iceGatheringDurationMs=Math.round(Date.now()-this.startTimestampMs))}})}}t.default=l,l.CHROME_VPN_TIMEOUT_MS=5e3},32908:function(e,t,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return r(t,e),t},o=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let l=a(i(57456)),d=a(i(8056)),u=a(i(25735)),c=s(i(45377)),h=a(i(62811)),f=a(i(92852)),p=i(39163),m=a(i(49288));class g extends m.default{constructor(e){super(e.logger),this.context=e,this.taskName="JoinAndReceiveIndexTask",this.taskCanceler=null}cancel(){this.taskCanceler&&(this.taskCanceler.cancel(),this.taskCanceler=null)}run(){return o(this,void 0,void 0,function*(){let e=yield new Promise((e,t)=>{let i=this.context;i.turnCredentials=null;class n{constructor(e){this.signalingClient=e}cancel(){this.signalingClient.removeObserver(this),t(Error("JoinAndReceiveIndexTask got canceled while waiting for SdkIndexFrame"))}handleSignalingClientEvent(t){if(t.type===h.default.WebSocketClosed){let e=`The signaling connection was closed with code ${t.closeCode} and reason: ${t.closeReason}`;i.logger.warn(e);let n=d.default.SignalingBadRequest;4410===t.closeCode?(e="The meeting already ended.",i.logger.warn(e),n=d.default.MeetingEnded):t.closeCode>=4500&&t.closeCode<4600&&(n=d.default.SignalingInternalServerError),i.audioVideoController.handleMeetingSessionStatus(new l.default(n),Error(e));return}if(t.type===h.default.ReceivedSignalFrame){if(t.message.type===p.SdkSignalFrame.Type.JOIN_ACK){let e=t.message.joinack;if(!e){i.audioVideoController.handleMeetingSessionStatus(new l.default(d.default.SignalingRequestFailed),Error("Join ACK message did not include expected frame"));return}if(e.videoSubscriptionLimit&&(i.videoSubscriptionLimit=e.videoSubscriptionLimit),i.serverSupportsCompression=e.wantsCompressedSdp,void 0!==e.defaultServerSideNetworkAdaption&&e.defaultServerSideNetworkAdaption!==c.default.Default&&void 0!==i.videoDownlinkBandwidthPolicy.setServerSideNetworkAdaption){let t=e.defaultServerSideNetworkAdaption;i.logger.info(`Overriding server side network adaption value to ${t}`),i.videoDownlinkBandwidthPolicy.setServerSideNetworkAdaption(c.convertServerSideNetworkAdaptionEnumFromSignaled(t))}e&&e.turnCredentials?(i.turnCredentials=new u.default,i.turnCredentials.username=e.turnCredentials.username,i.turnCredentials.password=e.turnCredentials.password,i.turnCredentials.ttl=e.turnCredentials.ttl,i.turnCredentials.uris=e.turnCredentials.uris.map(e=>i.meetingSessionConfiguration.urls.urlRewriter(e)).filter(e=>!!e)):i.logger.error("missing TURN credentials in JoinAckFrame");return}t.message.type===p.SdkSignalFrame.Type.INDEX&&(this.signalingClient.removeObserver(this),e(t.message.index))}}}let r=new n(this.context.signalingClient);this.context.signalingClient.registerObserver(r),this.taskCanceler=r,this.context.previousSdpAnswerAsString="",this.context.previousSdpOffer=null,this.context.serverSupportsCompression=!1;let s=new f.default(this.context.meetingSessionConfiguration.applicationMetadata);void 0!==this.context.videoDownlinkBandwidthPolicy.getServerSideNetworkAdaption&&void 0!==this.context.videoDownlinkBandwidthPolicy.supportedServerSideNetworkAdaptions&&(s.serverSideNetworkAdaption=this.context.videoDownlinkBandwidthPolicy.getServerSideNetworkAdaption(),s.supportedServerSideNetworkAdaptions=this.context.videoDownlinkBandwidthPolicy.supportedServerSideNetworkAdaptions()),void 0!==this.context.videoDownlinkBandwidthPolicy.wantsAllTemporalLayersInIndex&&(s.wantsAllTemporalLayersInIndex=this.context.videoDownlinkBandwidthPolicy.wantsAllTemporalLayersInIndex()),s.disablePeriodicKeyframeRequestOnContentSender=this.context.meetingSessionConfiguration.disablePeriodicKeyframeRequestOnContentSender,this.context.signalingClient.join(s)});this.context.logger.info(`received first index ${JSON.stringify(e)}`),this.context.indexFrame=e})}}t.default=g},75583:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=r(i(62811)),o=i(39163),a=r(i(49288));class l extends a.default{constructor(e){super(e.logger),this.context=e,this.taskName="LeaveAndReceiveLeaveAckTask",this.taskCanceler=null}cancel(){this.taskCanceler&&(this.taskCanceler.cancel(),this.taskCanceler=null)}run(){return n(this,void 0,void 0,function*(){this.context.signalingClient.ready()&&(this.context.signalingClient.leave(),this.context.logger.info("sent leave"),yield this.receiveLeaveAck())})}receiveLeaveAck(){return new Promise((e,t)=>{class i{constructor(e,t){this.signalingClient=e,this.logger=t}cancel(){this.signalingClient.removeObserver(this),t(Error("LeaveAndReceiveLeaveAckTask got canceled while waiting for IndexFrame"))}handleSignalingClientEvent(t){if(t.isConnectionTerminated()){this.signalingClient.removeObserver(this),this.logger.info("LeaveAndReceiveLeaveAckTask connection terminated"),e();return}t.type===s.default.ReceivedSignalFrame&&t.message.type===o.SdkSignalFrame.Type.LEAVE_ACK&&(this.signalingClient.removeObserver(this),this.logger.info("got leave ack"),e())}}let n=new i(this.context.signalingClient,this.context.logger);this.taskCanceler=n,this.context.signalingClient.registerObserver(n)})}}t.default=l},86581:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=r(i(62811)),o=i(39163),a=r(i(49288));class l extends a.default{constructor(e){super(e.logger),this.context=e,this.taskName="ListenForVolumeIndicatorsTask",this.realtimeMuteAndUnmuteHandler=e=>{this.context.signalingClient.mute(e)}}run(){return n(this,void 0,void 0,function*(){this.context.removableObservers.push(this),this.context.signalingClient.registerObserver(this),this.context.realtimeController.realtimeSubscribeToMuteAndUnmuteLocalAudio(this.realtimeMuteAndUnmuteHandler)})}removeObserver(){this.context.realtimeController.realtimeUnsubscribeToMuteAndUnmuteLocalAudio(this.realtimeMuteAndUnmuteHandler),this.context.signalingClient.removeObserver(this)}handleSignalingClientEvent(e){if(e.type===s.default.ReceivedSignalFrame){if(e.message.type===o.SdkSignalFrame.Type.AUDIO_STREAM_ID_INFO){let t=e.message.audioStreamIdInfo;this.context.volumeIndicatorAdapter.sendRealtimeUpdatesForAudioStreamIdInfo(t)}else if(e.message.type===o.SdkSignalFrame.Type.AUDIO_METADATA){let t=e.message.audioMetadata;this.context.volumeIndicatorAdapter.sendRealtimeUpdatesForAudioMetadata(t)}}}}t.default=l},17928:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=r(i(89496)),o=r(i(57192)),a=r(i(53129)),l=r(i(78946)),d=r(i(3590)),u=r(i(57456)),c=r(i(8056)),h=r(i(62811)),f=i(39163),p=r(i(35102)),m=i(71906),g=r(i(49288));class v extends g.default{constructor(e,t,i){super(e.logger),this.context=e,this.initialConnectionHealthData=i,this.taskName="MonitorTask",this.prevSignalStrength=1,this.currentAvailableStreamAvgBitrates=null,this.hasSignalingError=!1,this.presenceHandlerCalled=!1,this.isResubscribeCheckPaused=!1,this.pendingMetricsReport=void 0,this.isMeetingConnected=!1,this.checkAndSendWeakSignalEvent=e=>{let t=e<1,i=this.prevSignalStrength<1,n=t?i?null:p.default.RedmicStartLoss:i?p.default.RedmicEndLoss:null;n&&this.context.statsCollector.logAudioEvent(n),this.prevSignalStrength=e},this.realtimeFatalErrorCallback=e=>{this.logger.error(`realtime error: ${e}: ${e.stack}`),this.context.audioVideoController.handleMeetingSessionStatus(new u.default(c.default.RealtimeApiFailed),e)},this.realtimeAttendeeIdPresenceHandler=(e,t)=>{var i;let n=this.context.meetingSessionConfiguration.credentials.attendeeId;this.logger.info(`attendeePresenceReceived: ${n}`),n===e&&t&&!this.presenceHandlerCalled&&(this.presenceHandlerCalled=!0,this.context.attendeePresenceDurationMs=Date.now()-this.context.startAudioVideoTimestamp,null===(i=this.context.eventController)||void 0===i||i.publishEvent("attendeePresenceReceived",{attendeePresenceDurationMs:this.context.attendeePresenceDurationMs}))},this.generateBaseAudioVideoEventAttributes=()=>{let{signalingOpenDurationMs:e,startTimeMs:t,iceGatheringDurationMs:i,attendeePresenceDurationMs:n,meetingStartDurationMs:r}=this.context;return{meetingDurationMs:null===t?0:Math.round(Date.now()-t),signalingOpenDurationMs:e,iceGatheringDurationMs:i,attendeePresenceDurationMs:n,meetingStartDurationMs:r}},this.generateAudioVideoEventAttributesForReceivingAudioDropped=()=>Object.assign(Object.assign({},this.generateBaseAudioVideoEventAttributes()),{maxVideoTileCount:this.context.maxVideoTileCount,poorConnectionCount:this.context.poorConnectionCount}),this.reconnectionHealthPolicy=new a.default(e.logger,Object.assign({},t),this.initialConnectionHealthData.clone()),this.unusableAudioWarningHealthPolicy=new d.default(Object.assign({},t),this.initialConnectionHealthData.clone()),this.sendingAudioFailureHealthPolicy=new l.default(e.logger,Object.assign({},t),this.initialConnectionHealthData.clone())}removeObserver(){this.context.audioVideoController.removeObserver(this),this.context.realtimeController.realtimeUnsubscribeToFatalError(this.realtimeFatalErrorCallback),this.context.realtimeController.realtimeUnsubscribeToLocalSignalStrengthChange(this.checkAndSendWeakSignalEvent),this.context.realtimeController.realtimeUnsubscribeToAttendeeIdPresence(this.realtimeAttendeeIdPresenceHandler),this.context.signalingClient.removeObserver(this)}run(){return n(this,void 0,void 0,function*(){this.context.removableObservers.push(this),this.context.audioVideoController.addObserver(this),this.context.realtimeController.realtimeSubscribeToFatalError(this.realtimeFatalErrorCallback),this.context.realtimeController.realtimeSubscribeToLocalSignalStrengthChange(this.checkAndSendWeakSignalEvent),this.context.realtimeController.realtimeSubscribeToAttendeeIdPresence(this.realtimeAttendeeIdPresenceHandler),this.context.connectionMonitor.start(),this.context.statsCollector.start(this.context.signalingClient,this.context.videoStreamIndex),this.context.signalingClient.registerObserver(this)})}pauseResubscribeCheck(){this.isResubscribeCheckPaused=!0}resumeResubscribeCheck(){this.isResubscribeCheckPaused&&(this.isResubscribeCheckPaused=!1,this.pendingMetricsReport&&(this.context.logger.info("Resuming resubscribe check with pending metrics report"),this.checkResubscribe(this.pendingMetricsReport)&&this.context.audioVideoController.update({needsRenegotiation:!1})))}videoTileDidUpdate(e){this.context.maxVideoTileCount=Math.max(this.context.maxVideoTileCount,this.context.videoTileController.getAllVideoTiles().length)}checkResubscribe(e){if(this.isResubscribeCheckPaused){this.context.logger.info("Resubscribe check is paused, setting incoming client metric report as pending"),this.pendingMetricsReport=e;return}this.pendingMetricsReport=void 0;let t=e.getObservableMetrics(),i=t.availableOutgoingBitrate,n=t.nackCountReceivedPerSecond,r=!1;this.context.videoDownlinkBandwidthPolicy.updateMetrics(e);let s=this.context.videoDownlinkBandwidthPolicy.wantsResubscribe();if(r=r||s,s){let e=this.context.videoDownlinkBandwidthPolicy.chooseSubscriptions();this.context.videosToReceive=e.truncate(this.context.videoSubscriptionLimit),e.size()>this.context.videosToReceive.size()&&this.logger.warn(`Video receive limit exceeded. Limiting the videos to ${this.context.videosToReceive.size()}. Please consider using AllHighestVideoBandwidthPolicy or VideoPriorityBasedPolicy along with chooseRemoteVideoSources api to select the video sources to be displayed.`),this.logger.info(`trigger resubscribe for down=${s}; videosToReceive=[${this.context.videosToReceive.array()}]`)}if(this.context.videoTileController.hasStartedLocalVideoTile()){this.context.videoUplinkBandwidthPolicy.updateConnectionMetric({uplinkKbps:i/1e3,nackCountPerSecond:n});let e=this.context.videoUplinkBandwidthPolicy.wantsResubscribe();r=r||e,e&&(this.logger.info(`trigger resubscribe for up=${e}; videosToReceive=[${this.context.videosToReceive.array()}]`),this.context.videoUplinkBandwidthPolicy.chooseEncodingParameters())}return r}metricsDidReceive(e){if(this.checkResubscribe(e)&&this.context.audioVideoController.update({needsRenegotiation:!1}),!this.currentAvailableStreamAvgBitrates)return;let t=e.streamMetricReports,i=new Map;for(let e in t)t[e].mediaType===o.default.VIDEO&&t[e].direction===s.default.DOWNSTREAM&&i.set(t[e].streamId,t[e])}connectionHealthDidChange(e){0===e.consecutiveMissedPongs&&this.context.reconnectController&&this.context.reconnectController.setLastActiveTimestampMs(Date.now()),this.applyHealthPolicy(this.reconnectionHealthPolicy,e,()=>{this.context.audioVideoController.handleMeetingSessionStatus(new u.default(c.default.ConnectionHealthReconnect),null)}),this.applyHealthPolicy(this.unusableAudioWarningHealthPolicy,e,()=>{var e;this.context.poorConnectionCount+=1;let t=this.generateAudioVideoEventAttributesForReceivingAudioDropped();null===(e=this.context.eventController)||void 0===e||e.publishEvent("receivingAudioDropped",t),this.context.videoTileController.haveVideoTilesWithStreams()?this.context.audioVideoController.forEachObserver(e=>{m.Maybe.of(e.connectionDidSuggestStopVideo).map(t=>t.bind(e)())}):this.context.audioVideoController.forEachObserver(e=>{m.Maybe.of(e.connectionDidBecomePoor).map(t=>t.bind(e)())})},()=>{this.context.audioVideoController.forEachObserver(e=>{m.Maybe.of(e.connectionDidBecomeGood).map(t=>t.bind(e)())})}),this.isMeetingConnected&&this.applyHealthPolicy(this.sendingAudioFailureHealthPolicy,e,()=>{var e;let t=this.generateBaseAudioVideoEventAttributes();null===(e=this.context.eventController)||void 0===e||e.publishEvent("sendingAudioFailed",t)},()=>{var e;let t=this.generateBaseAudioVideoEventAttributes();null===(e=this.context.eventController)||void 0===e||e.publishEvent("sendingAudioRecovered",t)})}audioVideoDidStart(){this.isMeetingConnected=!0}audioVideoDidStartConnecting(e){this.isMeetingConnected=!1}audioVideoDidStop(e){this.isMeetingConnected=!1}applyHealthPolicy(e,t,i,n){e.update(t);let r=e.healthIfChanged();null!==r&&(this.logger.info(`${e.name} value is now ${r}`),r<=e.minimumHealth()?m.Maybe.of(i).map(e=>e.bind(this)()):m.Maybe.of(n).map(e=>e.bind(this)()))}handleBitrateFrame(e){this.currentAvailableStreamAvgBitrates=e,e.serverAvailableOutgoingBitrate>0&&(this.logger.info(`Received server side estimation of available incoming bitrate ${e.serverAvailableOutgoingBitrate}kbps`),this.context.statsCollector.overrideObservableMetric("availableIncomingBitrate",1e3*e.serverAvailableOutgoingBitrate))}handleSignalingClientEvent(e){var t;if(e.type===h.default.WebSocketClosed&&(4410===e.closeCode||e.closeCode>=4500&&e.closeCode<4600)||e.type===h.default.WebSocketError||e.type===h.default.WebSocketFailed){if(!this.hasSignalingError){let e=this.generateAudioVideoEventAttributesForReceivingAudioDropped();null===(t=this.context.eventController)||void 0===t||t.publishEvent("signalingDropped",e),this.hasSignalingError=!0}}else e.type===h.default.WebSocketOpen&&(this.hasSignalingError=!1);if(e.type===h.default.ReceivedSignalFrame){if(e.message.type===f.SdkSignalFrame.Type.NOTIFICATION){switch(e.message.notification.level){case f.SdkNotificationFrame.NotificationLevel.INFO:this.logger.info(`Received notification from server: ${e.message.notification.message}`);break;case f.SdkNotificationFrame.NotificationLevel.WARNING:this.logger.warn(`Received warning from server: ${e.message.notification.message}`);break;case f.SdkNotificationFrame.NotificationLevel.ERROR:this.logger.error(`Received error from server: ${e.message.notification.message}`);break;default:this.logger.error(`Received notification from server with unknown level ${e.message.notification.level}: ${e.message.notification.message}`)}return}if(e.message.bitrates){let t=e.message.bitrates;this.context.videoStreamIndex.integrateBitratesFrame(t),this.context.videoDownlinkBandwidthPolicy.updateIndex(this.context.videoStreamIndex),this.handleBitrateFrame(e.message.bitrates)}let t=u.default.fromSignalFrame(e.message);e.message.type!==f.SdkSignalFrame.Type.PRIMARY_MEETING_JOIN_ACK&&t.statusCode()!==c.default.OK&&this.context.audioVideoController.handleMeetingSessionStatus(t,null)}}}t.default=v},5899:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{cancel(){}name(){return"NoOpTask"}run(){return Promise.resolve()}setParent(e){}}t.default=i},40292:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let r=n(i(35711)),s=n(i(45619));class o{constructor(e,t,i){this.logger=e,this.task=t,this.dependencies=i,this.canceled=!1}name(){return`${this.task.name()} (once)`}cancel(){if(!this.canceled){if(this.dependencies)for(let e of this.dependencies)e.cancel();this.logger.info(`Canceling ${this.name()}`),s.default.nextTick(()=>this.task.cancel()),this.canceled=!0,this.cancelPromise&&s.default.nextTick(()=>this.cancelPromise(Error(`canceling ${this.name()}`)))}}logDependencies(){if(this.logger.getLogLevel()>r.default.INFO||!this.dependencies)return;let e=this.dependencies.filter(e=>e).map(e=>e.name()).join(", ");this.logger.info(`${this.task.name()} waiting for dependencies: ${e}`)}run(){if(this.promise)return this.promise;let e=this.dependencies?Promise.all(this.dependencies.map(e=>null==e?void 0:e.run())):Promise.resolve();return this.logDependencies(),this.ongoing=e.then(()=>this.task.run()),this.promise=new Promise((e,t)=>{this.cancelPromise=t,this.ongoing.then(e).catch(t)})}setParent(e){this.task.setParent(e)}}t.default=o},61849:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=r(i(67406)),o=r(i(62811)),a=r(i(49288));class l extends a.default{constructor(e){super(e.logger),this.context=e,this.taskName="OpenSignalingConnectionTask",this.taskCanceler=null}cancel(){this.taskCanceler&&(this.taskCanceler.cancel(),this.taskCanceler=null)}run(){return n(this,void 0,void 0,function*(){let e=this.context.meetingSessionConfiguration;this.context.signalingClient.openConnection(new s.default(e.urls.signalingURL,e.credentials.joinToken));let t=Date.now();try{yield new Promise((e,t)=>{class i{constructor(e){this.signalingClient=e}cancel(){this.signalingClient.removeObserver(this),t(Error("OpenSignalingConnectionTask got canceled while waiting to open signaling connection"))}handleSignalingClientEvent(i){switch(i.type){case o.default.WebSocketOpen:this.signalingClient.removeObserver(this),e();break;case o.default.WebSocketFailed:this.signalingClient.removeObserver(this),t(Error("WebSocket connection failed"))}}}let n=new i(this.context.signalingClient);this.context.signalingClient.registerObserver(n),this.taskCanceler=n})}catch(e){throw e}finally{this.context.signalingOpenDurationMs=Math.round(Date.now()-t),this.logger.info(`Opening signaling connection took ${this.context.signalingOpenDurationMs} ms`)}})}}t.default=l},522:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=r(i(49288));class o extends s.default{constructor(e,t,i){for(let n of(super(e),this.taskName=t,this.tasksToRunParallel=i,i))n.setParent(this)}cancel(){for(let e of this.tasksToRunParallel)this.logger.info(`canceling parallel group task ${this.name()} subtask ${e.name()}`),e.cancel()}run(){return n(this,void 0,void 0,function*(){let e=[];for(let t of this.tasksToRunParallel)this.logger.info(`parallel group task ${this.name()} running subtask ${t.name()}`),e.push(t.run());let t=[];for(let i=0;i<e.length;i++){try{yield e[i]}catch(e){t.push(`task ${this.tasksToRunParallel[i].name()} failed: ${e.message}`)}this.logger.info(`parallel group task ${this.name()} completed subtask ${this.tasksToRunParallel[i].name()}`)}if(t.length>0){let e=t.join(", ");this.logAndThrow(`parallel group task ${this.name()} failed for tasks: ${e}`)}this.logger.info(`parallel group task ${this.name()} completed`)})}}t.default=o},40708:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=i(8963),o=r(i(62811)),a=i(39163),l=r(i(49288));class d extends l.default{constructor(e,t,i){super(e.logger),this.context=e,this.credentials=t,this.completionCallback=i,this.taskName="PromoteToPrimaryMeetingTask",this.taskCanceler=null}cancel(){this.taskCanceler&&(this.taskCanceler.cancel(),this.taskCanceler=null)}run(){return n(this,void 0,void 0,function*(){this.context.signalingClient.ready()?(this.context.signalingClient.promoteToPrimaryMeeting(this.credentials),this.context.logger.info("Sent request to join primary meeting"),yield this.receivePrimaryMeetingJoinAck()):this.completionCallback(new s.MeetingSessionStatus(s.MeetingSessionStatusCode.SignalingRequestFailed))})}receivePrimaryMeetingJoinAck(){return new Promise((e,t)=>{class i{constructor(e,t,i){this.signalingClient=e,this.completionCallback=t,this.logger=i}cancel(){this.signalingClient.removeObserver(this),this.completionCallback(new s.MeetingSessionStatus(s.MeetingSessionStatusCode.SignalingRequestFailed)),e()}handleSignalingClientEvent(t){t.isConnectionTerminated()&&(this.signalingClient.removeObserver(this),this.logger.info("PromoteToPrimaryMeetingTask connection terminated"),this.completionCallback(new s.MeetingSessionStatus(s.MeetingSessionStatusCode.SignalingRequestFailed)),e()),t.type===o.default.ReceivedSignalFrame&&t.message.type===a.SdkSignalFrame.Type.PRIMARY_MEETING_JOIN_ACK&&(this.signalingClient.removeObserver(this),this.logger.info("Got a primary meeting join ACK"),this.completionCallback(s.MeetingSessionStatus.fromSignalFrame(t.message)),e())}}let n=new i(this.context.signalingClient,this.completionCallback,this.context.logger);this.taskCanceler=n,this.context.signalingClient.registerObserver(n)})}}t.default=d},22505:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=r(i(49288));class o extends s.default{constructor(e){super(e.logger),this.context=e,this.taskName="ReceiveAudioInputTask"}run(){var e,t;return n(this,void 0,void 0,function*(){let i;if(!(null===(t=null===(e=this.context.meetingSessionConfiguration)||void 0===e?void 0:e.urls)||void 0===t?void 0:t.audioHostURL)){this.context.logger.info("No audio connection: not acquiring audio input");return}if(this.context.activeAudioInput){this.context.logger.info("an active audio input exists");return}try{i=yield this.context.mediaStreamBroker.acquireAudioInputStream()}catch(e){this.context.logger.warn("could not acquire audio input from current device")}i?this.context.activeAudioInput=i:this.context.logger.warn("an audio input is not available")})}}t.default=o},91604:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=r(i(62811)),o=i(39163),a=r(i(49288));class l extends a.default{constructor(e){super(e.logger),this.context=e,this.taskName="ReceiveRemoteVideoPauseResume",this.serverPausedVideoTileIds=new Set}removeObserver(){this.context.signalingClient.removeObserver(this)}run(){return n(this,void 0,void 0,function*(){this.context.signalingClient.registerObserver(this),this.context.removableObservers.push(this)})}handleSignalingClientEvent(e){if(e.type!==s.default.ReceivedSignalFrame||e.message.type!==o.SdkSignalFrame.Type.PAUSE&&e.message.type!==o.SdkSignalFrame.Type.RESUME)return;let t=e.message.pause,i=e.message.type;if(this.context.logger.info(`received new ${i===o.SdkSignalFrame.Type.PAUSE?"pause":"resume"} frame: ${JSON.stringify(t)}`),t&&void 0!==this.context.videoTileController.getVideoTileForAttendeeId&&void 0!==this.context.videoDownlinkBandwidthPolicy.forEachObserver&&void 0!==this.context.videoStreamIndex.attendeeIdForGroupId)for(let e of t.groupIds.map(e=>{let t=this.context.videoStreamIndex.attendeeIdForGroupId(e);return this.context.videoTileController.getVideoTileForAttendeeId(t)}))void 0!==e&&(i===o.SdkSignalFrame.Type.PAUSE?e.state().paused||(this.serverPausedVideoTileIds.add(e.id()),this.context.videoDownlinkBandwidthPolicy.forEachObserver(t=>{t.tileWillBePausedByDownlinkPolicy(e.id())}),e.pause()):e.state().paused&&this.serverPausedVideoTileIds.has(e.id())&&(this.serverPausedVideoTileIds.delete(e.id()),this.context.videoDownlinkBandwidthPolicy.forEachObserver(t=>{t.tileWillBeUnpausedByDownlinkPolicy(e.id())}),e.unpause()))}}t.default=l},55960:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=r(i(77041)),o=i(39163),a=r(i(49288));class l extends a.default{constructor(e){super(e.logger),this.context=e,this.taskName="ReceiveVideoInputTask"}checkAndApplyVideoConstraint(e,t,i,r,s){return n(this,void 0,void 0,function*(){let n;let o=t.getSettings();if(i>(n=e?this.context.meetingSessionConfiguration.meetingFeatures.contentMaxResolution:this.context.meetingSessionConfiguration.meetingFeatures.videoMaxResolution).videoWidth||r>n.videoHeight||s>n.videoFrameRate){let i={width:{ideal:n.videoWidth},height:{ideal:n.videoHeight},frameRate:{ideal:n.videoFrameRate}};this.context.logger.warn(`Video track (content = ${e}) will be constrained to: ${JSON.stringify(i)} to remain below configured video quality settings, trackSettings: ${JSON.stringify(o)}`);try{yield t.applyConstraints(i)}catch(t){this.context.logger.info(`Could not apply constraint for video track (content = ${e})`)}}})}run(){return n(this,void 0,void 0,function*(){let e;let t=this.context.videoDuplexMode===o.SdkStreamServiceType.RX||this.context.videoDuplexMode===o.SdkStreamServiceType.DUPLEX;if(this.context.videoTileController.hasStartedLocalVideoTile()?this.context.videoDuplexMode=t?o.SdkStreamServiceType.DUPLEX:o.SdkStreamServiceType.TX:this.context.videoDuplexMode=t?o.SdkStreamServiceType.RX:0,this.context.videoCaptureAndEncodeParameter=this.context.videoUplinkBandwidthPolicy.chooseCaptureAndEncodeParameters(),!this.context.videoTileController.hasStartedLocalVideoTile()){this.context.logger.info("has not started local video tile"),this.context.activeVideoInput&&(this.context.activeVideoInput=void 0,this.context.videoStreamIndex.integrateUplinkPolicyDecision([]));return}let i=this.context.videoTileController.getLocalVideoTile();try{e=yield this.context.mediaStreamBroker.acquireVideoInputStream()}catch(e){this.context.logger.warn("could not acquire video input from current device"),this.context.videoTileController.stopLocalVideoTile()}if(this.context.enableSimulcast){let e=this.context.videoUplinkBandwidthPolicy.chooseEncodingParameters();this.context.videoStreamIndex.integrateUplinkPolicyDecision(Array.from(e.values()))}if(this.context.activeVideoInput=e,e){let t=e.getVideoTracks();if(!t||0===t.length)return;let n=this.context.meetingSessionConfiguration.credentials.attendeeId,r=new s.default(n).hasModality(s.default.MODALITY_CONTENT),o=t[0].getSettings();this.checkAndApplyVideoConstraint(r,t[0],o.width,o.height,o.frameRate);let a=this.context.audioVideoController.configuration.credentials.externalUserId;for(let r of(i.bindVideoStream(n,!0,e,o.width,o.height,null,a),t))this.logger.info(`Using video device label=${r.label} id=${r.id}`),this.context.videoDeviceInformation.current_camera_name=r.label,this.context.videoDeviceInformation.current_camera_id=r.id}})}}t.default=l},60519:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=r(i(1090)),o=r(i(77041)),a=r(i(81342)),l=r(i(62811)),d=i(39163),u=i(71906),c=r(i(49288));class h extends c.default{constructor(e){super(e.logger),this.context=e,this.taskName="ReceiveVideoStreamIndexTask",this.isIngestionPaused=!1,this.pendingIndex=null}removeObserver(){this.context.signalingClient.removeObserver(this)}run(){return n(this,void 0,void 0,function*(){this.handleIndexFrame(this.context.indexFrame),this.context.signalingClient.registerObserver(this),this.context.removableObservers.push(this)})}handleSignalingClientEvent(e){if(e.type!==l.default.ReceivedSignalFrame||e.message.type!==d.SdkSignalFrame.Type.INDEX)return;let t=e.message.index;this.context.logger.info(`received new index ${JSON.stringify(t)}`),this.handleIndexFrame(t)}pauseIngestion(){this.isIngestionPaused=!0}resumeIngestion(){this.isIngestionPaused&&(this.isIngestionPaused=!1,this.pendingIndex&&(this.context.logger.info("Resuming index ingestion with pending index"),this.handleIndexFrame(this.pendingIndex)))}handleIndexFrame(e){if(!e)return;if(this.isIngestionPaused){this.context.logger.info("Index ingestion is paused, setting most recent index as pending"),this.pendingIndex=e;return}this.pendingIndex=null;let t=this.context.audioVideoController.configuration.credentials.attendeeId;e.sources=e.sources.filter(e=>{let i=new o.default(e.attendeeId);return!(i.base()===t&&i.hasModality(o.default.MODALITY_CONTENT))});let{videoStreamIndex:i,videoDownlinkBandwidthPolicy:n,videoUplinkBandwidthPolicy:r}=this.context,s=i.allVideoSendingSourcesExcludingSelf(t);i.integrateIndexFrame(e),n.updateIndex(i),r.updateIndex(i),this.resubscribe(n,r),this.updateVideoAvailability(e),this.handleIndexVideosPausedAtSource(),e.supportedReceiveCodecIntersection.length>0&&this.handleSupportedVideoReceiveCodecIntersection(e);let a=i.allVideoSendingSourcesExcludingSelf(t);this.areVideoSourcesEqual(s,a)||this.context.audioVideoController.forEachObserver(e=>{u.Maybe.of(e.remoteVideoSourcesDidChange).map(t=>t.bind(e)(a))})}areVideoSourcesEqual(e,t){if(e.length!==t.length)return!1;let i=(e,t)=>e.attendee.attendeeId.localeCompare(t.attendee.attendeeId),n=[...e].sort(i),r=[...t].sort(i);for(let e=0;e<n.length;e++)if(n[e].attendee.attendeeId!==r[e].attendee.attendeeId)return!1;return!0}resubscribe(e,t){let i=e.wantsResubscribe(),n=(this.context.videoDuplexMode===d.SdkStreamServiceType.TX||this.context.videoDuplexMode===d.SdkStreamServiceType.DUPLEX)&&t.wantsResubscribe(),r=i||n;if(this.logger.info(`should resubscribe: ${r} (downlink: ${i} uplink: ${n})`),!r)return;let s=e.chooseSubscriptions();this.context.videosToReceive=s.truncate(this.context.videoSubscriptionLimit),s.size()>this.context.videosToReceive.size()&&this.logger.warn(`Video receive limit exceeded. Limiting the videos to ${this.context.videosToReceive.size()}. Please consider using AllHighestVideoBandwidthPolicy or VideoPriorityBasedPolicy along with chooseRemoteVideoSources api to select the video sources to be displayed.`),this.context.videoCaptureAndEncodeParameter=t.chooseCaptureAndEncodeParameters(),this.logger.info(`trigger resubscribe for up=${n} down=${i}; videosToReceive=[${this.context.videosToReceive.array()}] captureParams=${JSON.stringify(this.context.videoCaptureAndEncodeParameter)}`),this.context.audioVideoController.update({needsRenegotiation:!1})}updateVideoAvailability(e){if(!this.context.videosToReceive){this.logger.error("videosToReceive must be set in the meeting context.");return}let t=new s.default;t.remoteVideoAvailable=!this.context.videosToReceive.empty(),t.canStartLocalVideo=!e.atCapacity,this.context.lastKnownVideoAvailability&&this.context.lastKnownVideoAvailability.equal(t)||(this.context.lastKnownVideoAvailability=t.clone(),this.context.audioVideoController.forEachObserver(e=>{u.Maybe.of(e.videoAvailabilityDidChange).map(i=>i.bind(e)(t.clone()))}))}handleSupportedVideoReceiveCodecIntersection(e){if(void 0===this.context.videoSendCodecPreferences)return;let t=[],i=!1;for(let i of this.context.videoSendCodecPreferences)for(let n of e.supportedReceiveCodecIntersection)if(i.equals(a.default.fromSignaled(n))){t.push(i);break}if(t.length>0){let e=t.find(e=>this.context.prioritizedSendVideoCodecCapabilities.some(t=>e.equals(t)));void 0===this.context.currentVideoSendCodec||void 0!==e&&this.context.currentVideoSendCodec.equals(e)||(i=!0),this.context.meetingSupportedVideoSendCodecPreferences=t}else this.logger.warn("Interesection of meeting receive codec support and send codec preferences has no overlap, falling back to just values provided in `setVideoCodecSendPreferences`"),this.context.meetingSupportedVideoSendCodecPreferences=void 0;this.context.videoUplinkBandwidthPolicy.setMeetingSupportedVideoSendCodecs&&this.context.videoUplinkBandwidthPolicy.setMeetingSupportedVideoSendCodecs(this.context.meetingSupportedVideoSendCodecPreferences,this.context.videoSendCodecPreferences),i&&this.context.audioVideoController.update({needsRenegotiation:!0})}handleIndexVideosPausedAtSource(){let e=this.context.videoStreamIndex.streamsPausedAtSource();for(let t of this.context.videoTileController.getAllVideoTiles()){let i=t.state();e.contain(i.streamId)?t.markPoorConnection()&&this.logger.info(`marks the tile ${i.tileId} as having a poor connection`):t.unmarkPoorConnection()&&this.logger.info(`unmarks the tile ${i.tileId} as having a poor connection`)}}}t.default=h},53282:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let r=n(i(49288));class s extends r.default{constructor(e,t,i="RunnableTask"){super(e),this.fn=t,this.taskName=i}run(){return this.fn().then(()=>{})}}t.default=s},34395:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=r(i(87271)),o=r(i(62811)),a=i(39163),l=r(i(49288));class d extends l.default{constructor(e){super(e.logger),this.context=e,this.taskName="SendAndReceiveDataMessagesTask",this.sendDataMessageHandler=(e,t,i)=>{if(this.context.signalingClient.ready()){let n;t instanceof Uint8Array?n=t:n="string"==typeof t?new TextEncoder().encode(t):new TextEncoder().encode(JSON.stringify(t)),this.validateDataMessage(e,n,i);let r=a.SdkDataMessagePayload.create();r.topic=e,r.lifetimeMs=i,r.data=n;let s=a.SdkDataMessageFrame.create();s.messages=[r],this.context.signalingClient.sendDataMessage(s)}else this.context.logger.error("Signaling client is not ready")}}run(){return n(this,void 0,void 0,function*(){this.context.removableObservers.push(this),this.context.signalingClient.registerObserver(this),this.context.realtimeController.realtimeSubscribeToSendDataMessage(this.sendDataMessageHandler)})}removeObserver(){this.context.realtimeController.realtimeUnsubscribeFromSendDataMessage(this.sendDataMessageHandler),this.context.signalingClient.removeObserver(this)}handleSignalingClientEvent(e){if(e.type===o.default.ReceivedSignalFrame&&e.message.type===a.SdkSignalFrame.Type.DATA_MESSAGE)for(let t of e.message.dataMessage.messages){let e=new s.default(t.ingestTimeNs/1e6,t.topic,t.data,t.senderAttendeeId,t.senderExternalUserId,0===t.ingestTimeNs);this.context.realtimeController.realtimeReceiveDataMessage(e)}}validateDataMessage(e,t,i){if(!d.TOPIC_REGEX.test(e))throw Error("Invalid topic");if(t.length>d.DATA_SIZE)throw Error("Data size has to be less than 2048 bytes");if(i&&i<0)throw Error("The life time of the message has to be non negative")}}t.default=d,d.TOPIC_REGEX=new RegExp(/^[a-zA-Z0-9_-]{1,36}$/),d.DATA_SIZE=2048},38521:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=r(i(49288)),o=r(i(28850));class a extends s.default{constructor(e,t,i){for(let n of(super(e),this.taskName=t,this.tasksToRunSerially=i,this.currentTask=null,i))n.setParent(this)}cancel(){this.currentTask&&(this.logger.info(`canceling serial group task ${this.name()} subtask ${this.currentTask.name()}`),this.currentTask.cancel())}run(){return n(this,void 0,void 0,function*(){for(let e of this.tasksToRunSerially){this.getStatus()===o.default.CANCELED&&this.logAndThrow(`serial group task ${this.name()} was canceled`);try{this.logger.info(`serial group task ${this.name()} running subtask ${e.name()}`),this.currentTask=e,yield e.run(),this.logger.info(`serial group task ${this.name()} completed subtask ${e.name()}`)}catch(e){this.logAndThrow(`serial group task ${this.name()} was canceled due to subtask ${this.currentTask.name()} error: ${e.message}`)}finally{this.currentTask=null}}this.logger.info(`serial group task ${this.name()} completed`)})}}t.default=a},44970:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=r(i(81341)),o=r(i(77041)),a=r(i(87444)),l=r(i(49288));class d extends l.default{constructor(e){super(e.logger),this.context=e,this.taskName="SetLocalDescriptionTask"}cancel(){if(this.cancelPromise){let e=Error(`canceling ${this.name()}`);this.cancelPromise(e),delete this.cancelPromise}}run(){return n(this,void 0,void 0,function*(){let e=this.context.peer,t=this.context.sdpOfferInit.sdp;this.context.browserBehavior.supportsVideoLayersAllocationRtpHeaderExtension()&&(t=new a.default(t).withVideoLayersAllocationRtpHeaderExtension(this.context.previousSdpOffer).sdp),this.context.browserBehavior.supportsDependencyDescriptorRtpHeaderExtension()&&void 0!==this.context.videoUplinkBandwidthPolicy.wantsVideoDependencyDescriptorRtpHeaderExtension&&this.context.videoUplinkBandwidthPolicy.wantsVideoDependencyDescriptorRtpHeaderExtension()&&(t=new a.default(t).withDependencyDescriptorRtpHeaderExtension(this.context.previousSdpOffer).sdp),new s.default().requiresDisablingH264Encoding()&&(t=new a.default(t).removeH264SupportFromSendSection().sdp);let i=this.context.audioVideoController.configuration.credentials.attendeeId;if(new o.default(i).hasModality(o.default.MODALITY_CONTENT)&&this.context.audioVideoController.configuration.enableSVC&&(t=new a.default(t).withStartingVideoSendBitrate(100).sdp),void 0!==this.context.videoSendCodecPreferences&&this.context.videoSendCodecPreferences.length>0&&(t=new a.default(t).withVideoSendCodecPreferences(void 0!==this.context.meetingSupportedVideoSendCodecPreferences?this.context.meetingSupportedVideoSendCodecPreferences:this.context.videoSendCodecPreferences).sdp),this.context.audioProfile&&(t=new a.default(t).withAudioMaxAverageBitrate(this.context.audioProfile.audioBitrateBps).sdp,this.context.audioProfile.isStereo()&&(t=new a.default(t).withStereoAudio().sdp),this.context.audioProfile.hasRedundancyEnabled())){let e=new a.default(t).getAudioPayloadTypes();this.context.transceiverController&&this.context.transceiverController.setAudioPayloadTypes&&this.context.transceiverController.setAudioPayloadTypes(e)}this.logger.debug(()=>`local description is >>>${t}<<<`);let r={type:"offer",sdp:t,toJSON:null};yield new Promise((t,i)=>n(this,void 0,void 0,function*(){this.cancelPromise=e=>{i(e)};try{yield e.setLocalDescription(r),t()}catch(e){i(e)}finally{delete this.cancelPromise}})),this.context.logger.info("set local description")})}}t.default=d},9478:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=r(i(77041)),o=r(i(87444)),a=r(i(81342)),l=r(i(49288));class d extends l.default{constructor(e){super(e.logger),this.context=e,this.taskName="SetRemoteDescriptionTask"}cancel(){this.cancelICEPromise&&this.cancelICEPromise()}run(){var e;return n(this,void 0,void 0,function*(){this.context.peer||this.logAndThrow("session does not have peer connection; bypass set remote description");let t=this.context.sdpAnswer;t=new o.default(t).withoutServerReflexiveCandidates().sdp,this.context.audioProfile&&(t=new o.default(t).withAudioMaxAverageBitrate(this.context.audioProfile.audioBitrateBps).sdp,this.context.audioProfile.isStereo()&&(t=new o.default(t).withStereoAudio().sdp)),void 0!==this.context.videoSendCodecPreferences&&this.context.videoSendCodecPreferences.length>0&&(t=new o.default(t).withVideoSendCodecPreferences(void 0!==this.context.meetingSupportedVideoSendCodecPreferences?this.context.meetingSupportedVideoSendCodecPreferences:this.context.videoSendCodecPreferences).sdp),this.context.prioritizedSendVideoCodecCapabilities=new o.default(t).prioritizedSendVideoCodecCapabilities(),this.context.currentVideoSendCodec=this.context.prioritizedSendVideoCodecCapabilities.length>0?this.context.prioritizedSendVideoCodecCapabilities[0]:void 0;let i=this.context.activeVideoInput;if(void 0!==i){let t=this.context.audioVideoController.configuration.credentials.attendeeId,n=new s.default(t).hasModality(s.default.MODALITY_CONTENT),r=i.getVideoTracks()[0];n&&((null===(e=this.context.currentVideoSendCodec)||void 0===e?void 0:e.codecName)===a.default.av1Main().codecName?(r.contentHint="text",this.logger.info(`Setting content hint to text for AV1, attendee: ${t}`)):this.context.audioVideoController.configuration.enableSVC&&(r.contentHint="motion",this.logger.info(`Setting content hint to motion to enable SVC, attendee: ${t}`)))}this.logger.info(`processed remote description is >>>${t}<<<`);let n={type:"answer",sdp:t,toJSON:null};try{yield this.createICEConnectionCompletedPromise(n)}catch(e){throw e}})}createICEConnectionCompletedPromise(e){return new Promise((t,i)=>n(this,void 0,void 0,function*(){let n=()=>{("connected"===this.context.peer.iceConnectionState||"completed"===this.context.peer.iceConnectionState)&&(this.context.peer.removeEventListener("iceconnectionstatechange",n),t())};this.cancelICEPromise=()=>{this.context.peer&&this.context.peer.removeEventListener("iceconnectionstatechange",n),i(Error(`${this.name()} got canceled while waiting for the ICE connection state`))},this.context.peer.addEventListener("iceconnectionstatechange",n);try{yield this.context.peer.setRemoteDescription(e),this.logger.info("set remote description, waiting for ICE connection"),n()}catch(e){i(e)}}))}}t.default=d},60653:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=r(i(57456)),o=r(i(8056)),a=r(i(87444)),l=r(i(48693)),d=i(45377),u=r(i(62811)),c=r(i(12634)),h=i(39163),f=i(85336),p=r(i(49288));class m extends p.default{constructor(e){super(e.logger),this.context=e,this.taskName="SubscribeAndReceiveSubscribeAckTask",this.taskCanceler=null,this.textCompressor=new l.default(e.logger)}cancel(){this.taskCanceler&&(this.taskCanceler.cancel(),this.taskCanceler=null)}run(){return n(this,void 0,void 0,function*(){let e,t="";if(this.context.peer&&this.context.peer.localDescription&&(t=new a.default(this.context.peer.localDescription.sdp).withUnifiedPlanFormat().sdp),!this.context.enableSimulcast){let e=0,t=0;this.context.videoCaptureAndEncodeParameter&&(e=this.context.videoCaptureAndEncodeParameter.captureFrameRate(),t=this.context.videoCaptureAndEncodeParameter.encodeBitrates()[0]);let i={rid:"hi",maxBitrate:1e3*t,maxFramerate:e,active:!0};this.context.videoStreamIndex.integrateUplinkPolicyDecision([i])}this.context.videoStreamIndex.subscribeFrameSent();let i=this.fixUpSubscriptionOrder(t,this.context.videoSubscriptions),n=this.context.videoDuplexMode===h.SdkStreamServiceType.TX||this.context.videoDuplexMode===h.SdkStreamServiceType.DUPLEX,r=t;if(void 0!==this.context.videoUplinkBandwidthPolicy.wantsVideoDependencyDescriptorRtpHeaderExtension&&this.context.videoUplinkBandwidthPolicy.wantsVideoDependencyDescriptorRtpHeaderExtension()||(r=new a.default(r).withoutDependencyDescriptorRtpHeaderExtension().sdp),this.context.serverSupportsCompression){let i=this.context.previousSdpOffer?this.context.previousSdpOffer.sdp:"";e=this.textCompressor.compress(r,i),this.context.logger.info(`Compressed the SDP message from ${r.length} to ${e.length} bytes.`),t=""}this.context.previousSdpOffer=new a.default(t);let s=new c.default(this.context.meetingSessionConfiguration.credentials.attendeeId,t,this.context.meetingSessionConfiguration.urls.audioHostURL,this.context.realtimeController.realtimeIsLocalAudioMuted(),!1,i,n,this.context.videoStreamIndex.localStreamDescriptions(),!0,e);void 0===this.context.videoDownlinkBandwidthPolicy.getServerSideNetworkAdaption||d.serverSideNetworkAdaptionIsNoneOrDefault(this.context.videoDownlinkBandwidthPolicy.getServerSideNetworkAdaption())||void 0===this.context.videoDownlinkBandwidthPolicy.getVideoPreferences||(s.videoSubscriptionConfiguration=f.convertVideoPreferencesToSignalingClientVideoSubscriptionConfiguration(this.context,i.map(e=>0===e?0:this.context.videoStreamIndex.groupIdForStreamId(e)),this.context.videoDownlinkBandwidthPolicy.getVideoPreferences())),this.context.logger.info(`sending subscribe: ${JSON.stringify(s)}`),this.context.signalingClient.subscribe(s);let o=yield this.receiveSubscribeAck();this.context.logger.info(`got subscribe ack: ${JSON.stringify(o)}`);let l="";o.compressedSdpAnswer&&o.compressedSdpAnswer.length?(0===(l=this.textCompressor.decompress(o.compressedSdpAnswer,this.context.previousSdpAnswerAsString)).length&&(this.context.sdpAnswer="",this.context.previousSdpAnswerAsString="",this.logAndThrow("Error occurred while trying to decompress the SDP answer.")),this.context.logger.info(`Decompressed the SDP message from ${o.compressedSdpAnswer.length} to ${l.length} bytes.`),this.context.sdpAnswer=l):this.context.sdpAnswer=o.sdpAnswer,this.context.previousSdpAnswerAsString=this.context.sdpAnswer,this.context.videoStreamIndex.integrateSubscribeAckFrame(o)})}fixUpSubscriptionOrder(e,t){if(void 0===this.context.transceiverController.getMidForStreamId)return t;let i=new Map;for(let e of t){let t=this.context.transceiverController.getMidForStreamId(e);if(void 0===t){0!==e&&this.logger.warn(`Could not find MID for stream ID: ${e}`);continue}i.set(t,e)}let n=new a.default(e).mediaSections(),r=[];for(let e of n)if("video"===e.mediaType){if("recvonly"===e.direction){let t=i.get(e.mid);if(void 0===t){this.logger.warn(`Could not find stream ID for MID: ${e.mid}`);continue}r.push(t)}else r.push(0)}return this.logger.info(`Fixed up ${JSON.stringify(t)} to ${JSON.stringify(r)} (may be same))}`),r}receiveSubscribeAck(){return new Promise((e,t)=>{let i=this.context;class n{constructor(e){this.signalingClient=e}cancel(){this.signalingClient.removeObserver(this),t(Error("SubscribeAndReceiveSubscribeAckTask got canceled while waiting for SdkSubscribeAckFrame"))}handleSignalingClientEvent(t){if(t.isConnectionTerminated()){let e=`SubscribeAndReceiveSubscribeAckTask connection was terminated with code ${t.closeCode} and reason: ${t.closeReason}`;i.logger.warn(e);let n=o.default.TaskFailed;t.closeCode>=4500&&t.closeCode<4600&&(n=o.default.SignalingInternalServerError),i.audioVideoController.handleMeetingSessionStatus(new s.default(n),Error(e));return}t.type===u.default.ReceivedSignalFrame&&t.message.type===h.SdkSignalFrame.Type.SUBSCRIBE_ACK&&(this.signalingClient.removeObserver(this),e(t.message.suback))}}let r=new n(this.context.signalingClient);this.context.signalingClient.registerObserver(r),this.taskCanceler=r})}}t.default=m},28850:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.IDLE="IDLE",e.RUNNING="RUNNING",e.CANCELED="CANCELED",e.FINISHED="FINISHED"}(i||(i={})),t.default=i},30296:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=r(i(44307)),o=r(i(49288));class a extends o.default{constructor(e,t,i){super(e),this.taskToRunBeforeTimeout=t,this.timeoutMs=i,this.taskName=`Timeout${this.timeoutMs}ms`,t.setParent(this)}cancel(){this.logger.info(`canceling timeout task ${this.name()} subtask ${this.taskToRunBeforeTimeout}`),this.taskToRunBeforeTimeout.cancel()}run(){return n(this,void 0,void 0,function*(){let e=new s.default(this.timeoutMs);e.start(()=>{this.logger.info(`timeout reached for task ${this.name()}`),this.taskToRunBeforeTimeout.cancel()});try{yield this.taskToRunBeforeTimeout.run()}finally{e.stop()}this.logger.info(`timeout task ${this.name()} completed`)})}}t.default=a},27737:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=r(i(8056)),o=r(i(49288));class a extends o.default{constructor(e){super(e.logger),this.context=e,this.taskName="WaitForAttendeePresenceTask"}cancel(){if(this.cancelPromise){let e=Error(`canceling ${this.name()} due to the meeting status code: ${s.default.NoAttendeePresent}`);this.cancelPromise(e),delete this.cancelPromise}}run(){return n(this,void 0,void 0,function*(){let e=this.context.meetingSessionConfiguration.credentials.attendeeId;return new Promise((t,i)=>{let n=(i,r,s,o,a)=>{e===i&&r&&(this.context.realtimeController.realtimeUnsubscribeToAttendeeIdPresence(n),t(),delete this.cancelPromise)};this.cancelPromise=e=>{this.context.realtimeController.realtimeUnsubscribeToAttendeeIdPresence(n),i(e)},this.context.realtimeController.realtimeSubscribeToAttendeeIdPresence(n)})})}}t.default=a},33301:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=r(i(96665)),o=r(i(54281)),a=r(i(91687)),l=r(i(2026)),d=r(i(45619));class u{constructor(e,t,i){this.logger=e,this.browserBehavior=t,this.meetingSessionContext=i,this._localCameraTransceiver=null,this._localAudioTransceiver=null,this.videoSubscriptions=[],this.defaultMediaStream=null,this.peer=null,this.streamIdToTransceiver=new Map,this.groupIdToTransceiver=new Map,this.audioRedWorker=null,this.audioRedWorkerURL=null,this.audioMetricsHistory=[],this.redMetricsObservers=new Set,this.currentNumRedundantEncodings=0,this.lastRedHolddownTimerStartTimestampMs=0,this.lastHighPacketLossEventTimestampMs=0,this.lastAudioRedTurnOffTimestampMs=0,this.maxAudioMetricsHistory=20,this.audioRedPacketLossShortEvalPeriodMs=5e3,this.audioRedPacketLossLongEvalPeriodMs=15e3,this.audioRedHoldDownTimeMs=3e5,this.redRecoveryTimeMs=6e4}setEncodingParameters(e){return n(this,void 0,void 0,function*(){if(!this._localCameraTransceiver||"sendrecv"!==this._localCameraTransceiver.direction)return;let t=this._localCameraTransceiver.sender;if(!e||0===e.size)return;let i=Array.from(e.values()),n=t.getParameters();if(n.encodings&&0!==n.encodings.length)for(let e of n.encodings)for(let t of i){let i;if(!e.rid&&!t.rid||e.rid===t.rid)for(i in t)"rid"!==i&&"codecPayloadType"!==i&&t.hasOwnProperty(i)&&(e[i]=t[i])}else n.encodings=i;yield t.setParameters(n)})}localAudioTransceiver(){return this._localAudioTransceiver}localVideoTransceiver(){return this._localCameraTransceiver}setVideoSendingBitrateKbps(e){return n(this,void 0,void 0,function*(){if(!this._localCameraTransceiver||"sendrecv"!==this._localCameraTransceiver.direction)return;let t=this._localCameraTransceiver.sender;if(!t||e<=0)return;let i=t.getParameters();for(let t of(i.encodings||(i.encodings=[{}]),i.encodings))t.maxBitrate=1e3*e;yield t.setParameters(i)})}setPeer(e){this.peer=e}reset(){this.destroyAudioRedWorkerAndStates(),this._localCameraTransceiver=null,this._localAudioTransceiver=null,this.videoSubscriptions=[],this.defaultMediaStream=null,this.peer=null}useTransceivers(){return!!this.peer&&void 0!==this.peer.getTransceivers}hasVideoInput(){return!!this._localCameraTransceiver&&"sendrecv"===this._localCameraTransceiver.direction}trackIsVideoInput(e){return!!this._localCameraTransceiver&&(e===this._localCameraTransceiver.sender.track||e===this._localCameraTransceiver.receiver.track)}setupLocalTransceivers(){var e,t;this.useTransceivers()&&(this.defaultMediaStream||"undefined"==typeof MediaStream||(this.defaultMediaStream=new MediaStream),!this._localAudioTransceiver&&(this._localAudioTransceiver=this.peer.addTransceiver("audio",{direction:"inactive",streams:[this.defaultMediaStream]}),(null===(t=null===(e=this.meetingSessionContext)||void 0===e?void 0:e.audioProfile)||void 0===t?void 0:t.hasRedundancyEnabled())&&this.setupAudioRedWorker()),this._localCameraTransceiver||(this._localCameraTransceiver=this.addTransceiver("video",{direction:"inactive",streams:[this.defaultMediaStream]})))}replaceAudioTrack(e){return n(this,void 0,void 0,function*(){return this._localAudioTransceiver&&"sendrecv"===this._localAudioTransceiver.direction?(yield this._localAudioTransceiver.sender.replaceTrack(e),!0):(this.logger.info("audio transceiver direction is not set up or not activated"),!1)})}setAudioInput(e){return n(this,void 0,void 0,function*(){yield this.setTransceiverInput(this._localAudioTransceiver,e)})}setVideoInput(e){return n(this,void 0,void 0,function*(){yield this.setTransceiverInput(this._localCameraTransceiver,e)})}updateVideoTransceivers(e,t){if(!this.useTransceivers())return t.array();let i=this.peer.getTransceivers();return this.videoSubscriptions=[0],t=t.clone(),this.updateTransceivers(i,e,t),this.logger.debug(()=>this.debugDumpTransceivers()),this.videoSubscriptions}updateTransceivers(e,t,i){let n=i.array();for(let i of(0===e.length||e[0].stop?0!==e.length&&this.updateTransceiverWithStop(e,t,n):(this.logger.info("Updating transceivers without `stop` function"),this.updateTransceiverWithoutStop(e,t,n)),n)){let e=this.addTransceiver("video",{direction:"recvonly",streams:[new MediaStream]});this.streamIdToTransceiver.set(i,e),this.groupIdToTransceiver.set(t.groupIdForStreamId(i),e),this.videoSubscriptions.push(i),this.logger.info(`adding transceiver mid: ${e.mid} subscription: ${i} direction: recvonly`)}}updateTransceiverWithStop(e,t,i){let n=1;for(let r of(this.videoSubscriptions=[0],e)){if(r===this._localCameraTransceiver||!this.transceiverIsVideo(r)||!r.mid)continue;let e=!1,s=t.streamIdForTrack("v_"+r.mid);if("inactive"!==r.direction&&void 0!==s){for(let[o,a]of i.entries())if(t.StreamIdsInSameGroup(s,a)){r.direction="recvonly",this.videoSubscriptions[n]=a,e=!0,this.streamIdToTransceiver.delete(s),this.streamIdToTransceiver.set(a,r),i.splice(o,1);break}}if(!e)for(let[e,i]of(this.videoSubscriptions[n]=0,this.logger.info(`Stopping MID: ${r.mid}, direction: ${r.direction}, current direction: ${r.currentDirection}`),r.stop(),this.streamIdToTransceiver.entries()))r.mid===i.mid&&(this.streamIdToTransceiver.delete(e),this.groupIdToTransceiver.delete(t.groupIdForStreamId(e)));n+=1}}updateTransceiverWithoutStop(e,t,i){let n=1;for(let r of e)if(r!==this._localCameraTransceiver&&this.transceiverIsVideo(r)){if(this.videoSubscriptions[n]=0,"inactive"!==r.direction){let e=t.streamIdForTrack("v_"+r.mid);if(void 0!==e){for(let[s,o]of i.entries())if(t.StreamIdsInSameGroup(e,o)){r.direction="recvonly",this.videoSubscriptions[n]=o,this.streamIdToTransceiver.delete(e),this.streamIdToTransceiver.set(o,r),i.splice(s,1);break}}}n+=1}for(let r of(n=1,e))if(r!==this._localCameraTransceiver&&this.transceiverIsVideo(r)){if("inactive"===r.direction&&i.length>0){r.direction="recvonly";let e=i.shift();this.videoSubscriptions[n]=e,this.streamIdToTransceiver.set(e,r),this.groupIdToTransceiver.set(t.groupIdForStreamId(e),r)}else if(0===this.videoSubscriptions[n])for(let[e,i]of(r.direction="inactive",this.streamIdToTransceiver.entries()))r===i&&(this.streamIdToTransceiver.delete(e),this.groupIdToTransceiver.delete(t.groupIdForStreamId(e)));n+=1}}getMidForStreamId(e){var t;return null===(t=this.streamIdToTransceiver.get(e))||void 0===t?void 0:t.mid}setStreamIdForMid(e,t){for(let[i,n]of this.streamIdToTransceiver.entries())if(n.mid===e){this.streamIdToTransceiver.delete(i),this.streamIdToTransceiver.set(t,n);return}}getMidForGroupId(e){var t;return null===(t=this.groupIdToTransceiver.get(e))||void 0===t?void 0:t.mid}transceiverIsVideo(e){return e.receiver&&e.receiver.track&&"video"===e.receiver.track.kind||e.sender&&e.sender.track&&"video"===e.sender.track.kind}debugDumpTransceivers(){let e="",t=0;for(let i of this.peer.getTransceivers())this.transceiverIsVideo(i)&&(e+=`transceiver index=${t} mid=${i.mid} subscription=${this.videoSubscriptions[t]} direction=${i.direction}
`,t+=1);return e}setTransceiverInput(e,t){return n(this,void 0,void 0,function*(){e&&(t?e.direction="sendrecv":e.direction="inactive",yield e.sender.replaceTrack(t))})}forEachRedMetricsObserver(e){for(let t of this.redMetricsObservers)d.default.nextTick(()=>{this.redMetricsObservers.has(t)&&t.recoveryMetricsDidReceive(e)})}disableAudioRedundancy(){this.meetingSessionContext.audioProfile=new s.default(this.meetingSessionContext.audioProfile.audioBitrateBps,!1),this.meetingSessionContext.audioVideoController.setAudioProfile(this.meetingSessionContext.audioProfile)}setupAudioRedWorker(){var e,t;let i=!!window.RTCRtpScriptTransform,n=!!RTCRtpSender.prototype.createEncodedStreams;if(i)this.logger.info("[AudioRed] Supports encoded insertable streams using RTCRtpScriptTransform");else if(n)this.logger.info("[AudioRed] Supports encoded insertable streams using TransformStream");else throw this.disableAudioRedundancy(),Error("[AudioRed] Encoded insertable streams not supported. Recreating peer connection with audio redundancy disabled.");try{this.audioRedWorkerURL=URL.createObjectURL(new Blob([l.default],{type:"application/javascript"})),this.logger.info(`[AudioRed] Redundant audio worker URL ${this.audioRedWorkerURL}`),this.audioRedWorker=new Worker(this.audioRedWorkerURL)}catch(e){throw this.logger.error(`[AudioRed] Unable to create audio red worker due to ${e}`),URL.revokeObjectURL(this.audioRedWorkerURL),this.audioRedWorkerURL=null,this.audioRedWorker=null,this.disableAudioRedundancy(),this.logger.info("[AudioRed] Recreating peer connection with audio redundancy disabled"),e}if(this.audioRedEnabled=!0,this.audioRedWorker.onmessage=e=>{if("REDWorkerLog"===e.data.type)this.logger.info(e.data.log);else if("RedundantAudioEncoderStats"===e.data.type){let t=new o.default;t.currentTimestampMs=Date.now(),t.ssrc=e.data.ssrc,t.totalAudioPacketsLost=e.data.totalAudioPacketsLost,t.totalAudioPacketsExpected=e.data.totalAudioPacketsExpected,t.totalAudioPacketsRecoveredRed=e.data.totalAudioPacketsRecoveredRed,t.totalAudioPacketsRecoveredFec=e.data.totalAudioPacketsRecoveredFec,this.forEachRedMetricsObserver(t)}},i)this._localAudioTransceiver.sender.transform=new RTCRtpScriptTransform(this.audioRedWorker,{type:"SenderTransform"}),this._localAudioTransceiver.receiver.transform=new RTCRtpScriptTransform(this.audioRedWorker,{type:"ReceiverTransform"});else if(n){let e=this._localAudioTransceiver.sender.createEncodedStreams(),t=this._localAudioTransceiver.receiver.createEncodedStreams();this.audioRedWorker.postMessage({msgType:"StartRedWorker",send:e,receive:t},[e.readable,e.writable,t.readable,t.writable])}null===(e=this.meetingSessionContext)||void 0===e||e.audioVideoController.addObserver(this),this.addRedundantAudioRecoveryMetricsObserver(null===(t=this.meetingSessionContext)||void 0===t?void 0:t.statsCollector)}addTransceiver(e,t){var i;let n=this.peer.addTransceiver(e,t);if(!(null===(i=this.peer.getConfiguration())||void 0===i?void 0:i.encodedInsertableStreams)||!this.audioRedWorker)return n;let r=!!window.RTCRtpScriptTransform,s=!!RTCRtpSender.prototype.createEncodedStreams;if(r)n.sender.transform=new RTCRtpScriptTransform(this.audioRedWorker,{type:"PassthroughTransform"}),n.receiver.transform=new RTCRtpScriptTransform(this.audioRedWorker,{type:"PassthroughTransform"});else if(s){let e=n.sender.createEncodedStreams(),t=n.receiver.createEncodedStreams();this.audioRedWorker.postMessage({msgType:"PassthroughTransform",send:e,receive:t},[e.readable,e.writable,t.readable,t.writable])}return n}destroyAudioRedWorkerAndStates(){var e,t;this.audioRedWorker&&(URL.revokeObjectURL(this.audioRedWorkerURL),this.audioRedWorkerURL=null,this.audioRedWorker=null,this.currentNumRedundantEncodings=0,this.lastRedHolddownTimerStartTimestampMs=0,this.lastAudioRedTurnOffTimestampMs=0,this.lastHighPacketLossEventTimestampMs=0,this.audioRedEnabled=!0,null===(e=this.meetingSessionContext)||void 0===e||e.audioVideoController.removeObserver(this),this.removeRedundantAudioRecoveryMetricsObserver(null===(t=this.meetingSessionContext)||void 0===t?void 0:t.statsCollector))}setAudioPayloadTypes(e){this.audioRedWorker&&(this.audioRedWorker.postMessage({msgType:"RedPayloadType",payloadType:e.get("red")}),this.audioRedWorker.postMessage({msgType:"OpusPayloadType",payloadType:e.get("opus")}))}metricsDidReceive(e){let{currentTimestampMs:t}=e,i=e.getRTCStatsReport(),n=0,r=0,s=0;i.forEach(e=>{"audio"===e.kind&&("outbound-rtp"===e.type?r=e.packetsSent:"remote-inbound-rtp"===e.type&&(n=e.timestamp,s=e.packetsLost))}),(0===this.audioMetricsHistory.length||n>this.audioMetricsHistory[this.audioMetricsHistory.length-1].timestampMs&&r>this.audioMetricsHistory[this.audioMetricsHistory.length-1].totalPacketsSent)&&this.audioMetricsHistory.push({timestampMs:n,totalPacketsSent:r,totalPacketsLost:s}),this.audioMetricsHistory.length>this.maxAudioMetricsHistory&&this.audioMetricsHistory.shift();let o=Math.max(this.lossPercent(this.audioRedPacketLossShortEvalPeriodMs),this.lossPercent(this.audioRedPacketLossLongEvalPeriodMs)),[l,d]=a.default.getNumRedundantEncodingsForPacketLoss(o);if(d){this.lastHighPacketLossEventTimestampMs=t,this.audioRedEnabled&&(this.audioRedWorker&&this.audioRedWorker.postMessage({msgType:"Disable"}),this.audioRedEnabled=!1,this.lastAudioRedTurnOffTimestampMs=t);return}if(!this.audioRedEnabled){let e=t-this.lastAudioRedTurnOffTimestampMs,i=t-this.lastHighPacketLossEventTimestampMs;if(e>=this.audioRedPacketLossLongEvalPeriodMs&&i<this.redRecoveryTimeMs)return;this.audioRedWorker&&this.audioRedWorker.postMessage({msgType:"Enable"}),this.audioRedEnabled=!0,this.maybeResetHoldDownTimer(t)}this.shouldUpdateAudioRedWorkerEncodings(t,l)&&this.audioRedWorker&&this.audioRedWorker.postMessage({msgType:"UpdateNumRedundantEncodings",numRedundantEncodings:l})}maybeResetHoldDownTimer(e){this.currentNumRedundantEncodings>0&&(this.lastRedHolddownTimerStartTimestampMs=e)}lossPercent(e){if(this.audioMetricsHistory.length<2)return 0;let t=this.audioMetricsHistory[this.audioMetricsHistory.length-1].timestampMs,i=this.audioMetricsHistory[this.audioMetricsHistory.length-1].totalPacketsSent,n=this.audioMetricsHistory[this.audioMetricsHistory.length-1].totalPacketsLost;for(let r=this.audioMetricsHistory.length-2;r>=0;r--)if(t-this.audioMetricsHistory[r].timestampMs>=e)return Math.max(0,Math.min((n-this.audioMetricsHistory[r].totalPacketsLost)/(i-this.audioMetricsHistory[r].totalPacketsSent)*100,100));return 0}shouldUpdateAudioRedWorkerEncodings(e,t){return this.currentNumRedundantEncodings===t?(this.maybeResetHoldDownTimer(e),!1):(!(t<this.currentNumRedundantEncodings)||!(e-this.lastRedHolddownTimerStartTimestampMs<this.audioRedHoldDownTimeMs))&&(this.currentNumRedundantEncodings=t,this.maybeResetHoldDownTimer(e),!0)}addRedundantAudioRecoveryMetricsObserver(e){this.redMetricsObservers.add(e)}removeRedundantAudioRecoveryMetricsObserver(e){this.redMetricsObservers.delete(e)}}t.default=u},1529:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=r(i(14055));class o extends s.default{constructor(e,t,i){super(e,t,i);let n=2;this.videoQualityControlParameterMap=new Map;for(let e=0;e<o.NAME_ARR_ASCENDING.length;e++){let t=o.NAME_ARR_ASCENDING[e];this.videoQualityControlParameterMap.set(t,{rid:t,scaleResolutionDownBy:n,maxBitrate:1e3*o.BITRATE_ARR_ASCENDING[e]}),n/=2}}setEncodingParameters(e){return n(this,void 0,void 0,function*(){if(!this._localCameraTransceiver||"sendrecv"!==this._localCameraTransceiver.direction)return;let t=this._localCameraTransceiver.sender,i=Array.from(e.values());if(i.length<=0)return;let n=t.getParameters();if(n.encodings)for(let t=0;t<n.encodings.length;t++)n.encodings[t].rid===s.default.LOW_LEVEL_NAME&&this.copyEncodingParams(e.get(s.default.LOW_LEVEL_NAME),n.encodings[t]),n.encodings[t].rid===s.default.HIGH_LEVEL_NAME&&this.copyEncodingParams(e.get(s.default.HIGH_LEVEL_NAME),n.encodings[t]);else n.encodings=i;yield t.setParameters(n),this.logVideoTransceiverParameters()})}}t.default=o,o.NAME_ARR_ASCENDING=["low","hi"],o.BITRATE_ARR_ASCENDING=[300,1200]},14055:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=r(i(33301));class o extends s.default{constructor(e,t,i){super(e,t,i),this.videoQualityControlParameterMap=new Map;let n=4;for(let e=0;e<o.NAME_ARR_ASCENDING.length;e++){let t=o.NAME_ARR_ASCENDING[e];this.videoQualityControlParameterMap.set(t,{rid:t,scaleResolutionDownBy:n,maxBitrate:1e3*o.BITRATE_ARR_ASCENDING[e]}),n/=2}}setEncodingParameters(e){return n(this,void 0,void 0,function*(){if(!this._localCameraTransceiver||"sendrecv"!==this._localCameraTransceiver.direction)return;let t=this._localCameraTransceiver.sender,i=Array.from(e.values());if(i.length<=0)return;let n=t.getParameters();if(n.encodings)for(let t of n.encodings)t.rid===o.LOW_LEVEL_NAME&&this.copyEncodingParams(e.get(o.LOW_LEVEL_NAME),t),t.rid===o.MID_LEVEL_NAME&&this.copyEncodingParams(e.get(o.MID_LEVEL_NAME),t),t.rid===o.HIGH_LEVEL_NAME&&this.copyEncodingParams(e.get(o.HIGH_LEVEL_NAME),t);else n.encodings=i;yield t.setParameters(n),this.logVideoTransceiverParameters()})}setVideoSendingBitrateKbps(e){return n(this,void 0,void 0,function*(){})}setupLocalTransceivers(){var e,t;if(this.useTransceivers()&&(this.defaultMediaStream||"undefined"==typeof MediaStream||(this.defaultMediaStream=new MediaStream),!this._localAudioTransceiver&&(this._localAudioTransceiver=this.peer.addTransceiver("audio",{direction:"inactive",streams:[this.defaultMediaStream]}),(null===(t=null===(e=this.meetingSessionContext)||void 0===e?void 0:e.audioProfile)||void 0===t?void 0:t.hasRedundancyEnabled())&&this.setupAudioRedWorker()),!this._localCameraTransceiver)){let e=Array.from(this.videoQualityControlParameterMap.values());this._localCameraTransceiver=this.addTransceiver("video",{direction:"inactive",streams:[this.defaultMediaStream],sendEncodings:e})}}logVideoTransceiverParameters(){let e=this._localCameraTransceiver.sender.getParameters().encodings,t="simulcast: current encoding parameters \n";for(let i of e)t+=`rid=${i.rid} maxBitrate=${i.maxBitrate} active=${i.active} scaleDownBy=${i.scaleResolutionDownBy} maxFrameRate = ${i.maxFramerate} 
`;this.logger.info(t)}copyEncodingParams(e,t){t.active=e.active,t.maxBitrate=e.maxBitrate,t.scaleResolutionDownBy=e.scaleResolutionDownBy,t.maxFramerate=e.maxFramerate}}t.default=o,o.LOW_LEVEL_NAME="low",o.MID_LEVEL_NAME="mid",o.HIGH_LEVEL_NAME="hi",o.NAME_ARR_ASCENDING=["low","mid","hi"],o.BITRATE_ARR_ASCENDING=[200,400,1100]},31288:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let r=n(i(33301));class s extends r.default{constructor(e,t,i){super(e,t,i)}setupLocalTransceivers(){this.useTransceivers()&&(this.defaultMediaStream||"undefined"==typeof MediaStream||(this.defaultMediaStream=new MediaStream),this._localCameraTransceiver||(this._localCameraTransceiver=this.peer.addTransceiver("video",{direction:"inactive",streams:[this.defaultMediaStream]})))}}t.default=s},25094:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TRANSCRIPTION_DATA_MESSAGE_TOPIC=void 0;let n=i(18389);t.TRANSCRIPTION_DATA_MESSAGE_TOPIC="aws:chime:transcription";class r{constructor(e){this.realtimeController=e,this.transcriptEventCallbacks=new Set}subscribeToTranscriptEvent(e){0===this.transcriptEventCallbacks.size&&this.realtimeController.realtimeSubscribeToReceiveDataMessage(t.TRANSCRIPTION_DATA_MESSAGE_TOPIC,e=>{for(let t of n.TranscriptEventConverter.from(e))for(let e of this.transcriptEventCallbacks)e(t)}),this.transcriptEventCallbacks.add(e)}unsubscribeFromTranscriptEvent(e){this.transcriptEventCallbacks.delete(e),0===this.transcriptEventCallbacks.size&&this.realtimeController.realtimeUnsubscribeFromReceiveDataMessage(t.TRANSCRIPTION_DATA_MESSAGE_TOPIC)}}t.default=r},99550:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{}t.default=i},47105:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{}t.default=i},33396:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{}t.default=i},18389:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.TranscriptEventConverter=void 0;let r=i(39163),s=n(i(99550)),o=n(i(60639)),a=n(i(43945)),l=n(i(20905)),d={[r.SdkTranscriptionStatus.Type.STARTED]:a.default.STARTED,[r.SdkTranscriptionStatus.Type.INTERRUPTED]:a.default.INTERRUPTED,[r.SdkTranscriptionStatus.Type.RESUMED]:a.default.RESUMED,[r.SdkTranscriptionStatus.Type.STOPPED]:a.default.STOPPED,[r.SdkTranscriptionStatus.Type.FAILED]:a.default.FAILED};class u{static from(e){let t;try{t=r.SdkTranscriptFrame.decode(e.data)}catch(e){throw Error("Cannot decode transcript data message: "+e)}let i=[];for(let e of t.events)if(e.status){let t=d[e.status.type];if(!t)continue;let n=new o.default;n.type=t,n.eventTimeMs=e.status.eventTime,n.transcriptionRegion=e.status.transcriptionRegion,n.transcriptionConfiguration=e.status.transcriptionConfiguration,e.status.message&&(n.message=e.status.message),i.push(n)}else if(e.transcript){let t=new s.default;for(let i of(t.results=[],e.transcript.results)){let e={channelId:i.channelId,isPartial:i.isPartial,resultId:i.resultId,startTimeMs:i.startTime,endTimeMs:i.endTime,alternatives:[]};if(i.languageCode&&(e.languageCode=i.languageCode),i.languageIdentification&&i.languageIdentification.length>0)for(let t of(e.languageIdentification=[],i.languageIdentification)){let i={languageCode:t.languageCode,score:t.score};e.languageIdentification.push(i)}for(let t of i.alternatives){let i={items:[],transcript:t.transcript};for(let e of t.items){let t={content:e.content,attendee:{attendeeId:e.speakerAttendeeId,externalUserId:e.speakerExternalUserId},startTimeMs:e.startTime,endTimeMs:e.endTime,type:null};switch(e.vocabularyFilterMatch&&(t.vocabularyFilterMatch=e.vocabularyFilterMatch),e.hasOwnProperty("stable")&&(t.stable=e.stable),e.hasOwnProperty("confidence")&&(t.confidence=e.confidence),e.type){case r.SdkTranscriptItem.Type.PRONUNCIATION:t.type=l.default.PRONUNCIATION;break;case r.SdkTranscriptItem.Type.PUNCTUATION:t.type=l.default.PUNCTUATION}i.items.push(t)}for(let e of t.entities){i.entities||(i.entities=[]);let t={category:e.category,confidence:e.confidence,content:e.content,startTimeMs:e.startTime,endTimeMs:e.endTime};e.type&&(t.type=e.type),i.entities.push(t)}e.alternatives.push(i)}t.results.push(e)}i.push(t)}return i}}t.TranscriptEventConverter=u},24065:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{}t.default=i},20905:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.PRONUNCIATION="pronunciation",e.PUNCTUATION="punctuation"}(i||(i={})),t.default=i},12567:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{}t.default=i},90035:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{}t.default=i},60639:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{}t.default=i},43945:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.STARTED="started",e.INTERRUPTED="interrupted",e.RESUMED="resumed",e.STOPPED="stopped",e.FAILED="failed"}(i||(i={})),t.default=i},48013:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let r=i(26088),s=n(i(29505));class o{constructor(e){var t,i,n,s,a,l,d;try{this.parserResult=navigator&&navigator.userAgent?new r.UAParser(navigator.userAgent).getResult():void 0}catch(t){e.error(t.message)}this.browserMajorVersion=(null===(n=null===(i=null===(t=this.parserResult)||void 0===t?void 0:t.browser)||void 0===i?void 0:i.version)||void 0===n?void 0:n.split(".")[0])||o.UNAVAILABLE,this.browserName=(null===(s=this.parserResult)||void 0===s?void 0:s.browser.name)||o.UNAVAILABLE,this.browserVersion=(null===(a=this.parserResult)||void 0===a?void 0:a.browser.version)||o.UNAVAILABLE,this.deviceName=[(null===(l=this.parserResult)||void 0===l?void 0:l.device.vendor)||"",(null===(d=this.parserResult)||void 0===d?void 0:d.device.model)||""].join(" ").trim()||o.UNAVAILABLE}getParserResult(){var e,t;return{browserMajorVersion:this.browserMajorVersion,browserName:this.browserName,browserVersion:this.browserVersion,deviceName:this.deviceName,osName:(null===(e=this.parserResult)||void 0===e?void 0:e.os.name)||o.UNAVAILABLE,osVersion:(null===(t=this.parserResult)||void 0===t?void 0:t.os.version)||o.UNAVAILABLE,sdkVersion:s.default.sdkVersion,sdkName:s.default.sdkName}}}t.default=o,o.UNAVAILABLE="Unavailable"},33137:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(){this.queue=Promise.resolve()}add(e){return new Promise((t,i)=>{this.queue=this.queue.then(e).then(t).catch(i)})}}t.default=i},71906:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.None=t.Some=t.Maybe=void 0;class i{static of(e){return null==e?r.of():n.of(e)}}t.Maybe=i;class n{constructor(e){this.value=e,this.isSome=!0,this.isNone=!1}map(e){return i.of(e(this.value))}flatMap(e){return e(this.value)}get(){return this.value}getOrElse(e){return this.value}defaulting(e){return i.of(this.getOrElse(e))}static of(e){if(null==e)throw Error("value is ${value}");return new n(e)}}t.Some=n;class r{constructor(){this.isSome=!1,this.isNone=!0}get(){throw Error("value is null")}getOrElse(e){return e}map(e){return new r}flatMap(e){return new r}defaulting(e){return i.of(this.getOrElse(e))}static of(){return new r}}t.None=r},17201:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getRandomValues=t.getFormattedOffset=t.getDefaultAssetSpec=t.toLowerCasePropertyNames=t.isIFramed=t.wait=void 0;let r=n(i(29505));function s(e){return new Promise(t=>setTimeout(t,e))}function o(){var e;try{return(null===(e=window.frameElement)||void 0===e?void 0:e.nodeName)==="IFRAME"||parent!==top}catch(e){return!0}}function a(e){return null===e?null:"object"!=typeof e?e:Array.isArray(e)?e.map(a):Object.keys(e).reduce((t,i)=>{let n=e[i],r="object"==typeof n?a(n):n;return t[i.toLowerCase()]=r,t},{})}function l(){let e=r.default.sdkVersionSemVer;return{assetGroup:`sdk-${e.major}.${e.minor}`}}function d(e){let t=Math.abs(e),i=e<=0?"+":"-",n=Math.floor(t/60).toString().padStart(2,"0"),r=Math.floor(t%60).toString().padStart(2,"0");return`${i}${n}:${r}`}function u(e){try{window.crypto.getRandomValues(e)}catch(t){new DataView(e.buffer).setUint32(0,Math.trunc(4294967296*Math.random()),!0)}}t.wait=s,t.isIFramed=o,t.toLowerCasePropertyNames=a,t.getDefaultAssetSpec=l,t.getFormattedOffset=d,t.getRandomValues=u},29505:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let r=n(i(81341)),s=n(i(55527));class o{static get sdkName(){return"amazon-chime-sdk-js"}static get sdkVersion(){return s.default.semverString}static get sdkVersionSemVer(){var e,t,i,n;let r=s.default.semverString.match(/^(?<major>[0-9]+)\.(?<minor>[0-9]+)((?:\.(?<patch>[0-9]+))(?:-(?<preRelease>[a-zA-Z]+(\.[0-9])*))?)?/);return{major:null===(e=null==r?void 0:r.groups)||void 0===e?void 0:e.major,minor:null===(t=null==r?void 0:r.groups)||void 0===t?void 0:t.minor,patch:null===(i=null==r?void 0:r.groups)||void 0===i?void 0:i.patch,preRelease:null===(n=null==r?void 0:r.groups)||void 0===n?void 0:n.preRelease}}static get buildSHA(){return s.default.hash.substr(1)}static get sdkUserAgentLowResolution(){let e=new r.default;return`${e.name()}-${e.majorVersion()}`}static urlWithVersion(e){let t=new URL(e);return t.searchParams.append(o.X_AMZN_VERSION,o.sdkVersion),t.searchParams.append(o.X_AMZN_USER_AGENT,o.sdkUserAgentLowResolution),t.toString()}}t.default=o,o.X_AMZN_VERSION="X-Amzn-Version",o.X_AMZN_USER_AGENT="X-Amzn-User-Agent"},55527:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={hash:"9158963",raw:"v3.21.1",semverString:"3.21.1"}},48786:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(e,t,i,n,r,s=1,o=!1){this.cameraWidth=e,this.cameraHeight=t,this.cameraFrameRate=i,this.maxEncodeBitrateKbps=n,this.isSimulcast=r,this.scaleResolutionDownBy=s,this.isSVC=o}equal(e){let t=e.captureWidth()===this.cameraWidth&&e.captureHeight()===this.cameraHeight&&e.captureFrameRate()===this.cameraFrameRate&&e.encodeBitrates().length===this.encodeBitrates().length&&e.encodeScaleResolutionDownBy().length===this.encodeScaleResolutionDownBy().length&&e.encodeWidths().length===this.encodeWidths().length&&e.encodeHeights().length===this.encodeHeights().length&&e.isSVCEncoding()===this.isSVC;if(t){for(let i=0;i<e.encodeWidths().length;i++)if(e.encodeWidths()[i]!==this.encodeWidths()[i]||e.encodeHeights()[i]!==this.encodeHeights()[i]||e.encodeBitrates()[i]!==this.encodeBitrates()[i]||e.encodeScaleResolutionDownBy()[i]!==this.encodeScaleResolutionDownBy()[i]){t=!1;break}}return t}clone(){return new i(this.cameraWidth,this.cameraHeight,this.cameraFrameRate,this.maxEncodeBitrateKbps,this.isSimulcast,this.scaleResolutionDownBy,this.isSVC)}captureWidth(){return this.cameraWidth}captureHeight(){return this.cameraHeight}captureFrameRate(){return this.cameraFrameRate}encodeBitrates(){return[this.maxEncodeBitrateKbps]}encodeScaleResolutionDownBy(){return[this.scaleResolutionDownBy]}encodeWidths(){return[this.cameraWidth]}encodeHeights(){return[this.cameraHeight]}isSVCEncoding(){return this.isSVC}}t.default=i},12019:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let r=n(i(47569));class s{constructor(e){this.selfAttendeeId=e,this.reset()}reset(){this.optimalReceiveSet=new r.default,this.subscribedReceiveSet=new r.default,this.videoSources=void 0}updateIndex(e){this.videoIndex=e,this.optimalReceiveSet=this.calculateOptimalReceiveSet(e)}updateMetrics(e){}wantsResubscribe(){return!this.subscribedReceiveSet.equal(this.optimalReceiveSet)}chooseSubscriptions(){return this.subscribedReceiveSet=this.optimalReceiveSet.clone(),this.subscribedReceiveSet.clone()}chooseRemoteVideoSources(e){this.videoSources=e,this.optimalReceiveSet=this.calculateOptimalReceiveSet(this.videoIndex).clone()}calculateOptimalReceiveSet(e){let t=new r.default;if(!this.videoIndex||this.videoIndex.allStreams().empty())return t;let i=e.highestQualityStreamFromEachGroupExcludingSelf(this.selfAttendeeId),n=this.videoSources?this.videoSources:this.videoIndex.allVideoSendingSourcesExcludingSelf(this.selfAttendeeId),o=this.videoIndex.remoteStreamDescriptions(),a=new Map;for(let e of o)i.contain(e.streamId)&&a.set(e.attendeeId,e);let l=0;for(let e of n){let i=e.attendee.attendeeId;if(a.has(i)){let e=a.get(i);if(l+e.maxBitrateKbps<=s.maxReceiveBitrateKbps)t.add(e.streamId),l+=e.maxBitrateKbps;else{console.warn("total bitrate "+(l+e.maxBitrateKbps)+" exceeds maximum limit (15000). Use chooseRemoteVideoSources to select a subset of participants to avoid this.");break}}}return t}}t.default=s,s.maxReceiveBitrateKbps=15e3},23995:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let r=n(i(47569));class s{reset(){}updateIndex(e){}updateMetrics(e){}wantsResubscribe(){return!1}chooseSubscriptions(){return new r.default}}t.default=s},36608:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.TargetDisplaySize=void 0,function(e){e[e.Low=0]="Low",e[e.Medium=1]="Medium",e[e.High=2]="High",e[e.Maximum=3]="Maximum"}(i=t.TargetDisplaySize||(t.TargetDisplaySize={})),t.default=i},71461:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let r=n(i(11807)),s=n(i(2801)),o=i(85336),a=n(i(2962));class l extends a.default{constructor(e){super(e),this.logger=e,super.shouldPauseTiles=!1,this.videoPreferences=void 0}reset(){super.reset(),super.shouldPauseTiles=!1,this.videoPreferences=void 0}updateIndex(e){super.updateIndex(e);let t=o.VideoPreferences.prepare(),i=!1;for(let n of e.remoteStreamDescriptions())t.some(e=>e.attendeeId===n.attendeeId)||(n.attendeeId.endsWith(r.default.Modality)?(t.add(new s.default(n.attendeeId,1)),i=!0):t.add(new s.default(n.attendeeId,2)));i?(this.videoPreferences=t.build(),this.videoPreferencesUpdated=!0):this.videoPreferences=void 0}chooseRemoteVideoSources(e){this.logger.error("chooseRemoteVideoSources should not be called by VideoAdaptiveProbePolicy")}}t.default=l},2801:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let r=n(i(36608)),s=n(i(67473));class o{constructor(e,t,i,n){this.attendeeId=e,this.priority=t,this.targetSize=void 0!==i?i:r.default.Maximum,this.degradationPreference=void 0!==n?n:s.default.Balanced}partialCompare(e){return this.priority-e.priority}equals(e){return this.attendeeId===e.attendeeId&&this.targetSize===e.targetSize&&this.priority===e.priority&&this.degradationPreference===e.degradationPreference}clone(){return new o(this.attendeeId,this.priority,this.targetSize,this.degradationPreference)}targetSizeToBitrateKbps(e){switch(e){case r.default.Maximum:return o.MAXIMUM_BITRATE_KBPS;case r.default.High:return o.HIGH_BITRATE_KBPS;case r.default.Medium:return o.MID_BITRATE_KBPS;case r.default.Low:return o.LOW_BITRATE_KBPS}}}t.default=o,o.LOW_BITRATE_KBPS=300,o.MID_BITRATE_KBPS=600,o.HIGH_BITRATE_KBPS=1500,o.MAXIMUM_BITRATE_KBPS=1e4},85336:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.VideoPreferences=t.MutableVideoPreferences=t.convertVideoPreferencesToSignalingClientVideoSubscriptionConfiguration=void 0;let r=n(i(75749));function s(e,t,i){if(void 0===e.transceiverController.getMidForGroupId||void 0===e.videoStreamIndex.attendeeIdForGroupId||void 0===i)return[];let n=[],s=new Map,o=new Map;for(let i of t){let t=e.transceiverController.getMidForGroupId(i);if(void 0===t)continue;let n=e.videoStreamIndex.attendeeIdForGroupId(i);s.set(n,t),o.set(n,i)}for(let e of i){let t=new r.default,i=s.get(e.attendeeId);void 0!==i&&(t.mid=i,t.attendeeId=e.attendeeId,t.groupId=o.get(e.attendeeId),t.priority=Number.MAX_SAFE_INTEGER-e.priority,t.targetBitrateKbps=e.targetSizeToBitrateKbps(e.targetSize),t.qualityAdaptationPreference=e.degradationPreference,n.push(t))}return n}t.convertVideoPreferencesToSignalingClientVideoSubscriptionConfiguration=s;class o{constructor(e=[]){this.items=e}static default(){return new o([])}[Symbol.iterator](){let e=0,t=this.items;return{next:()=>e<t.length?{done:!1,value:t[e++]}:{done:!0,value:null}}}first(){return this.items[0]}add(e){this.items.push(e)}replaceFirst(e,t){let i=this.items.findIndex(t);-1===i?this.items.push(e):this.has(e)?this.items.splice(i,1):this.items[i]=e}remove(e){this.items=this.items.filter(t=>!t.equals(e))}clear(){this.items=[]}isEmpty(){return 0===this.items.length}equals(e){if(e===this)return!0;if(e.items.length!==this.items.length)return!1;for(let t of this.items)if(!e.items.some(e=>e.equals(t)))return!1;return!0}has(e){return this.items.some(t=>t.equals(e))}some(e){return this.items.some(e)}clone(){return new o([...this.items])}sort(){this.items.sort((e,t)=>e.partialCompare(t))}modify(){return new a(this)}}class a{constructor(e=new o){this.items=e,this.copied=!1}cow(){this.copied||(this.items=this.items.clone(),this.copied=!0)}add(e){this.items.has(e)||(this.cow(),this.items.add(e))}replaceFirst(e,t){(!this.items.has(e)||this.items.some(t))&&(this.cow(),this.items.replaceFirst(e,t))}remove(e){this.items.has(e)&&(this.cow(),this.items.remove(e))}some(e){return this.items.some(e)}clear(){this.items.isEmpty()||(this.cow(),this.items.clear())}build(){return this.copied&&this.items.sort(),this.copied=!1,this.items}}class l{constructor(e){this.builder=e}add(e){this.builder.add(e)}replaceFirst(e,t){this.builder.replaceFirst(e,t)}remove(e){this.builder.remove(e)}some(e){return this.builder.some(e)}clear(){this.builder.clear()}build(){return new d(this.builder.build())}}t.MutableVideoPreferences=l;class d{constructor(e){this.items=e}static prepare(){return new l(new a)}static default(){return new d(o.default())}[Symbol.iterator](){return this.items[Symbol.iterator]()}highestPriority(){var e;return null===(e=this.items.first())||void 0===e?void 0:e.priority}sorted(){return this.items[Symbol.iterator]()}equals(e){return e===this||this.items.equals(e.items)}modify(){return new l(this.items.modify())}some(e){return this.items.some(e)}isEmpty(){return this.items.isEmpty()}clone(){let e=d.prepare();for(let t of this.items)e.add(t.clone());return e.build()}}t.VideoPreferences=d,t.default=d},2962:function(e,t,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return r(t,e),t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let a=o(i(49717)),l=o(i(89496)),d=o(i(57192)),u=o(i(11807)),c=i(35711),h=s(i(45377)),f=o(i(35879)),p=o(i(47569)),m=o(i(12019)),g=o(i(36608)),v=o(i(2801)),b=i(85336),S=o(i(73463)),y=o(i(67473));class w{constructor(){this.bandwidthEstimateKbps=0,this.usedBandwidthKbps=0,this.packetsLost=0,this.nackCount=0,this.rttMs=0}}class C{constructor(e,t=S.default.Default){this.logger=e,this.videoPriorityBasedPolicyConfig=t,this.shouldPauseTiles=!0,this.observerQueue=new Set,this.pausedBwAttendeeIds=new Set,this.wantsResubscribeObserver=void 0,this.reset()}reset(){this.allHighestPolicy=new m.default(""),this.optimalReceiveSet=new p.default,this.optimalReceiveStreams=[],this.optimalNonPausedReceiveStreams=[],this.subscribedReceiveSet=new p.default,this.subscribedReceiveStreams=[],this.videoPreferences=void 0,this.defaultVideoPreferences=void 0,this.shouldPauseTiles=!0,this.pausedStreamIds=new p.default,this.pausedBwAttendeeIds=new Set,this.videoPreferencesUpdated=!1,this.logCount=0,this.startupPeriod=!0,this.usingPrevTargetRate=!1,this.rateProbeState="Not Probing",this.firstEstimateTimestamp=0,this.lastUpgradeRateKbps=0,this.timeBeforeAllowSubscribeMs=C.MIN_TIME_BETWEEN_SUBSCRIBE_MS,this.lastProbeTimestamp=Date.now(),this.timeBeforeAllowProbeMs=C.MIN_TIME_BETWEEN_PROBE_MS,this.downlinkStats=new w,this.prevDownlinkStats=new w,this.probeFailed=!1,this.serverSideNetworkAdaption=this.videoPriorityBasedPolicyConfig.serverSideNetworkAdaption,this.pendingActionAfterUpdatedPreferences=!1}bindToTileController(e){this.tileController=e,this.logger.info("tileController bound")}setWantsResubscribeObserver(e){this.wantsResubscribeObserver=e}chooseRemoteVideoSources(e){var t;if(null===(t=this.videoPreferences)||void 0===t||!t.equals(e)){if(this.videoPreferences=null==e?void 0:e.clone(),!h.serverSideNetworkAdaptionIsNoneOrDefault(this.serverSideNetworkAdaption)&&(this.pendingActionAfterUpdatedPreferences=!0,void 0!==this.wantsResubscribeObserver&&(this.wantsResubscribeObserver(),this.pendingActionAfterUpdatedPreferences=!1),this.serverSideNetworkAdaption===h.default.BandwidthProbingAndRemoteVideoQualityAdaption)){let e=[];for(let t of this.videoPreferences){let i=new f.default;i.attendee=new a.default,i.attendee.attendeeId=t.attendeeId,e.push(i)}this.allHighestPolicy.chooseRemoteVideoSources(e);return}this.videoPreferencesUpdated=!0,this.logger.info(`bwe: setVideoPreferences bwe: new preferences: ${JSON.stringify(e)}`)}}updateIndex(e){this.videoIndex=e,this.serverSideNetworkAdaption===h.default.BandwidthProbingAndRemoteVideoQualityAdaption&&this.allHighestPolicy.updateIndex(e),this.videoPreferences||this.updateDefaultVideoPreferences()}updateDefaultVideoPreferences(){let e=new Set;for(let t of this.videoIndex.remoteStreamDescriptions())e.add(t.attendeeId);let t=b.VideoPreferences.prepare(),i=e.size,n=g.default.Maximum;for(let r of(i>8?n=g.default.Low:i>4&&(n=g.default.Medium),e))t.add(new v.default(r,1,n));this.defaultVideoPreferences=t.build()}updateMetrics(e){if(!this.videoIndex||this.videoIndex.allStreams().empty())return;this.prevDownlinkStats=this.downlinkStats,this.downlinkStats=new w;let t=e.getObservableMetrics();for(let i in this.downlinkStats.bandwidthEstimateKbps=t.availableIncomingBitrate/1e3,e.streamMetricReports){let t=Number.parseInt(i,10),n=e.streamMetricReports[t];n.direction===l.default.DOWNSTREAM&&n.mediaType===d.default.VIDEO&&(n.currentMetrics.hasOwnProperty("nackCount")&&(this.downlinkStats.nackCount+=e.countPerSecond("nackCount",t)),n.currentMetrics.hasOwnProperty("packetsLost")&&(this.downlinkStats.packetsLost+=e.countPerSecond("packetsLost",t)),n.currentMetrics.hasOwnProperty("bytesReceived")&&(this.downlinkStats.usedBandwidthKbps+=e.bitsPerSecond("bytesReceived",t)/1e3))}}wantsResubscribe(){let e=!1;return h.serverSideNetworkAdaptionIsNoneOrDefault(this.serverSideNetworkAdaption)||(e||(e=this.pendingActionAfterUpdatedPreferences),this.serverSideNetworkAdaption!==h.default.BandwidthProbingAndRemoteVideoQualityAdaption)?(this.calculateOptimalReceiveSet(),e||(e=!this.subscribedReceiveSet.equal(this.optimalReceiveSet)),e):e||this.allHighestPolicy.wantsResubscribe()}chooseSubscriptions(){return h.serverSideNetworkAdaptionIsNoneOrDefault(this.serverSideNetworkAdaption)||(this.pendingActionAfterUpdatedPreferences=!1,this.serverSideNetworkAdaption!==h.default.BandwidthProbingAndRemoteVideoQualityAdaption)?(this.subscribedReceiveSet.equal(this.optimalReceiveSet)||(this.lastSubscribeTimestamp=Date.now()),this.subscribedReceiveSet=this.optimalReceiveSet.clone(),this.subscribedReceiveStreams=this.optimalReceiveStreams.slice(),this.subscribedReceiveSet.clone()):this.allHighestPolicy.chooseSubscriptions()}addObserver(e){this.observerQueue.add(e)}removeObserver(e){this.observerQueue.delete(e)}forEachObserver(e){for(let t of this.observerQueue)e(t)}setVideoPriorityBasedPolicyConfigs(e){this.videoPriorityBasedPolicyConfig=e}calculateOptimalReceiveStreams(){var e;let t=[],i=this.videoIndex.remoteStreamDescriptions();if(0===i.length||(null===(e=this.videoPreferences)||void 0===e?void 0:e.isEmpty())){this.optimalReceiveStreams=[];return}let n=this.rateProbeState;this.cleanBwPausedTiles(i),this.handleAppPausedStreams(t,i);let r=new Map;for(let e of this.getCurrentVideoPreferences())r.set(e.attendeeId,e);let s=i.filter(e=>r.has(e.attendeeId)),o=!this.streamsWithPreferenceDidChange(s),a=!this.startupPeriod&&o;if(a&&Date.now()-this.lastSubscribeTimestamp<this.timeBeforeAllowSubscribeMs)return;for(let e of(s.sort((e,t)=>e.maxBitrateKbps===t.maxBitrateKbps?e.streamId-t.streamId:e.maxBitrateKbps-t.maxBitrateKbps),s))(0===e.avgBitrateKbps||e.avgBitrateKbps>e.maxBitrateKbps)&&(e.attendeeId.endsWith(u.default.Modality)&&e.maxBitrateKbps<100?e.maxBitrateKbps=e.avgBitrateKbps:e.avgBitrateKbps=e.maxBitrateKbps);let l=new Set;for(let e of this.getCurrentVideoPreferences()){let t;let i=s.filter(t=>t.attendeeId===e.attendeeId);if(i.length<3)continue;let n=15,r=153600;for(let s of(i.forEach(e=>{n=Math.max(n,e.maxFrameRate),r=Math.max(r,e.totalPixels())}),i.sort((t,i)=>{if(e.degradationPreference===y.default.MaintainResolution)return 2>Math.abs(t.maxFrameRate-i.maxFrameRate)?t.totalPixels()-i.totalPixels():t.maxFrameRate-i.maxFrameRate;if(e.degradationPreference===y.default.MaintainFramerate)return t.totalPixels()===i.totalPixels()?t.maxFrameRate-i.maxFrameRate:t.totalPixels()-i.totalPixels();{let e=5,s=2,o=t=>t.avgBitrateKbps*Math.pow(2,e*t.maxFrameRate/n*Math.pow(2*s,t.totalPixels()/r));return o(t)-o(i)}}),i)){if(void 0!==t&&(s.maxFrameRate<t.maxFrameRate&&Math.abs(t.maxFrameRate-s.maxFrameRate)>2||s.totalPixels()<t.totalPixels())){l.add(s.streamId);continue}t=s}}let d=s.filter(e=>!l.has(e.streamId));this.logger.info(`Filtered to ${JSON.stringify(d)}`);let f={targetDownlinkBitrate:0,chosenTotalBitrate:0,deltaToNextUpgrade:0};f.targetDownlinkBitrate=this.determineTargetRate();let p=this.subscribedReceiveSet.size(),m=this.downlinkStats.bandwidthEstimateKbps,g=!this.videoPriorityBasedPolicyConfig.allowSubscribe(p,m);if(this.probeFailed&&(this.probeFailed=!1,this.timeBeforeAllowSubscribeMs=C.MIN_TIME_BETWEEN_SUBSCRIBE_MS,a&&g))return;let v=this.priorityPolicy(f,d,t),b=!h.serverSideNetworkAdaptionIsNoneOrDefault(this.serverSideNetworkAdaption),S=0;if(b||this.startupPeriod||!o?(this.setProbeState("Not Probing"),this.lastUpgradeRateKbps=0):"Probing"===this.rateProbeState?S=this.handleProbe(t,f.targetDownlinkBitrate):0!==f.deltaToNextUpgrade&&(S=this.maybeOverrideOrProbe(t,f,v)),this.previousStreamsWithPreference=s,this.videoPreferencesUpdated=!1,1===S){this.logger.info(`bwe: keepSameSubscriptions stats:${JSON.stringify(this.downlinkStats)}`),this.prevTargetRateKbps=f.targetDownlinkBitrate;return}if(2===S){let e=this.calculateSubscribeRate(this.preProbeNonPausedReceiveStreams);this.optimalReceiveStreams=this.preProbeReceiveStreams.slice(),this.processBwPausedStreams(s,this.preProbeNonPausedReceiveStreams),this.logger.info("bwe: Use Pre-Probe subscription subscribedRate:"+e);return}this.optimalNonPausedReceiveStreams=t.slice();let w=this.pausedBwAttendeeIds.size;this.processBwPausedStreams(s,t),this.logger.getLogLevel()<=c.LogLevel.INFO&&(this.logCount%15==0||this.rateProbeState!==n||this.optimalReceiveStreams.length!==t.length||w!==this.pausedBwAttendeeIds.size)&&(this.logger.info(this.policyStateLogStr(i,f.targetDownlinkBitrate)),this.logCount=0),this.logCount++,this.prevTargetRateKbps=f.targetDownlinkBitrate,this.optimalReceiveStreams=t.slice()}calculateOptimalReceiveSet(){let e=new p.default;for(let t of(this.calculateOptimalReceiveStreams(),this.optimalReceiveStreams))e.add(t.streamId);if(!this.optimalReceiveSet.equal(e)){let t=this.calculateSubscribeRate(this.optimalReceiveStreams);this.logger.info(`bwe: new streamSelection: ${JSON.stringify(e)} subscribedRate:${t}`)}this.optimalReceiveSet=e}determineTargetRate(){let e=0,t=Date.now();return 0!==this.downlinkStats.bandwidthEstimateKbps?(0===this.firstEstimateTimestamp&&(this.firstEstimateTimestamp=t),this.startupPeriod&&(this.downlinkStats.bandwidthEstimateKbps>C.DEFAULT_BANDWIDTH_KBPS||this.downlinkStats.packetsLost>0||t-this.firstEstimateTimestamp>C.STARTUP_PERIOD_MS&&this.downlinkStats.bandwidthEstimateKbps<=this.prevDownlinkStats.bandwidthEstimateKbps)&&(this.startupPeriod=!1,this.prevTargetRateKbps=this.downlinkStats.bandwidthEstimateKbps),this.startupPeriod?e=C.DEFAULT_BANDWIDTH_KBPS:"Probing"===this.rateProbeState&&this.downlinkStats.usedBandwidthKbps>this.downlinkStats.bandwidthEstimateKbps&&this.downlinkStats.packetsLost<C.SPURIOUS_PACKET_LOST_THRESHOLD?(this.logger.info(`bwe: In probe state, overriding estimate ${this.downlinkStats.bandwidthEstimateKbps} with actual receive bitrate ${this.downlinkStats.usedBandwidthKbps}`),e=this.downlinkStats.usedBandwidthKbps+C.USED_BANDWIDTH_OVERRIDE_BUFFER_KBPS):e=this.downlinkStats.bandwidthEstimateKbps):e=0===this.firstEstimateTimestamp?C.DEFAULT_BANDWIDTH_KBPS:this.prevTargetRateKbps,!this.startupPeriod&&(this.usingPrevTargetRate&&this.downlinkStats.bandwidthEstimateKbps<this.prevTargetRateKbps||this.downlinkStats.bandwidthEstimateKbps<this.prevTargetRateKbps*(100-C.LARGE_RATE_CHANGE_TRIGGER_PERCENT)/100||this.downlinkStats.bandwidthEstimateKbps<this.downlinkStats.usedBandwidthKbps*C.LARGE_RATE_CHANGE_TRIGGER_PERCENT/100)&&0===this.downlinkStats.packetsLost?(this.logger.debug(()=>"bwe: ValidateRate: Using Previous rate "+this.prevTargetRateKbps),this.usingPrevTargetRate=!0,e=this.prevTargetRateKbps):this.usingPrevTargetRate=!1,e>15e3&&this.logger.warn("bwe: "+e+" exceeds maximum limit (15000). Limit TargetDisplaySize with VideoPreferences to avoid this."),Math.min(e,15e3)}setProbeState(e){if(this.rateProbeState===e)return!1;let t=Date.now();switch(e){case"Not Probing":this.probePendingStartTimestamp=0;break;case"Probe Pending":if(0!==this.lastProbeTimestamp&&!(t-this.lastProbeTimestamp>C.MIN_TIME_BETWEEN_PROBE_MS))return!1;this.probePendingStartTimestamp=t;break;case"Probing":if(!(t-this.probePendingStartTimestamp>this.timeBeforeAllowProbeMs))return!1;this.lastProbeTimestamp=t,this.preProbeReceiveStreams=this.subscribedReceiveStreams.slice(),this.preProbeNonPausedReceiveStreams=this.optimalNonPausedReceiveStreams,this.timeBeforeAllowProbeMs=Math.min(2*this.timeBeforeAllowProbeMs,C.MAX_HOLD_BEFORE_PROBE_MS)}return this.logger.info("bwe: setProbeState to "+e+" from "+this.rateProbeState),this.rateProbeState=e,!0}upgradeToStream(e,t){for(let i=0;i<e.length;i++)if(e[i].groupId===t.groupId){let n=t.avgBitrateKbps-e[i].avgBitrateKbps;return this.logger.info("bwe: upgradeStream from "+JSON.stringify(e[i])+" to "+t),this.lastUpgradeRateKbps=n,e[i]=t,n}return e.push(t),this.lastUpgradeRateKbps=t.avgBitrateKbps,this.lastUpgradeRateKbps}handleProbe(e,t){if(Date.now()-this.lastProbeTimestamp>C.MAX_ALLOWED_PROBE_TIME_MS)return this.logger.info("bwe: Canceling probe due to timeout"),this.setProbeState("Not Probing"),0;if(this.downlinkStats.packetsLost>0&&(this.logger.info(`bwe: Probe encountering packets lost:${this.downlinkStats.packetsLost}`),this.downlinkStats.packetsLost>C.SPURIOUS_PACKET_LOST_THRESHOLD))return this.setProbeState("Not Probing"),this.logger.info(`bwe: Canceling probe due to packets lost:${this.downlinkStats.packetsLost}`),this.probeFailed=!0,this.timeBeforeAllowSubscribeMs=3*Math.max(C.MIN_TIME_BETWEEN_SUBSCRIBE_MS,this.timeBeforeAllowSubscribeMs),2;let i=this.calculateSubscribeRate(this.optimalReceiveStreams);return this.chosenStreamsSameAsLast(e)||t>i?(this.logger.info("bwe: Probe successful"),this.setProbeState("Not Probing"),this.timeBeforeAllowProbeMs=C.MIN_TIME_BETWEEN_PROBE_MS,0):1}maybeOverrideOrProbe(e,t,i){let n=this.chosenStreamsSameAsLast(e),r=0,s=t.targetDownlinkBitrate>C.LOW_BITRATE_THRESHOLD_KBPS?C.TARGET_RATE_CHANGE_TRIGGER_PERCENT:2*C.TARGET_RATE_CHANGE_TRIGGER_PERCENT,o=t.targetDownlinkBitrate*s/100;if(this.targetRateBaselineForDeltaCheckKbps=void 0!==this.targetRateBaselineForDeltaCheckKbps?this.targetRateBaselineForDeltaCheckKbps:this.prevTargetRateKbps,!n&&Math.abs(t.targetDownlinkBitrate-this.targetRateBaselineForDeltaCheckKbps)<o?(this.logger.info("bwe: MaybeOverrideOrProbe: Reuse last decision based on delta rate. {"+JSON.stringify(this.subscribedReceiveSet)+"}"),r=1):this.targetRateBaselineForDeltaCheckKbps=t.targetDownlinkBitrate,this.downlinkStats.packetsLost>this.prevDownlinkStats.packetsLost)return this.setProbeState("Not Probing"),this.lastUpgradeRateKbps=0,r;if(n||1===r)switch(this.rateProbeState){case"Not Probing":this.setProbeState("Probe Pending");break;case"Probe Pending":this.setProbeState("Probing")&&(this.upgradeToStream(e,i),r=0)}else this.setProbeState("Not Probing");return r}calculateSubscribeRate(e){let t=0;for(let i of e)this.pausedStreamIds.contain(i.streamId)||this.pausedBwAttendeeIds.has(i.attendeeId)||(t+=i.maxBitrateKbps);return t}handleAppPausedStreams(e,t){if(!this.tileController){this.logger.warn("tileController not found!");return}for(let i of(this.pausedStreamIds=new p.default,this.tileController.getAllRemoteVideoTiles())){let n=i.state();if(n.paused&&!this.pausedBwAttendeeIds.has(n.boundAttendeeId)){let i=t.length;for(;i--;)t[i].attendeeId===n.boundAttendeeId&&(this.logger.info("bwe: removed paused attendee "+n.boundAttendeeId+" streamId: "+t[i].streamId),this.pausedStreamIds.add(t[i].streamId),this.subscribedReceiveSet.contain(t[i].streamId)&&e.push(t[i]),t.splice(i,1))}}}processBwPausedStreams(e,t){if(!this.tileController){this.logger.warn("tileController not found!");return}let i=this.getCurrentVideoPreferences();if(i&&this.shouldPauseTiles){let n=this.tileController.getAllVideoTiles();for(let r of i){let i=this.getVideoTileForAttendeeId(r.attendeeId,n),s=(null==i?void 0:i.state().paused)||!1;if(t.some(e=>e.attendeeId===r.attendeeId))s&&this.pausedBwAttendeeIds.has(r.attendeeId)&&(this.logger.info(`bwe: unpausing attendee ${r.attendeeId} due to bandwidth`),this.forEachObserver(e=>{e.tileWillBeUnpausedByDownlinkPolicy(i.id())}),this.tileController.unpauseVideoTile(i.id()),this.pausedBwAttendeeIds.delete(r.attendeeId));else{let n=e.some(e=>e.attendeeId===r.attendeeId);if(i&&n){let e=this.optimalReceiveStreams.find(e=>e.attendeeId===r.attendeeId);void 0!==e&&(s||(this.logger.info(`bwe: pausing streamId ${e.streamId} attendee ${r.attendeeId} due to bandwidth`),this.forEachObserver(e=>{e.tileWillBePausedByDownlinkPolicy(i.id())}),this.tileController.pauseVideoTile(i.id())),t.push(e)),this.pausedBwAttendeeIds.add(r.attendeeId)}else if(n){let e=this.tileController.addVideoTile();e.bindVideoStream(r.attendeeId,!1,null,0,0,0,null),this.forEachObserver(t=>{t.tileWillBePausedByDownlinkPolicy(e.id())}),e.pause(),this.logger.info(`bwe: Created video tile ${e.id()} for bw paused attendee ${r.attendeeId}`),this.pausedBwAttendeeIds.add(r.attendeeId)}}}}}cleanBwPausedTiles(e){if(!this.tileController){this.logger.warn("tileController not found!");return}let t=this.tileController.getAllRemoteVideoTiles(),i=this.getCurrentVideoPreferences();for(let n of t){let t=n.state();t.boundVideoStream||(e.some(e=>e.attendeeId===t.boundAttendeeId)?void 0===i||i.some(e=>e.attendeeId===t.boundAttendeeId)||this.tileController.removeVideoTile(t.tileId):(this.tileController.removeVideoTile(t.tileId),this.logger.info(`bwe: Removed video tile ${t.tileId} for bw paused attendee ${t.boundAttendeeId}`)))}}priorityPolicy(e,t,i){let n,r;let s=this.getCurrentVideoPreferences(),o=s.highestPriority(),a=o;for(;-1!==a;){for(let o of(r=-1,s))if(o.priority===a)for(let r of t)r.attendeeId!==o.attendeeId||i.some(e=>e.groupId===r.groupId)||(e.chosenTotalBitrate+r.avgBitrateKbps<=e.targetDownlinkBitrate?(i.push(r),e.chosenTotalBitrate+=r.avgBitrateKbps):0!==e.deltaToNextUpgrade||(e.deltaToNextUpgrade=r.avgBitrateKbps,n=r));else if(o.priority>a){r=o.priority;break}for(let r of s)if(r.priority===a){for(let s of t)if(s.attendeeId===r.attendeeId){let o=i.findIndex(e=>e.groupId===s.groupId&&e.maxBitrateKbps<=s.maxBitrateKbps&&e.avgBitrateKbps<s.avgBitrateKbps);if(-1!==o){let a=s.avgBitrateKbps-i[o].avgBitrateKbps;this.hasSimulcastStreams(t,s.attendeeId,s.groupId)&&this.canUpgrade(s.avgBitrateKbps,r.targetSize,r.targetSizeToBitrateKbps(r.targetSize),s.attendeeId.endsWith(u.default.Modality))?(this.logger.info(`bwe: attendee: ${s.attendeeId} group: ${s.groupId} has simulcast and can upgrade avgBitrate: ${s.avgBitrateKbps} target: ${r.targetSizeToBitrateKbps(r.targetSize)} targetTotalBitrate: ${e.targetDownlinkBitrate}`),e.chosenTotalBitrate+a<=e.targetDownlinkBitrate?(e.chosenTotalBitrate+=a,i[o]=s):0===e.deltaToNextUpgrade&&(e.deltaToNextUpgrade=a,n=s)):this.logger.info("bwe: cannot upgrade stream quality beyond target size")}}}else if(r.priority>a)break;if(a===o&&0!==e.deltaToNextUpgrade)break;a=r}return n}getVideoTileForAttendeeId(e,t){for(let i of t)if(i.state().boundAttendeeId===e)return i;return null}canUpgrade(e,t,i,n){let r=!1;return(t===g.default.High?r=!0:!n&&e<=i?r=!0:n&&t===g.default.Medium&&e<=i&&(r=!0),r)?(this.logger.info(`bwe: canUpgrade: bitrateKbps: ${e} targetBitrateKbps: ${i}`),!0):(this.logger.info(`bwe: cannot Upgrade: bitrateKbps: ${e} targetBitrateKbps: ${i}`),!1)}hasSimulcastStreams(e,t,i){let n=0;for(let r of e)r.attendeeId===t&&r.groupId===i&&n++;return this.logger.info(`bwe: attendeeId: ${t} groupId: ${i} hasSimulcastStreams: streamCount: ${n}`),n>1}streamsWithPreferenceDidChange(e){if(void 0===this.previousStreamsWithPreference||e.length!==this.previousStreamsWithPreference.length||!0===this.videoPreferencesUpdated)return!0;for(let t of e)if(void 0===this.previousStreamsWithPreference.find(e=>e.groupId===t.groupId&&e.streamId===t.streamId&&e.maxBitrateKbps===t.maxBitrateKbps))return!0;return!1}chosenStreamsSameAsLast(e){if(this.optimalNonPausedReceiveStreams.length!==e.length)return!1;for(let t of this.optimalNonPausedReceiveStreams)if(!e.some(e=>e.streamId===t.streamId))return!1;return!0}policyStateLogStr(e,t){let i={targetBitrate:t,subscribedRate:this.calculateSubscribeRate(this.optimalReceiveStreams),probeState:this.rateProbeState,startupPeriod:this.startupPeriod},n="remoteInfos: [";for(let t of e)n+=`{grpId:${t.groupId} strId:${t.streamId} maxBr:${t.maxBitrateKbps} avgBr:${t.avgBitrateKbps}}, `;n+="]";let r=`bwe: optimalReceiveSet ${JSON.stringify(i)}
bwe:   prev ${JSON.stringify(this.prevDownlinkStats)}
bwe:   now  ${JSON.stringify(this.downlinkStats)}
bwe:   ${n}
`;return(this.pausedStreamIds.size()>0||this.pausedBwAttendeeIds.size>0)&&(r+=`bwe:   paused: app stream ids ${JSON.stringify(this.pausedStreamIds)}  bw attendees { ${Array.from(this.pausedBwAttendeeIds).join(" ")} }
`),this.videoPreferences?r+=`bwe:   preferences: ${JSON.stringify(this.videoPreferences)}`:r+=`bwe:   default preferences: ${JSON.stringify(this.defaultVideoPreferences)}`,r}getCurrentVideoPreferences(){return this.videoPreferences||this.defaultVideoPreferences}getServerSideNetworkAdaption(){return this.serverSideNetworkAdaption}setServerSideNetworkAdaption(e){this.serverSideNetworkAdaption=e,this.setProbeState("Not Probing")}supportedServerSideNetworkAdaptions(){return[h.default.None,h.default.BandwidthProbing,h.default.BandwidthProbingAndRemoteVideoQualityAdaption]}getVideoPreferences(){let e=this.getCurrentVideoPreferences();return e||(e=b.VideoPreferences.prepare().build()),e}wantsAllTemporalLayersInIndex(){return!0}}t.default=C,C.DEFAULT_BANDWIDTH_KBPS=2800,C.STARTUP_PERIOD_MS=6e3,C.LARGE_RATE_CHANGE_TRIGGER_PERCENT=20,C.TARGET_RATE_CHANGE_TRIGGER_PERCENT=15,C.LOW_BITRATE_THRESHOLD_KBPS=300,C.MIN_TIME_BETWEEN_PROBE_MS=5e3,C.MIN_TIME_BETWEEN_SUBSCRIBE_MS=2e3,C.MAX_HOLD_BEFORE_PROBE_MS=3e4,C.MAX_ALLOWED_PROBE_TIME_MS=6e4,C.SPURIOUS_PACKET_LOST_THRESHOLD=2,C.USED_BANDWIDTH_OVERRIDE_BUFFER_KBPS=100},73463:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let r=n(i(45377));class s{constructor(e=0,t=0){this.networkIssueResponseDelayFactor=e,this.networkIssueRecoveryDelayFactor=t,this.currentNetworkEvent=0,this.bandwidthDecreaseTimestamp=0,this.referenceBitrate=0,this.serverSideNetworkAdaption=r.default.Default,e<0?e=0:e>1&&(e=1),this.networkIssueResponseDelayFactor=e,t<0?t=0:t>1&&(t=1),this.networkIssueRecoveryDelayFactor=t}allowSubscribe(e,t){let i=0,n=this.currentNetworkEvent;if(t>this.referenceBitrate)return this.currentNetworkEvent=2,this.referenceBitrate=t,!0;if(!(t<this.referenceBitrate))return this.currentNetworkEvent=0,!1;if(this.currentNetworkEvent=1,i=this.getSubscribeDelay(this.currentNetworkEvent,e),1!==n)this.bandwidthDecreaseTimestamp=Date.now();else if(Date.now()-this.bandwidthDecreaseTimestamp>i)return this.referenceBitrate=t,!0;return!1}getSubscribeDelay(e,t){let i=s.MINIMUM_DELAY_MS,n=s.MAXIMUM_DELAY_MS-s.MINIMUM_DELAY_MS,r=this.networkIssueResponseDelayFactor;return 1===e&&(i+=n*r*(1+t/10),i=Math.min(s.MAXIMUM_DELAY_MS,i)),i}}t.default=s,s.MINIMUM_DELAY_MS=2e3,s.MAXIMUM_DELAY_MS=8e3,s.Default=new s(0,0),s.UnstableNetworkPreset=new s(0,1),s.StableNetworkPreset=new s(1,0)},67473:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.VideoQualityAdaptationPreference=void 0,function(e){e[e.Balanced=0]="Balanced",e[e.MaintainFramerate=1]="MaintainFramerate",e[e.MaintainResolution=2]="MaintainResolution"}(i=t.VideoQualityAdaptationPreference||(t.VideoQualityAdaptationPreference={})),t.default=i},52363:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{create(){let e={clientWidth:400,clientHeight:300,width:400,height:300,videoWidth:400,videoHeight:300,style:{transform:""},hasAttribute:()=>!1,removeAttribute:()=>{},setAttribute:()=>{},srcObject:!1,paused:!0,pause:()=>{e.paused=!0},play:()=>(e.paused=!1,Promise.resolve())};return e}}t.default=i},98400:function(e,t){"use strict";var i=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});class n{constructor(e){this.canvas=e,this.destroyed=!1}destroy(){this.canvas=null,this.destroyed=!0}asCanvasImageSource(){return i(this,void 0,void 0,function*(){return this.destroyed?Promise.reject("canvas buffer is destroyed"):Promise.resolve(this.canvas)})}asCanvasElement(){return this.canvas}}t.default=n},44739:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=r(i(98400)),o=r(i(15706)),a=15;class l{constructor(e,t,i=new o.default){this.logger=e,this.stages=t,this.fr=a,this.outputMediaStream=new MediaStream,this.videoInput=document.createElement("video"),this.canvasOutput=document.createElement("canvas"),this.outputCtx=this.canvasOutput.getContext("2d"),this.canvasInput=document.createElement("canvas"),this.inputCtx=this.canvasInput.getContext("2d"),this.inputVideoStream=null,this.sourceBuffers=[],this.destBuffers=[],this.observers=new Set,this.hasStarted=!1,this.process=e=>n(this,void 0,void 0,function*(){let e;if(!this.inputVideoStream)return;let t=performance.now();this.videoInput.videoWidth&&(this.canvasInput.width!==this.videoInput.videoWidth&&(this.canvasInput.width=this.videoInput.videoWidth,this.canvasInput.height=this.videoInput.videoHeight,this.sourceBuffers[0].height=this.canvasInput.height,this.sourceBuffers[0].width=this.canvasInput.width,this.sourceBuffers[0].framerate=this.framerate),this.inputCtx.drawImage(this.videoInput,0,0));let i=[];i.push(this.sourceBuffers[0]);try{for(let e of this.processors)i=yield e.process(i)}catch(e){this.forEachObserver(e=>{e.processingDidFailToStart&&e.processingDidFailToStart()});return}this.destBuffers=i;try{e=yield this.destBuffers[0].asCanvasImageSource()}catch(e){this.inputVideoStream&&(this.logger.info("buffers are destroyed and pipeline could not start"),this.forEachObserver(e=>{e.processingDidFailToStart&&e.processingDidFailToStart()}));return}let n=e.width,r=e.height;0===n||0===r||(this.canvasOutput.width!==n&&this.canvasOutput.height!==r&&(this.canvasOutput.width=n,this.canvasOutput.height=r),this.outputCtx.drawImage(e,0,0,n,r,0,0,n,r),this.hasStarted||(this.hasStarted=!0,this.forEachObserver(e=>{e.processingDidStart&&e.processingDidStart()})));let s=performance.now()-t,o=2e3/this.framerate-s,a=Math.max(0,1e3/this.framerate-s);o<=0&&this.forEachObserver(e=>{e.processingLatencyTooHigh&&e.processingLatencyTooHigh(s)}),yield this.timer.start(a,this.process.bind(this))}),this.timer=i}destroy(){if(this.stop(),this.stages)for(let e of this.stages)e.destroy();this.timer.destroy()}get framerate(){return this.fr}set framerate(e){this.fr=e<0?a:e}stop(){if(this.videoInput.removeEventListener("loadedmetadata",this.process),this.videoInput.srcObject=null,this.destroyInputMediaStreamAndBuffers(),this.outputMediaStream)for(let e of this.outputMediaStream.getVideoTracks())e.stop();this.hasStarted&&(this.hasStarted=!1,this.forEachObserver(e=>{e.processingDidStop&&e.processingDidStop()}))}addObserver(e){this.observers.add(e)}removeObserver(e){this.observers.delete(e)}getInputMediaStream(){return n(this,void 0,void 0,function*(){return this.inputVideoStream})}getActiveOutputMediaStream(){return this.isOutputMediaStreamActive()||(this.outputMediaStream=this.canvasOutput.captureStream(this.framerate),this.cloneInputAudioTracksToOutput()),this.outputMediaStream}setInputMediaStream(e){return n(this,void 0,void 0,function*(){if(!e){this.stop();return}if(0===e.getVideoTracks().length){this.logger.error("No video tracks in input media stream, ignoring");return}this.inputVideoStream=e;let t=this.inputVideoStream.getVideoTracks()[0].getSettings();this.logger.info(`processing pipeline input stream settings ${JSON.stringify(t)}`),this.canvasOutput.width=t.width,this.canvasOutput.height=t.height,this.videoInput.addEventListener("loadedmetadata",this.process),this.videoInput.srcObject=this.inputVideoStream,this.videoInput.setAttribute("playsinline","true");let i=new s.default(this.canvasInput);this.sourceBuffers.push(i),this.videoInput.load();try{yield this.videoInput.play()}catch(e){this.logger.warn("Video element play() overrided by another load().")}this.cloneInputAudioTracksToOutput()})}cloneInputAudioTracksToOutput(){if(!this.isOutputMediaStreamActive()||null===this.inputVideoStream){this.logger.info("Not cloning input audio tracks to output, do not have media streams ready");return}for(let e of this.outputMediaStream.getAudioTracks())this.logger.info(`Removing audio track ${e.id} from output stream`),this.outputMediaStream.removeTrack(e);for(let e of this.inputVideoStream.getAudioTracks())this.logger.info(`Adding audio track ${e.id} to output stream`),this.outputMediaStream.addTrack(e)}isOutputMediaStreamActive(){return this.outputMediaStream&&this.outputMediaStream.active}set processors(e){this.stages=e}get processors(){return this.stages}forEachObserver(e){for(let t of this.observers)setTimeout(()=>{e(t)},0)}destroyInputMediaStreamAndBuffers(){if(this.inputVideoStream)for(let e of this.inputVideoStream.getTracks())e.stop();for(let e of(this.inputVideoStream=null,this.sourceBuffers))e.destroy();this.sourceBuffers=[]}}t.default=l},15706:function(e,t){"use strict";var i=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});class n{constructor(){this.workerTimer=void 0,this.callback=void 0,this.workerTimer=this.createWorkerTimer()}createWorkerTimer(){try{let e=new Blob([`self.onmessage = async function(e){ 
            var timerID = null;
            const awaitTimeout = delay => new Promise( resolve => {
              timerID = setTimeout(resolve, delay);
            })
            await awaitTimeout(e.data);
            postMessage(timerID);
          }`],{type:"application/javascript"});return new Worker(window.URL.createObjectURL(e))}catch(e){}}start(e,t){return i(this,void 0,void 0,function*(){this.callback=t,this.workerTimer?(this.workerTimer.onmessage=e=>{this.lastTimeout=e.data,this.callback()},this.workerTimer.postMessage(e)):this.lastTimeout=setTimeout(()=>{this.callback()},e)})}destroy(){return i(this,void 0,void 0,function*(){this.callback=void 0,this.lastTimeout&&(clearTimeout(this.lastTimeout),this.lastTimeout=void 0),this.workerTimer&&(this.workerTimer.terminate(),this.workerTimer=void 0)})}}t.default=n},63062:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=r(i(81341)),o=r(i(44739));class a{constructor(e,t,i,n=new s.default){this.logger=e,this.device=t,this.processors=i,this.browserBehavior=n,this.observers=new Set,this.pipe=new o.default(this.logger,this.processors),this.pipe.addObserver(this)}get outputMediaStream(){return this.pipe.outputMediaStream}passEventControllerToProcessors(e){if(this.pipe.processors)for(let t of this.pipe.processors)"function"==typeof t.setEventController&&t.setEventController(e)}chooseNewInnerDevice(e){let t=new a(this.logger,e,this.processors,this.browserBehavior);return t.pipe=this.pipe,t}getInnerDevice(){return this.device}intrinsicDevice(){return n(this,void 0,void 0,function*(){return this.device})}transformStream(e){return n(this,void 0,void 0,function*(){return yield this.pipe.setInputMediaStream(e),this.inputMediaStream=e,this.pipe.getActiveOutputMediaStream()})}onOutputStreamDisconnect(){this.logger.info("DefaultVideoTransformDevice: detach stopping input media stream");let e=this.device&&this.device.id;if(this.pipe.stop(),!e&&this.inputMediaStream)for(let e of this.inputMediaStream.getVideoTracks())e.stop()}stop(){return n(this,void 0,void 0,function*(){if(this.inputMediaStream)for(let e of this.inputMediaStream.getVideoTracks())e.stop();this.pipe.destroy(),this.inputMediaStream=null})}addObserver(e){this.observers.add(e)}removeObserver(e){this.observers.delete(e)}processingDidStart(){this.logger.info("video transform device processing started"),this.forEachObserver(e=>{e.processingDidStart&&e.processingDidStart()})}processingLatencyTooHigh(e){this.forEachObserver(t=>{t.processingLatencyTooHigh&&t.processingLatencyTooHigh(e)})}processingDidFailToStart(){this.logger.info("video transform device processing failed to start"),this.forEachObserver(e=>{e.processingDidFailToStart&&e.processingDidFailToStart()})}processingDidStop(){this.logger.info("video transform device processing stopped"),this.forEachObserver(e=>{e.processingDidStop&&e.processingDidStop()})}forEachObserver(e){for(let t of this.observers)setTimeout(()=>{e(t)},0)}}t.default=a},86349:function(e,t){"use strict";var i=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});class n{process(e){return i(this,void 0,void 0,function*(){return e})}destroy(){return i(this,void 0,void 0,function*(){})}}t.default=n},92308:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DeferredPromise=void 0;class i{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}getPromise(){return this.promise}resolvePromise(e){this.resolve(e)}resolveAndReplacePromise(e){this.resolve(e),this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}rejectPromise(e){this.reject(e)}rejectAndReplacePromise(e){this.reject(e),this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}t.DeferredPromise=i},85731:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.VideoFxCanvasOpsManager=void 0;let r=i(36419);class s{constructor(e,t){this.streamParameters=e,this.outputCanvas=t,this.configureCanvasPipeline()}getInferenceInputData(e){return this.inferenceCtx.save(),this.inferenceCtx.scale(this.horizontalResizeScalar,this.verticalResizeScalar),this.inferenceCtx.drawImage(e,0,0),this.inferenceCtx.restore(),this.inferenceCtx.getImageData(0,0,r.SEGMENTATION_MODEL.WIDTH_IN_PIXELS,r.SEGMENTATION_MODEL.HEIGHT_IN_PIXELS)}configureForStreamParameters(e){return n(this,void 0,void 0,function*(){if(this.streamParameters=e,this.outputCanvas.width=this.streamParameters.width,this.outputCanvas.height=this.streamParameters.height,this.backgroundReplacementCanvas){let e=document.createElement("canvas");e.width=this.streamParameters.width,e.height=this.streamParameters.height,e.getContext("2d").drawImage(this.backgroundReplacementCanvas,0,0,this.streamParameters.width,this.streamParameters.height),this.backgroundReplacementCanvas=e}this.configureCanvasPipeline()})}configureCanvasPipeline(){this.inferenceCanvas=document.createElement("canvas"),this.inferenceCtx=this.inferenceCanvas.getContext("2d",{willReadFrequently:!0}),this.inferenceCanvas.width=r.SEGMENTATION_MODEL.WIDTH_IN_PIXELS,this.inferenceCanvas.height=r.SEGMENTATION_MODEL.HEIGHT_IN_PIXELS,this.horizontalResizeScalar=r.SEGMENTATION_MODEL.WIDTH_IN_PIXELS/this.streamParameters.width,this.verticalResizeScalar=r.SEGMENTATION_MODEL.HEIGHT_IN_PIXELS/this.streamParameters.height}getBackgroundReplacementCanvas(){return this.backgroundReplacementCanvas}loadReplacementBackground(e){return n(this,void 0,void 0,function*(){let t=e.backgroundReplacement.backgroundImageURL,i=e.backgroundReplacement.defaultColor;if(t)try{let e=yield this.loadImage(t);this.backgroundReplacementImage=e,this.resizeAndSetReplacementImage(this.backgroundReplacementImage)}catch(e){throw this.logger.error(e),Error("Failed to set the replacement image.")}else this.resizeAndSetReplacementColor(i)})}resizeAndSetReplacementImage(e){let t=document.createElement("canvas"),i=t.getContext("2d");t.width=this.streamParameters.width,t.height=this.streamParameters.height,i.drawImage(e,0,0,this.streamParameters.width,this.streamParameters.height),this.backgroundReplacementCanvas=t}resizeAndSetReplacementColor(e){let t=document.createElement("canvas"),i=t.getContext("2d");t.width=this.streamParameters.width,t.height=this.streamParameters.height,i.fillStyle=e,i.fillRect(0,0,this.streamParameters.width,this.streamParameters.height),this.backgroundReplacementCanvas=t}loadImage(e){return n(this,void 0,void 0,function*(){let t=yield fetch(e).catch(e=>{throw this.logger.error(e.toString()),Error("Failed to fetch image.")}),i=yield t.blob(),n=new Image;return n.src=URL.createObjectURL(i),new Promise((e,t)=>{n.onload=()=>{e(n)},n.onerror=e=>{t(e)}})})}}t.VideoFxCanvasOpsManager=s},36419:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FXLIB_PATH=t.WORKER_PATH=t.CDN_BASE_PATH=t.RESOURCE_CONSTRAINTS=t.SEGMENTATION_MODEL=t.DEFAULT_STREAM_PARAMETERS=t.WORKER_MSG=void 0,t.WORKER_MSG={BUILD_ENGINE_REQUEST:"BuildEngineRequest",BUILD_ENGINE_RESPONSE:"BuildEngineResponse",PERFORM_SEGMENTATION_REQUEST:"PerformSegmentationRequest",PERFORM_SEGMENTATION_RESPONSE:"PerformSegmentationResponse",PERFORM_SEGMENTATION_SAB_REQUEST:"PerformSegmentationSABRequest",PERFORM_SEGMENTATION_SAB_RESPONSE:"PerformSegmentationSABResponse",DESTROY_ASSETS_REQUEST:"DestroyAssetsRequest",DESTROY_ASSETS_RESPONSE:"DestroyAssetsResponse",CLOSE_WORKER_REQUEST:"CloseWorkerRequest"},t.DEFAULT_STREAM_PARAMETERS={FRAMES_PER_SECOND:15,WIDTH_IN_PIXEL:960,HEIGHT_IN_PIXEL:540,CHANNEL_COUNT:4},t.SEGMENTATION_MODEL={LOAD_SUCCESS:2,WIDTH_IN_PIXELS:176,HEIGHT_IN_PIXELS:160},t.RESOURCE_CONSTRAINTS={DEFAULT_PROCESSING_BUDGET_PER_FRAME:50,SEGMENTATION_DEFAULT_FRAMES_PER_SEGMENTATION:1,SEGMENTATION_SAMPLING_PERIOD_FRAME_COUNT:500,BLUR_DEFAULT_CYCLE_PERCENTAGE:10,BLUR_SAMPLING_PERIOD_FRAME_COUNT:1e3,MIN_PROCESSING_BUDGET:0,MAX_PROCESSING_BUDGET:100},t.CDN_BASE_PATH="https://static.sdkassets.chime.aws";let i="/ml_media_fx/otherassets";t.WORKER_PATH=`${i}/worker.js`,t.FXLIB_PATH=`${i}/fxlib.js`},97677:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=i(21012),o=i(71143),a=i(70085),l=r(i(81341)),d=r(i(93101)),u=i(17201),c=r(i(29505)),h=r(i(98400)),f=i(92308),p=i(85731),m=i(36419),g=i(50563);class v{constructor(e,t=m.RESOURCE_CONSTRAINTS.DEFAULT_PROCESSING_BUDGET_PER_FRAME,i){this.logger=e,this.outputCanvas=document.createElement("canvas"),this.canvasVideoFrameBuffer=new h.default(this.outputCanvas);try{this.validateProcessingBudgetPerFrame(t)}catch(e){throw this.logger.error(e),Error(`Cannot instantiate VideoFxProcessor due to invalid processingBudgetPerFrame of ${t}`)}i&&(this.eventController=i),this.effectConfig={backgroundBlur:{isEnabled:!1,strength:"low"},backgroundReplacement:{isEnabled:!1,backgroundImageURL:null,defaultColor:"black"}},this.segmentationRequestPromise=new f.DeferredPromise,this.segmentationRateManager=new g.VideoFxSegmentationRateManager(this.logger,t),this.streamParameters={framerate:m.DEFAULT_STREAM_PARAMETERS.FRAMES_PER_SECOND,width:m.DEFAULT_STREAM_PARAMETERS.WIDTH_IN_PIXEL,height:m.DEFAULT_STREAM_PARAMETERS.HEIGHT_IN_PIXEL,channels:m.DEFAULT_STREAM_PARAMETERS.CHANNEL_COUNT},v.isSharedArrayBufferSupported&&(this.sharedImageBuffer=new SharedArrayBuffer(m.SEGMENTATION_MODEL.WIDTH_IN_PIXELS*m.SEGMENTATION_MODEL.HEIGHT_IN_PIXELS*this.streamParameters.channels),this.sharedImageData=new Uint8ClampedArray(this.sharedImageBuffer)),this.logger.info(`VideoFx supports Shared Array Buffer: ${v.isSharedArrayBufferSupported}`),this.canvasOpsManager=new p.VideoFxCanvasOpsManager(this.streamParameters,this.outputCanvas),this.outputCanvas.width=this.streamParameters.width,this.outputCanvas.height=this.streamParameters.height,this.segmentationMask=new ImageData(this.streamParameters.width,this.streamParameters.height),this.logger.info(`VideoFxProcessor instantiated with a processingBudgetPerFrame of ${t}`)}process(e){return n(this,void 0,void 0,function*(){return e})}fxProcess(e){return n(this,void 0,void 0,function*(){let t=e[0].asCanvasElement();this.didStreamParametersChange(t)&&(yield this.adjustProcessorForNewStreamParameters(t));try{yield this.manageSegmentationMask(t)}catch(e){throw this.logger.error(e),Error("Video stream could not be processed")}return yield this.renderer.render(t,this.segmentationMask),e[0]=this.canvasVideoFrameBuffer,e})}noOpProcess(e){return n(this,void 0,void 0,function*(){return e})}didStreamParametersChange(e){return e.width!==this.streamParameters.width||e.height!==this.streamParameters.height}adjustProcessorForNewStreamParameters(e){return n(this,void 0,void 0,function*(){this.streamParameters.width=e.width,this.streamParameters.height=e.height,yield this.canvasOpsManager.configureForStreamParameters(this.streamParameters),yield this.renderer.configure(this.streamParameters.width,this.streamParameters.height,this.effectConfig)})}destroy(){return n(this,void 0,void 0,function*(){this.canvasVideoFrameBuffer.destroy(),this.fxLibScript&&this.fxLibScript.parentNode&&this.fxLibScript.parentNode.removeChild(this.fxLibScript),this.engineWorker&&(this.destroyedAssetsPromise=new f.DeferredPromise,this.engineWorker.postMessage({msg:m.WORKER_MSG.DESTROY_ASSETS_REQUEST}),yield this.destroyedAssetsPromise.getPromise(),this.engineWorker.postMessage({msg:m.WORKER_MSG.CLOSE_WORKER_REQUEST})),this.logger.info("VideoFxProcessor destroyed.")})}manageSegmentationMask(e){return n(this,void 0,void 0,function*(){try{if(this.segmentationRateManager.submitFrame(),this.segmentationRateManager.shouldApplySegmentation()){this.segmentationRateManager.startSegmentation();let t=this.canvasOpsManager.getInferenceInputData(e);this.segmentationMask=yield this.generateSegmentationMask(t),this.segmentationRateManager.completeSegmentation()}}catch(e){throw this.logger.error(e.toString()),Error("Can not properly manage the returned segmentation mask")}})}generateSegmentationMask(e){return n(this,void 0,void 0,function*(){v.isSharedArrayBufferSupported?(this.sharedImageData.set(e.data),this.engineWorker.postMessage({msg:m.WORKER_MSG.PERFORM_SEGMENTATION_SAB_REQUEST,payload:this.sharedImageBuffer})):this.engineWorker.postMessage({msg:m.WORKER_MSG.PERFORM_SEGMENTATION_REQUEST,payload:e},[e.data.buffer]);try{return yield this.segmentationRequestPromise.getPromise()}catch(e){throw this.logger.error(e.toString()),Error("Segmentation mask could not be generated")}})}cloneConfigFrom(e){return{backgroundBlur:{isEnabled:e.backgroundBlur.isEnabled,strength:e.backgroundBlur.strength},backgroundReplacement:{isEnabled:e.backgroundReplacement.isEnabled,backgroundImageURL:e.backgroundReplacement.backgroundImageURL,defaultColor:e.backgroundReplacement.defaultColor}}}setEffectConfig(e){return n(this,void 0,void 0,function*(){if(this.sameVideoFxConfig(e,this.effectConfig))return;let t=this.cloneConfigFrom(e);try{yield this.validateEffectConfig(t)}catch(e){throw this.logger.error(e.toString()),Error("Provided effect config is invalid, not updating VideoFxProcessor")}t.backgroundReplacement.isEnabled&&(yield this.canvasOpsManager.loadReplacementBackground(t),yield this.renderer.setBackgroundReplacementCanvas(this.canvasOpsManager.getBackgroundReplacementCanvas())),yield this.renderer.configure(this.streamParameters.width,this.streamParameters.height,t),this.effectConfig=t,this.effectConfig.backgroundBlur.isEnabled||this.effectConfig.backgroundReplacement.isEnabled?this.process=this.fxProcess:this.process=this.noOpProcess,this.logger.info(`VideoFxProcessor effect configuration updated to: ${JSON.stringify(this.effectConfig)}`),this.eventController&&this.publishVideoFxConfigEvent()})}validateEffectConfig(e){return n(this,void 0,void 0,function*(){if(e.backgroundBlur.isEnabled&&e.backgroundReplacement.isEnabled)throw Error("Invalid VideoFx configuration: Background Blur and Background Replacement can not both be enabled");e.backgroundReplacement.isEnabled&&(yield this.validateReplacementConfig(e))})}validateReplacementConfig(e){return n(this,void 0,void 0,function*(){if(e.backgroundReplacement.backgroundImageURL&&e.backgroundReplacement.defaultColor)throw Error("Invalid VideoFx configuration: Background Replacement can not have both an image URL and default color");if(!e.backgroundReplacement.backgroundImageURL&&!e.backgroundReplacement.defaultColor)throw Error("Invalid VideoFx configuration: Background Replacement image URL and default can not both be null/undefined");try{e.backgroundReplacement.backgroundImageURL&&(yield this.canvasOpsManager.loadImage(e.backgroundReplacement.backgroundImageURL))}catch(e){throw this.logger.error(e.toString()),Error("Invalid VideoFx configuration: backgroundImageURL failed to load")}let t=e.backgroundReplacement.defaultColor;if(t&&"black"!==t&&"#000000"!==t&&"#000"!==t){if(t.includes("#")&&!new RegExp(/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/).test(t))throw Error(`Invalid hexadecimal color code for default replacement background: ${t}`);let e=document.createElement("canvas").getContext("2d"),i=e.fillStyle;if(e.fillStyle=t,e.fillStyle===i)throw Error(`Invalid color for default replacement background: ${t}`)}})}validateProcessingBudgetPerFrame(e){if(e<m.RESOURCE_CONSTRAINTS.MIN_PROCESSING_BUDGET||e>m.RESOURCE_CONSTRAINTS.MAX_PROCESSING_BUDGET)throw Error(`Invalid resource constraint: cycle percentage must be within range of ${m.RESOURCE_CONSTRAINTS.MIN_PROCESSING_BUDGET} and ${m.RESOURCE_CONSTRAINTS.MAX_PROCESSING_BUDGET}`)}loadAssets(){return n(this,void 0,void 0,function*(){this.logger.info("Loading required assets for the VideoFxProcessor");try{let e=this.getVideoFxAssetParams();yield this.loadEngineWorker(e),yield this.buildEngine(e),yield this.loadFxLib(e),this.renderer=constructRenderer(m.SEGMENTATION_MODEL.WIDTH_IN_PIXELS,m.SEGMENTATION_MODEL.HEIGHT_IN_PIXELS,this.effectConfig,this.outputCanvas)}catch(e){throw this.logger.error(e.toString()),Error("Failed to load necessary assets for the VideoFxProcessor")}this.logger.info("Finished loading of essential VideoFxProcessor assets.")})}getVideoFxAssetParams(){let e=u.getDefaultAssetSpec();return{assetGroup:e.assetGroup,revisionID:e.revisionID,sdk:encodeURIComponent(c.default.sdkVersion),ua:encodeURIComponent(c.default.sdkUserAgentLowResolution)}}getPathFromVideoFxAssetParams(e,t){let i=new URL(e);for(let[e,n]of Object.entries(t))if(void 0!==n){let t=encodeURIComponent(e),r=encodeURIComponent(n);i.searchParams.set(t,r)}return i.toString()}loadEngineWorker(e){return n(this,void 0,void 0,function*(){try{let t=this.getPathFromVideoFxAssetParams(m.CDN_BASE_PATH+m.WORKER_PATH,e);this.engineWorker=yield o.loadWorker(t,"VideoFxEngineWorker",{},null),this.logger.info("Successfully loaded the VideoFxProcessor's engine worker"),this.engineWorker.addEventListener("message",e=>this.engineWorkerReceiver(e))}catch(e){throw this.logger.error(e.toString()),Error("Failed to load the VideoFxProcessor's engine worker")}})}buildEngine(e){return n(this,void 0,void 0,function*(){this.buildEnginePromise=new f.DeferredPromise,this.engineWorker.postMessage({msg:m.WORKER_MSG.BUILD_ENGINE_REQUEST,payload:{cdnBasePath:m.CDN_BASE_PATH,sdkVersioningParams:e}});try{yield this.buildEnginePromise.getPromise()}catch(e){throw this.logger.error(e.toString()),Error("Failed to instantiate the VideoFxEngine")}})}loadFxLib(e){return n(this,void 0,void 0,function*(){let t=this.getPathFromVideoFxAssetParams(m.CDN_BASE_PATH+m.FXLIB_PATH,e),i={method:"GET",mode:"cors",credentials:"omit",redirect:"follow",referrerPolicy:"no-referrer"};try{let e=yield s.fetchWithBehavior(t,i,{});if(!e.ok)throw Error("Fetch failed.");let n=window.URL.createObjectURL((yield e.blob()));yield new Promise((e,t)=>{this.fxLibScript=document.createElement("script"),this.fxLibScript.setAttribute("src",n),this.fxLibScript.setAttribute("type","module"),this.fxLibScript.setAttribute("async","false"),this.fxLibScript.addEventListener("load",e),this.fxLibScript.addEventListener("error",t),document.body.appendChild(this.fxLibScript)})}catch(e){throw this.logger.error(e.toString()),Error("Failed to load the fxlib")}})}getEffectConfig(){return this.cloneConfigFrom(this.effectConfig)}engineWorkerReceiver(e){let t=e.data;switch(t.msg){case m.WORKER_MSG.BUILD_ENGINE_RESPONSE:this.settleEngineBuildPromise(t.payload);break;case m.WORKER_MSG.PERFORM_SEGMENTATION_RESPONSE:this.settleSegmentationPromise(t.payload.output);break;case m.WORKER_MSG.PERFORM_SEGMENTATION_SAB_RESPONSE:this.settleSegmentationPromiseSAB();break;case m.WORKER_MSG.DESTROY_ASSETS_RESPONSE:this.destroyedAssetsPromise.resolvePromise();break;default:this.logger.info(`VideoFx worker received unknown event msg: ${JSON.stringify(t)}`)}}settleEngineBuildPromise(e){e!==m.SEGMENTATION_MODEL.LOAD_SUCCESS?this.buildEnginePromise.rejectPromise(Error("Failed to build VideoFxProcessor's engine")):(this.logger.info("Successfully built the VideoFxEngine"),this.buildEnginePromise.resolvePromise())}settleSegmentationPromise(e){e?this.segmentationRequestPromise.resolveAndReplacePromise(e):this.segmentationRequestPromise.rejectAndReplacePromise(Error("Failed to perform a segmentation on the input image"))}settleSegmentationPromiseSAB(){try{let e=new ImageData(new Uint8ClampedArray(this.sharedImageData),m.SEGMENTATION_MODEL.WIDTH_IN_PIXELS,m.SEGMENTATION_MODEL.HEIGHT_IN_PIXELS);this.segmentationRequestPromise.resolveAndReplacePromise(e)}catch(e){this.segmentationRequestPromise.rejectAndReplacePromise(Error("Failed to perform a segmentation with a shared array buffer on the input image"))}}setToNoOpProcess(){this.process=this.noOpProcess}static isSupported(e=new d.default,t=!0){return n(this,void 0,void 0,function*(){let i=!0,r=(t,n)=>{t&&(e.info(n),i=!1)};r("undefined"==typeof globalThis,"Browser does not have globalThis."),r(!a.supportsWorker(globalThis,e),"Browser does not support web workers."),r(!a.supportsWASM(globalThis,e),"Browser does not support wasm."),r(!document.createElement("canvas").getContext("webgl2"),"Browser does not support webgl."),r(!new l.default().isVideoFxSupportedBrowser(),"Browser is unsupported for VideoFxProcessor");let s=()=>n(this,void 0,void 0,function*(){if(t)try{let t=new v(e);yield t.loadAssets(),yield t.destroy()}catch(t){return e.info("Browser environment is unable to access the required external assets."),Promise.resolve(!1)}return Promise.resolve(!0)});return Promise.resolve(!!i&&(yield s()))})}static create(e,t,i=m.RESOURCE_CONSTRAINTS.DEFAULT_PROCESSING_BUDGET_PER_FRAME){return n(this,void 0,void 0,function*(){let n=new v(e,i);try{return yield n.loadAssets(),yield n.setEffectConfig(t),n}catch(t){throw e.error(t.toString()),n.setToNoOpProcess(),Error("VideoFxProcessor built with support for only NoOp processing")}})}setEventController(e){this.eventController?this.eventController=e:(this.eventController=e,this.publishVideoFxConfigEvent())}publishVideoFxConfigEvent(){let e={backgroundBlurEnabled:this.effectConfig.backgroundBlur.isEnabled.toString(),backgroundBlurStrength:this.effectConfig.backgroundBlur.strength,backgroundReplacementEnabled:this.effectConfig.backgroundReplacement.isEnabled.toString(),backgroundFilterVersion:2};this.eventController.publishEvent("backgroundFilterConfigSelected",e)}sameVideoFxConfig(e,t){return e.backgroundBlur.isEnabled===t.backgroundBlur.isEnabled&&e.backgroundBlur.strength===t.backgroundBlur.strength&&e.backgroundReplacement.backgroundImageURL===t.backgroundReplacement.backgroundImageURL&&e.backgroundReplacement.defaultColor===t.backgroundReplacement.defaultColor&&e.backgroundReplacement.isEnabled===t.backgroundReplacement.isEnabled}}t.default=v,v.isSharedArrayBufferSupported="undefined"!=typeof SharedArrayBuffer},50563:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VideoFxSegmentationRateManager=void 0;let n=i(36419);class r{constructor(e,t){this.logger=e,this.targetSegmentationCyclePercentage=t/100,this.frameCountOverSamplingPeriod=0,this.totalSegmentationDurationOverSamplingPeriod=0,this.samplingPeriodStartTime=performance.now(),this.framesPerSegmentation=n.RESOURCE_CONSTRAINTS.SEGMENTATION_DEFAULT_FRAMES_PER_SEGMENTATION}submitFrame(){this.frameCountOverSamplingPeriod++}shouldApplySegmentation(){return this.frameCountOverSamplingPeriod%this.framesPerSegmentation==0}startSegmentation(){this.frameSegmentationStartTime=performance.now()}completeSegmentation(){this.totalSegmentationDurationOverSamplingPeriod+=performance.now()-this.frameSegmentationStartTime,this.frameCountOverSamplingPeriod>=n.RESOURCE_CONSTRAINTS.SEGMENTATION_SAMPLING_PERIOD_FRAME_COUNT&&this.adjustFramesPerSegmentation(this.totalSegmentationDurationOverSamplingPeriod/(performance.now()-this.samplingPeriodStartTime))}adjustFramesPerSegmentation(e){e>this.targetSegmentationCyclePercentage?(this.framesPerSegmentation++,this.logger.info(`Segmentation cycle percentage above the configured maximal value. Decreasing segmentation rate to 1 segmentation per ${this.framesPerSegmentation} frames`)):this.framesPerSegmentation>1&&e<this.targetSegmentationCyclePercentage&&(this.framesPerSegmentation--,this.logger.info(`Segmentation cycle percentage below the configured maximal value. Increasing segmentation rate to 1 segmentation per ${this.framesPerSegmentation} frames`)),this.totalSegmentationDurationOverSamplingPeriod=0,this.frameCountOverSamplingPeriod=0,this.samplingPeriodStartTime=performance.now()}}t.VideoFxSegmentationRateManager=r},35879:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{}t.default=i},47569:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(e){this.ids=new Set(e)}add(e){this.ids.add(e)}array(){return Array.from(this.ids.values()).sort((e,t)=>e-t)}contain(e){return this.ids.has(e)}forEach(e){this.ids.forEach(e)}empty(){return 0===this.ids.size}size(){return this.ids.size}equal(e){if(!e)return 0===this.ids.size;let t=this.array(),i=e.array();if(t.length!==i.length)return!1;for(let e=0;e<t.length;e++)if(t[e]!==i[e])return!1;return!0}clone(){return new i(this.array())}remove(e){this.ids.delete(e)}toJSON(){return this.array()}truncate(e){return new i(this.array().splice(0,e))}}t.default=i},44550:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let r=i(39163),s=n(i(47569)),o=n(i(46376));class a{constructor(e){this.logger=e,this.currentIndex=null,this.indexForSubscribe=null,this.currentSubscribeAck=null,this.subscribeTrackToStreamMap=null,this.subscribeStreamToAttendeeMap=null,this.subscribeStreamToExternalUserIdMap=null,this.subscribeSsrcToStreamMap=null,this.subscribeSsrcToGroupMap=null,this.streamToAttendeeMap=null,this.groupIdToAttendeeMap=null,this.streamToExternalUserIdMap=null,this.videoStreamDescription=new o.default,this.sendVideoStreamId=0,this.videoStreamDescription.trackLabel="AmazonChimeExpressVideo",this.videoStreamDescription.streamId=2,this.videoStreamDescription.groupId=2}localStreamDescriptions(){return[this.videoStreamDescription.clone()]}convertBpsToKbps(e){return e>0&&e<1e3?1:Math.trunc(e/1e3)}remoteStreamDescriptions(){if(!this.currentIndex||!this.currentIndex.sources)return[];let e=[];return this.currentIndex.sources.forEach(t=>{let i=new o.default;i.attendeeId=t.attendeeId,i.groupId=t.groupId,i.streamId=t.streamId,i.maxBitrateKbps=t.maxBitrateKbps,i.avgBitrateKbps=this.convertBpsToKbps(t.avgBitrateBps),i.width=t.width,i.height=t.height,i.maxFrameRate=t.framerate,e.push(i)}),e}integrateUplinkPolicyDecision(e){if(e&&e.length){let t=e[0];this.videoStreamDescription.maxBitrateKbps=t.maxBitrate/1e3,this.videoStreamDescription.maxFrameRate=t.maxFramerate}}integrateIndexFrame(e){if(this.currentIndex=e,!e)return;let t=new Map,i=!1;for(let n of e.sources){if(!t.has(n.attendeeId)){t.set(n.attendeeId,n.groupId);continue}let e=t.get(n.attendeeId);e<n.groupId&&(this.logger.warn(`Old group ID ${e} found for attendee ID ${n.attendeeId}, replacing with newer group ID ${n.groupId}`),t.set(n.attendeeId,n.groupId)),i=!0}i&&(this.currentIndex.sources=this.currentIndex.sources.filter(e=>t.get(e.attendeeId)===e.groupId)),this.streamToAttendeeMap=null,this.groupIdToAttendeeMap=null,this.streamToExternalUserIdMap=null}subscribeFrameSent(){this.indexForSubscribe=this.currentIndex}integrateSubscribeAckFrame(e){this.currentSubscribeAck=e,this.subscribeTrackToStreamMap=this.buildTrackToStreamMap(this.currentSubscribeAck),this.subscribeSsrcToStreamMap=this.buildSSRCToStreamMap(this.currentSubscribeAck),this.subscribeSsrcToGroupMap=this.buildSSRCToGroupMap(this.currentSubscribeAck),this.subscribeStreamToAttendeeMap=this.buildStreamToAttendeeMap(this.indexForSubscribe),this.subscribeStreamToExternalUserIdMap=this.buildStreamExternalUserIdMap(this.indexForSubscribe),this.sendVideoStreamId=0,e.allocations&&void 0!==e.allocations&&e.allocations.length>0&&(this.sendVideoStreamId=e.allocations[0].streamId)}integrateBitratesFrame(e){if(this.currentIndex)for(let t of e.bitrates){let e=this.currentIndex.sources.find(e=>e.streamId===t.sourceStreamId);void 0!==e&&(e.avgBitrateBps=t.avgBitrateBps)}}allStreams(){let e=new s.default;if(this.currentIndex)for(let t of this.currentIndex.sources)e.add(t.streamId);return e}allVideoSendingSourcesExcludingSelf(e){let t=[],i=new Set;if(this.currentIndex&&this.currentIndex.sources&&this.currentIndex.sources.length)for(let n of this.currentIndex.sources){let{attendeeId:s,externalUserId:o,mediaType:a}=n;s===e||a!==r.SdkStreamMediaType.VIDEO||i.has(s)||(t.push({attendee:{attendeeId:s,externalUserId:o}}),i.add(s))}return t}streamSelectionUnderBandwidthConstraint(e,t,i,n){let o=new Set;if(this.currentIndex)for(let n of this.currentIndex.sources)n.attendeeId!==e&&n.mediaType===r.SdkStreamMediaType.VIDEO&&(t.has(n.attendeeId)||i.has(n.attendeeId)||o.add(n.attendeeId));let a=this.buildAttendeeToSortedStreamDescriptorMapExcludingSelf(e),l=new Map,d=0;a.forEach((e,t)=>{l.set(t,e[0]),d+=e[0].maxBitrateKbps}),d=this.trySelectHighBitrateForAttendees(a,t,d,n,l),this.trySelectHighBitrateForAttendees(a,o,d,n,l);let u=new s.default;for(let e of l.values())u.add(e.streamId);return u}highestQualityStreamFromEachGroupExcludingSelf(e){let t=new s.default;if(this.currentIndex){let i=new Map;for(let t of this.currentIndex.sources)t.attendeeId!==e&&t.mediaType===r.SdkStreamMediaType.VIDEO&&(!i.has(t.groupId)||t.maxBitrateKbps>i.get(t.groupId).maxBitrateKbps)&&i.set(t.groupId,t);for(let e of i.values())t.add(e.streamId)}return t}numberOfVideoPublishingParticipantsExcludingSelf(e){return this.highestQualityStreamFromEachGroupExcludingSelf(e).array().length}numberOfParticipants(){return this.currentIndex.numParticipants?this.currentIndex.numParticipants:-1}attendeeIdForTrack(e){let t=this.streamIdForTrack(e);return void 0!==t&&this.subscribeStreamToAttendeeMap?this.subscribeStreamToAttendeeMap.get(t)||(this.logger.info(`track ${e} (stream ${t}) does not correspond to a known attendee`),""):(this.logger.warn(`no attendee found for track ${e}`),"")}externalUserIdForTrack(e){let t=this.streamIdForTrack(e);return void 0!==t&&this.subscribeStreamToExternalUserIdMap?this.subscribeStreamToExternalUserIdMap.get(t)||(this.logger.info(`track ${e} (stream ${t}) does not correspond to a known externalUserId`),""):(this.logger.warn(`no external user id found for track ${e}`),"")}attendeeIdForStreamId(e){if(!this.streamToAttendeeMap){if(!this.currentIndex)return"";this.streamToAttendeeMap=this.buildStreamToAttendeeMap(this.currentIndex)}return this.streamToAttendeeMap.get(e)||(this.logger.info(`stream ID ${e} does not correspond to a known attendee`),"")}attendeeIdForGroupId(e){if(!this.groupIdToAttendeeMap){if(!this.currentIndex)return"";this.groupIdToAttendeeMap=this.buildGroupIdToAttendeeMap(this.currentIndex)}return this.groupIdToAttendeeMap.get(e)||(this.logger.info(`group ID ${e} does not correspond to a known attendee`),"")}groupIdForStreamId(e){if(this.currentIndex&&this.currentIndex.sources){for(let t of this.currentIndex.sources)if(t.streamId===e)return t.groupId;if(this.indexForSubscribe){for(let t of this.indexForSubscribe.sources)if(t.streamId===e)return t.groupId}}}StreamIdsInSameGroup(e,t){return this.groupIdForStreamId(e)===this.groupIdForStreamId(t)}streamIdForTrack(e){if(this.subscribeTrackToStreamMap)return this.subscribeTrackToStreamMap.get(e)}streamIdForSSRC(e){if(this.subscribeSsrcToStreamMap)return this.subscribeSsrcToStreamMap.get(e)}overrideStreamIdMappings(e,t){if(this.subscribeTrackToStreamMap){for(let[i,n]of this.subscribeTrackToStreamMap.entries())if(e===n){this.subscribeTrackToStreamMap.set(i,t);break}}if(this.subscribeSsrcToStreamMap){for(let[i,n]of this.subscribeSsrcToStreamMap.entries())if(e===n){this.subscribeSsrcToStreamMap.set(i,t);break}}}groupIdForSSRC(e){if(this.subscribeSsrcToGroupMap)return this.subscribeSsrcToGroupMap.get(e)}streamsPausedAtSource(){let e=new s.default;if(this.currentIndex)for(let t of this.currentIndex.pausedAtSourceIds)e.add(t);return e}sendVideoStreamIdFromRid(e){return this.sendVideoStreamId}buildTrackToStreamMap(e){let t=new Map;for(let i of(this.logger.debug(()=>`trackMap ${JSON.stringify(e.tracks)}`),e.tracks))i.trackLabel.length>0&&i.streamId>0&&t.set(i.trackLabel,i.streamId);return t}buildSSRCToStreamMap(e){let t=new Map;for(let i of(this.logger.debug(()=>`ssrcMap ${JSON.stringify(e.tracks)}`),e.tracks))i.trackLabel.length>0&&i.streamId>0&&t.set(i.ssrc,i.streamId);return t}buildSSRCToGroupMap(e){let t=new Map;for(let i of e.tracks)i.trackLabel.length>0&&i.streamId>0&&t.set(i.ssrc,this.groupIdForStreamId(i.streamId));return t}buildStreamToAttendeeMap(e){let t=new Map;if(e)for(let i of e.sources)t.set(i.streamId,i.attendeeId);return t}buildGroupIdToAttendeeMap(e){let t=new Map;for(let i of e.sources)t.set(i.groupId,i.attendeeId);return t}buildStreamExternalUserIdMap(e){let t=new Map;if(e)for(let i of e.sources)i.externalUserId&&t.set(i.streamId,i.externalUserId);return t}trySelectHighBitrateForAttendees(e,t,i,n,r){for(let s of t){if(i>=n)break;if(e.has(s)){for(let t of e.get(s).reverse())if(i-r.get(s).maxBitrateKbps+t.maxBitrateKbps<n){i=i-r.get(s).maxBitrateKbps+t.maxBitrateKbps,r.set(s,t);break}}}return i}buildAttendeeToSortedStreamDescriptorMapExcludingSelf(e){let t=new Map;if(this.currentIndex)for(let i of this.currentIndex.sources)i.attendeeId!==e&&i.mediaType===r.SdkStreamMediaType.VIDEO&&(t.has(i.attendeeId)?t.get(i.attendeeId).push(i):t.set(i.attendeeId,[i]));return t.forEach((e,t)=>{e.sort((e,t)=>e.maxBitrateKbps>t.maxBitrateKbps?1:e.maxBitrateKbps<t.maxBitrateKbps?-1:0)}),t}}t.default=a},62073:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let r=i(39163),s=n(i(44550)),o=n(i(46376));class a extends s.default{constructor(){super(...arguments),this.streamIdToBitrateKbpsMap=new Map,this._localStreamInfos=[],this._sendRidToVideoStreamIdMap=new Map}localStreamDescriptions(){let e=[];return this._localStreamInfos.forEach(t=>{e.push(t.clone())}),e}integrateUplinkPolicyDecision(e){let t=!0,i=0;for(let n=0;n<e.length;n++){let r=e[n].maxBitrate/1e3,s=e[n].maxFramerate;if(!t||n===this._localStreamInfos.length){t=!1;let a=new o.default;a.maxBitrateKbps=r,a.maxFrameRate=s,a.disabledByUplinkPolicy=0===r,a.rid=e[n].rid,0!==r&&(a.timeEnabled=Date.now()),this._localStreamInfos.push(a),i++;continue}0===this._localStreamInfos[i].maxBitrateKbps&&r>0&&(this._localStreamInfos[i].timeEnabled=Date.now()),this._localStreamInfos[i].maxBitrateKbps=r,this._localStreamInfos[i].maxFrameRate=s,this._localStreamInfos[i].disabledByUplinkPolicy=0===r,i++}t&&this._localStreamInfos.splice(i)}integrateBitratesFrame(e){super.integrateBitratesFrame(e);let t=new Set,i=new Set(this.streamIdToBitrateKbpsMap.keys());for(let i of e.bitrates)t.add(i.sourceStreamId),this.streamIdToBitrateKbpsMap.set(i.sourceStreamId,this.convertBpsToKbps(i.avgBitrateBps));for(let e of i)t.has(e)||(this.streamIdToBitrateKbpsMap.get(e)===a.UNSEEN_STREAM_BITRATE?this.streamIdToBitrateKbpsMap.set(e,a.RECENTLY_INACTIVE_STREAM_BITRATE):this.streamIdToBitrateKbpsMap.set(e,a.NOT_SENDING_STREAM_BITRATE));this.logLocalStreamDescriptions()}logLocalStreamDescriptions(){let e="";for(let t of this._localStreamInfos)e+=`streamId=${t.streamId} maxBitrate=${t.maxBitrateKbps} disabledByUplink=${t.disabledByUplinkPolicy}
`;this.logger.debug(()=>e)}integrateIndexFrame(e){super.integrateIndexFrame(e);let t=new Set,i=new Set(this.streamIdToBitrateKbpsMap.keys());for(let e of this.currentIndex.sources)e.mediaType===r.SdkStreamMediaType.VIDEO&&(t.add(e.streamId),this.streamIdToBitrateKbpsMap.has(e.streamId)||this.streamIdToBitrateKbpsMap.set(e.streamId,a.UNSEEN_STREAM_BITRATE));for(let e of i)t.has(e)||this.streamIdToBitrateKbpsMap.delete(e)}integrateSubscribeAckFrame(e){if(super.integrateSubscribeAckFrame(e),!e.allocations||void 0===e.allocations)return;let t=0;for(let i of(this._sendRidToVideoStreamIdMap.clear(),e.allocations)){if(this._localStreamInfos.length<t+1){this.logger.info("simulcast: allocation has more than number of local streams");break}this._localStreamInfos[t].groupId=i.groupId,this._localStreamInfos[t].streamId=i.streamId,this.streamIdToBitrateKbpsMap.has(i.streamId)||this.streamIdToBitrateKbpsMap.set(i.streamId,a.UNSEEN_STREAM_BITRATE),this._sendRidToVideoStreamIdMap.set(this._localStreamInfos[t].rid,i.streamId),t++}}sendVideoStreamIdFromRid(e){let t=0;return this._sendRidToVideoStreamIdMap.has(e)&&(t=this._sendRidToVideoStreamIdMap.get(e)),t}}t.default=a,a.UNSEEN_STREAM_BITRATE=-2,a.RECENTLY_INACTIVE_STREAM_BITRATE=-1,a.NOT_SENDING_STREAM_BITRATE=0,a.BitratesMsgFrequencyMs=4e3},46376:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=i(39163);class r{constructor(e,t,i,n,r){this.attendeeId="",this.groupId=0,this.streamId=0,this.ssrc=0,this.trackLabel="",this.maxBitrateKbps=0,this.avgBitrateKbps=0,this.maxFrameRate=0,this.width=0,this.height=0,this.timeEnabled=0,this.disabledByWebRTC=!1,this.disabledByUplinkPolicy=!1,this.rid="",this.attendeeId=e,this.groupId=t,this.streamId=i,this.maxBitrateKbps=n,this.avgBitrateKbps=r}clone(){let e=new r;return e.attendeeId=this.attendeeId,e.groupId=this.groupId,e.streamId=this.streamId,e.ssrc=this.ssrc,e.trackLabel=this.trackLabel,e.maxBitrateKbps=this.maxBitrateKbps,e.avgBitrateKbps=this.avgBitrateKbps,e.maxFrameRate=this.maxFrameRate,e.timeEnabled=this.timeEnabled,e.disabledByUplinkPolicy=this.disabledByUplinkPolicy,e.width=this.width,e.height=this.height,e}toStreamDescriptor(){let e=n.SdkStreamDescriptor.create();return e.mediaType=n.SdkStreamMediaType.VIDEO,e.trackLabel=this.trackLabel,e.attendeeId=this.attendeeId,e.streamId=this.streamId,e.groupId=this.groupId,e.framerate=this.maxFrameRate,e.maxBitrateKbps=this.disabledByUplinkPolicy?0:this.maxBitrateKbps,e.avgBitrateBps=this.avgBitrateKbps,e}totalPixels(){return this.width*this.height}}t.default=r},82905:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let r=n(i(81341)),s=n(i(77041)),o=n(i(54695));class a{constructor(e,t,i,n){this.tileController=i,this.devicePixelRatioMonitor=n,this.tileState=new o.default,this.tileState.tileId=e,this.tileState.localTile=t,this.devicePixelRatioMonitor.registerObserver(this)}static connectVideoStreamToVideoElement(e,t,i){let n=i&&"environment"!==e.getVideoTracks()[0].getSettings().facingMode?"rotateY(180deg)":"";if(a.setVideoElementFlag(t,"disablePictureInPicture",i),a.setVideoElementFlag(t,"disableRemotePlayback",i),t.style.transform!==n&&(t.style.transform=n),t.hasAttribute("controls")&&t.removeAttribute("controls"),t.hasAttribute("autoplay")||t.setAttribute("autoplay","true"),t.hasAttribute("playsinline")||t.setAttribute("playsinline","true"),t.hasAttribute("muted")||(t.setAttribute("muted","true"),t.muted=!0),t.srcObject!==e&&(t.srcObject=e,new r.default().requiresVideoPlayWorkaround()&&t.paused)){let e=t.play();void 0!==e&&e.catch(e=>{console.warn("Error playing video in Safari",e)}).then(()=>{console.debug("Video played successfully in Safari")})}}static disconnectVideoStreamFromVideoElement(e,t,i=!1){if(e){if(t)i||(e.srcObject=null,e.style.transform="");else{if(!e.srcObject)return;e.pause(),e.style.transform="",a.setVideoElementFlag(e,"disablePictureInPicture",!1),a.setVideoElementFlag(e,"disableRemotePlayback",!1),e.srcObject=null}}}destroy(){this.devicePixelRatioMonitor.removeObserver(this),this.tileState.boundVideoElement&&this.tileState.boundVideoElement.srcObject===this.tileState.boundVideoStream&&a.disconnectVideoStreamFromVideoElement(this.tileState.boundVideoElement,!1),this.tileState=new o.default}devicePixelRatioChanged(e){this.tileState.devicePixelRatio=e,this.sendTileStateUpdate()}id(){return this.tileState.tileId}state(){return this.tileState.clone()}stateRef(){return this.tileState}bindVideoStream(e,t,i,n,r,o,a){let l=!1;this.tileState.boundAttendeeId!==e&&(this.tileState.boundAttendeeId=e,new s.default(e).hasModality(s.default.MODALITY_CONTENT)&&(this.tileState.isContent=!0),l=!0),this.tileState.boundExternalUserId!==a&&(this.tileState.boundExternalUserId=a,l=!0),this.tileState.localTile!==t&&(this.tileState.localTile=t,l=!0),this.tileState.boundVideoStream!==i&&(this.tileState.boundVideoStream=i,l=!0),this.tileState.videoStreamContentWidth!==n&&(this.tileState.videoStreamContentWidth=n,l=!0),this.tileState.videoStreamContentHeight!==r&&(this.tileState.videoStreamContentHeight=r,l=!0),this.tileState.streamId!==o&&(this.tileState.streamId=o,l=!0),l&&this.sendTileStateUpdate()}bindVideoElement(e){let t=!1;this.tileState.boundVideoElement!==e&&(this.tileState.boundVideoElement=e,t=!0),null!==this.tileState.boundVideoElement?(this.tileState.videoElementCSSWidthPixels!==e.clientWidth&&(this.tileState.videoElementCSSWidthPixels=e.clientWidth,t=!0),this.tileState.videoElementCSSHeightPixels!==e.clientHeight&&(this.tileState.videoElementCSSHeightPixels=e.clientHeight,t=!0)):(this.tileState.videoElementCSSWidthPixels=null,this.tileState.videoElementCSSHeightPixels=null),t&&this.sendTileStateUpdate()}pause(){this.tileState.paused||(this.tileState.paused=!0,this.sendTileStateUpdate())}unpause(){this.tileState.paused&&(this.tileState.paused=!1,this.sendTileStateUpdate())}markPoorConnection(){return!this.tileState.poorConnection&&(this.tileState.poorConnection=!0,this.sendTileStateUpdate(),!0)}unmarkPoorConnection(){return!!this.tileState.poorConnection&&(this.tileState.poorConnection=!1,this.sendTileStateUpdate(),!0)}capture(){if(!this.tileState.active)return null;let e=document.createElement("canvas"),t=this.tileState.boundVideoElement;e.width=t.videoWidth||t.width,e.height=t.videoHeight||t.height;let i=e.getContext("2d");return i.drawImage(t,0,0,e.width,e.height),i.getImageData(0,0,e.width,e.height)}setStreamId(e){this.tileState.streamId=e,this.tileController.sendTileStateUpdate(this.state())}sendTileStateUpdate(){this.updateActiveState(),this.updateVideoStreamOnVideoElement(),this.updateVideoElementPhysicalPixels(),this.tileController.sendTileStateUpdate(this.state())}updateActiveState(){this.tileState.active=!!(!this.tileState.paused&&!this.tileState.poorConnection&&this.tileState.boundAttendeeId&&this.tileState.boundVideoElement&&this.tileState.boundVideoStream)}updateVideoElementPhysicalPixels(){"number"==typeof this.tileState.videoElementCSSWidthPixels&&"number"==typeof this.tileState.videoElementCSSHeightPixels?(this.tileState.videoElementPhysicalWidthPixels=this.tileState.devicePixelRatio*this.tileState.videoElementCSSWidthPixels,this.tileState.videoElementPhysicalHeightPixels=this.tileState.devicePixelRatio*this.tileState.videoElementCSSHeightPixels):(this.tileState.videoElementPhysicalWidthPixels=null,this.tileState.videoElementPhysicalHeightPixels=null)}updateVideoStreamOnVideoElement(){this.tileState.active?a.connectVideoStreamToVideoElement(this.tileState.boundVideoStream,this.tileState.boundVideoElement,this.tileState.localTile):a.disconnectVideoStreamFromVideoElement(this.tileState.boundVideoElement,this.tileState.paused,this.tileController.keepLastFrameWhenPaused)}static setVideoElementFlag(e,t,i){t in e&&(e[t]=i)}}t.default=a},54695:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(){this.tileId=null,this.localTile=!1,this.localTileStarted=!1,this.isContent=!1,this.active=!1,this.paused=!1,this.poorConnection=!1,this.boundAttendeeId=null,this.boundExternalUserId=null,this.boundVideoStream=null,this.boundVideoElement=null,this.nameplate=null,this.videoStreamContentWidth=null,this.videoStreamContentHeight=null,this.videoElementCSSWidthPixels=null,this.videoElementCSSHeightPixels=null,this.devicePixelRatio=0,this.videoElementPhysicalWidthPixels=null,this.videoElementPhysicalHeightPixels=null,this.streamId=null}clone(){let e=new i;return e.tileId=this.tileId,e.localTile=this.localTile,e.isContent=this.isContent,e.active=this.active,e.paused=this.paused,e.poorConnection=this.poorConnection,e.boundAttendeeId=this.boundAttendeeId,e.boundExternalUserId=this.boundExternalUserId,e.boundVideoStream=this.boundVideoStream,e.boundVideoElement=this.boundVideoElement,e.nameplate=this.nameplate,e.videoStreamContentWidth=this.videoStreamContentWidth,e.videoStreamContentHeight=this.videoStreamContentHeight,e.videoElementCSSWidthPixels=this.videoElementCSSWidthPixels,e.videoElementCSSHeightPixels=this.videoElementCSSHeightPixels,e.devicePixelRatio=this.devicePixelRatio,e.videoElementPhysicalWidthPixels=this.videoElementPhysicalWidthPixels,e.videoElementPhysicalHeightPixels=this.videoElementPhysicalHeightPixels,e.streamId=this.streamId,e}}t.default=i},54008:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=r(i(55510)),o=r(i(37188)),a=r(i(51064)),l=i(71906),d=r(i(82905));class u{constructor(e,t,i){this.tileFactory=e,this.audioVideoController=t,this.logger=i,this.tileMap=new Map,this.nextTileId=1,this.currentLocalTile=null,this.currentPausedTilesByIds=new Set,this.keepLastFrameWhenPaused=!1,this.keepLastFrameWhenPaused=t.configuration.keepLastFrameWhenPaused}createDevicePixelRatioMonitorIfNeeded(){this.devicePixelRatioMonitor||(this.devicePixelRatioMonitor=new o.default(new a.default,this.logger))}discardDevicePixelRatioMonitorIfNotNeeded(){return n(this,void 0,void 0,function*(){if(this.tileMap.size||!this.devicePixelRatioMonitor)return;let e=this.devicePixelRatioMonitor;return this.devicePixelRatioMonitor=void 0,e.destroy()})}bindVideoElement(e,t){let i=this.getVideoTile(e);if(null===i){this.logger.warn(`Ignoring video element binding for unknown tile id ${e}`);return}i.bindVideoElement(t)}unbindVideoElement(e,t=!0){let i=this.getVideoTile(e);if(null===i){this.logger.warn(`Ignoring video element unbinding for unknown tile id ${e}`);return}this.logger.info("Unbinding the video element");let n=i.stateRef().boundVideoElement;i.bindVideoElement(null),t&&(this.logger.info("Cleaning up the video element"),d.default.disconnectVideoStreamFromVideoElement(n,!1))}startLocalVideoTile(){if(this.audioVideoController.configuration.meetingFeatures.videoMaxResolution===s.default.VideoDisabled)return this.logger.warn("Could not start camera video because max video resolution was set to None"),-1;let e=this.findOrCreateLocalVideoTile();return this.currentLocalTile.stateRef().localTileStarted=!0,this.audioVideoController.update({needsRenegotiation:!0}),e.id()}stopLocalVideoTile(){this.currentLocalTile&&(this.currentLocalTile.stateRef().localTileStarted=!1,this.currentLocalTile.bindVideoStream(this.audioVideoController.configuration.credentials.attendeeId,!0,null,null,null,null,this.audioVideoController.configuration.credentials.externalUserId),this.audioVideoController.update({needsRenegotiation:!0}))}hasStartedLocalVideoTile(){return!!(this.currentLocalTile&&this.currentLocalTile.stateRef().localTileStarted)}removeLocalVideoTile(){this.currentLocalTile&&this.removeVideoTile(this.currentLocalTile.id())}getLocalVideoTile(){return this.currentLocalTile}pauseVideoTile(e){let t=this.getVideoTile(e);t&&(this.currentPausedTilesByIds.has(e)||(this.audioVideoController.pauseReceivingStream(t.stateRef().streamId),this.currentPausedTilesByIds.add(e)),t.pause())}unpauseVideoTile(e){let t=this.getVideoTile(e);t&&(this.currentPausedTilesByIds.has(e)&&(this.audioVideoController.resumeReceivingStream(t.stateRef().streamId),this.currentPausedTilesByIds.delete(e)),t.unpause())}getVideoTile(e){return this.tileMap.has(e)?this.tileMap.get(e):null}getVideoTileArea(e){let t=e.state(),i=0,n=0;return t.boundVideoElement&&(i=t.boundVideoElement.clientHeight*t.devicePixelRatio,n=t.boundVideoElement.clientWidth*t.devicePixelRatio),i*n}getAllRemoteVideoTiles(){let e=[];return this.tileMap.forEach((t,i)=>{this.currentLocalTile&&i===this.currentLocalTile.id()||e.push(t)}),e}getAllVideoTiles(){return Array.from(this.tileMap.values())}addVideoTile(e=!1){let t=this.nextTileId;this.nextTileId+=1,this.createDevicePixelRatioMonitorIfNeeded();let i=this.tileFactory.makeTile(t,e,this,this.devicePixelRatioMonitor);return this.tileMap.set(t,i),i}removeVideoTile(e){if(!this.tileMap.has(e))return;let t=this.tileMap.get(e);this.currentLocalTile===t&&(this.currentLocalTile=null),t.destroy(),this.tileMap.delete(e),this.audioVideoController.forEachObserver(t=>{l.Maybe.of(t.videoTileWasRemoved).map(i=>i.bind(t)(e))}),this.discardDevicePixelRatioMonitorIfNotNeeded()}removeVideoTilesByAttendeeId(e){let t=[];for(let i of this.getAllVideoTiles()){let n=i.state();n.boundAttendeeId===e&&(this.removeVideoTile(n.tileId),t.push(n.tileId))}return t}removeAllVideoTiles(){for(let e of Array.from(this.tileMap.keys()))this.removeVideoTile(e)}sendTileStateUpdate(e){this.audioVideoController.forEachObserver(t=>{l.Maybe.of(t.videoTileDidUpdate).map(i=>i.bind(t)(e))})}haveVideoTilesWithStreams(){for(let e of this.getAllVideoTiles())if(e.state().boundVideoStream)return!0;return!1}haveVideoTileForAttendeeId(e){return!!this.getVideoTileForAttendeeId(e)}getVideoTileForAttendeeId(e){for(let t of this.getAllVideoTiles())if(t.state().boundAttendeeId===e)return t}captureVideoTile(e){let t=this.getVideoTile(e);return t?t.capture():null}findOrCreateLocalVideoTile(){return this.currentLocalTile||(this.currentLocalTile=this.addVideoTile(!0),this.currentLocalTile.bindVideoStream(this.audioVideoController.configuration.credentials.attendeeId,!0,null,null,null,null,this.audioVideoController.configuration.credentials.externalUserId)),this.currentLocalTile}}t.default=u},86351:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let r=n(i(82905));class s{makeTile(e,t,i,n){return new r.default(e,t,i,n)}}t.default=s},47739:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{}t.default=i},88576:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let r=n(i(73920)),s=n(i(14055)),o=i(71906),a=n(i(48786)),l=n(i(47739));class d{constructor(e,t){this.selfAttendeeId=e,this.logger=t,this.numSenders=0,this.shouldDisableSimulcast=!1,this.newQualityMap=new Map,this.currentQualityMap=new Map,this.newActiveStreams=1,this.videoIndex=null,this.observerQueue=new Set,this.hiTargetBitrateKbps=d.kHiTargetBitrateKbpsHd,this.midTargetBitrateKbps=d.kMidTargetBitrateKbpsHd,this.lowTargetBitrateKbps=d.kLowTargetBitrateKbpsHd,this.enableFhdVideo=!1,this.optimalParameters=new a.default(0,0,0,0,!0),this.parametersInEffect=new a.default(0,0,0,0,!0),this.currentQualityMap=this.fillEncodingParamWithBitrates([this.lowTargetBitrateKbps,0,this.hiTargetBitrateKbps]),this.newQualityMap=this.fillEncodingParamWithBitrates([this.lowTargetBitrateKbps,0,this.hiTargetBitrateKbps])}updateConnectionMetric(e){}calculateEncodingParameters(){let e=[new l.default,new l.default,new l.default];this.shouldDisableSimulcast?(this.newActiveStreams=0,e[0].maxBitrateKbps=0,e[1].maxBitrateKbps=this.hiTargetBitrateKbps,e[2].maxBitrateKbps=0):this.numSenders<=4?(this.newActiveStreams=1,e[0].maxBitrateKbps=this.lowTargetBitrateKbps,e[1].maxBitrateKbps=0,e[2].maxBitrateKbps=this.hiTargetBitrateKbps):(this.newActiveStreams=2,e[0].maxBitrateKbps=2*this.lowTargetBitrateKbps/3,e[1].maxBitrateKbps=this.numSenders<=6?this.midTargetBitrateKbps:.6*this.midTargetBitrateKbps,e[2].maxBitrateKbps=0);let t=e.map((e,t,i)=>e.maxBitrateKbps);return this.newQualityMap=this.fillEncodingParamWithBitrates(t),this.encodingParametersEqual()||this.logger.info(`simulcast: policy:calculateEncodingParameters numSources:${this.numSenders} shouldDisableSimulcast:${this.shouldDisableSimulcast} newQualityMap: ${this.getQualityMapString(this.newQualityMap)}`),this.newQualityMap}chooseMediaTrackConstraints(){}chooseEncodingParameters(){return this.currentQualityMap=this.newQualityMap,this.activeStreamsToPublish!==this.newActiveStreams&&(this.activeStreamsToPublish=this.newActiveStreams,this.publishEncodingSimulcastLayer()),this.currentQualityMap}updateIndex(e){let t=e.numberOfVideoPublishingParticipantsExcludingSelf(this.selfAttendeeId)+1,i=t!==this.numSenders,n=e.numberOfParticipants(),r=n>=0&&n<=2,s=this.shouldDisableSimulcast!==r;this.numSenders=t,this.shouldDisableSimulcast=r,this.optimalParameters=new a.default(this.captureWidth(),this.captureHeight(),this.captureFrameRate(),this.maxBandwidthKbps(),!1),this.videoIndex=e,(i||s)&&(this.newQualityMap=this.calculateEncodingParameters())}wantsResubscribe(){return!this.encodingParametersEqual()}compareEncodingParameter(e,t){return JSON.stringify(e)===JSON.stringify(t)}encodingParametersEqual(){let e=!1;for(let t of s.default.NAME_ARR_ASCENDING)if(e=e||!this.compareEncodingParameter(this.newQualityMap.get(t),this.currentQualityMap.get(t)))break;return!e}chooseCaptureAndEncodeParameters(){return this.parametersInEffect=this.optimalParameters.clone(),this.parametersInEffect.clone()}captureWidth(){return this.enableFhdVideo?1920:1280}captureHeight(){return this.enableFhdVideo?1080:768}captureFrameRate(){return 15}maxBandwidthKbps(){return this.enableFhdVideo?2500:1400}setIdealMaxBandwidthKbps(e){}setHasBandwidthPriority(e){}setHighResolutionFeatureEnabled(e){this.enableFhdVideo=e,this.hiTargetBitrateKbps=e?d.kHiTargetBitrateKbpsFhd:d.kHiTargetBitrateKbpsHd,this.midTargetBitrateKbps=e?d.kMidTargetBitrateKbpsFhd:d.kMidTargetBitrateKbpsHd,this.lowTargetBitrateKbps=e?d.kLowTargetBitrateKbpsFhd:d.kLowTargetBitrateKbpsHd}wantsVideoDependencyDescriptorRtpHeaderExtension(){return!0}fillEncodingParamWithBitrates(e){let t=new Map,i=1e3,n=s.default.NAME_ARR_ASCENDING,r=e,o=this.shouldDisableSimulcast?1:4;for(let e=0;e<n.length;e++){let s=n[e];t.set(s,{rid:s,active:r[e]>0,scaleResolutionDownBy:Math.max(o,1),maxBitrate:r[e]*i}),o/=2}return t}getQualityMapString(e){let t="";return 3===this.videoIndex.localStreamDescriptions().length&&e.forEach(e=>{t+=`{ rid: ${e.rid} active:${e.active} maxBitrate:${e.maxBitrate}}`}),t}getEncodingSimulcastLayer(e){switch(e){case 0:return r.default.High;case 1:return r.default.LowAndHigh;case 2:return r.default.LowAndMedium}}publishEncodingSimulcastLayer(){let e=this.getEncodingSimulcastLayer(this.activeStreamsToPublish);this.forEachObserver(t=>{o.Maybe.of(t.encodingSimulcastLayersDidChange).map(i=>i.bind(t)(e))})}addObserver(e){this.logger.info("adding simulcast uplink observer"),this.observerQueue.add(e)}removeObserver(e){this.logger.info("removing simulcast uplink observer"),this.observerQueue.delete(e)}forEachObserver(e){for(let t of this.observerQueue)e(t)}}t.default=d,d.kHiTargetBitrateKbpsHd=1200,d.kMidTargetBitrateKbpsHd=600,d.kLowTargetBitrateKbpsHd=300,d.kHiTargetBitrateKbpsFhd=2e3,d.kMidTargetBitrateKbpsFhd=1e3,d.kLowTargetBitrateKbpsFhd=500},49357:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let r=n(i(1529));class s{constructor(e,t){this.encodingParams=t,this.enableUhdContent=!1,this.defaultHiTargetBitrateKbps=1200,this.defaultLowTargetBitrateKbps=300}updateConnectionMetric(e){}chooseMediaTrackConstraints(){}chooseEncodingParameters(){var e,t,i,n,s,o,a,l,d,u,c,h;let f=new Map,p=1e3,m=r.default.NAME_ARR_ASCENDING;return f.set(m[0],{rid:m[0],active:!0,scaleResolutionDownBy:(null===(t=null===(e=this.encodingParams)||void 0===e?void 0:e.low)||void 0===t?void 0:t.scaleResolutionDownBy)||2,maxBitrate:((null===(n=null===(i=this.encodingParams)||void 0===i?void 0:i.low)||void 0===n?void 0:n.maxBitrateKbps)||this.defaultLowTargetBitrateKbps)*p,maxFramerate:(null===(o=null===(s=this.encodingParams)||void 0===s?void 0:s.low)||void 0===o?void 0:o.maxFramerate)||5}),f.set(m[1],{rid:m[1],active:!0,scaleResolutionDownBy:(null===(l=null===(a=this.encodingParams)||void 0===a?void 0:a.high)||void 0===l?void 0:l.scaleResolutionDownBy)||1,maxBitrate:((null===(u=null===(d=this.encodingParams)||void 0===d?void 0:d.high)||void 0===u?void 0:u.maxBitrateKbps)||this.defaultHiTargetBitrateKbps)*p,maxFramerate:null===(h=null===(c=this.encodingParams)||void 0===c?void 0:c.high)||void 0===h?void 0:h.maxFramerate}),f}updateIndex(e){}wantsResubscribe(){return!1}chooseCaptureAndEncodeParameters(){}maxBandwidthKbps(){return this.enableUhdContent?2e3:1200}setIdealMaxBandwidthKbps(e){}setHasBandwidthPriority(e){}setHighResolutionFeatureEnabled(e){this.enableUhdContent=e,this.defaultHiTargetBitrateKbps=e?2e3:1200,this.defaultLowTargetBitrateKbps=e?500:300}addObserver(e){}removeObserver(e){}forEachObserver(e){}}t.default=s},46735:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=r(i(48786));class o{constructor(e,t=!0,i,n){this.selfAttendeeId=e,this.scaleResolution=t,this.logger=i,this.browserBehavior=n,this.numberOfPublishedVideoSources=void 0,this.idealMaxBandwidthKbps=1500,this.hasBandwidthPriority=!1,this.encodingParamMap=new Map,this.enableHighResolutionFeature=!1,this.enableSVC=!1,this.isUsingSVCCodec=!0,this.numParticipants=0,this.reset()}reset(){this.numberOfPublishedVideoSources=void 0,this.optimalParameters=new s.default(0,0,0,0,!1),this.parametersInEffect=new s.default(0,0,0,0,!1),this.encodingParamMap.set(o.encodingMapKey,{maxBitrate:0})}updateConnectionMetric(e){}chooseMediaTrackConstraints(){return{}}chooseEncodingParameters(){return new Map}updateIndex(e){var t;let i=!0;this.transceiverController&&(i=this.transceiverController.hasVideoInput());let n=e.numberOfVideoPublishingParticipantsExcludingSelf(this.selfAttendeeId)+(i?1:0),r=e.numberOfParticipants();if(this.numParticipants===r&&this.numberOfPublishedVideoSources===n){null===(t=this.logger)||void 0===t||t.debug("Skipping update index; Number of participants has not changed");return}this.numberOfPublishedVideoSources=n,this.numParticipants=r,this.updateOptimalParameters()}wantsResubscribe(){return!this.parametersInEffect.equal(this.optimalParameters)}chooseCaptureAndEncodeParameters(){return this.parametersInEffect=this.optimalParameters.clone(),this.parametersInEffect.clone()}updateOptimalParameters(){let e=1;if(this.transceiverController){let t=this.getStreamCaptureSetting();t&&(e=this.calculateEncodingParameters(t).scaleResolutionDownBy)}this.optimalParameters=new s.default(this.captureWidth(),this.captureHeight(),this.captureFrameRate(),this.maxBandwidthKbps(),!1,e,this.enableSVC&&this.numParticipants>2&&this.isUsingSVCCodec)}captureWidth(){let e=640;return this.getNumberOfPublishedVideoSources()>4&&(e=320),e}captureHeight(){let e=384;return this.getNumberOfPublishedVideoSources()>4&&(e=192),e}captureFrameRate(){return 15}maxBandwidthKbps(){if(this.hasBandwidthPriority)return Math.trunc(this.idealMaxBandwidthKbps);let e=0;return Math.trunc(e=2>=this.getNumberOfPublishedVideoSources()?this.idealMaxBandwidthKbps:4>=this.getNumberOfPublishedVideoSources()?2*this.idealMaxBandwidthKbps/3:(544/11+14880/(11*this.getNumberOfPublishedVideoSources()))/600*this.idealMaxBandwidthKbps)}setIdealMaxBandwidthKbps(e){this.idealMaxBandwidthKbps=e}setHasBandwidthPriority(e){this.hasBandwidthPriority=e}setTransceiverController(e){this.transceiverController=e}setSVCEnabled(e){var t;this.enableSVC=e,null===(t=this.logger)||void 0===t||t.info(`setSVCEnabled, enable: ${e}}`)}setHighResolutionFeatureEnabled(e){this.enableHighResolutionFeature=e}updateTransceiverController(){return n(this,void 0,void 0,function*(){let e=this.getStreamCaptureSetting();if(!e)return;let t=this.calculateEncodingParameters(e);this.shouldUpdateEndcodingParameters(t)&&(this.encodingParamMap.set(o.encodingMapKey,t),this.transceiverController.setEncodingParameters(this.encodingParamMap))})}shouldUpdateEndcodingParameters(e){var t,i;let n=null===(i=null===(t=this.transceiverController.localVideoTransceiver().sender.getParameters())||void 0===t?void 0:t.encodings)||void 0===i?void 0:i[0];return e.maxBitrate!==(null==n?void 0:n.maxBitrate)||e.scaleResolutionDownBy!==(null==n?void 0:n.scaleResolutionDownBy)||(null==e?void 0:e.scalabilityMode)!==(null==n?void 0:n.scalabilityMode)}calculateEncodingParameters(e){var t,i,n;let r=1e3*this.maxBandwidthKbps(),s=1,a=720;if(void 0!==e.height&&void 0!==e.width&&this.scaleResolution&&!this.hasBandwidthPriority&&this.getNumberOfPublishedVideoSources()>2&&(480===(a=o.targetHeightArray[Math.min(this.getNumberOfPublishedVideoSources(),o.targetHeightArray.length-1)][this.enableHighResolutionFeature?1:0])&&(null===(t=this.browserBehavior)||void 0===t?void 0:t.disable480pResolutionScaleDown())&&(a=360),s=Math.max(Math.min(e.height,e.width)/a,1),null===(i=this.logger)||void 0===i||i.info(`Resolution scale factor is ${s} for capture resolution ${e.width}x${e.height}. New dimension is ${e.width/s}x${e.height/s}`)),!this.enableSVC)return{scaleResolutionDownBy:s,maxBitrate:r};{let e;return e=this.numParticipants>=0&&this.numParticipants<3||!this.isUsingSVCCodec?"L1T1":a>=720?"L3T3":a>=360?"L2T3":"L1T3",null===(n=this.logger)||void 0===n||n.info(`calculateEncodingParameters: SVC: ${this.enableSVC}    participants: ${this.numParticipants}     publishers: ${this.getNumberOfPublishedVideoSources()}     bitrate: ${r}  targetHeight: ${a}  scalabilityMode: ${e}   isUsingSVCCodec: ${this.isUsingSVCCodec}`),{scaleResolutionDownBy:s,maxBitrate:r,scalabilityMode:e}}}getStreamCaptureSetting(){var e,t,i,n;return null===(n=null===(i=null===(t=null===(e=this.transceiverController)||void 0===e?void 0:e.localVideoTransceiver())||void 0===t?void 0:t.sender)||void 0===i?void 0:i.track)||void 0===n?void 0:n.getSettings()}getNumberOfPublishedVideoSources(){var e;return null!==(e=this.numberOfPublishedVideoSources)&&void 0!==e?e:0}wantsVideoDependencyDescriptorRtpHeaderExtension(){return this.enableSVC}setMeetingSupportedVideoSendCodecs(e,t){let i=null!=e?e:t,n=i.length>0&&o.SVCCodecNames.includes(i[0].codecName);n!==this.isUsingSVCCodec&&(this.isUsingSVCCodec=n,this.updateOptimalParameters())}}t.default=o,o.encodingMapKey="video",o.targetHeightArray=[[0,0],[0,0],[0,0],[540,720],[540,720],[480,540],[480,540],[480,540],[480,540],[360,480],[360,480],[360,480],[360,480],[270,360],[270,360],[270,360],[270,360],[180,270],[180,270],[180,270],[180,270],[180,270],[180,270],[180,270],[180,270],[180,270]],o.SVCCodecNames=["VP9"]},16643:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let r=n(i(48786));class s{constructor(){}updateConnectionMetric(e){}chooseMediaTrackConstraints(){return{}}chooseEncodingParameters(){return new Map}updateIndex(e){}wantsResubscribe(){return!1}chooseCaptureAndEncodeParameters(){return new r.default(0,0,0,0,!1)}maxBandwidthKbps(){return 0}setIdealMaxBandwidthKbps(e){}setHasBandwidthPriority(e){}setHighResolutionFeatureEnabled(e){}wantsVideoDependencyDescriptorRtpHeaderExtension(){return!1}}t.default=s},80842:function(e,t){"use strict";function i(e){return e.map(e=>"object"==typeof e?JSON.stringify(e):`${e}`).join(" ")}Object.defineProperty(t,"__esModule",{value:!0});class n{constructor(e){this.base=e}debug(...e){this.base.debug(i(e))}info(...e){this.base.info(i(e))}warn(...e){this.base.warn(i(e))}error(...e){this.base.error(i(e))}}t.default=n},37993:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.VoiceFocusDeviceTransformer=void 0;let s=i(29556),o=i(17201),a=r(i(29505)),l=r(i(80842)),d=r(i(91330)),u=r(i(1326));class c{constructor(e,{preload:t=!0,logger:i,fetchBehavior:n=c.defaultFetchBehavior()},r){this.spec=e,this.supported=!0,this.logger=i,this.vfLogger=i?new l.default(i):void 0,this.preload=t,this.fetchBehavior=n,this.spec=c.augmentSpec(this.spec),r&&(this.configuration=Promise.resolve(r))}static isSupported(e,t){var i,n;let r={fetchBehavior:c.defaultFetchBehavior(),logger:(null==t?void 0:t.logger)?new l.default(t.logger):void 0};if(o.isIFramed()){if((null==t?void 0:t.allowIFrame)===!1)return null===(i=null==t?void 0:t.logger)||void 0===i||i.error("Amazon Voice Focus support check inside iframe: not supported."),Promise.resolve(!1);null===(n=null==t?void 0:t.logger)||void 0===n||n.warn("Amazon Voice Focus support check inside iframe: not recommended.")}return s.VoiceFocus.isSupported(c.augmentSpec(e),r)}static create(e={},t={},i,r,s){var o,a,l;return n(this,void 0,void 0,function*(){r&&r.Meeting.Meeting&&(r=r.Meeting);let n=(null===(l=null===(a=null===(o=null==r?void 0:r.Meeting)||void 0===o?void 0:o.MeetingFeatures)||void 0===a?void 0:a.Audio)||void 0===l?void 0:l.EchoReduction)==="AVAILABLE",s=i&&!0===i.supported&&"ns_es"===i.model.name&&!n,d="ns_es"===e.name&&!n;if(s||d)throw Error("Echo Reduction requested but not enabled.");let u=new c(e,t,i);return yield u.init(),u})}static configure(e={},t={}){return n(this,void 0,void 0,function*(){return new c(e,t,void 0).configure(!0)})}getConfiguration(){return this.configuration}isSupported(){return this.supported}createTransformDevice(e,t){return n(this,void 0,void 0,function*(){if(this.supported)try{let i=!0,[n,r]=yield this.allocateVoiceFocus(i),s=Object.assign(Object.assign({},t),{es:"ns_es"===this.spec.name});return new d.default(e,n,r,s)}catch(e){return}})}static destroyVoiceFocus(e){var t;return n(this,void 0,void 0,function*(){null===(t=null==e?void 0:e.vf)||void 0===t||t.destroy()})}static augmentSpec(e){return e&&(e.assetGroup||e.revisionID)?e:Object.assign(Object.assign({},e),{assetGroup:c.currentSDKAssetGroup()})}configure(e=!1){return n(this,void 0,void 0,function*(){let t={fetchBehavior:this.fetchBehavior,preResolve:e,logger:this.vfLogger};return s.VoiceFocus.configure(this.spec,t)})}init(){var e;return n(this,void 0,void 0,function*(){this.configuration||(this.configuration=this.configure());let t=yield this.configuration;if(!t.supported){this.supported=!1;return}this.pendingVoiceFocus=this.createVoiceFocus(t,this.preload);try{yield this.pendingVoiceFocus}catch(t){null===(e=this.logger)||void 0===e||e.error(`Unable to initialize Amazon Voice Focus: ${t}`),this.supported=!1}})}createVoiceFocus(e,t){return n(this,void 0,void 0,function*(){let i=new u.default;return this.vf=yield s.VoiceFocus.init(e,{delegate:i,preload:t,logger:this.vfLogger}),[this.vf,i]})}allocateVoiceFocus(e){return n(this,void 0,void 0,function*(){if(!this.supported)throw Error("Not supported.");if(this.pendingVoiceFocus){let e=this.pendingVoiceFocus;return this.pendingVoiceFocus=void 0,e}return this.createVoiceFocus((yield this.configuration),e)})}static majorVersion(){return a.default.sdkVersion.match(/^[1-9][0-9]*\.(?:0|[1-9][0-9]*)/)[0]}static majorMinorVersion(){return a.default.sdkVersion.match(/^[1-9][0-9]*\.(?:0|(?:[1-9][0-9]*))\.(?:0|[1-9][0-9]*)/)[0]}static currentSDKAssetGroup(){let e=this.majorVersion();return e?`sdk-${e}`:"stable-v1"}static defaultFetchBehavior(){let e=c.majorMinorVersion()||"unknown",t=a.default.sdkUserAgentLowResolution;return{escapedQueryString:`sdk=${encodeURIComponent(e)}&ua=${encodeURIComponent(t)}`}}}t.VoiceFocusDeviceTransformer=c,t.default=c},91330:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=r(i(81341));class o{constructor(e,t,i,n,r=!1,o,a=new s.default,l=new Map,d,u){this.device=e,this.voiceFocus=t,this.delegate=i,this.nodeOptions=n,this.failed=r,this.node=o,this.browserBehavior=a,this.farEndStreamToAudioSourceNode=l,this.mixDestNode=d,this.mixSourceNode=u}getInnerDevice(){return this.device}mute(e){return n(this,void 0,void 0,function*(){this.node&&(e?yield this.node.disable():yield this.node.enable())})}stop(){return n(this,void 0,void 0,function*(){this.node&&(this.node.disconnect(),yield this.node.stop())})}chooseNewInnerDevice(e){return n(this,void 0,void 0,function*(){return this.device!==e||a(e)?new o(e,this.voiceFocus,this.delegate,this.nodeOptions,this.failed,this.node,this.browserBehavior,this.farEndStreamToAudioSourceNode,this.mixDestNode,this.mixSourceNode):this})}intrinsicDevice(){return n(this,void 0,void 0,function*(){let e;if(this.failed)return this.device;let t=this.nodeOptions.es,i={echoCancellation:!t,googEchoCancellation:!t,googEchoCancellation2:!t,noiseSuppression:!1,googNoiseSuppression:!1,googHighpassFilter:!1,googNoiseSuppression2:!1};return(e=!this.nodeOptions||void 0===this.nodeOptions.agc||this.nodeOptions.agc.useBuiltInAGC,i.autoGainControl=e,i.googAutoGainControl=e,i.googAutoGainControl2=e,this.device)?"string"==typeof this.device?(this.browserBehavior.requiresNoExactMediaStreamConstraints()?i.deviceId=this.device:i.deviceId={exact:this.device},i):this.device.id?this.device:Object.assign(Object.assign({},this.device),i):i})}createAudioNode(e){var t,i;return n(this,void 0,void 0,function*(){if((null===(t=this.node)||void 0===t?void 0:t.context)===e)return{start:this.node,end:this.node};let n=Object.assign({enabled:!0,agc:{useVoiceFocusAGC:!1}},this.nodeOptions);try{if(null===(i=this.node)||void 0===i||i.disconnect(),this.node=yield this.voiceFocus.createNode(e,n),this.nodeOptions.es){for(let t of(this.mixDestNode=new MediaStreamAudioDestinationNode(e,{channelCount:1,channelCountMode:"explicit"}),this.farEndStreamToAudioSourceNode.keys()))this.assignFarEndStreamToAudioSourceNode(t);this.createMixSourceNode()}let t=this.node,r=this.node;return{start:t,end:r}}catch(e){throw this.failed=!0,this.delegate.onFallback(this,e),e}})}observeMeetingAudio(e){return n(this,void 0,void 0,function*(){if(!this.nodeOptions.es)return;e.addAudioMixObserver(this);let t=yield e.getCurrentMeetingAudioStream();t&&this.addFarEndStream(t)})}unObserveMeetingAudio(e){return n(this,void 0,void 0,function*(){if(!this.nodeOptions.es)return;e.removeAudioMixObserver(this);let t=yield e.getCurrentMeetingAudioStream();t&&this.removeFarendStream(t)})}addObserver(e){this.delegate.addObserver(e)}removeObserver(e){this.delegate.removeObserver(e)}addFarEndStream(e){return n(this,void 0,void 0,function*(){!this.nodeOptions.es||!e||this.farEndStreamToAudioSourceNode.has(e)||(this.node?this.assignFarEndStreamToAudioSourceNode(e):this.farEndStreamToAudioSourceNode.set(e,null))})}removeFarendStream(e){var t;return n(this,void 0,void 0,function*(){null===(t=this.farEndStreamToAudioSourceNode.get(e))||void 0===t||t.disconnect(),this.farEndStreamToAudioSourceNode.delete(e)})}meetingAudioStreamBecameActive(e){return n(this,void 0,void 0,function*(){this.addFarEndStream(e)})}meetingAudioStreamBecameInactive(e){return n(this,void 0,void 0,function*(){this.removeFarendStream(e)})}assignFarEndStreamToAudioSourceNode(e){let t=this.node.context.createMediaStreamSource(e);t.channelCount=1,t.channelCountMode="explicit",this.farEndStreamToAudioSourceNode.set(e,t),t.connect(this.mixDestNode,0)}createMixSourceNode(){this.mixSourceNode=this.node.context.createMediaStreamSource(this.mixDestNode.stream),this.mixSourceNode.channelCount=1,this.mixSourceNode.channelCountMode="explicit",this.mixSourceNode.connect(this.node,0,1)}}function a(e){return"default"===e||!!e&&"object"==typeof e&&("deviceId"in e&&"default"===e.deviceId||"id"in e&&"default"===e.id)}t.default=o},1326:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(){this.observers=new Set}addObserver(e){this.observers.add(e)}removeObserver(e){this.observers.delete(e)}onFallback(e,t){var i;for(let n of this.observers)null===(i=n.voiceFocusFellBackToInnerStream)||void 0===i||i.call(n,e,t)}onCPUWarning(){var e;for(let t of this.observers)null===(e=t.voiceFocusInsufficientResources)||void 0===e||e.call(t)}}t.default=i},75762:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(e,t,i,n,r){this.logger=e,this.realtimeController=t,this.minVolumeDecibels=i,this.maxVolumeDecibels=n,this.selfAttendeeId=r,this.streamIdToAttendeeId={},this.streamIdToExternalUserId={},this.warnedAboutMissingStreamIdMapping={},this.attendeeIdToStreamId={},this.sessionReconnected=!1}onReconnect(){this.sessionReconnected=!0}sendRealtimeUpdatesForAudioStreamIdInfo(e){let t=0;for(let i of e.streams){let n=!!i.attendeeId,r=!!i.externalUserId,s=i.hasOwnProperty("muted"),o=!!i.dropped;if(n){this.attendeeIdToStreamId[i.attendeeId]&&this.attendeeIdToStreamId[i.attendeeId]<i.audioStreamId&&delete this.attendeeIdToStreamId[i.attendeeId],this.streamIdToAttendeeId[i.audioStreamId]=i.attendeeId;let n=r?i.externalUserId:i.attendeeId;this.streamIdToExternalUserId[i.audioStreamId]=n,this.attendeeIdToStreamId[i.attendeeId]=i.audioStreamId,this.realtimeController.realtimeSetAttendeeIdPresence(i.attendeeId,!0,n,!1,{attendeeIndex:t++,attendeesInFrame:e.streams.length})}if(s){let e=this.streamIdToAttendeeId[i.audioStreamId],t=this.streamIdToExternalUserId[i.audioStreamId];this.realtimeController.realtimeUpdateVolumeIndicator(e,null,i.muted,null,t)}if(!n&&!s){let n=this.streamIdToAttendeeId[i.audioStreamId];if(n){let r=this.streamIdToExternalUserId[i.audioStreamId];delete this.streamIdToAttendeeId[i.audioStreamId],delete this.streamIdToExternalUserId[i.audioStreamId],delete this.warnedAboutMissingStreamIdMapping[i.audioStreamId],this.attendeeIdToStreamId[n]===i.audioStreamId&&delete this.attendeeIdToStreamId[n];let s=!1;for(let e of Object.keys(this.streamIdToAttendeeId)){let t=parseInt(e);if(t>i.audioStreamId&&this.streamIdToAttendeeId[t]===n){s=!0;break}}s||this.realtimeController.realtimeSetAttendeeIdPresence(n,!1,r,o,{attendeeIndex:t++,attendeesInFrame:e.streams.length})}}}this.sessionReconnected&&(this.cleanUpState(e),this.sessionReconnected=!1)}cleanUpState(e){let t=Object.values(this.streamIdToAttendeeId),i=e.streams.map(e=>e.attendeeId);for(let[e,n]of t.filter(e=>!i.includes(e)).entries()){let t=this.attendeeIdToStreamId[n],i=this.streamIdToExternalUserId[t];if(delete this.streamIdToAttendeeId[t],delete this.streamIdToExternalUserId[t],delete this.warnedAboutMissingStreamIdMapping[t],delete this.attendeeIdToStreamId[n],n===this.selfAttendeeId){this.logger.warn("the volume indicator adapter cleans up the current attendee (presence = false) after reconnection");continue}this.realtimeController.realtimeSetAttendeeIdPresence(n,!1,i,!1,{attendeeIndex:e,attendeesInFrame:n.length})}}sendRealtimeUpdatesForAudioMetadata(e){let t=null,i=null;for(let n of e.attendeeStates){let e=this.attendeeIdForStreamId(n.audioStreamId);n.hasOwnProperty("volume")&&(null===t&&(t={}),null!==e&&(t[e]=this.normalizedVolume(n))),n.hasOwnProperty("signalStrength")&&(null===i&&(i={}),null!==e&&(i[e]=this.normalizedSignalStrength(n)))}this.applyRealtimeUpdatesForAudioMetadata(t,i)}normalizedVolume(e){return Math.min(Math.max(1-(-e.volume-this.maxVolumeDecibels)/(this.minVolumeDecibels-this.maxVolumeDecibels),0),1)}normalizedSignalStrength(e){return Math.min(Math.max(e.signalStrength/i.MAX_SIGNAL_STRENGTH_LEVELS,0),1)}applyRealtimeUpdatesForAudioMetadata(e,t){for(let n in this.streamIdToAttendeeId){let r=this.streamIdToAttendeeId[n],s=this.streamIdToExternalUserId[n],o=null,a=null;null!==e&&(o=e.hasOwnProperty(r)?e[r]:i.IMPLICIT_VOLUME),null!==t&&(a=t.hasOwnProperty(r)?t[r]:i.IMPLICIT_SIGNAL_STRENGTH),(null!==o||null!==a)&&this.realtimeController.realtimeUpdateVolumeIndicator(r,o,null,a,s)}}attendeeIdForStreamId(e){return 0===e?null:this.streamIdToAttendeeId[e]||(this.warnedAboutMissingStreamIdMapping[e]||(this.warnedAboutMissingStreamIdMapping[e]=!0,this.logger.warn(`volume indicator stream id ${e} seen before being defined`)),null)}}t.default=i,i.MAX_SIGNAL_STRENGTH_LEVELS=2,i.IMPLICIT_VOLUME=0,i.IMPLICIT_SIGNAL_STRENGTH=1},14832:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let r=n(i(29505)),s=n(i(99983));class o{constructor(e){this.logger=e}create(e,t,i){this.connection=new WebSocket(i?e:r.default.urlWithVersion(e),t),this.connection.binaryType="arraybuffer"}send(e){if(!this.connection)return this.logger.error("WebSocket not yet created or already destroyed."),!1;try{return e instanceof Uint8Array?this.connection.send(e.buffer):this.connection.send(e),!0}catch(e){return this.logger.debug(()=>`send error: ${e.message}, websocket state=${s.default[this.readyState()]}`),!1}}close(e,t){var i;null===(i=this.connection)||void 0===i||i.close(e,t)}destroy(){this.connection=void 0}addEventListener(e,t){if(!this.connection){this.logger.warn("Cannot add event listener with no WebSocket connection.");return}this.connection.addEventListener(e,t)}removeEventListener(e,t){var i;null===(i=this.connection)||void 0===i||i.removeEventListener(e,t)}readyState(){if(!this.connection)return s.default.None;switch(this.connection.readyState){case WebSocket.CONNECTING:return s.default.Connecting;case WebSocket.OPEN:return s.default.Open;case WebSocket.CLOSING:return s.default.Closing;case WebSocket.CLOSED:return s.default.Closed}}}t.default=o},99983:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.WebSocketReadyState=void 0,function(e){e[e.None=0]="None",e[e.Connecting=1]="Connecting",e[e.Open=2]="Open",e[e.Closing=3]="Closing",e[e.Closed=4]="Closed"}(i=t.WebSocketReadyState||(t.WebSocketReadyState={})),t.default=i},34106:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.decideModel=t.measureAndDecideExecutionApproach=void 0;let r=i(71143),s=i(70085),o=3,a=2.5,l=2.63,d=.6,u=.65,c=.5,h=.7,f={wasm:{noSupport:.07,inline:{c100:1,c50:.36,c20:.16,c10:.07},worker:{c100:.5,c50:.18,c20:.08,c10:.06}},simd:{noSupport:.1,inline:{c100:1,c50:.43,c20:.3,c10:.2},worker:{c100:.5,c50:.21,c20:.15,c10:.1}}};class p{constructor(e,t){this.fetchConfig=e,this.logger=t;let i=`${e.paths.workers}estimator-v1.js`;this.fetchBehavior={headers:e.headers,escapedQueryString:e.escapedQueryString},this.worker=r.loadWorker(i,"VoiceFocusEstimator",this.fetchBehavior,t)}roundtrip(e,t,i){return new Promise((n,r)=>{this.worker.then(r=>{let s;s=e=>{let{message:o,key:a}=e.data;o===t&&a===i&&(r.removeEventListener("message",s),n(e.data))},r.addEventListener("message",s),r.postMessage(e)}).catch(e=>{var t;null===(t=this.logger)||void 0===t||t.error("Failed to load worker.",e),r(e)})})}supportsSIMD(e){let t="simd",i=e||`${this.fetchConfig.paths.wasm}simd-v1.wasm`,n={message:"supports-simd",fetchBehavior:this.fetchBehavior,path:i,key:t};return this.roundtrip(n,"simd-support",t).then(e=>e.supports)}measure(e,t){let i=`${this.fetchConfig.paths.wasm}bench-v1.wasm`,n=`${this.fetchConfig.paths.wasm}bench-v1_simd.wasm`,r=e?n:i,s=`bench:${e}`,o={message:"measure",fetchBehavior:this.fetchBehavior,budget:t,path:r,key:s};return this.roundtrip(o,"measurement",s).then(e=>{if(e.measurement)return e.measurement;throw Error("Failed to measure.")})}stop(){this.worker.then(e=>{var t;null===(t=this.logger)||void 0===t||t.debug("Stopping estimator worker."),e.terminate()}).catch(e=>{})}}let m=(e,t)=>1===e?d:"quality"===t?u*e:c*e,g=({supportsSIMD:e,supportsSAB:t,duration:i,executionPreference:n="auto",simdPreference:r,variantPreference:d="auto",namePreference:u="default",usagePreference:c,executionQuantaPreference:p=o},g=f,v)=>{let b="force"===r||"disable"!==r&&e,S=-1!==i,y=S?(b?a:l)/i:0,w=b?g.simd:g.wasm,C=S?m(p,c)*y:0,_=S?h*y:0,k=u,T=e=>({supported:!1,reason:e});if(S){if(y<w.noSupport)return T(`Performance score ${y} worse than threshold ${w.noSupport}.`)}else if("auto"===n||"auto"===d)return T(`Missing explicit execution (${n}) or variant (${d}) preference, but no scoring performed.`);null==v||v.debug(`Bench duration ${i} yields inline score ${C} and worker score ${_}.`);let P=(e,t,i)=>({supported:!0,useSIMD:b,processor:e,executionApproach:t,variant:i,executionQuanta:"inline"===t?p:void 0,name:k}),E=(e,t,i)=>"auto"!==t?!S||e>i[t]?t:"failed":e>i.c100?"c100":e>i.c50?"c50":e>i.c20?"c20":e>i.c10?"c10":"failed",M=e=>{switch(e||"auto"){case"auto":{let e=M("inline"),t=M("worker");if(null==v||v.debug(`Reducing auto preference: ${JSON.stringify(e)} vs ${JSON.stringify(t)}`),!1===e.supported||!1===t.supported)return t;if(e.variant===t.variant||"c50"===e.variant)return e;return t}case"worker":if(s.supportsSharedArrayBuffer(globalThis,window,v))return M("worker-sab");return M("worker-postMessage");case"inline":{let e=E(C,d,w.inline);if("failed"===e)return T(`Performance score ${C} not sufficient for inline use with variant preference ${d}.`);return P("voicefocus-inline-processor","inline",e)}case"worker-sab":{if(!t){let e="Requested worker-sab but no SharedArrayBuffer support.";return null==v||v.warn(e),{supported:!1,reason:e}}let e=E(_,d,w.worker);if("failed"===e)return T(`Performance score ${_} not sufficient for worker use with variant preference ${d}.`);return P("voicefocus-worker-sab-processor","worker-sab",e)}case"worker-postMessage":{let e=E(_,d,w.worker);if("failed"===e)return T(`Performance score ${_} not sufficient for worker use.`);if("ns_es"===k){let e="Requested echo suppression but postMessage executor does not support it.";return null==v||v.warn(e),{supported:!1,reason:e}}return P("voicefocus-worker-postMessage-processor","worker-postMessage",e)}}};return M(n)},v=(e,t,i,r)=>n(void 0,void 0,void 0,function*(){let n={supportsSIMD:e,supportsSAB:s.supportsSharedArrayBuffer(globalThis,window,i),duration:-1};if(e)return null==i||i.info("Supports SIMD: true (force)"),n;let o=!r,a=r||new p(t,i);try{let t=!s.isOldChrome(window,i)&&(yield a.supportsSIMD());return null==i||i.info(`Supports SIMD: ${t} (force: ${e})`),n.supportsSIMD=t,n}finally{o&&a.stop()}}),b=(e,t,i,r)=>n(void 0,void 0,void 0,function*(){let n=new p(t,r);try{let s=yield v(e,t,r,n);if(s.supportsSIMD)try{return s.duration=yield n.measure(!0,i),null==r||r.info("SIMD timing:",s.duration),s}catch(e){null==r||r.warn("Failed SIMD estimation; falling back to non-SIMD."),s.supportsSIMD=!1}return s.duration=yield n.measure(!1,i),null==r||r.info("No-SIMD timing:",s.duration),s}catch(e){throw null==r||r.error("Could not feature check.",e),e}finally{n.stop()}}),S=(e,t,i,r=f)=>n(void 0,void 0,void 0,function*(){let n,s=e.executionPreference,{usagePreference:o,variantPreference:a,namePreference:l,simdPreference:d,estimatorBudget:u,executionQuantaPreference:c}=e;"interactivity"===o&&"inline"!==s&&(null==i||i.debug(`Overriding execution preference ${s} to reflect interactivity preference.`),s="inline");let h="force"===d,f="auto"!==a,p="auto"!==s;try{n=f&&p?yield v(h,t,i):yield b(h,t,u,i)}catch(e){throw null==i||i.error("Could not load estimator.",e),Error("Could not load Voice Focus estimator.")}return g(Object.assign(Object.assign({},n),{simdPreference:d,executionPreference:s,variantPreference:a,namePreference:l,usagePreference:o,executionQuantaPreference:c}),r,i)});t.measureAndDecideExecutionApproach=S;let y=({category:e,name:t,variant:i,simd:n,url:r})=>`${e}-${t}-${i}-v1${n?"_simd":""}`;t.decideModel=y},21012:function(e,t){"use strict";function i(e,t,i){return i?fetch(r(e,i),n(t,i)):fetch(e,t)}function n(e,t){return(null==t?void 0:t.headers)?e?Object.assign(Object.assign({},e),{headers:Object.assign(Object.assign({},e.headers||{}),t.headers)}):{headers:t.headers}:e}function r(e,t){if(!(null==t?void 0:t.escapedQueryString))return e;let i=-1!==e.lastIndexOf("?");return`${e}${i?"&":"?"}${t.escapedQueryString}`}function s(e,t){let i=Object.keys(t);if(!i.length)return e;let n=new URLSearchParams(null==e?void 0:e.escapedQueryString);for(let e of i)n.append(e,t[e]);return Object.assign(Object.assign({},e),{escapedQueryString:n.toString()})}Object.defineProperty(t,"__esModule",{value:!0}),t.isValidRevisionID=t.isValidAssetGroup=t.resolveURL=t.addQueryParams=t.withQueryString=t.withRequestHeaders=t.fetchWithBehavior=void 0,t.fetchWithBehavior=i,t.withRequestHeaders=n,t.withQueryString=r,t.addQueryParams=s;let o={method:"HEAD",mode:"cors",credentials:"omit",redirect:"follow",referrerPolicy:"origin"};function a(e,t){return i(e,o,t).then(t=>t.redirected?t.url:e)}function l(e){return!!e&&/^[-.a-zA-Z0-9]+$/.test(e)}function d(e){return!!e&&/^[123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ]{22}$/.test(e)}t.resolveURL=a,t.isValidAssetGroup=l,t.isValidRevisionID=d},71143:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadWorker=void 0;let n=i(21012),r={method:"GET",mode:"cors",credentials:"omit",redirect:"follow",referrerPolicy:"no-referrer"},s=(e,t,i,s)=>{null==s||s.debug(`Loading ${t} worker from ${e}.`);let o=!1;try{o=self.origin===new URL(e).origin}catch(e){null==s||s.error("Could not compare origins.",e)}return o?Promise.resolve(new Worker(n.withQueryString(e,i),{name:t})):n.fetchWithBehavior(e,r,i).then(e=>{if(e.ok)return e.blob().then(e=>new Worker(window.URL.createObjectURL(e)));throw Error("Fetch failed.")})};t.loadWorker=s},70085:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.isOldChrome=t.supportsWASMStreaming=t.supportsSharedArrayBuffer=t.supportsWASM=t.supportsAudioWorklet=t.supportsWorker=t.supportsVoiceFocusWorker=t.supportsWASMPostMessage=t.isSafari=void 0;let r=i(71143),s=(e=globalThis)=>!!e.navigator.userAgent.match(/Chrom(?:e|ium)\/([0-9]+)/),o=(e=globalThis)=>{let t=e.navigator.userAgent,i=t.match(/Safari\//),n=t.match(/Chrom(?:e|ium)\//);return!!(i&&!n)};t.isSafari=o;let a=(e=globalThis)=>!t.isSafari(e)&&(!s(e)||95>(m(e)||0));t.supportsWASMPostMessage=a;let l=(e=globalThis,i,s)=>n(void 0,void 0,void 0,function*(){if(!t.supportsWorker(e,s))return!1;let n=`${i.paths.workers}worker-v1.js`;try{let e=yield r.loadWorker(n,"VoiceFocusTestWorker",i,s);try{e.terminate()}catch(e){null==s||s.debug("Failed to terminate worker.",e)}return!0}catch(e){return null==s||s.info("Failed to fetch and instantiate test worker",e),!1}});t.supportsVoiceFocusWorker=l;let d=(e=globalThis,t)=>{try{return!!e.Worker}catch(e){return null==t||t.info("Does not support Worker",e),!1}};t.supportsWorker=d;let u=(e=globalThis,t)=>{try{return!!e.AudioWorklet&&!!e.AudioWorkletNode}catch(e){return null==t||t.info("Does not support Audio Worklet",e),!1}};t.supportsAudioWorklet=u;let c=(e=globalThis,t)=>{try{return!!e.WebAssembly&&(!!e.WebAssembly.compile||!!e.WebAssembly.compileStreaming)}catch(e){return null==t||t.info("Does not support WASM",e),!1}};t.supportsWASM=c;let h=(e=globalThis,t=globalThis,i)=>{try{return!!e.SharedArrayBuffer&&(!!t.chrome||!!e.crossOriginIsolated)}catch(e){return null==i||i.info("Does not support SharedArrayBuffer."),!1}};t.supportsSharedArrayBuffer=h;let f=(e=globalThis,t)=>{var i;try{return!!(null===(i=e.WebAssembly)||void 0===i?void 0:i.compileStreaming)}catch(e){return null==t||t.info("Does not support WASM streaming compilation",e),!1}};t.supportsWASMStreaming=f;let p=90,m=(e=globalThis)=>{try{if(!e.chrome)return}catch(e){}let t=e.navigator.userAgent.match(/Chrom(?:e|ium)\/([0-9]+)/);if(t)return parseInt(t[1],10)},g=(e=globalThis,t)=>{let i=m(e);return!!i&&i<p&&(null==t||t.debug(`Chrome ${i} has incomplete SIMD support.`),!0)};t.isOldChrome=g},24771:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VoiceFocusAudioWorkletNode=void 0;class i extends("undefined"!=typeof globalThis&&globalThis.AudioWorkletNode||class{}){}t.VoiceFocusAudioWorkletNode=i},29556:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.getAudioInput=t.createAudioContext=t.VoiceFocus=void 0;let r=i(34106),s=i(21012),o=i(71143),a=i(70085),l=i(47662),d=i(97527),u=i(77118),c={useVoiceFocusAGC:!1,useBuiltInAGC:!0},h="stable-v1",f="https://static.sdkassets.chime.aws",p={processors:`${f}/processors/`,workers:`${f}/workers/`,wasm:`${f}/wasm/`,models:`${f}/wasm/`},m={latencyHint:0},g={channelCount:1,echoCancellation:!0,googEchoCancellation:!0,noiseSuppression:!1,googNoiseSuppression:!1,googHighpassFilter:!1,googTypingNoiseDetection:!1},v=Object.assign(Object.assign({},g),{autoGainControl:!0,googAutoGainControl:!0,googAutoGainControl2:!0}),b=Object.assign(Object.assign({},g),{autoGainControl:!1,googAutoGainControl:!1,googAutoGainControl2:!1}),S={"voicefocus-worker-sab-processor":{file:"worklet-worker-sab-processor-v1.js",node:d.default},"voicefocus-worker-postMessage-processor":{file:"worklet-worker-postMessage-processor-v1.js",node:u.default},"voicefocus-inline-processor":{file:"worklet-inline-processor-v1.js",node:l.default}},y=(e,t)=>{if(void 0!==e&&!s.isValidAssetGroup(e))throw Error(`Invalid asset group ${e}`);if(void 0!==t&&!s.isValidRevisionID(t))throw Error(`Invalid revision ID ${t}`)},w=(e,t)=>{let i;if(i=t.useBuiltInAGC?v:b,!e)return{audio:i};if(!e.audio)return e;if(e.video)throw Error("Not adding Voice Focus to multi-device getUserMedia call.");return Object.assign(Object.assign({},e),{audio:!0===e.audio?i:Object.assign(Object.assign({},e.audio),i)})},C=(e,t)=>`${t.models}${r.decideModel(e)}.wasm`;class _{constructor(e,t,i,n,r){this.processorURL=t,this.nodeConstructor=i,this.nodeOptions=n,this.executionQuanta=r,this.internal={worker:e,nodeOptions:n,isDestroyed:!1}}static isSupported(e,t){let{fetchBehavior:i,logger:n}=t||{};if("undefined"==typeof globalThis)return null==n||n.debug("Browser does not have globalThis."),Promise.resolve(!1);if(!a.supportsAudioWorklet(globalThis,n))return null==n||n.debug("Browser does not support Audio Worklet."),Promise.resolve(!1);if(!a.supportsWASM(globalThis,n))return null==n||n.debug("Browser does not support WASM."),Promise.resolve(!1);a.supportsWASMStreaming(globalThis,n)||null==n||n.debug("Browser does not support streaming WASM compilation.");let{assetGroup:r=h,revisionID:o,paths:l=p}=e||{};y(r,o);let d=o?{revisionID:o}:{assetGroup:r},u=Object.assign(Object.assign({},s.addQueryParams(i,d)),{paths:l});return a.supportsVoiceFocusWorker(globalThis,u,n)}static mungeExecutionPreference(e,t){let i=void 0===e||"auto"===e;if(a.isSafari(globalThis)){if(i||"inline"===e)return"inline";if(!i)throw Error(`Unsupported execution preference ${e}`)}if("worker-sab"===e&&!a.supportsSharedArrayBuffer(globalThis,globalThis,t))throw Error(`Unsupported execution preference ${e}`);return e||"auto"}static configure(e,t){return n(this,void 0,void 0,function*(){let{fetchBehavior:i,preResolve:n,logger:o}=t||{},{category:a="voicefocus",name:l="default",variant:d="auto",assetGroup:u=h,revisionID:c,simd:f="detect",executionPreference:m="auto",executionQuantaPreference:g,usagePreference:v="interactivity",estimatorBudget:b=100,paths:S=p,thresholds:w}=e||{};if(null==o||o.debug("Configuring Voice Focus with spec",e),void 0!==a&&"voicefocus"!==a)throw Error(`Unrecognized category ${a}`);if(void 0!==l&&"default"!==l&&"ns_es"!==l)throw Error(`Unrecognized feature name ${l}`);if(void 0!==d&&!["auto","c100","c50","c20","c10"].includes(d))throw Error(`Unrecognized feature variant ${d}`);if(void 0!==g&&![1,2,3].includes(g))throw Error(`Unrecognized execution quanta preference ${g}`);if(y(u,c),void 0!==f&&!["detect","force","disable"].includes(f))throw Error(`Unrecognized SIMD option ${f}`);if(void 0!==m&&!["auto","inline","worker","worker-sab","worker-postMessage"].includes(m))throw Error(`Unrecognized execution preference ${m}`);if(void 0!==v&&!["quality","interactivity"].includes(v))throw Error(`Unrecognized usage preference ${v}`);let _={executionPreference:this.mungeExecutionPreference(m,o),usagePreference:v,executionQuantaPreference:g,variantPreference:d,namePreference:l,simdPreference:f,estimatorBudget:b},k=c?{revisionID:c}:{assetGroup:u},T=s.addQueryParams(i,k),P=Object.assign({paths:S},T),E=yield r.measureAndDecideExecutionApproach(_,P,o,w);if(!1===E.supported)return{supported:!1,reason:E.reason};null==o||o.info("Decided execution approach",E);let{useSIMD:M,processor:I,variant:A,executionQuanta:R}=E,x={category:a||"voicefocus",name:l||"default",variant:A,simd:M};if(n){let e=C(x,S);x.url=yield s.resolveURL(e,T)}return{fetchConfig:P,model:x,processor:I,executionQuanta:R,supported:!0}})}static init(e,{delegate:t,preload:i=!0,logger:r}){return n(this,void 0,void 0,function*(){if(!1===e.supported)throw Error("Voice Focus not supported. Reason: "+e.reason);let{model:n,processor:s,fetchConfig:l,executionQuanta:d}=e,{simd:u,name:c}=n,{paths:h}=l;if("voicefocus-inline-processor"!==s&&"voicefocus-worker-postMessage-processor"!==s&&"voicefocus-worker-sab-processor"!==s)throw Error(`Unknown processor ${s}`);let f=n.url||C(n,h);null==r||r.debug(`Using model URL ${f}.`);let p=`${h.wasm}audio_buffer-v1${u?"_simd":""}.wasm`,m=`${h.wasm}resampler-v1${u?"_simd":""}.wasm`,g=`${h.workers}worker-v1.js`,{file:v,node:b}=S[s],y=`${h.processors}${v}`,w=yield o.loadWorker(g,"VoiceFocusWorker",l,r);if(i){null==r||r.debug("Preloading",f);let e=a.supportsWASMPostMessage(globalThis)?"get-module":"get-module-buffer";w.postMessage({message:e,preload:!0,key:"model",fetchBehavior:l,path:f})}let k={processor:s,worker:w,audioBufferURL:p,resamplerURL:m,fetchBehavior:l,modelURL:f,delegate:t,logger:r,numberOfInputs:"ns_es"===c?2:1};return Promise.resolve(new _(w,y,b,k,d))})}createNode(e,t){var i;if(this.internal.isDestroyed)throw Error("Unable to create node because VoiceFocus worker has been destroyed.");let{voiceFocusSampleRate:n=16e3===e.sampleRate?16e3:48e3,enabled:r=!0,agc:o=c}=t||{},a=null==t?void 0:t.es,l={voiceFocusSampleRate:n,enabled:r,sendBufferCount:10,prefill:6,agc:o,executionQuanta:this.executionQuanta,supportFarendStream:a},d=s.withQueryString(this.processorURL,null===(i=this.nodeOptions)||void 0===i?void 0:i.fetchBehavior);return e.audioWorklet.addModule(d).then(()=>new this.nodeConstructor(e,Object.assign(Object.assign({},this.nodeOptions),{processorOptions:l})))}applyToStream(e,t,i){return n(this,void 0,void 0,function*(){if(this.internal.isDestroyed)throw Error("Unable to apply stream because VoiceFocus worker has been destroyed");let n=t.createMediaStreamSource(e),r=yield this.applyToSourceNode(n,t,i),s=t.createMediaStreamDestination();return r.connect(s),{node:r,source:n,destination:s,stream:s.stream}})}applyToSourceNode(e,t,i){return n(this,void 0,void 0,function*(){let n=yield this.createNode(t,i);return e.connect(n),n})}destroy(){this.internal.worker&&this.internal.worker.terminate(),this.internal.isDestroyed=!0}}t.VoiceFocus=_;let k=(e=m)=>new(window.AudioContext||window.webkitAudioContext)(e);t.createAudioContext=k;let T=(e,t,i)=>n(void 0,void 0,void 0,function*(){var n,r;let{constraints:s,spec:o,delegate:a,preload:l=!0,options:d}=t,{logger:u}=i,h=yield _.configure(o,i);if(!h.supported)return null===(n=i.logger)||void 0===n||n.warn("Voice Focus not supported; returning standard stream."),window.navigator.mediaDevices.getUserMedia(s);let f=yield _.init(h,{delegate:a,preload:l,logger:u}),p=(null===(r=t.options)||void 0===r?void 0:r.agc)||c,m=yield window.navigator.mediaDevices.getUserMedia(w(s,p));return f.applyToStream(m,e,d).then(e=>e.stream)});t.getAudioInput=T},47662:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});let r=i(70085),s=i(24771),o=5e3;class a extends s.VoiceFocusAudioWorkletNode{constructor(e,t){super(e,t.processor,t),this.cpuWarningCount=0,this.channelCountMode="explicit",this.channelCount=1;let{modelURL:i,worker:n,fetchBehavior:s,logger:o,delegate:a}=t;this.logger=o,this.port.onmessage=this.onProcessorMessage.bind(this),this.delegate=a,o&&o.debug("VoiceFocusInlineNode:",i),this.worker=n,this.worker.onmessage=this.onWorkerMessage.bind(this);let l=r.supportsWASMPostMessage(globalThis)?"get-module":"get-module-buffer";this.worker.postMessage({message:l,key:"model",fetchBehavior:s,path:i})}onModuleBufferLoaded(e,t){this.port.postMessage({message:"module-buffer",buffer:e,key:t})}onModuleLoaded(e,t){this.port.postMessage({message:"module",module:e,key:t})}enable(){return n(this,void 0,void 0,function*(){this.port.postMessage({message:"enable"})})}disable(){return n(this,void 0,void 0,function*(){this.port.postMessage({message:"disable"})})}stop(){var e;return n(this,void 0,void 0,function*(){this.port.postMessage({message:"stop"});try{null===(e=this.worker)||void 0===e||e.terminate()}catch(e){console.error("failed to terminate worker:",e)}this.disconnect()})}onProcessorMessage(e){var t,i,n;let r=e.data;if("cpu"===r.message){this.cpuWarningCount++;let e=Date.now(),n=this.cpuWarningLastTriggered||e,s=Math.abs(e-n);(!this.cpuWarningLastTriggered||s>o)&&(null===(t=this.logger)||void 0===t||t.warn(`CPU warning (count: ${this.cpuWarningCount}):`,r.message),this.cpuWarningCount=0,this.cpuWarningLastTriggered=e),null===(i=this.delegate)||void 0===i||i.onCPUWarning()}else null===(n=this.logger)||void 0===n||n.debug("Ignoring processor message.")}onWorkerMessage(e){let t=e.data;switch(t.message){case"module-buffer":if(!t.buffer||!t.key)return;this.onModuleBufferLoaded(t.buffer,t.key);break;case"module":if(!t.module||!t.key)return;this.onModuleLoaded(t.module,t.key);break;case"stopped":this.worker&&this.worker.terminate();break;default:return}}}t.default=a},77118:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});let r=i(70085),s=i(24771);class o extends s.VoiceFocusAudioWorkletNode{constructor(e,t){super(e,t.processor,t),this.channelCountMode="explicit",this.channelCount=1;let{modelURL:i,audioBufferURL:n,worker:s,fetchBehavior:o,delegate:a}=t;this.delegate=a,this.worker=s,this.worker.onmessage=this.onWorkerMessage.bind(this),this.port.onmessage=this.onProcessorMessage.bind(this);let{enabled:l,agc:d,supportFarendStream:u}=t.processorOptions;this.worker.postMessage({message:"init",approach:"postMessage",frames:16e3===e.sampleRate?160:480,enabled:l,agc:d,fetchBehavior:o,model:i,supportFarendStream:u});let c=r.supportsWASMPostMessage(globalThis)?"get-module":"get-module-buffer";this.worker.postMessage({message:c,key:"buffer",fetchBehavior:o,path:n})}enable(){return n(this,void 0,void 0,function*(){this.worker.postMessage({message:"enable"})})}disable(){return n(this,void 0,void 0,function*(){this.worker.postMessage({message:"disable"})})}stop(){return n(this,void 0,void 0,function*(){try{this.worker.postMessage({message:"stop"})}catch(e){}this.disconnect()})}onWorkerMessage(e){var t;let i=e.data;switch(i.message){case"ready":this.port.postMessage({message:"ready",shared:i.shared},i.shared?Object.values(i.shared):[]);break;case"data":if(!i.buffer)return;this.port.postMessage({message:"data",buffer:i.buffer},[i.buffer]);break;case"stopped":this.worker.terminate();break;case"module-buffer":case"module":case"processing":this.port.postMessage(i);break;case"cpu":null===(t=this.delegate)||void 0===t||t.onCPUWarning();break;default:return}}onProcessorMessage(e){var t;let i=e.data;switch(i.message){case"data":if(!i.buffer)return;this.worker.postMessage({message:"data",buffer:i.buffer},[i.buffer]);break;case"cpu":null===(t=this.delegate)||void 0===t||t.onCPUWarning();break;case"prepare-for-frames":this.worker.postMessage(i);break;default:return}}}t.default=o},97527:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});let r=i(70085),s=i(24771),o={ready:0,enabled:1},a={disabled:0,enabled:1,stopped:2};class l extends s.VoiceFocusAudioWorkletNode{constructor(e,t){super(e,t.processor,t),this.channelCountMode="explicit",this.channelCount=1;let{modelURL:i,resamplerURL:n,worker:s,fetchBehavior:o,delegate:a}=t;this.delegate=a,this.worker=s,this.worker.onmessage=this.onWorkerMessage.bind(this),this.port.onmessage=this.onProcessorMessage.bind(this);let{enabled:l,supportFarendStream:d}=t.processorOptions;this.worker.postMessage({message:"init",approach:"sab",frames:16e3===e.sampleRate?160:480,enabled:l,model:i,supportFarendStream:d});let u=r.supportsWASMPostMessage(globalThis)?"get-module":"get-module-buffer";this.worker.postMessage({message:u,key:"resampler",fetchBehavior:o,path:n})}enable(){return n(this,void 0,void 0,function*(){this.state?(Atomics.store(this.state,o.enabled,a.enabled),Atomics.notify(this.state,o.ready,1)):this.worker.postMessage({message:"enable"})})}disable(){return n(this,void 0,void 0,function*(){this.state?(Atomics.store(this.state,o.enabled,a.disabled),Atomics.notify(this.state,o.ready,1)):this.worker.postMessage({message:"disable"})})}stop(){return n(this,void 0,void 0,function*(){if(this.state)Atomics.store(this.state,o.enabled,a.stopped),Atomics.notify(this.state,o.ready,1);else try{this.worker.postMessage({message:"stop"})}catch(e){}this.disconnect()})}onWorkerMessage(e){var t;let i=e.data;switch(i.message){case"ready":if(!i.shared)throw Error("No shared state.");this.state=new Int32Array(i.shared.state),this.port.postMessage(i);break;case"stopped":this.worker.terminate();break;case"module-buffer":case"module":case"processing":this.port.postMessage(i);break;case"cpu":null===(t=this.delegate)||void 0===t||t.onCPUWarning();break;default:return}}onProcessorMessage(e){var t;let i=e.data;switch(i.message){case"cpu":null===(t=this.delegate)||void 0===t||t.onCPUWarning();break;case"prepare-for-frames":this.worker.postMessage(i)}}}t.default=l},48738:function(e,t){"use strict";t.byteLength=d,t.toByteArray=c,t.fromByteArray=p;for(var i=[],n=[],r="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,a=s.length;o<a;++o)i[o]=s[o],n[s.charCodeAt(o)]=o;function l(e){var t=e.length;if(t%4>0)throw Error("Invalid string. Length must be a multiple of 4");var i=e.indexOf("=");-1===i&&(i=t);var n=i===t?0:4-i%4;return[i,n]}function d(e){var t=l(e),i=t[0],n=t[1];return(i+n)*3/4-n}function u(e,t,i){return(t+i)*3/4-i}function c(e){var t,i,s=l(e),o=s[0],a=s[1],d=new r(u(e,o,a)),c=0,h=a>0?o-4:o;for(i=0;i<h;i+=4)t=n[e.charCodeAt(i)]<<18|n[e.charCodeAt(i+1)]<<12|n[e.charCodeAt(i+2)]<<6|n[e.charCodeAt(i+3)],d[c++]=t>>16&255,d[c++]=t>>8&255,d[c++]=255&t;return 2===a&&(t=n[e.charCodeAt(i)]<<2|n[e.charCodeAt(i+1)]>>4,d[c++]=255&t),1===a&&(t=n[e.charCodeAt(i)]<<10|n[e.charCodeAt(i+1)]<<4|n[e.charCodeAt(i+2)]>>2,d[c++]=t>>8&255,d[c++]=255&t),d}function h(e){return i[e>>18&63]+i[e>>12&63]+i[e>>6&63]+i[63&e]}function f(e,t,i){for(var n=[],r=t;r<i;r+=3)n.push(h((e[r]<<16&16711680)+(e[r+1]<<8&65280)+(255&e[r+2])));return n.join("")}function p(e){for(var t,n=e.length,r=n%3,s=[],o=16383,a=0,l=n-r;a<l;a+=o)s.push(f(e,a,a+o>l?l:a+o));return 1===r?s.push(i[(t=e[n-1])>>2]+i[t<<4&63]+"=="):2===r&&s.push(i[(t=(e[n-2]<<8)+e[n-1])>>10]+i[t>>4&63]+i[t<<2&63]+"="),s.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},22510:function(e){!function(t,i){e.exports=i()}(0,function(){return function(e){var t={};function i(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t||4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,(function(t){return e[t]}).bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=90)}({17:function(e,t,i){"use strict";t.__esModule=!0,t.default=void 0;var n=i(18),r=function(){function e(){}return e.getFirstMatch=function(e,t){var i=t.match(e);return i&&i.length>0&&i[1]||""},e.getSecondMatch=function(e,t){var i=t.match(e);return i&&i.length>1&&i[2]||""},e.matchAndReturnConst=function(e,t,i){if(e.test(t))return i},e.getWindowsVersionName=function(e){switch(e){case"NT":return"NT";case"XP":case"NT 5.1":return"XP";case"NT 5.0":return"2000";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}},e.getMacOSVersionName=function(e){var t=e.split(".").splice(0,2).map(function(e){return parseInt(e,10)||0});if(t.push(0),10===t[0])switch(t[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}},e.getAndroidVersionName=function(e){var t=e.split(".").splice(0,2).map(function(e){return parseInt(e,10)||0});if(t.push(0),!(1===t[0]&&t[1]<5))return 1===t[0]&&t[1]<6?"Cupcake":1===t[0]&&t[1]>=6?"Donut":2===t[0]&&t[1]<2?"Eclair":2===t[0]&&2===t[1]?"Froyo":2===t[0]&&t[1]>2?"Gingerbread":3===t[0]?"Honeycomb":4===t[0]&&t[1]<1?"Ice Cream Sandwich":4===t[0]&&t[1]<4?"Jelly Bean":4===t[0]&&t[1]>=4?"KitKat":5===t[0]?"Lollipop":6===t[0]?"Marshmallow":7===t[0]?"Nougat":8===t[0]?"Oreo":9===t[0]?"Pie":void 0},e.getVersionPrecision=function(e){return e.split(".").length},e.compareVersions=function(t,i,n){void 0===n&&(n=!1);var r=e.getVersionPrecision(t),s=e.getVersionPrecision(i),o=Math.max(r,s),a=0,l=e.map([t,i],function(t){var i=o-e.getVersionPrecision(t),n=t+Array(i+1).join(".0");return e.map(n.split("."),function(e){return Array(20-e.length).join("0")+e}).reverse()});for(n&&(a=o-Math.min(r,s)),o-=1;o>=a;){if(l[0][o]>l[1][o])return 1;if(l[0][o]===l[1][o]){if(o===a)return 0;o-=1}else if(l[0][o]<l[1][o])return -1}},e.map=function(e,t){var i,n=[];if(Array.prototype.map)return Array.prototype.map.call(e,t);for(i=0;i<e.length;i+=1)n.push(t(e[i]));return n},e.find=function(e,t){var i,n;if(Array.prototype.find)return Array.prototype.find.call(e,t);for(i=0,n=e.length;i<n;i+=1){var r=e[i];if(t(r,i))return r}},e.assign=function(e){for(var t,i,n=e,r=arguments.length,s=Array(r>1?r-1:0),o=1;o<r;o++)s[o-1]=arguments[o];if(Object.assign)return Object.assign.apply(Object,[e].concat(s));var a=function(){var e=s[t];"object"==typeof e&&null!==e&&Object.keys(e).forEach(function(t){n[t]=e[t]})};for(t=0,i=s.length;t<i;t+=1)a();return e},e.getBrowserAlias=function(e){return n.BROWSER_ALIASES_MAP[e]},e.getBrowserTypeByAlias=function(e){return n.BROWSER_MAP[e]||""},e}();t.default=r,e.exports=t.default},18:function(e,t,i){"use strict";t.__esModule=!0,t.ENGINE_MAP=t.OS_MAP=t.PLATFORMS_MAP=t.BROWSER_MAP=t.BROWSER_ALIASES_MAP=void 0,t.BROWSER_ALIASES_MAP={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},t.BROWSER_MAP={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},t.PLATFORMS_MAP={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},t.OS_MAP={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},t.ENGINE_MAP={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"}},90:function(e,t,i){"use strict";t.__esModule=!0,t.default=void 0;var n,r=(n=i(91))&&n.__esModule?n:{default:n},s=i(18);function o(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=function(){var e;function t(){}return t.getParser=function(e,t){if(void 0===t&&(t=!1),"string"!=typeof e)throw Error("UserAgent should be a string");return new r.default(e,t)},t.parse=function(e){return new r.default(e).getResult()},e=null,o(t,[{key:"BROWSER_MAP",get:function(){return s.BROWSER_MAP}},{key:"ENGINE_MAP",get:function(){return s.ENGINE_MAP}},{key:"OS_MAP",get:function(){return s.OS_MAP}},{key:"PLATFORMS_MAP",get:function(){return s.PLATFORMS_MAP}}]),t}();t.default=a,e.exports=t.default},91:function(e,t,i){"use strict";t.__esModule=!0,t.default=void 0;var n=l(i(92)),r=l(i(93)),s=l(i(94)),o=l(i(95)),a=l(i(17));function l(e){return e&&e.__esModule?e:{default:e}}var d=function(){function e(e,t){if(void 0===t&&(t=!1),null==e||""===e)throw Error("UserAgent parameter can't be empty");this._ua=e,this.parsedResult={},!0!==t&&this.parse()}var t=e.prototype;return t.getUA=function(){return this._ua},t.test=function(e){return e.test(this._ua)},t.parseBrowser=function(){var e=this;this.parsedResult.browser={};var t=a.default.find(n.default,function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some(function(t){return e.test(t)});throw Error("Browser's test function is not valid")});return t&&(this.parsedResult.browser=t.describe(this.getUA())),this.parsedResult.browser},t.getBrowser=function(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()},t.getBrowserName=function(e){return e?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""},t.getBrowserVersion=function(){return this.getBrowser().version},t.getOS=function(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()},t.parseOS=function(){var e=this;this.parsedResult.os={};var t=a.default.find(r.default,function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some(function(t){return e.test(t)});throw Error("Browser's test function is not valid")});return t&&(this.parsedResult.os=t.describe(this.getUA())),this.parsedResult.os},t.getOSName=function(e){var t=this.getOS().name;return e?String(t).toLowerCase()||"":t||""},t.getOSVersion=function(){return this.getOS().version},t.getPlatform=function(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()},t.getPlatformType=function(e){void 0===e&&(e=!1);var t=this.getPlatform().type;return e?String(t).toLowerCase()||"":t||""},t.parsePlatform=function(){var e=this;this.parsedResult.platform={};var t=a.default.find(s.default,function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some(function(t){return e.test(t)});throw Error("Browser's test function is not valid")});return t&&(this.parsedResult.platform=t.describe(this.getUA())),this.parsedResult.platform},t.getEngine=function(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()},t.getEngineName=function(e){return e?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""},t.parseEngine=function(){var e=this;this.parsedResult.engine={};var t=a.default.find(o.default,function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some(function(t){return e.test(t)});throw Error("Browser's test function is not valid")});return t&&(this.parsedResult.engine=t.describe(this.getUA())),this.parsedResult.engine},t.parse=function(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this},t.getResult=function(){return a.default.assign({},this.parsedResult)},t.satisfies=function(e){var t=this,i={},n=0,r={},s=0;if(Object.keys(e).forEach(function(t){var o=e[t];"string"==typeof o?(r[t]=o,s+=1):"object"==typeof o&&(i[t]=o,n+=1)}),n>0){var o=Object.keys(i),l=a.default.find(o,function(e){return t.isOS(e)});if(l){var d=this.satisfies(i[l]);if(void 0!==d)return d}var u=a.default.find(o,function(e){return t.isPlatform(e)});if(u){var c=this.satisfies(i[u]);if(void 0!==c)return c}}if(s>0){var h=Object.keys(r),f=a.default.find(h,function(e){return t.isBrowser(e,!0)});if(void 0!==f)return this.compareVersion(r[f])}},t.isBrowser=function(e,t){void 0===t&&(t=!1);var i=this.getBrowserName().toLowerCase(),n=e.toLowerCase(),r=a.default.getBrowserTypeByAlias(n);return t&&r&&(n=r.toLowerCase()),n===i},t.compareVersion=function(e){var t=[0],i=e,n=!1,r=this.getBrowserVersion();if("string"==typeof r)return">"===e[0]||"<"===e[0]?(i=e.substr(1),"="===e[1]?(n=!0,i=e.substr(2)):t=[],">"===e[0]?t.push(1):t.push(-1)):"="===e[0]?i=e.substr(1):"~"===e[0]&&(n=!0,i=e.substr(1)),t.indexOf(a.default.compareVersions(r,i,n))>-1},t.isOS=function(e){return this.getOSName(!0)===String(e).toLowerCase()},t.isPlatform=function(e){return this.getPlatformType(!0)===String(e).toLowerCase()},t.isEngine=function(e){return this.getEngineName(!0)===String(e).toLowerCase()},t.is=function(e,t){return void 0===t&&(t=!1),this.isBrowser(e,t)||this.isOS(e)||this.isPlatform(e)},t.some=function(e){var t=this;return void 0===e&&(e=[]),e.some(function(e){return t.is(e)})},e}();t.default=d,e.exports=t.default},92:function(e,t,i){"use strict";t.__esModule=!0,t.default=void 0;var n,r=(n=i(17))&&n.__esModule?n:{default:n},s=/version\/(\d+(\.?_?\d+)+)/i,o=[{test:[/googlebot/i],describe:function(e){var t={name:"Googlebot"},i=r.default.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,e)||r.default.getFirstMatch(s,e);return i&&(t.version=i),t}},{test:[/opera/i],describe:function(e){var t={name:"Opera"},i=r.default.getFirstMatch(s,e)||r.default.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/opr\/|opios/i],describe:function(e){var t={name:"Opera"},i=r.default.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,e)||r.default.getFirstMatch(s,e);return i&&(t.version=i),t}},{test:[/SamsungBrowser/i],describe:function(e){var t={name:"Samsung Internet for Android"},i=r.default.getFirstMatch(s,e)||r.default.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/Whale/i],describe:function(e){var t={name:"NAVER Whale Browser"},i=r.default.getFirstMatch(s,e)||r.default.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/MZBrowser/i],describe:function(e){var t={name:"MZ Browser"},i=r.default.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,e)||r.default.getFirstMatch(s,e);return i&&(t.version=i),t}},{test:[/focus/i],describe:function(e){var t={name:"Focus"},i=r.default.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,e)||r.default.getFirstMatch(s,e);return i&&(t.version=i),t}},{test:[/swing/i],describe:function(e){var t={name:"Swing"},i=r.default.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,e)||r.default.getFirstMatch(s,e);return i&&(t.version=i),t}},{test:[/coast/i],describe:function(e){var t={name:"Opera Coast"},i=r.default.getFirstMatch(s,e)||r.default.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe:function(e){var t={name:"Opera Touch"},i=r.default.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,e)||r.default.getFirstMatch(s,e);return i&&(t.version=i),t}},{test:[/yabrowser/i],describe:function(e){var t={name:"Yandex Browser"},i=r.default.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,e)||r.default.getFirstMatch(s,e);return i&&(t.version=i),t}},{test:[/ucbrowser/i],describe:function(e){var t={name:"UC Browser"},i=r.default.getFirstMatch(s,e)||r.default.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/Maxthon|mxios/i],describe:function(e){var t={name:"Maxthon"},i=r.default.getFirstMatch(s,e)||r.default.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/epiphany/i],describe:function(e){var t={name:"Epiphany"},i=r.default.getFirstMatch(s,e)||r.default.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/puffin/i],describe:function(e){var t={name:"Puffin"},i=r.default.getFirstMatch(s,e)||r.default.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/sleipnir/i],describe:function(e){var t={name:"Sleipnir"},i=r.default.getFirstMatch(s,e)||r.default.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/k-meleon/i],describe:function(e){var t={name:"K-Meleon"},i=r.default.getFirstMatch(s,e)||r.default.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/micromessenger/i],describe:function(e){var t={name:"WeChat"},i=r.default.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,e)||r.default.getFirstMatch(s,e);return i&&(t.version=i),t}},{test:[/qqbrowser/i],describe:function(e){var t={name:/qqbrowserlite/i.test(e)?"QQ Browser Lite":"QQ Browser"},i=r.default.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,e)||r.default.getFirstMatch(s,e);return i&&(t.version=i),t}},{test:[/msie|trident/i],describe:function(e){var t={name:"Internet Explorer"},i=r.default.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/\sedg\//i],describe:function(e){var t={name:"Microsoft Edge"},i=r.default.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/edg([ea]|ios)/i],describe:function(e){var t={name:"Microsoft Edge"},i=r.default.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/vivaldi/i],describe:function(e){var t={name:"Vivaldi"},i=r.default.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/seamonkey/i],describe:function(e){var t={name:"SeaMonkey"},i=r.default.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/sailfish/i],describe:function(e){var t={name:"Sailfish"},i=r.default.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,e);return i&&(t.version=i),t}},{test:[/silk/i],describe:function(e){var t={name:"Amazon Silk"},i=r.default.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/phantom/i],describe:function(e){var t={name:"PhantomJS"},i=r.default.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/slimerjs/i],describe:function(e){var t={name:"SlimerJS"},i=r.default.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t={name:"BlackBerry"},i=r.default.getFirstMatch(s,e)||r.default.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t={name:"WebOS Browser"},i=r.default.getFirstMatch(s,e)||r.default.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/bada/i],describe:function(e){var t={name:"Bada"},i=r.default.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/tizen/i],describe:function(e){var t={name:"Tizen"},i=r.default.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,e)||r.default.getFirstMatch(s,e);return i&&(t.version=i),t}},{test:[/qupzilla/i],describe:function(e){var t={name:"QupZilla"},i=r.default.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,e)||r.default.getFirstMatch(s,e);return i&&(t.version=i),t}},{test:[/firefox|iceweasel|fxios/i],describe:function(e){var t={name:"Firefox"},i=r.default.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/electron/i],describe:function(e){var t={name:"Electron"},i=r.default.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/MiuiBrowser/i],describe:function(e){var t={name:"Miui"},i=r.default.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/chromium/i],describe:function(e){var t={name:"Chromium"},i=r.default.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,e)||r.default.getFirstMatch(s,e);return i&&(t.version=i),t}},{test:[/chrome|crios|crmo/i],describe:function(e){var t={name:"Chrome"},i=r.default.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/GSA/i],describe:function(e){var t={name:"Google Search"},i=r.default.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:function(e){var t=!e.test(/like android/i),i=e.test(/android/i);return t&&i},describe:function(e){var t={name:"Android Browser"},i=r.default.getFirstMatch(s,e);return i&&(t.version=i),t}},{test:[/playstation 4/i],describe:function(e){var t={name:"PlayStation 4"},i=r.default.getFirstMatch(s,e);return i&&(t.version=i),t}},{test:[/safari|applewebkit/i],describe:function(e){var t={name:"Safari"},i=r.default.getFirstMatch(s,e);return i&&(t.version=i),t}},{test:[/.*/i],describe:function(e){var t=-1!==e.search("\\(")?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:r.default.getFirstMatch(t,e),version:r.default.getSecondMatch(t,e)}}}];t.default=o,e.exports=t.default},93:function(e,t,i){"use strict";t.__esModule=!0,t.default=void 0;var n,r=(n=i(17))&&n.__esModule?n:{default:n},s=i(18),o=[{test:[/Roku\/DVP/],describe:function(e){var t=r.default.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,e);return{name:s.OS_MAP.Roku,version:t}}},{test:[/windows phone/i],describe:function(e){var t=r.default.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,e);return{name:s.OS_MAP.WindowsPhone,version:t}}},{test:[/windows /i],describe:function(e){var t=r.default.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,e),i=r.default.getWindowsVersionName(t);return{name:s.OS_MAP.Windows,version:t,versionName:i}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(e){var t={name:s.OS_MAP.iOS},i=r.default.getSecondMatch(/(Version\/)(\d[\d.]+)/,e);return i&&(t.version=i),t}},{test:[/macintosh/i],describe:function(e){var t=r.default.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,e).replace(/[_\s]/g,"."),i=r.default.getMacOSVersionName(t),n={name:s.OS_MAP.MacOS,version:t};return i&&(n.versionName=i),n}},{test:[/(ipod|iphone|ipad)/i],describe:function(e){var t=r.default.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,e).replace(/[_\s]/g,".");return{name:s.OS_MAP.iOS,version:t}}},{test:function(e){var t=!e.test(/like android/i),i=e.test(/android/i);return t&&i},describe:function(e){var t=r.default.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,e),i=r.default.getAndroidVersionName(t),n={name:s.OS_MAP.Android,version:t};return i&&(n.versionName=i),n}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t=r.default.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,e),i={name:s.OS_MAP.WebOS};return t&&t.length&&(i.version=t),i}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t=r.default.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,e)||r.default.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,e)||r.default.getFirstMatch(/\bbb(\d+)/i,e);return{name:s.OS_MAP.BlackBerry,version:t}}},{test:[/bada/i],describe:function(e){var t=r.default.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,e);return{name:s.OS_MAP.Bada,version:t}}},{test:[/tizen/i],describe:function(e){var t=r.default.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,e);return{name:s.OS_MAP.Tizen,version:t}}},{test:[/linux/i],describe:function(){return{name:s.OS_MAP.Linux}}},{test:[/CrOS/],describe:function(){return{name:s.OS_MAP.ChromeOS}}},{test:[/PlayStation 4/],describe:function(e){var t=r.default.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,e);return{name:s.OS_MAP.PlayStation4,version:t}}}];t.default=o,e.exports=t.default},94:function(e,t,i){"use strict";t.__esModule=!0,t.default=void 0;var n,r=(n=i(17))&&n.__esModule?n:{default:n},s=i(18),o=[{test:[/googlebot/i],describe:function(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe:function(e){var t=r.default.getFirstMatch(/(can-l01)/i,e)&&"Nova",i={type:s.PLATFORMS_MAP.mobile,vendor:"Huawei"};return t&&(i.model=t),i}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:function(){return{type:s.PLATFORMS_MAP.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe:function(){return{type:s.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(){return{type:s.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe:function(){return{type:s.PLATFORMS_MAP.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe:function(){return{type:s.PLATFORMS_MAP.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe:function(){return{type:s.PLATFORMS_MAP.tablet}}},{test:function(e){var t=e.test(/ipod|iphone/i),i=e.test(/like (ipod|iphone)/i);return t&&!i},describe:function(e){var t=r.default.getFirstMatch(/(ipod|iphone)/i,e);return{type:s.PLATFORMS_MAP.mobile,vendor:"Apple",model:t}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:function(){return{type:s.PLATFORMS_MAP.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe:function(){return{type:s.PLATFORMS_MAP.mobile}}},{test:function(e){return"blackberry"===e.getBrowserName(!0)},describe:function(){return{type:s.PLATFORMS_MAP.mobile,vendor:"BlackBerry"}}},{test:function(e){return"bada"===e.getBrowserName(!0)},describe:function(){return{type:s.PLATFORMS_MAP.mobile}}},{test:function(e){return"windows phone"===e.getBrowserName()},describe:function(){return{type:s.PLATFORMS_MAP.mobile,vendor:"Microsoft"}}},{test:function(e){var t=Number(String(e.getOSVersion()).split(".")[0]);return"android"===e.getOSName(!0)&&t>=3},describe:function(){return{type:s.PLATFORMS_MAP.tablet}}},{test:function(e){return"android"===e.getOSName(!0)},describe:function(){return{type:s.PLATFORMS_MAP.mobile}}},{test:function(e){return"macos"===e.getOSName(!0)},describe:function(){return{type:s.PLATFORMS_MAP.desktop,vendor:"Apple"}}},{test:function(e){return"windows"===e.getOSName(!0)},describe:function(){return{type:s.PLATFORMS_MAP.desktop}}},{test:function(e){return"linux"===e.getOSName(!0)},describe:function(){return{type:s.PLATFORMS_MAP.desktop}}},{test:function(e){return"playstation 4"===e.getOSName(!0)},describe:function(){return{type:s.PLATFORMS_MAP.tv}}},{test:function(e){return"roku"===e.getOSName(!0)},describe:function(){return{type:s.PLATFORMS_MAP.tv}}}];t.default=o,e.exports=t.default},95:function(e,t,i){"use strict";t.__esModule=!0,t.default=void 0;var n,r=(n=i(17))&&n.__esModule?n:{default:n},s=i(18),o=[{test:function(e){return"microsoft edge"===e.getBrowserName(!0)},describe:function(e){if(/\sedg\//i.test(e))return{name:s.ENGINE_MAP.Blink};var t=r.default.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,e);return{name:s.ENGINE_MAP.EdgeHTML,version:t}}},{test:[/trident/i],describe:function(e){var t={name:s.ENGINE_MAP.Trident},i=r.default.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:function(e){return e.test(/presto/i)},describe:function(e){var t={name:s.ENGINE_MAP.Presto},i=r.default.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:function(e){var t=e.test(/gecko/i),i=e.test(/like gecko/i);return t&&!i},describe:function(e){var t={name:s.ENGINE_MAP.Gecko},i=r.default.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/(apple)?webkit\/537\.36/i],describe:function(){return{name:s.ENGINE_MAP.Blink}}},{test:[/(apple)?webkit/i],describe:function(e){var t={name:s.ENGINE_MAP.WebKit},i=r.default.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}}];t.default=o,e.exports=t.default}})})},9109:function(e,t,i){"use strict";/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var n=i(48738),r=i(6868);t.Buffer=l,t.SlowBuffer=b,t.INSPECT_MAX_BYTES=50;var s=2147483647;function o(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()}catch(e){return!1}}function a(e){if(e>s)throw RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return t.__proto__=l.prototype,t}function l(e,t,i){if("number"==typeof e){if("string"==typeof t)throw TypeError('The "string" argument must be of type string. Received type number');return h(e)}return d(e,t,i)}function d(e,t,i){if("string"==typeof e)return f(e,t);if(ArrayBuffer.isView(e))return p(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(Y(e,ArrayBuffer)||e&&Y(e.buffer,ArrayBuffer))return m(e,t,i);if("number"==typeof e)throw TypeError('The "value" argument must not be of type number. Received type number');var n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return l.from(n,t,i);var r=g(e);if(r)return r;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return l.from(e[Symbol.toPrimitive]("string"),t,i);throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function u(e){if("number"!=typeof e)throw TypeError('"size" argument must be of type number');if(e<0)throw RangeError('The value "'+e+'" is invalid for option "size"')}function c(e,t,i){return(u(e),e<=0)?a(e):void 0!==t?"string"==typeof i?a(e).fill(t,i):a(e).fill(t):a(e)}function h(e){return u(e),a(e<0?0:0|v(e))}function f(e,t){if(("string"!=typeof t||""===t)&&(t="utf8"),!l.isEncoding(t))throw TypeError("Unknown encoding: "+t);var i=0|S(e,t),n=a(i),r=n.write(e,t);return r!==i&&(n=n.slice(0,r)),n}function p(e){for(var t=e.length<0?0:0|v(e.length),i=a(t),n=0;n<t;n+=1)i[n]=255&e[n];return i}function m(e,t,i){var n;if(t<0||e.byteLength<t)throw RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(i||0))throw RangeError('"length" is outside of buffer bounds');return(n=void 0===t&&void 0===i?new Uint8Array(e):void 0===i?new Uint8Array(e,t):new Uint8Array(e,t,i)).__proto__=l.prototype,n}function g(e){if(l.isBuffer(e)){var t=0|v(e.length),i=a(t);return 0===i.length||e.copy(i,0,0,t),i}return void 0!==e.length?"number"!=typeof e.length||J(e.length)?a(0):p(e):"Buffer"===e.type&&Array.isArray(e.data)?p(e.data):void 0}function v(e){if(e>=s)throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return 0|e}function b(e){return+e!=e&&(e=0),l.alloc(+e)}function S(e,t){if(l.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||Y(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var i=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===i)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":return K(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return Q(e).length;default:if(r)return n?-1:K(e).length;t=(""+t).toLowerCase(),r=!0}}function y(e,t,i){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length||((void 0===i||i>this.length)&&(i=this.length),i<=0||(i>>>=0)<=(t>>>=0)))return"";for(e||(e="utf8");;)switch(e){case"hex":return F(this,t,i);case"utf8":case"utf-8":return R(this,t,i);case"ascii":return D(this,t,i);case"latin1":case"binary":return L(this,t,i);case"base64":return A(this,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return B(this,t,i);default:if(n)throw TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function w(e,t,i){var n=e[t];e[t]=e[i],e[i]=n}function C(e,t,i,n,r){if(0===e.length)return -1;if("string"==typeof i?(n=i,i=0):i>2147483647?i=2147483647:i<-2147483648&&(i=-2147483648),J(i=+i)&&(i=r?0:e.length-1),i<0&&(i=e.length+i),i>=e.length){if(r)return -1;i=e.length-1}else if(i<0){if(!r)return -1;i=0}if("string"==typeof t&&(t=l.from(t,n)),l.isBuffer(t))return 0===t.length?-1:_(e,t,i,n,r);if("number"==typeof t)return(t&=255,"function"==typeof Uint8Array.prototype.indexOf)?r?Uint8Array.prototype.indexOf.call(e,t,i):Uint8Array.prototype.lastIndexOf.call(e,t,i):_(e,[t],i,n,r);throw TypeError("val must be string, number or Buffer")}function _(e,t,i,n,r){var s,o=1,a=e.length,l=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return -1;o=2,a/=2,l/=2,i/=2}function d(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(r){var u=-1;for(s=i;s<a;s++)if(d(e,s)===d(t,-1===u?0:s-u)){if(-1===u&&(u=s),s-u+1===l)return u*o}else -1!==u&&(s-=s-u),u=-1}else for(i+l>a&&(i=a-l),s=i;s>=0;s--){for(var c=!0,h=0;h<l;h++)if(d(e,s+h)!==d(t,h)){c=!1;break}if(c)return s}return -1}function k(e,t,i,n){i=Number(i)||0;var r=e.length-i;n?(n=Number(n))>r&&(n=r):n=r;var s=t.length;n>s/2&&(n=s/2);for(var o=0;o<n;++o){var a=parseInt(t.substr(2*o,2),16);if(J(a))break;e[i+o]=a}return o}function T(e,t,i,n){return Z(K(t,e.length-i),e,i,n)}function P(e,t,i,n){return Z(G(t),e,i,n)}function E(e,t,i,n){return P(e,t,i,n)}function M(e,t,i,n){return Z(Q(t),e,i,n)}function I(e,t,i,n){return Z(q(t,e.length-i),e,i,n)}function A(e,t,i){return 0===t&&i===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,i))}function R(e,t,i){i=Math.min(e.length,i);for(var n=[],r=t;r<i;){var s,o,a,l,d=e[r],u=null,c=d>239?4:d>223?3:d>191?2:1;if(r+c<=i)switch(c){case 1:d<128&&(u=d);break;case 2:(192&(s=e[r+1]))==128&&(l=(31&d)<<6|63&s)>127&&(u=l);break;case 3:s=e[r+1],o=e[r+2],(192&s)==128&&(192&o)==128&&(l=(15&d)<<12|(63&s)<<6|63&o)>2047&&(l<55296||l>57343)&&(u=l);break;case 4:s=e[r+1],o=e[r+2],a=e[r+3],(192&s)==128&&(192&o)==128&&(192&a)==128&&(l=(15&d)<<18|(63&s)<<12|(63&o)<<6|63&a)>65535&&l<1114112&&(u=l)}null===u?(u=65533,c=1):u>65535&&(u-=65536,n.push(u>>>10&1023|55296),u=56320|1023&u),n.push(u),r+=c}return O(n)}t.kMaxLength=s,l.TYPED_ARRAY_SUPPORT=o(),l.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.buffer}}),Object.defineProperty(l.prototype,"offset",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),l.poolSize=8192,l.from=function(e,t,i){return d(e,t,i)},l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,l.alloc=function(e,t,i){return c(e,t,i)},l.allocUnsafe=function(e){return h(e)},l.allocUnsafeSlow=function(e){return h(e)},l.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==l.prototype},l.compare=function(e,t){if(Y(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),Y(t,Uint8Array)&&(t=l.from(t,t.offset,t.byteLength)),!l.isBuffer(e)||!l.isBuffer(t))throw TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var i=e.length,n=t.length,r=0,s=Math.min(i,n);r<s;++r)if(e[r]!==t[r]){i=e[r],n=t[r];break}return i<n?-1:n<i?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!Array.isArray(e))throw TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);if(void 0===t)for(i=0,t=0;i<e.length;++i)t+=e[i].length;var i,n=l.allocUnsafe(t),r=0;for(i=0;i<e.length;++i){var s=e[i];if(Y(s,Uint8Array)&&(s=l.from(s)),!l.isBuffer(s))throw TypeError('"list" argument must be an Array of Buffers');s.copy(n,r),r+=s.length}return n},l.byteLength=S,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)w(this,t,t+1);return this},l.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)w(this,t,t+3),w(this,t+1,t+2);return this},l.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)w(this,t,t+7),w(this,t+1,t+6),w(this,t+2,t+5),w(this,t+3,t+4);return this},l.prototype.toString=function(){var e=this.length;return 0===e?"":0==arguments.length?R(this,0,e):y.apply(this,arguments)},l.prototype.toLocaleString=l.prototype.toString,l.prototype.equals=function(e){if(!l.isBuffer(e))throw TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){var e="",i=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,i).replace(/(.{2})/g,"$1 ").trim(),this.length>i&&(e+=" ... "),"<Buffer "+e+">"},l.prototype.compare=function(e,t,i,n,r){if(Y(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),!l.isBuffer(e))throw TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===i&&(i=e?e.length:0),void 0===n&&(n=0),void 0===r&&(r=this.length),t<0||i>e.length||n<0||r>this.length)throw RangeError("out of range index");if(n>=r&&t>=i)return 0;if(n>=r)return -1;if(t>=i)return 1;if(t>>>=0,i>>>=0,n>>>=0,r>>>=0,this===e)return 0;for(var s=r-n,o=i-t,a=Math.min(s,o),d=this.slice(n,r),u=e.slice(t,i),c=0;c<a;++c)if(d[c]!==u[c]){s=d[c],o=u[c];break}return s<o?-1:o<s?1:0},l.prototype.includes=function(e,t,i){return -1!==this.indexOf(e,t,i)},l.prototype.indexOf=function(e,t,i){return C(this,e,t,i,!0)},l.prototype.lastIndexOf=function(e,t,i){return C(this,e,t,i,!1)},l.prototype.write=function(e,t,i,n){if(void 0===t)n="utf8",i=this.length,t=0;else if(void 0===i&&"string"==typeof t)n=t,i=this.length,t=0;else if(isFinite(t))t>>>=0,isFinite(i)?(i>>>=0,void 0===n&&(n="utf8")):(n=i,i=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var r=this.length-t;if((void 0===i||i>r)&&(i=r),e.length>0&&(i<0||t<0)||t>this.length)throw RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var s=!1;;)switch(n){case"hex":return k(this,e,t,i);case"utf8":case"utf-8":return T(this,e,t,i);case"ascii":return P(this,e,t,i);case"latin1":case"binary":return E(this,e,t,i);case"base64":return M(this,e,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,e,t,i);default:if(s)throw TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),s=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var x=4096;function O(e){var t=e.length;if(t<=x)return String.fromCharCode.apply(String,e);for(var i="",n=0;n<t;)i+=String.fromCharCode.apply(String,e.slice(n,n+=x));return i}function D(e,t,i){var n="";i=Math.min(e.length,i);for(var r=t;r<i;++r)n+=String.fromCharCode(127&e[r]);return n}function L(e,t,i){var n="";i=Math.min(e.length,i);for(var r=t;r<i;++r)n+=String.fromCharCode(e[r]);return n}function F(e,t,i){var n=e.length;(!t||t<0)&&(t=0),(!i||i<0||i>n)&&(i=n);for(var r="",s=t;s<i;++s)r+=H(e[s]);return r}function B(e,t,i){for(var n=e.slice(t,i),r="",s=0;s<n.length;s+=2)r+=String.fromCharCode(n[s]+256*n[s+1]);return r}function N(e,t,i){if(e%1!=0||e<0)throw RangeError("offset is not uint");if(e+t>i)throw RangeError("Trying to access beyond buffer length")}function V(e,t,i,n,r,s){if(!l.isBuffer(e))throw TypeError('"buffer" argument must be a Buffer instance');if(t>r||t<s)throw RangeError('"value" argument is out of bounds');if(i+n>e.length)throw RangeError("Index out of range")}function U(e,t,i,n,r,s){if(i+n>e.length||i<0)throw RangeError("Index out of range")}function z(e,t,i,n,s){return t=+t,i>>>=0,s||U(e,t,i,4,34028234663852886e22,-34028234663852886e22),r.write(e,t,i,n,23,4),i+4}function j(e,t,i,n,s){return t=+t,i>>>=0,s||U(e,t,i,8,17976931348623157e292,-17976931348623157e292),r.write(e,t,i,n,52,8),i+8}l.prototype.slice=function(e,t){var i=this.length;e=~~e,t=void 0===t?i:~~t,e<0?(e+=i)<0&&(e=0):e>i&&(e=i),t<0?(t+=i)<0&&(t=0):t>i&&(t=i),t<e&&(t=e);var n=this.subarray(e,t);return n.__proto__=l.prototype,n},l.prototype.readUIntLE=function(e,t,i){e>>>=0,t>>>=0,i||N(e,t,this.length);for(var n=this[e],r=1,s=0;++s<t&&(r*=256);)n+=this[e+s]*r;return n},l.prototype.readUIntBE=function(e,t,i){e>>>=0,t>>>=0,i||N(e,t,this.length);for(var n=this[e+--t],r=1;t>0&&(r*=256);)n+=this[e+--t]*r;return n},l.prototype.readUInt8=function(e,t){return e>>>=0,t||N(e,1,this.length),this[e]},l.prototype.readUInt16LE=function(e,t){return e>>>=0,t||N(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUInt16BE=function(e,t){return e>>>=0,t||N(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUInt32LE=function(e,t){return e>>>=0,t||N(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUInt32BE=function(e,t){return e>>>=0,t||N(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readIntLE=function(e,t,i){e>>>=0,t>>>=0,i||N(e,t,this.length);for(var n=this[e],r=1,s=0;++s<t&&(r*=256);)n+=this[e+s]*r;return n>=(r*=128)&&(n-=Math.pow(2,8*t)),n},l.prototype.readIntBE=function(e,t,i){e>>>=0,t>>>=0,i||N(e,t,this.length);for(var n=t,r=1,s=this[e+--n];n>0&&(r*=256);)s+=this[e+--n]*r;return s>=(r*=128)&&(s-=Math.pow(2,8*t)),s},l.prototype.readInt8=function(e,t){return(e>>>=0,t||N(e,1,this.length),128&this[e])?-((255-this[e]+1)*1):this[e]},l.prototype.readInt16LE=function(e,t){e>>>=0,t||N(e,2,this.length);var i=this[e]|this[e+1]<<8;return 32768&i?4294901760|i:i},l.prototype.readInt16BE=function(e,t){e>>>=0,t||N(e,2,this.length);var i=this[e+1]|this[e]<<8;return 32768&i?4294901760|i:i},l.prototype.readInt32LE=function(e,t){return e>>>=0,t||N(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return e>>>=0,t||N(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readFloatLE=function(e,t){return e>>>=0,t||N(e,4,this.length),r.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return e>>>=0,t||N(e,4,this.length),r.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return e>>>=0,t||N(e,8,this.length),r.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return e>>>=0,t||N(e,8,this.length),r.read(this,e,!1,52,8)},l.prototype.writeUIntLE=function(e,t,i,n){if(e=+e,t>>>=0,i>>>=0,!n){var r=Math.pow(2,8*i)-1;V(this,e,t,i,r,0)}var s=1,o=0;for(this[t]=255&e;++o<i&&(s*=256);)this[t+o]=e/s&255;return t+i},l.prototype.writeUIntBE=function(e,t,i,n){if(e=+e,t>>>=0,i>>>=0,!n){var r=Math.pow(2,8*i)-1;V(this,e,t,i,r,0)}var s=i-1,o=1;for(this[t+s]=255&e;--s>=0&&(o*=256);)this[t+s]=e/o&255;return t+i},l.prototype.writeUInt8=function(e,t,i){return e=+e,t>>>=0,i||V(this,e,t,1,255,0),this[t]=255&e,t+1},l.prototype.writeUInt16LE=function(e,t,i){return e=+e,t>>>=0,i||V(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeUInt16BE=function(e,t,i){return e=+e,t>>>=0,i||V(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeUInt32LE=function(e,t,i){return e=+e,t>>>=0,i||V(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},l.prototype.writeUInt32BE=function(e,t,i){return e=+e,t>>>=0,i||V(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeIntLE=function(e,t,i,n){if(e=+e,t>>>=0,!n){var r=Math.pow(2,8*i-1);V(this,e,t,i,r-1,-r)}var s=0,o=1,a=0;for(this[t]=255&e;++s<i&&(o*=256);)e<0&&0===a&&0!==this[t+s-1]&&(a=1),this[t+s]=(e/o>>0)-a&255;return t+i},l.prototype.writeIntBE=function(e,t,i,n){if(e=+e,t>>>=0,!n){var r=Math.pow(2,8*i-1);V(this,e,t,i,r-1,-r)}var s=i-1,o=1,a=0;for(this[t+s]=255&e;--s>=0&&(o*=256);)e<0&&0===a&&0!==this[t+s+1]&&(a=1),this[t+s]=(e/o>>0)-a&255;return t+i},l.prototype.writeInt8=function(e,t,i){return e=+e,t>>>=0,i||V(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,i){return e=+e,t>>>=0,i||V(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeInt16BE=function(e,t,i){return e=+e,t>>>=0,i||V(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeInt32LE=function(e,t,i){return e=+e,t>>>=0,i||V(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},l.prototype.writeInt32BE=function(e,t,i){return e=+e,t>>>=0,i||V(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeFloatLE=function(e,t,i){return z(this,e,t,!0,i)},l.prototype.writeFloatBE=function(e,t,i){return z(this,e,t,!1,i)},l.prototype.writeDoubleLE=function(e,t,i){return j(this,e,t,!0,i)},l.prototype.writeDoubleBE=function(e,t,i){return j(this,e,t,!1,i)},l.prototype.copy=function(e,t,i,n){if(!l.isBuffer(e))throw TypeError("argument should be a Buffer");if(i||(i=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<i&&(n=i),n===i||0===e.length||0===this.length)return 0;if(t<0)throw RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw RangeError("Index out of range");if(n<0)throw RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-i&&(n=e.length-t+i);var r=n-i;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(t,i,n);else if(this===e&&i<t&&t<n)for(var s=r-1;s>=0;--s)e[s+t]=this[s+i];else Uint8Array.prototype.set.call(e,this.subarray(i,n),t);return r},l.prototype.fill=function(e,t,i,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,i=this.length):"string"==typeof i&&(n=i,i=this.length),void 0!==n&&"string"!=typeof n)throw TypeError("encoding must be a string");if("string"==typeof n&&!l.isEncoding(n))throw TypeError("Unknown encoding: "+n);if(1===e.length){var r,s=e.charCodeAt(0);("utf8"===n&&s<128||"latin1"===n)&&(e=s)}}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<i)throw RangeError("Out of range index");if(i<=t)return this;if(t>>>=0,i=void 0===i?this.length:i>>>0,e||(e=0),"number"==typeof e)for(r=t;r<i;++r)this[r]=e;else{var o=l.isBuffer(e)?e:l.from(e,n),a=o.length;if(0===a)throw TypeError('The value "'+e+'" is invalid for argument "value"');for(r=0;r<i-t;++r)this[r+t]=o[r%a]}return this};var $=/[^+/0-9A-Za-z-_]/g;function W(e){if((e=(e=e.split("=")[0]).trim().replace($,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}function H(e){return e<16?"0"+e.toString(16):e.toString(16)}function K(e,t){t=t||1/0;for(var i,n=e.length,r=null,s=[],o=0;o<n;++o){if((i=e.charCodeAt(o))>55295&&i<57344){if(!r){if(i>56319||o+1===n){(t-=3)>-1&&s.push(239,191,189);continue}r=i;continue}if(i<56320){(t-=3)>-1&&s.push(239,191,189),r=i;continue}i=(r-55296<<10|i-56320)+65536}else r&&(t-=3)>-1&&s.push(239,191,189);if(r=null,i<128){if((t-=1)<0)break;s.push(i)}else if(i<2048){if((t-=2)<0)break;s.push(i>>6|192,63&i|128)}else if(i<65536){if((t-=3)<0)break;s.push(i>>12|224,i>>6&63|128,63&i|128)}else if(i<1114112){if((t-=4)<0)break;s.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}else throw Error("Invalid code point")}return s}function G(e){for(var t=[],i=0;i<e.length;++i)t.push(255&e.charCodeAt(i));return t}function q(e,t){for(var i,n,r=[],s=0;s<e.length&&!((t-=2)<0);++s)n=(i=e.charCodeAt(s))>>8,r.push(i%256),r.push(n);return r}function Q(e){return n.toByteArray(W(e))}function Z(e,t,i,n){for(var r=0;r<n&&!(r+i>=t.length)&&!(r>=e.length);++r)t[r+i]=e[r];return r}function Y(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function J(e){return e!=e}},52159:function(e,t,i){"use strict";i.r(t),i.d(t,{BotInfo:function(){return l},BrowserInfo:function(){return s},NodeInfo:function(){return o},ReactNativeInfo:function(){return d},SearchBotDeviceInfo:function(){return a},browserName:function(){return g},detect:function(){return p},detectOS:function(){return b},getNodeVersion:function(){return S},parseUserAgent:function(){return v}});var n=i(25566),r=function(e,t,i){if(i||2==arguments.length)for(var n,r=0,s=t.length;r<s;r++)!n&&r in t||(n||(n=Array.prototype.slice.call(t,0,r)),n[r]=t[r]);return e.concat(n||Array.prototype.slice.call(t))},s=function(){return function(e,t,i){this.name=e,this.version=t,this.os=i,this.type="browser"}}(),o=function(){return function(e){this.version=e,this.type="node",this.name="node",this.os=n.platform}}(),a=function(){return function(e,t,i,n){this.name=e,this.version=t,this.os=i,this.bot=n,this.type="bot-device"}}(),l=function(){return function(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}}(),d=function(){return function(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}}(),u=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,c=3,h=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/]],f=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function p(e){return e?v(e):"undefined"==typeof document&&"undefined"!=typeof navigator&&"ReactNative"===navigator.product?new d:"undefined"!=typeof navigator?v(navigator.userAgent):S()}function m(e){return""!==e&&h.reduce(function(t,i){var n=i[0],r=i[1];if(t)return t;var s=r.exec(e);return!!s&&[n,s]},!1)}function g(e){var t=m(e);return t?t[0]:null}function v(e){var t=m(e);if(!t)return null;var i=t[0],n=t[1];if("searchbot"===i)return new l;var o=n[1]&&n[1].split(".").join("_").split("_").slice(0,3);o?o.length<c&&(o=r(r([],o,!0),y(c-o.length),!0)):o=[];var d=o.join("."),h=b(e),f=u.exec(e);return f&&f[1]?new a(i,d,h,f[1]):new s(i,d,h)}function b(e){for(var t=0,i=f.length;t<i;t++){var n=f[t],r=n[0];if(n[1].exec(e))return r}return null}function S(){return void 0!==n&&n.version?new o(n.version.slice(1)):null}function y(e){for(var t=[],i=0;i<e;i++)t.push("0");return t}},37836:function(e){"use strict";var t=Object.prototype.hasOwnProperty,i="~";function n(){}function r(e,t,i){this.fn=e,this.context=t,this.once=i||!1}function s(e,t,n,s,o){if("function"!=typeof n)throw TypeError("The listener must be a function");var a=new r(n,s||e,o),l=i?i+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],a]:e._events[l].push(a):(e._events[l]=a,e._eventsCount++),e}function o(e,t){0==--e._eventsCount?e._events=new n:delete e._events[t]}function a(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(i=!1)),a.prototype.eventNames=function(){var e,n,r=[];if(0===this._eventsCount)return r;for(n in e=this._events)t.call(e,n)&&r.push(i?n.slice(1):n);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(e)):r},a.prototype.listeners=function(e){var t=i?i+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var r=0,s=n.length,o=Array(s);r<s;r++)o[r]=n[r].fn;return o},a.prototype.listenerCount=function(e){var t=i?i+e:e,n=this._events[t];return n?n.fn?1:n.length:0},a.prototype.emit=function(e,t,n,r,s,o){var a=i?i+e:e;if(!this._events[a])return!1;var l,d,u=this._events[a],c=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),c){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,n),!0;case 4:return u.fn.call(u.context,t,n,r),!0;case 5:return u.fn.call(u.context,t,n,r,s),!0;case 6:return u.fn.call(u.context,t,n,r,s,o),!0}for(d=1,l=Array(c-1);d<c;d++)l[d-1]=arguments[d];u.fn.apply(u.context,l)}else{var h,f=u.length;for(d=0;d<f;d++)switch(u[d].once&&this.removeListener(e,u[d].fn,void 0,!0),c){case 1:u[d].fn.call(u[d].context);break;case 2:u[d].fn.call(u[d].context,t);break;case 3:u[d].fn.call(u[d].context,t,n);break;case 4:u[d].fn.call(u[d].context,t,n,r);break;default:if(!l)for(h=1,l=Array(c-1);h<c;h++)l[h-1]=arguments[h];u[d].fn.apply(u[d].context,l)}}return!0},a.prototype.on=function(e,t,i){return s(this,e,t,i,!1)},a.prototype.once=function(e,t,i){return s(this,e,t,i,!0)},a.prototype.removeListener=function(e,t,n,r){var s=i?i+e:e;if(!this._events[s])return this;if(!t)return o(this,s),this;var a=this._events[s];if(a.fn)a.fn!==t||r&&!a.once||n&&a.context!==n||o(this,s);else{for(var l=0,d=[],u=a.length;l<u;l++)(a[l].fn!==t||r&&!a[l].once||n&&a[l].context!==n)&&d.push(a[l]);d.length?this._events[s]=1===d.length?d[0]:d:o(this,s)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=i?i+e:e,this._events[t]&&o(this,t)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=i,a.EventEmitter=a,e.exports=a},6868:function(e,t){/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */t.read=function(e,t,i,n,r){var s,o,a=8*r-n-1,l=(1<<a)-1,d=l>>1,u=-7,c=i?r-1:0,h=i?-1:1,f=e[t+c];for(c+=h,s=f&(1<<-u)-1,f>>=-u,u+=a;u>0;s=256*s+e[t+c],c+=h,u-=8);for(o=s&(1<<-u)-1,s>>=-u,u+=n;u>0;o=256*o+e[t+c],c+=h,u-=8);if(0===s)s=1-d;else{if(s===l)return o?NaN:1/0*(f?-1:1);o+=Math.pow(2,n),s-=d}return(f?-1:1)*o*Math.pow(2,s-n)},t.write=function(e,t,i,n,r,s){var o,a,l,d=8*s-r-1,u=(1<<d)-1,c=u>>1,h=23===r?5960464477539062e-23:0,f=n?0:s-1,p=n?1:-1,m=t<0||0===t&&1/t<0?1:0;for(isNaN(t=Math.abs(t))||t===1/0?(a=isNaN(t)?1:0,o=u):(o=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-o))<1&&(o--,l*=2),o+c>=1?t+=h/l:t+=h*Math.pow(2,1-c),t*l>=2&&(o++,l/=2),o+c>=u?(a=0,o=u):o+c>=1?(a=(t*l-1)*Math.pow(2,r),o+=c):(a=t*Math.pow(2,c-1)*Math.pow(2,r),o=0));r>=8;e[i+f]=255&a,f+=p,a/=256,r-=8);for(o=o<<r|a,d+=r;d>0;e[i+f]=255&o,f+=p,o/=256,d-=8);e[i+f-p]|=128*m}},24580:function(e){"use strict";var t=Object.assign.bind(Object);e.exports=t,e.exports.default=e.exports},25090:function(e,t,i){"use strict";let{Deflate:n,deflate:r,deflateRaw:s,gzip:o}=i(47949),{Inflate:a,inflate:l,inflateRaw:d,ungzip:u}=i(5167),c=i(39946);e.exports.Deflate=n,e.exports.deflate=r,e.exports.deflateRaw=s,e.exports.gzip=o,e.exports.Inflate=a,e.exports.inflate=l,e.exports.inflateRaw=d,e.exports.ungzip=u,e.exports.constants=c},47949:function(e,t,i){"use strict";let n=i(72269),r=i(92402),s=i(66578),o=i(496),a=i(45274),l=Object.prototype.toString,{Z_NO_FLUSH:d,Z_SYNC_FLUSH:u,Z_FULL_FLUSH:c,Z_FINISH:h,Z_OK:f,Z_STREAM_END:p,Z_DEFAULT_COMPRESSION:m,Z_DEFAULT_STRATEGY:g,Z_DEFLATED:v}=i(39946);function b(e){this.options=r.assign({level:m,method:v,chunkSize:16384,windowBits:15,memLevel:8,strategy:g},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new a,this.strm.avail_out=0;let i=n.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(i!==f)throw Error(o[i]);if(t.header&&n.deflateSetHeader(this.strm,t.header),t.dictionary){let e;if(e="string"==typeof t.dictionary?s.string2buf(t.dictionary):"[object ArrayBuffer]"===l.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,(i=n.deflateSetDictionary(this.strm,e))!==f)throw Error(o[i]);this._dict_set=!0}}function S(e,t){let i=new b(t);if(i.push(e,!0),i.err)throw i.msg||o[i.err];return i.result}function y(e,t){return(t=t||{}).raw=!0,S(e,t)}function w(e,t){return(t=t||{}).gzip=!0,S(e,t)}b.prototype.push=function(e,t){let i,r;let o=this.strm,a=this.options.chunkSize;if(this.ended)return!1;for(r=t===~~t?t:!0===t?h:d,"string"==typeof e?o.input=s.string2buf(e):"[object ArrayBuffer]"===l.call(e)?o.input=new Uint8Array(e):o.input=e,o.next_in=0,o.avail_in=o.input.length;;){if(0===o.avail_out&&(o.output=new Uint8Array(a),o.next_out=0,o.avail_out=a),(r===u||r===c)&&o.avail_out<=6){this.onData(o.output.subarray(0,o.next_out)),o.avail_out=0;continue}if((i=n.deflate(o,r))===p)return o.next_out>0&&this.onData(o.output.subarray(0,o.next_out)),i=n.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===f;if(0===o.avail_out){this.onData(o.output);continue}if(r>0&&o.next_out>0){this.onData(o.output.subarray(0,o.next_out)),o.avail_out=0;continue}if(0===o.avail_in)break}return!0},b.prototype.onData=function(e){this.chunks.push(e)},b.prototype.onEnd=function(e){e===f&&(this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},e.exports.Deflate=b,e.exports.deflate=S,e.exports.deflateRaw=y,e.exports.gzip=w,e.exports.constants=i(39946)},5167:function(e,t,i){"use strict";let n=i(63400),r=i(92402),s=i(66578),o=i(496),a=i(45274),l=i(67891),d=Object.prototype.toString,{Z_NO_FLUSH:u,Z_FINISH:c,Z_OK:h,Z_STREAM_END:f,Z_NEED_DICT:p,Z_STREAM_ERROR:m,Z_DATA_ERROR:g,Z_MEM_ERROR:v}=i(39946);function b(e){this.options=r.assign({chunkSize:65536,windowBits:15,to:""},e||{});let t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(15&t.windowBits)==0&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new a,this.strm.avail_out=0;let i=n.inflateInit2(this.strm,t.windowBits);if(i!==h||(this.header=new l,n.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=s.string2buf(t.dictionary):"[object ArrayBuffer]"===d.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(i=n.inflateSetDictionary(this.strm,t.dictionary))!==h)))throw Error(o[i])}function S(e,t){let i=new b(t);if(i.push(e),i.err)throw i.msg||o[i.err];return i.result}function y(e,t){return(t=t||{}).raw=!0,S(e,t)}b.prototype.push=function(e,t){let i,r,o;let a=this.strm,l=this.options.chunkSize,b=this.options.dictionary;if(this.ended)return!1;for(r=t===~~t?t:!0===t?c:u,"[object ArrayBuffer]"===d.call(e)?a.input=new Uint8Array(e):a.input=e,a.next_in=0,a.avail_in=a.input.length;;){for(0===a.avail_out&&(a.output=new Uint8Array(l),a.next_out=0,a.avail_out=l),(i=n.inflate(a,r))===p&&b&&((i=n.inflateSetDictionary(a,b))===h?i=n.inflate(a,r):i===g&&(i=p));a.avail_in>0&&i===f&&a.state.wrap>0&&0!==e[a.next_in];)n.inflateReset(a),i=n.inflate(a,r);switch(i){case m:case g:case p:case v:return this.onEnd(i),this.ended=!0,!1}if(o=a.avail_out,a.next_out&&(0===a.avail_out||i===f)){if("string"===this.options.to){let e=s.utf8border(a.output,a.next_out),t=a.next_out-e,i=s.buf2string(a.output,e);a.next_out=t,a.avail_out=l-t,t&&a.output.set(a.output.subarray(e,e+t),0),this.onData(i)}else this.onData(a.output.length===a.next_out?a.output:a.output.subarray(0,a.next_out))}if(i!==h||0!==o){if(i===f)return i=n.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,!0;if(0===a.avail_in)break}}return!0},b.prototype.onData=function(e){this.chunks.push(e)},b.prototype.onEnd=function(e){e===h&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},e.exports.Inflate=b,e.exports.inflate=S,e.exports.inflateRaw=y,e.exports.ungzip=S,e.exports.constants=i(39946)},92402:function(e){"use strict";let t=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);e.exports.assign=function(e){let i=Array.prototype.slice.call(arguments,1);for(;i.length;){let n=i.shift();if(n){if("object"!=typeof n)throw TypeError(n+"must be non-object");for(let i in n)t(n,i)&&(e[i]=n[i])}}return e},e.exports.flattenChunks=e=>{let t=0;for(let i=0,n=e.length;i<n;i++)t+=e[i].length;let i=new Uint8Array(t);for(let t=0,n=0,r=e.length;t<r;t++){let r=e[t];i.set(r,n),n+=r.length}return i}},66578:function(e){"use strict";let t=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){t=!1}let i=new Uint8Array(256);for(let e=0;e<256;e++)i[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;i[254]=i[254]=1,e.exports.string2buf=e=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let t,i,n,r,s,o=e.length,a=0;for(r=0;r<o;r++)(64512&(i=e.charCodeAt(r)))==55296&&r+1<o&&(64512&(n=e.charCodeAt(r+1)))==56320&&(i=65536+(i-55296<<10)+(n-56320),r++),a+=i<128?1:i<2048?2:i<65536?3:4;for(s=0,t=new Uint8Array(a),r=0;s<a;r++)(64512&(i=e.charCodeAt(r)))==55296&&r+1<o&&(64512&(n=e.charCodeAt(r+1)))==56320&&(i=65536+(i-55296<<10)+(n-56320),r++),i<128?t[s++]=i:(i<2048?t[s++]=192|i>>>6:(i<65536?t[s++]=224|i>>>12:(t[s++]=240|i>>>18,t[s++]=128|i>>>12&63),t[s++]=128|i>>>6&63),t[s++]=128|63&i);return t};let n=(e,i)=>{if(i<65534&&e.subarray&&t)return String.fromCharCode.apply(null,e.length===i?e:e.subarray(0,i));let n="";for(let t=0;t<i;t++)n+=String.fromCharCode(e[t]);return n};e.exports.buf2string=(e,t)=>{let r,s;let o=t||e.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,t));let a=Array(2*o);for(s=0,r=0;r<o;){let t=e[r++];if(t<128){a[s++]=t;continue}let n=i[t];if(n>4){a[s++]=65533,r+=n-1;continue}for(t&=2===n?31:3===n?15:7;n>1&&r<o;)t=t<<6|63&e[r++],n--;if(n>1){a[s++]=65533;continue}t<65536?a[s++]=t:(t-=65536,a[s++]=55296|t>>10&1023,a[s++]=56320|1023&t)}return n(a,s)},e.exports.utf8border=(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let n=t-1;for(;n>=0&&(192&e[n])==128;)n--;return n<0||0===n?t:n+i[e[n]]>t?n:t}},43213:function(e){"use strict";let t=(e,t,i,n)=>{let r=65535&e|0,s=e>>>16&65535|0,o=0;for(;0!==i;){o=i>2e3?2e3:i,i-=o;do s=s+(r=r+t[n++]|0)|0;while(--o);r%=65521,s%=65521}return r|s<<16|0};e.exports=t},39946:function(e){"use strict";e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},15193:function(e){"use strict";let t=new Uint32Array((()=>{let e,t=[];for(var i=0;i<256;i++){e=i;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[i]=e}return t})()),i=(e,i,n,r)=>{let s=t,o=r+n;e^=-1;for(let t=r;t<o;t++)e=e>>>8^s[(e^i[t])&255];return -1^e};e.exports=i},72269:function(e,t,i){"use strict";let{_tr_init:n,_tr_stored_block:r,_tr_flush_block:s,_tr_tally:o,_tr_align:a}=i(78898),l=i(43213),d=i(15193),u=i(496),{Z_NO_FLUSH:c,Z_PARTIAL_FLUSH:h,Z_FULL_FLUSH:f,Z_FINISH:p,Z_BLOCK:m,Z_OK:g,Z_STREAM_END:v,Z_STREAM_ERROR:b,Z_DATA_ERROR:S,Z_BUF_ERROR:y,Z_DEFAULT_COMPRESSION:w,Z_FILTERED:C,Z_HUFFMAN_ONLY:_,Z_RLE:k,Z_FIXED:T,Z_DEFAULT_STRATEGY:P,Z_UNKNOWN:E,Z_DEFLATED:M}=i(39946),I=9,A=15,R=8,x=286,O=30,D=19,L=573,F=15,B=3,N=258,V=262,U=32,z=42,j=57,$=69,W=73,H=91,K=103,G=113,q=666,Q=1,Z=2,Y=3,J=4,X=3,ee=(e,t)=>(e.msg=u[t],t),et=e=>2*e-(e>4?9:0),ei=e=>{let t=e.length;for(;--t>=0;)e[t]=0},en=e=>{let t,i,n;let r=e.w_size;n=t=e.hash_size;do i=e.head[--n],e.head[n]=i>=r?i-r:0;while(--t);n=t=r;do i=e.prev[--n],e.prev[n]=i>=r?i-r:0;while(--t)},er=(e,t,i)=>(t<<e.hash_shift^i)&e.hash_mask,es=e=>{let t=e.state,i=t.pending;i>e.avail_out&&(i=e.avail_out),0!==i&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+i),e.next_out),e.next_out+=i,t.pending_out+=i,e.total_out+=i,e.avail_out-=i,t.pending-=i,0===t.pending&&(t.pending_out=0))},eo=(e,t)=>{s(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,es(e.strm)},ea=(e,t)=>{e.pending_buf[e.pending++]=t},el=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},ed=(e,t,i,n)=>{let r=e.avail_in;return(r>n&&(r=n),0===r)?0:(e.avail_in-=r,t.set(e.input.subarray(e.next_in,e.next_in+r),i),1===e.state.wrap?e.adler=l(e.adler,t,r,i):2===e.state.wrap&&(e.adler=d(e.adler,t,r,i)),e.next_in+=r,e.total_in+=r,r)},eu=(e,t)=>{let i,n,r=e.max_chain_length,s=e.strstart,o=e.prev_length,a=e.nice_match,l=e.strstart>e.w_size-V?e.strstart-(e.w_size-V):0,d=e.window,u=e.w_mask,c=e.prev,h=e.strstart+N,f=d[s+o-1],p=d[s+o];e.prev_length>=e.good_match&&(r>>=2),a>e.lookahead&&(a=e.lookahead);do{if(d[(i=t)+o]!==p||d[i+o-1]!==f||d[i]!==d[s]||d[++i]!==d[s+1])continue;s+=2,i++;do;while(d[++s]===d[++i]&&d[++s]===d[++i]&&d[++s]===d[++i]&&d[++s]===d[++i]&&d[++s]===d[++i]&&d[++s]===d[++i]&&d[++s]===d[++i]&&d[++s]===d[++i]&&s<h);if(n=N-(h-s),s=h-N,n>o){if(e.match_start=t,o=n,n>=a)break;f=d[s+o-1],p=d[s+o]}}while((t=c[t&u])>l&&0!=--r);return o<=e.lookahead?o:e.lookahead},ec=e=>{let t,i,n;let r=e.w_size;do{if(i=e.window_size-e.lookahead-e.strstart,e.strstart>=r+(r-V)&&(e.window.set(e.window.subarray(r,r+r-i),0),e.match_start-=r,e.strstart-=r,e.block_start-=r,e.insert>e.strstart&&(e.insert=e.strstart),en(e),i+=r),0===e.strm.avail_in)break;if(t=ed(e.strm,e.window,e.strstart+e.lookahead,i),e.lookahead+=t,e.lookahead+e.insert>=B)for(n=e.strstart-e.insert,e.ins_h=e.window[n],e.ins_h=er(e,e.ins_h,e.window[n+1]);e.insert&&(e.ins_h=er(e,e.ins_h,e.window[n+B-1]),e.prev[n&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=n,n++,e.insert--,!(e.lookahead+e.insert<B)););}while(e.lookahead<V&&0!==e.strm.avail_in)},eh=(e,t)=>{let i=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,n,s,o,a=0,l=e.strm.avail_in;do{if(n=65535,o=e.bi_valid+42>>3,e.strm.avail_out<o||(o=e.strm.avail_out-o,n>(s=e.strstart-e.block_start)+e.strm.avail_in&&(n=s+e.strm.avail_in),n>o&&(n=o),n<i&&(0===n&&t!==p||t===c||n!==s+e.strm.avail_in)))break;a=t===p&&n===s+e.strm.avail_in?1:0,r(e,0,0,a),e.pending_buf[e.pending-4]=n,e.pending_buf[e.pending-3]=n>>8,e.pending_buf[e.pending-2]=~n,e.pending_buf[e.pending-1]=~n>>8,es(e.strm),s&&(s>n&&(s=n),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+s),e.strm.next_out),e.strm.next_out+=s,e.strm.avail_out-=s,e.strm.total_out+=s,e.block_start+=s,n-=s),n&&(ed(e.strm,e.strm.output,e.strm.next_out,n),e.strm.next_out+=n,e.strm.avail_out-=n,e.strm.total_out+=n)}while(0===a);return((l-=e.strm.avail_in)&&(l>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=l&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-l,e.strm.next_in),e.strstart),e.strstart+=l,e.insert+=l>e.w_size-e.insert?e.w_size-e.insert:l),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),a)?J:t!==c&&t!==p&&0===e.strm.avail_in&&e.strstart===e.block_start?Z:(o=e.window_size-e.strstart,e.strm.avail_in>o&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,o+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),o>e.strm.avail_in&&(o=e.strm.avail_in),o&&(ed(e.strm,e.window,e.strstart,o),e.strstart+=o,e.insert+=o>e.w_size-e.insert?e.w_size-e.insert:o),e.high_water<e.strstart&&(e.high_water=e.strstart),o=e.bi_valid+42>>3,i=(o=e.pending_buf_size-o>65535?65535:e.pending_buf_size-o)>e.w_size?e.w_size:o,((s=e.strstart-e.block_start)>=i||(s||t===p)&&t!==c&&0===e.strm.avail_in&&s<=o)&&(n=s>o?o:s,a=t===p&&0===e.strm.avail_in&&n===s?1:0,r(e,e.block_start,n,a),e.block_start+=n,es(e.strm)),a?Y:Q)},ef=(e,t)=>{let i,n;for(;;){if(e.lookahead<V){if(ec(e),e.lookahead<V&&t===c)return Q;if(0===e.lookahead)break}if(i=0,e.lookahead>=B&&(e.ins_h=er(e,e.ins_h,e.window[e.strstart+B-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==i&&e.strstart-i<=e.w_size-V&&(e.match_length=eu(e,i)),e.match_length>=B){if(n=o(e,e.strstart-e.match_start,e.match_length-B),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=B){e.match_length--;do e.strstart++,e.ins_h=er(e,e.ins_h,e.window[e.strstart+B-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=er(e,e.ins_h,e.window[e.strstart+1])}else n=o(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(eo(e,!1),0===e.strm.avail_out))return Q}return(e.insert=e.strstart<B-1?e.strstart:B-1,t===p)?(eo(e,!0),0===e.strm.avail_out)?Y:J:e.sym_next&&(eo(e,!1),0===e.strm.avail_out)?Q:Z},ep=(e,t)=>{let i,n,r;for(;;){if(e.lookahead<V){if(ec(e),e.lookahead<V&&t===c)return Q;if(0===e.lookahead)break}if(i=0,e.lookahead>=B&&(e.ins_h=er(e,e.ins_h,e.window[e.strstart+B-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=B-1,0!==i&&e.prev_length<e.max_lazy_match&&e.strstart-i<=e.w_size-V&&(e.match_length=eu(e,i),e.match_length<=5&&(e.strategy===C||e.match_length===B&&e.strstart-e.match_start>4096)&&(e.match_length=B-1)),e.prev_length>=B&&e.match_length<=e.prev_length){r=e.strstart+e.lookahead-B,n=o(e,e.strstart-1-e.prev_match,e.prev_length-B),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=r&&(e.ins_h=er(e,e.ins_h,e.window[e.strstart+B-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(0!=--e.prev_length);if(e.match_available=0,e.match_length=B-1,e.strstart++,n&&(eo(e,!1),0===e.strm.avail_out))return Q}else if(e.match_available){if((n=o(e,0,e.window[e.strstart-1]))&&eo(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return Q}else e.match_available=1,e.strstart++,e.lookahead--}return(e.match_available&&(n=o(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<B-1?e.strstart:B-1,t===p)?(eo(e,!0),0===e.strm.avail_out)?Y:J:e.sym_next&&(eo(e,!1),0===e.strm.avail_out)?Q:Z},em=(e,t)=>{let i,n,r,s;let a=e.window;for(;;){if(e.lookahead<=N){if(ec(e),e.lookahead<=N&&t===c)return Q;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=B&&e.strstart>0&&(n=a[r=e.strstart-1])===a[++r]&&n===a[++r]&&n===a[++r]){s=e.strstart+N;do;while(n===a[++r]&&n===a[++r]&&n===a[++r]&&n===a[++r]&&n===a[++r]&&n===a[++r]&&n===a[++r]&&n===a[++r]&&r<s);e.match_length=N-(s-r),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=B?(i=o(e,1,e.match_length-B),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(i=o(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),i&&(eo(e,!1),0===e.strm.avail_out))return Q}return(e.insert=0,t===p)?(eo(e,!0),0===e.strm.avail_out)?Y:J:e.sym_next&&(eo(e,!1),0===e.strm.avail_out)?Q:Z},eg=(e,t)=>{let i;for(;;){if(0===e.lookahead&&(ec(e),0===e.lookahead)){if(t===c)return Q;break}if(e.match_length=0,i=o(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,i&&(eo(e,!1),0===e.strm.avail_out))return Q}return(e.insert=0,t===p)?(eo(e,!0),0===e.strm.avail_out)?Y:J:e.sym_next&&(eo(e,!1),0===e.strm.avail_out)?Q:Z};function ev(e,t,i,n,r){this.good_length=e,this.max_lazy=t,this.nice_length=i,this.max_chain=n,this.func=r}let eb=[new ev(0,0,0,0,eh),new ev(4,4,8,4,ef),new ev(4,5,16,8,ef),new ev(4,6,32,32,ef),new ev(4,4,16,16,ep),new ev(8,16,32,32,ep),new ev(8,16,128,128,ep),new ev(8,32,128,256,ep),new ev(32,128,258,1024,ep),new ev(32,258,258,4096,ep)],eS=e=>{e.window_size=2*e.w_size,ei(e.head),e.max_lazy_match=eb[e.level].max_lazy,e.good_match=eb[e.level].good_length,e.nice_match=eb[e.level].nice_length,e.max_chain_length=eb[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=B-1,e.match_available=0,e.ins_h=0};function ey(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=M,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(2*L),this.dyn_dtree=new Uint16Array((2*O+1)*2),this.bl_tree=new Uint16Array((2*D+1)*2),ei(this.dyn_ltree),ei(this.dyn_dtree),ei(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(F+1),this.heap=new Uint16Array(2*x+1),ei(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*x+1),ei(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}let ew=e=>{if(!e)return 1;let t=e.state;return t&&t.strm===e&&(t.status===z||t.status===j||t.status===$||t.status===W||t.status===H||t.status===K||t.status===G||t.status===q)?0:1},eC=e=>{if(ew(e))return ee(e,b);e.total_in=e.total_out=0,e.data_type=E;let t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=2===t.wrap?j:t.wrap?z:G,e.adler=2===t.wrap?0:1,t.last_flush=-2,n(t),g},e_=e=>{let t=eC(e);return t===g&&eS(e.state),t},ek=(e,t)=>ew(e)||2!==e.state.wrap?b:(e.state.gzhead=t,g),eT=(e,t,i,n,r,s)=>{if(!e)return b;let o=1;if(t===w&&(t=6),n<0?(o=0,n=-n):n>15&&(o=2,n-=16),r<1||r>I||i!==M||n<8||n>15||t<0||t>9||s<0||s>T||8===n&&1!==o)return ee(e,b);8===n&&(n=9);let a=new ey;return e.state=a,a.strm=e,a.status=z,a.wrap=o,a.gzhead=null,a.w_bits=n,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=r+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+B-1)/B),a.window=new Uint8Array(2*a.w_size),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<r+6,a.pending_buf_size=4*a.lit_bufsize,a.pending_buf=new Uint8Array(a.pending_buf_size),a.sym_buf=a.lit_bufsize,a.sym_end=(a.lit_bufsize-1)*3,a.level=t,a.strategy=s,a.method=i,e_(e)},eP=(e,t)=>eT(e,t,M,A,R,P),eE=(e,t)=>{if(ew(e)||t>m||t<0)return e?ee(e,b):b;let i=e.state;if(!e.output||0!==e.avail_in&&!e.input||i.status===q&&t!==p)return ee(e,0===e.avail_out?y:b);let n=i.last_flush;if(i.last_flush=t,0!==i.pending){if(es(e),0===e.avail_out)return i.last_flush=-1,g}else if(0===e.avail_in&&et(t)<=et(n)&&t!==p)return ee(e,y);if(i.status===q&&0!==e.avail_in)return ee(e,y);if(i.status===z&&0===i.wrap&&(i.status=G),i.status===z){let t=M+(i.w_bits-8<<4)<<8,n=-1;if(t|=(n=i.strategy>=_||i.level<2?0:i.level<6?1:6===i.level?2:3)<<6,0!==i.strstart&&(t|=U),el(i,t+=31-t%31),0!==i.strstart&&(el(i,e.adler>>>16),el(i,65535&e.adler)),e.adler=1,i.status=G,es(e),0!==i.pending)return i.last_flush=-1,g}if(i.status===j){if(e.adler=0,ea(i,31),ea(i,139),ea(i,8),i.gzhead)ea(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),ea(i,255&i.gzhead.time),ea(i,i.gzhead.time>>8&255),ea(i,i.gzhead.time>>16&255),ea(i,i.gzhead.time>>24&255),ea(i,9===i.level?2:i.strategy>=_||i.level<2?4:0),ea(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(ea(i,255&i.gzhead.extra.length),ea(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(e.adler=d(e.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=$;else if(ea(i,0),ea(i,0),ea(i,0),ea(i,0),ea(i,0),ea(i,9===i.level?2:i.strategy>=_||i.level<2?4:0),ea(i,X),i.status=G,es(e),0!==i.pending)return i.last_flush=-1,g}if(i.status===$){if(i.gzhead.extra){let t=i.pending,n=(65535&i.gzhead.extra.length)-i.gzindex;for(;i.pending+n>i.pending_buf_size;){let r=i.pending_buf_size-i.pending;if(i.pending_buf.set(i.gzhead.extra.subarray(i.gzindex,i.gzindex+r),i.pending),i.pending=i.pending_buf_size,i.gzhead.hcrc&&i.pending>t&&(e.adler=d(e.adler,i.pending_buf,i.pending-t,t)),i.gzindex+=r,es(e),0!==i.pending)return i.last_flush=-1,g;t=0,n-=r}let r=new Uint8Array(i.gzhead.extra);i.pending_buf.set(r.subarray(i.gzindex,i.gzindex+n),i.pending),i.pending+=n,i.gzhead.hcrc&&i.pending>t&&(e.adler=d(e.adler,i.pending_buf,i.pending-t,t)),i.gzindex=0}i.status=W}if(i.status===W){if(i.gzhead.name){let t,n=i.pending;do{if(i.pending===i.pending_buf_size){if(i.gzhead.hcrc&&i.pending>n&&(e.adler=d(e.adler,i.pending_buf,i.pending-n,n)),es(e),0!==i.pending)return i.last_flush=-1,g;n=0}t=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,ea(i,t)}while(0!==t);i.gzhead.hcrc&&i.pending>n&&(e.adler=d(e.adler,i.pending_buf,i.pending-n,n)),i.gzindex=0}i.status=H}if(i.status===H){if(i.gzhead.comment){let t,n=i.pending;do{if(i.pending===i.pending_buf_size){if(i.gzhead.hcrc&&i.pending>n&&(e.adler=d(e.adler,i.pending_buf,i.pending-n,n)),es(e),0!==i.pending)return i.last_flush=-1,g;n=0}t=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,ea(i,t)}while(0!==t);i.gzhead.hcrc&&i.pending>n&&(e.adler=d(e.adler,i.pending_buf,i.pending-n,n))}i.status=K}if(i.status===K){if(i.gzhead.hcrc){if(i.pending+2>i.pending_buf_size&&(es(e),0!==i.pending))return i.last_flush=-1,g;ea(i,255&e.adler),ea(i,e.adler>>8&255),e.adler=0}if(i.status=G,es(e),0!==i.pending)return i.last_flush=-1,g}if(0!==e.avail_in||0!==i.lookahead||t!==c&&i.status!==q){let n=0===i.level?eh(i,t):i.strategy===_?eg(i,t):i.strategy===k?em(i,t):eb[i.level].func(i,t);if((n===Y||n===J)&&(i.status=q),n===Q||n===Y)return 0===e.avail_out&&(i.last_flush=-1),g;if(n===Z&&(t===h?a(i):t!==m&&(r(i,0,0,!1),t===f&&(ei(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),es(e),0===e.avail_out))return i.last_flush=-1,g}return t!==p?g:i.wrap<=0?v:(2===i.wrap?(ea(i,255&e.adler),ea(i,e.adler>>8&255),ea(i,e.adler>>16&255),ea(i,e.adler>>24&255),ea(i,255&e.total_in),ea(i,e.total_in>>8&255),ea(i,e.total_in>>16&255),ea(i,e.total_in>>24&255)):(el(i,e.adler>>>16),el(i,65535&e.adler)),es(e),i.wrap>0&&(i.wrap=-i.wrap),0!==i.pending?g:v)},eM=e=>{if(ew(e))return b;let t=e.state.status;return e.state=null,t===G?ee(e,S):g},eI=(e,t)=>{let i=t.length;if(ew(e))return b;let n=e.state,r=n.wrap;if(2===r||1===r&&n.status!==z||n.lookahead)return b;if(1===r&&(e.adler=l(e.adler,t,i,0)),n.wrap=0,i>=n.w_size){0===r&&(ei(n.head),n.strstart=0,n.block_start=0,n.insert=0);let e=new Uint8Array(n.w_size);e.set(t.subarray(i-n.w_size,i),0),t=e,i=n.w_size}let s=e.avail_in,o=e.next_in,a=e.input;for(e.avail_in=i,e.next_in=0,e.input=t,ec(n);n.lookahead>=B;){let e=n.strstart,t=n.lookahead-(B-1);do n.ins_h=er(n,n.ins_h,n.window[e+B-1]),n.prev[e&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=e,e++;while(--t);n.strstart=e,n.lookahead=B-1,ec(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=B-1,n.match_available=0,e.next_in=o,e.input=a,e.avail_in=s,n.wrap=r,g};e.exports.deflateInit=eP,e.exports.deflateInit2=eT,e.exports.deflateReset=e_,e.exports.deflateResetKeep=eC,e.exports.deflateSetHeader=ek,e.exports.deflate=eE,e.exports.deflateEnd=eM,e.exports.deflateSetDictionary=eI,e.exports.deflateInfo="pako deflate (from Nodeca project)"},67891:function(e){"use strict";function t(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}e.exports=t},61974:function(e){"use strict";let t=16209,i=16191;e.exports=function(e,n){let r,s,o,a,l,d,u,c,h,f,p,m,g,v,b,S,y,w,C,_,k,T,P,E;let M=e.state;r=e.next_in,P=e.input,s=r+(e.avail_in-5),o=e.next_out,E=e.output,a=o-(n-e.avail_out),l=o+(e.avail_out-257),d=M.dmax,u=M.wsize,c=M.whave,h=M.wnext,f=M.window,p=M.hold,m=M.bits,g=M.lencode,v=M.distcode,b=(1<<M.lenbits)-1,S=(1<<M.distbits)-1;e:do for(m<15&&(p+=P[r++]<<m,m+=8,p+=P[r++]<<m,m+=8),y=g[p&b];;){if(p>>>=w=y>>>24,m-=w,0==(w=y>>>16&255))E[o++]=65535&y;else if(16&w)for(C=65535&y,(w&=15)&&(m<w&&(p+=P[r++]<<m,m+=8),C+=p&(1<<w)-1,p>>>=w,m-=w),m<15&&(p+=P[r++]<<m,m+=8,p+=P[r++]<<m,m+=8),y=v[p&S];;){if(p>>>=w=y>>>24,m-=w,16&(w=y>>>16&255)){if(_=65535&y,m<(w&=15)&&(p+=P[r++]<<m,(m+=8)<w&&(p+=P[r++]<<m,m+=8)),(_+=p&(1<<w)-1)>d){e.msg="invalid distance too far back",M.mode=t;break e}if(p>>>=w,m-=w,_>(w=o-a)){if((w=_-w)>c&&M.sane){e.msg="invalid distance too far back",M.mode=t;break e}if(k=0,T=f,0===h){if(k+=u-w,w<C){C-=w;do E[o++]=f[k++];while(--w);k=o-_,T=E}}else if(h<w){if(k+=u+h-w,(w-=h)<C){C-=w;do E[o++]=f[k++];while(--w);if(k=0,h<C){C-=w=h;do E[o++]=f[k++];while(--w);k=o-_,T=E}}}else if(k+=h-w,w<C){C-=w;do E[o++]=f[k++];while(--w);k=o-_,T=E}for(;C>2;)E[o++]=T[k++],E[o++]=T[k++],E[o++]=T[k++],C-=3;C&&(E[o++]=T[k++],C>1&&(E[o++]=T[k++]))}else{k=o-_;do E[o++]=E[k++],E[o++]=E[k++],E[o++]=E[k++],C-=3;while(C>2);C&&(E[o++]=E[k++],C>1&&(E[o++]=E[k++]))}}else if((64&w)==0){y=v[(65535&y)+(p&(1<<w)-1)];continue}else{e.msg="invalid distance code",M.mode=t;break e}break}else if((64&w)==0){y=g[(65535&y)+(p&(1<<w)-1)];continue}else if(32&w){M.mode=i;break e}else{e.msg="invalid literal/length code",M.mode=t;break e}break}while(r<s&&o<l);r-=C=m>>3,m-=C<<3,p&=(1<<m)-1,e.next_in=r,e.next_out=o,e.avail_in=r<s?5+(s-r):5-(r-s),e.avail_out=o<l?257+(l-o):257-(o-l),M.hold=p,M.bits=m}},63400:function(e,t,i){"use strict";let n,r;let s=i(43213),o=i(15193),a=i(61974),l=i(37121),d=0,u=1,c=2,{Z_FINISH:h,Z_BLOCK:f,Z_TREES:p,Z_OK:m,Z_STREAM_END:g,Z_NEED_DICT:v,Z_STREAM_ERROR:b,Z_DATA_ERROR:S,Z_MEM_ERROR:y,Z_BUF_ERROR:w,Z_DEFLATED:C}=i(39946),_=16180,k=16181,T=16182,P=16183,E=16184,M=16185,I=16186,A=16187,R=16188,x=16189,O=16190,D=16191,L=16192,F=16193,B=16194,N=16195,V=16196,U=16197,z=16198,j=16199,$=16200,W=16201,H=16202,K=16203,G=16204,q=16205,Q=16206,Z=16207,Y=16208,J=16209,X=16210,ee=16211,et=852,ei=592,en=15,er=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function es(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}let eo=e=>{if(!e)return 1;let t=e.state;return!t||t.strm!==e||t.mode<_||t.mode>ee?1:0},ea=e=>{if(eo(e))return b;let t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=_,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(et),t.distcode=t.distdyn=new Int32Array(ei),t.sane=1,t.back=-1,m},el=e=>{if(eo(e))return b;let t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,ea(e)},ed=(e,t)=>{let i;if(eo(e))return b;let n=e.state;return(t<0?(i=0,t=-t):(i=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15))?b:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=i,n.wbits=t,el(e))},eu=(e,t)=>{if(!e)return b;let i=new es;e.state=i,i.strm=e,i.window=null,i.mode=_;let n=ed(e,t);return n!==m&&(e.state=null),n},ec=e=>eu(e,en),eh=!0,ef=e=>{if(eh){n=new Int32Array(512),r=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(l(u,e.lens,0,288,n,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;l(c,e.lens,0,32,r,0,e.work,{bits:5}),eh=!1}e.lencode=n,e.lenbits=9,e.distcode=r,e.distbits=5},ep=(e,t,i,n)=>{let r;let s=e.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),n>=s.wsize?(s.window.set(t.subarray(i-s.wsize,i),0),s.wnext=0,s.whave=s.wsize):((r=s.wsize-s.wnext)>n&&(r=n),s.window.set(t.subarray(i-n,i-n+r),s.wnext),(n-=r)?(s.window.set(t.subarray(i-n,i),0),s.wnext=n,s.whave=s.wsize):(s.wnext+=r,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=r))),0},em=(e,t)=>{let i,n,r,ee,et,ei,en,es,ea,el,ed,eu,ec,eh,em,eg,ev,eb,eS,ey,ew,eC,e_,ek;let eT=0,eP=new Uint8Array(4),eE=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(eo(e)||!e.output||!e.input&&0!==e.avail_in)return b;(i=e.state).mode===D&&(i.mode=L),et=e.next_out,r=e.output,en=e.avail_out,ee=e.next_in,n=e.input,ei=e.avail_in,es=i.hold,ea=i.bits,el=ei,ed=en,eC=m;t:for(;;)switch(i.mode){case _:if(0===i.wrap){i.mode=L;break}for(;ea<16;){if(0===ei)break t;ei--,es+=n[ee++]<<ea,ea+=8}if(2&i.wrap&&35615===es){0===i.wbits&&(i.wbits=15),i.check=0,eP[0]=255&es,eP[1]=es>>>8&255,i.check=o(i.check,eP,2,0),es=0,ea=0,i.mode=k;break}if(i.head&&(i.head.done=!1),!(1&i.wrap)||(((255&es)<<8)+(es>>8))%31){e.msg="incorrect header check",i.mode=J;break}if((15&es)!==C){e.msg="unknown compression method",i.mode=J;break}if(es>>>=4,ea-=4,ew=(15&es)+8,0===i.wbits&&(i.wbits=ew),ew>15||ew>i.wbits){e.msg="invalid window size",i.mode=J;break}i.dmax=1<<i.wbits,i.flags=0,e.adler=i.check=1,i.mode=512&es?x:D,es=0,ea=0;break;case k:for(;ea<16;){if(0===ei)break t;ei--,es+=n[ee++]<<ea,ea+=8}if(i.flags=es,(255&i.flags)!==C){e.msg="unknown compression method",i.mode=J;break}if(57344&i.flags){e.msg="unknown header flags set",i.mode=J;break}i.head&&(i.head.text=es>>8&1),512&i.flags&&4&i.wrap&&(eP[0]=255&es,eP[1]=es>>>8&255,i.check=o(i.check,eP,2,0)),es=0,ea=0,i.mode=T;case T:for(;ea<32;){if(0===ei)break t;ei--,es+=n[ee++]<<ea,ea+=8}i.head&&(i.head.time=es),512&i.flags&&4&i.wrap&&(eP[0]=255&es,eP[1]=es>>>8&255,eP[2]=es>>>16&255,eP[3]=es>>>24&255,i.check=o(i.check,eP,4,0)),es=0,ea=0,i.mode=P;case P:for(;ea<16;){if(0===ei)break t;ei--,es+=n[ee++]<<ea,ea+=8}i.head&&(i.head.xflags=255&es,i.head.os=es>>8),512&i.flags&&4&i.wrap&&(eP[0]=255&es,eP[1]=es>>>8&255,i.check=o(i.check,eP,2,0)),es=0,ea=0,i.mode=E;case E:if(1024&i.flags){for(;ea<16;){if(0===ei)break t;ei--,es+=n[ee++]<<ea,ea+=8}i.length=es,i.head&&(i.head.extra_len=es),512&i.flags&&4&i.wrap&&(eP[0]=255&es,eP[1]=es>>>8&255,i.check=o(i.check,eP,2,0)),es=0,ea=0}else i.head&&(i.head.extra=null);i.mode=M;case M:if(1024&i.flags&&((eu=i.length)>ei&&(eu=ei),eu&&(i.head&&(ew=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Uint8Array(i.head.extra_len)),i.head.extra.set(n.subarray(ee,ee+eu),ew)),512&i.flags&&4&i.wrap&&(i.check=o(i.check,n,eu,ee)),ei-=eu,ee+=eu,i.length-=eu),i.length))break t;i.length=0,i.mode=I;case I:if(2048&i.flags){if(0===ei)break t;eu=0;do ew=n[ee+eu++],i.head&&ew&&i.length<65536&&(i.head.name+=String.fromCharCode(ew));while(ew&&eu<ei);if(512&i.flags&&4&i.wrap&&(i.check=o(i.check,n,eu,ee)),ei-=eu,ee+=eu,ew)break t}else i.head&&(i.head.name=null);i.length=0,i.mode=A;case A:if(4096&i.flags){if(0===ei)break t;eu=0;do ew=n[ee+eu++],i.head&&ew&&i.length<65536&&(i.head.comment+=String.fromCharCode(ew));while(ew&&eu<ei);if(512&i.flags&&4&i.wrap&&(i.check=o(i.check,n,eu,ee)),ei-=eu,ee+=eu,ew)break t}else i.head&&(i.head.comment=null);i.mode=R;case R:if(512&i.flags){for(;ea<16;){if(0===ei)break t;ei--,es+=n[ee++]<<ea,ea+=8}if(4&i.wrap&&es!==(65535&i.check)){e.msg="header crc mismatch",i.mode=J;break}es=0,ea=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),e.adler=i.check=0,i.mode=D;break;case x:for(;ea<32;){if(0===ei)break t;ei--,es+=n[ee++]<<ea,ea+=8}e.adler=i.check=er(es),es=0,ea=0,i.mode=O;case O:if(0===i.havedict)return e.next_out=et,e.avail_out=en,e.next_in=ee,e.avail_in=ei,i.hold=es,i.bits=ea,v;e.adler=i.check=1,i.mode=D;case D:if(t===f||t===p)break t;case L:if(i.last){es>>>=7&ea,ea-=7&ea,i.mode=Q;break}for(;ea<3;){if(0===ei)break t;ei--,es+=n[ee++]<<ea,ea+=8}switch(i.last=1&es,ea-=1,3&(es>>>=1)){case 0:i.mode=F;break;case 1:if(ef(i),i.mode=j,t===p){es>>>=2,ea-=2;break t}break;case 2:i.mode=V;break;case 3:e.msg="invalid block type",i.mode=J}es>>>=2,ea-=2;break;case F:for(es>>>=7&ea,ea-=7&ea;ea<32;){if(0===ei)break t;ei--,es+=n[ee++]<<ea,ea+=8}if((65535&es)!=(es>>>16^65535)){e.msg="invalid stored block lengths",i.mode=J;break}if(i.length=65535&es,es=0,ea=0,i.mode=B,t===p)break t;case B:i.mode=N;case N:if(eu=i.length){if(eu>ei&&(eu=ei),eu>en&&(eu=en),0===eu)break t;r.set(n.subarray(ee,ee+eu),et),ei-=eu,ee+=eu,en-=eu,et+=eu,i.length-=eu;break}i.mode=D;break;case V:for(;ea<14;){if(0===ei)break t;ei--,es+=n[ee++]<<ea,ea+=8}if(i.nlen=(31&es)+257,es>>>=5,ea-=5,i.ndist=(31&es)+1,es>>>=5,ea-=5,i.ncode=(15&es)+4,es>>>=4,ea-=4,i.nlen>286||i.ndist>30){e.msg="too many length or distance symbols",i.mode=J;break}i.have=0,i.mode=U;case U:for(;i.have<i.ncode;){for(;ea<3;){if(0===ei)break t;ei--,es+=n[ee++]<<ea,ea+=8}i.lens[eE[i.have++]]=7&es,es>>>=3,ea-=3}for(;i.have<19;)i.lens[eE[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,e_={bits:i.lenbits},eC=l(d,i.lens,0,19,i.lencode,0,i.work,e_),i.lenbits=e_.bits,eC){e.msg="invalid code lengths set",i.mode=J;break}i.have=0,i.mode=z;case z:for(;i.have<i.nlen+i.ndist;){for(;em=(eT=i.lencode[es&(1<<i.lenbits)-1])>>>24,eg=eT>>>16&255,ev=65535&eT,!(em<=ea);){if(0===ei)break t;ei--,es+=n[ee++]<<ea,ea+=8}if(ev<16)es>>>=em,ea-=em,i.lens[i.have++]=ev;else{if(16===ev){for(ek=em+2;ea<ek;){if(0===ei)break t;ei--,es+=n[ee++]<<ea,ea+=8}if(es>>>=em,ea-=em,0===i.have){e.msg="invalid bit length repeat",i.mode=J;break}ew=i.lens[i.have-1],eu=3+(3&es),es>>>=2,ea-=2}else if(17===ev){for(ek=em+3;ea<ek;){if(0===ei)break t;ei--,es+=n[ee++]<<ea,ea+=8}es>>>=em,ea-=em,ew=0,eu=3+(7&es),es>>>=3,ea-=3}else{for(ek=em+7;ea<ek;){if(0===ei)break t;ei--,es+=n[ee++]<<ea,ea+=8}es>>>=em,ea-=em,ew=0,eu=11+(127&es),es>>>=7,ea-=7}if(i.have+eu>i.nlen+i.ndist){e.msg="invalid bit length repeat",i.mode=J;break}for(;eu--;)i.lens[i.have++]=ew}}if(i.mode===J)break;if(0===i.lens[256]){e.msg="invalid code -- missing end-of-block",i.mode=J;break}if(i.lenbits=9,e_={bits:i.lenbits},eC=l(u,i.lens,0,i.nlen,i.lencode,0,i.work,e_),i.lenbits=e_.bits,eC){e.msg="invalid literal/lengths set",i.mode=J;break}if(i.distbits=6,i.distcode=i.distdyn,e_={bits:i.distbits},eC=l(c,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,e_),i.distbits=e_.bits,eC){e.msg="invalid distances set",i.mode=J;break}if(i.mode=j,t===p)break t;case j:i.mode=$;case $:if(ei>=6&&en>=258){e.next_out=et,e.avail_out=en,e.next_in=ee,e.avail_in=ei,i.hold=es,i.bits=ea,a(e,ed),et=e.next_out,r=e.output,en=e.avail_out,ee=e.next_in,n=e.input,ei=e.avail_in,es=i.hold,ea=i.bits,i.mode===D&&(i.back=-1);break}for(i.back=0;em=(eT=i.lencode[es&(1<<i.lenbits)-1])>>>24,eg=eT>>>16&255,ev=65535&eT,!(em<=ea);){if(0===ei)break t;ei--,es+=n[ee++]<<ea,ea+=8}if(eg&&(240&eg)==0){for(eb=em,eS=eg,ey=ev;em=(eT=i.lencode[ey+((es&(1<<eb+eS)-1)>>eb)])>>>24,eg=eT>>>16&255,ev=65535&eT,!(eb+em<=ea);){if(0===ei)break t;ei--,es+=n[ee++]<<ea,ea+=8}es>>>=eb,ea-=eb,i.back+=eb}if(es>>>=em,ea-=em,i.back+=em,i.length=ev,0===eg){i.mode=q;break}if(32&eg){i.back=-1,i.mode=D;break}if(64&eg){e.msg="invalid literal/length code",i.mode=J;break}i.extra=15&eg,i.mode=W;case W:if(i.extra){for(ek=i.extra;ea<ek;){if(0===ei)break t;ei--,es+=n[ee++]<<ea,ea+=8}i.length+=es&(1<<i.extra)-1,es>>>=i.extra,ea-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=H;case H:for(;em=(eT=i.distcode[es&(1<<i.distbits)-1])>>>24,eg=eT>>>16&255,ev=65535&eT,!(em<=ea);){if(0===ei)break t;ei--,es+=n[ee++]<<ea,ea+=8}if((240&eg)==0){for(eb=em,eS=eg,ey=ev;em=(eT=i.distcode[ey+((es&(1<<eb+eS)-1)>>eb)])>>>24,eg=eT>>>16&255,ev=65535&eT,!(eb+em<=ea);){if(0===ei)break t;ei--,es+=n[ee++]<<ea,ea+=8}es>>>=eb,ea-=eb,i.back+=eb}if(es>>>=em,ea-=em,i.back+=em,64&eg){e.msg="invalid distance code",i.mode=J;break}i.offset=ev,i.extra=15&eg,i.mode=K;case K:if(i.extra){for(ek=i.extra;ea<ek;){if(0===ei)break t;ei--,es+=n[ee++]<<ea,ea+=8}i.offset+=es&(1<<i.extra)-1,es>>>=i.extra,ea-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){e.msg="invalid distance too far back",i.mode=J;break}i.mode=G;case G:if(0===en)break t;if(eu=ed-en,i.offset>eu){if((eu=i.offset-eu)>i.whave&&i.sane){e.msg="invalid distance too far back",i.mode=J;break}eu>i.wnext?(eu-=i.wnext,ec=i.wsize-eu):ec=i.wnext-eu,eu>i.length&&(eu=i.length),eh=i.window}else eh=r,ec=et-i.offset,eu=i.length;eu>en&&(eu=en),en-=eu,i.length-=eu;do r[et++]=eh[ec++];while(--eu);0===i.length&&(i.mode=$);break;case q:if(0===en)break t;r[et++]=i.length,en--,i.mode=$;break;case Q:if(i.wrap){for(;ea<32;){if(0===ei)break t;ei--,es|=n[ee++]<<ea,ea+=8}if(ed-=en,e.total_out+=ed,i.total+=ed,4&i.wrap&&ed&&(e.adler=i.check=i.flags?o(i.check,r,ed,et-ed):s(i.check,r,ed,et-ed)),ed=en,4&i.wrap&&(i.flags?es:er(es))!==i.check){e.msg="incorrect data check",i.mode=J;break}es=0,ea=0}i.mode=Z;case Z:if(i.wrap&&i.flags){for(;ea<32;){if(0===ei)break t;ei--,es+=n[ee++]<<ea,ea+=8}if(4&i.wrap&&es!==(4294967295&i.total)){e.msg="incorrect length check",i.mode=J;break}es=0,ea=0}i.mode=Y;case Y:eC=g;break t;case J:eC=S;break t;case X:return y;default:return b}return(e.next_out=et,e.avail_out=en,e.next_in=ee,e.avail_in=ei,i.hold=es,i.bits=ea,(i.wsize||ed!==e.avail_out&&i.mode<J&&(i.mode<Q||t!==h))&&ep(e,e.output,e.next_out,ed-e.avail_out))?(i.mode=X,y):(el-=e.avail_in,ed-=e.avail_out,e.total_in+=el,e.total_out+=ed,i.total+=ed,4&i.wrap&&ed&&(e.adler=i.check=i.flags?o(i.check,r,ed,e.next_out-ed):s(i.check,r,ed,e.next_out-ed)),e.data_type=i.bits+(i.last?64:0)+(i.mode===D?128:0)+(i.mode===j||i.mode===B?256:0),(0===el&&0===ed||t===h)&&eC===m&&(eC=w),eC)},eg=e=>{if(eo(e))return b;let t=e.state;return t.window&&(t.window=null),e.state=null,m},ev=(e,t)=>{if(eo(e))return b;let i=e.state;return(2&i.wrap)==0?b:(i.head=t,t.done=!1,m)},eb=(e,t)=>{let i,n;let r=t.length;return eo(e)||0!==(i=e.state).wrap&&i.mode!==O?b:i.mode===O&&(n=s(n=1,t,r,0))!==i.check?S:ep(e,t,r,r)?(i.mode=X,y):(i.havedict=1,m)};e.exports.inflateReset=el,e.exports.inflateReset2=ed,e.exports.inflateResetKeep=ea,e.exports.inflateInit=ec,e.exports.inflateInit2=eu,e.exports.inflate=em,e.exports.inflateEnd=eg,e.exports.inflateGetHeader=ev,e.exports.inflateSetDictionary=eb,e.exports.inflateInfo="pako inflate (from Nodeca project)"},37121:function(e){"use strict";let t=15,i=852,n=592,r=0,s=1,o=2,a=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),l=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),d=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),u=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),c=(e,c,h,f,p,m,g,v)=>{let b,S,y,w,C,_,k,T,P;let E=v.bits,M=0,I=0,A=0,R=0,x=0,O=0,D=0,L=0,F=0,B=0,N=null,V=new Uint16Array(t+1),U=new Uint16Array(t+1),z=null;for(M=0;M<=t;M++)V[M]=0;for(I=0;I<f;I++)V[c[h+I]]++;for(x=E,R=t;R>=1&&0===V[R];R--);if(x>R&&(x=R),0===R)return p[m++]=20971520,p[m++]=20971520,v.bits=1,0;for(A=1;A<R&&0===V[A];A++);for(x<A&&(x=A),L=1,M=1;M<=t;M++)if(L<<=1,(L-=V[M])<0)return -1;if(L>0&&(e===r||1!==R))return -1;for(M=1,U[1]=0;M<t;M++)U[M+1]=U[M]+V[M];for(I=0;I<f;I++)0!==c[h+I]&&(g[U[c[h+I]]++]=I);if(e===r?(N=z=g,_=20):e===s?(N=a,z=l,_=257):(N=d,z=u,_=0),B=0,I=0,M=A,C=m,O=x,D=0,y=-1,w=(F=1<<x)-1,e===s&&F>i||e===o&&F>n)return 1;for(;;){k=M-D,g[I]+1<_?(T=0,P=g[I]):g[I]>=_?(T=z[g[I]-_],P=N[g[I]-_]):(T=96,P=0),b=1<<M-D,A=S=1<<O;do p[C+(B>>D)+(S-=b)]=k<<24|T<<16|P|0;while(0!==S);for(b=1<<M-1;B&b;)b>>=1;if(0!==b?(B&=b-1,B+=b):B=0,I++,0==--V[M]){if(M===R)break;M=c[h+g[I]]}if(M>x&&(B&w)!==y){for(0===D&&(D=x),C+=A,L=1<<(O=M-D);O+D<R&&!((L-=V[O+D])<=0);)O++,L<<=1;if(F+=1<<O,e===s&&F>i||e===o&&F>n)return 1;p[y=B&w]=x<<24|O<<16|C-m|0}}return 0!==B&&(p[C+B]=M-D<<24|4194304),v.bits=x,0};e.exports=c},496:function(e){"use strict";e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},78898:function(e){"use strict";let t,i,n;let r=4,s=0,o=1,a=2;function l(e){let t=e.length;for(;--t>=0;)e[t]=0}let d=0,u=1,c=2,h=3,f=258,p=29,m=256,g=286,v=30,b=19,S=573,y=15,w=16,C=7,_=256,k=16,T=17,P=18,E=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),M=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),I=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),A=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),R=512,x=Array((g+2)*2);l(x);let O=Array(2*v);l(O);let D=Array(R);l(D);let L=Array(f-h+1);l(L);let F=Array(p);l(F);let B=Array(v);function N(e,t,i,n,r){this.static_tree=e,this.extra_bits=t,this.extra_base=i,this.elems=n,this.max_length=r,this.has_stree=e&&e.length}function V(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}l(B);let U=e=>e<256?D[e]:D[256+(e>>>7)],z=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},j=(e,t,i)=>{e.bi_valid>w-i?(e.bi_buf|=t<<e.bi_valid&65535,z(e,e.bi_buf),e.bi_buf=t>>w-e.bi_valid,e.bi_valid+=i-w):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=i)},$=(e,t,i)=>{j(e,i[2*t],i[2*t+1])},W=(e,t)=>{let i=0;do i|=1&e,e>>>=1,i<<=1;while(--t>0);return i>>>1},H=e=>{16===e.bi_valid?(z(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)},K=(e,t)=>{let i,n,r,s,o,a;let l=t.dyn_tree,d=t.max_code,u=t.stat_desc.static_tree,c=t.stat_desc.has_stree,h=t.stat_desc.extra_bits,f=t.stat_desc.extra_base,p=t.stat_desc.max_length,m=0;for(s=0;s<=y;s++)e.bl_count[s]=0;for(l[2*e.heap[e.heap_max]+1]=0,i=e.heap_max+1;i<S;i++)(s=l[2*l[2*(n=e.heap[i])+1]+1]+1)>p&&(s=p,m++),l[2*n+1]=s,!(n>d)&&(e.bl_count[s]++,o=0,n>=f&&(o=h[n-f]),a=l[2*n],e.opt_len+=a*(s+o),c&&(e.static_len+=a*(u[2*n+1]+o)));if(0!==m){do{for(s=p-1;0===e.bl_count[s];)s--;e.bl_count[s]--,e.bl_count[s+1]+=2,e.bl_count[p]--,m-=2}while(m>0);for(s=p;0!==s;s--)for(n=e.bl_count[s];0!==n;)!((r=e.heap[--i])>d)&&(l[2*r+1]!==s&&(e.opt_len+=(s-l[2*r+1])*l[2*r],l[2*r+1]=s),n--)}},G=(e,t,i)=>{let n,r;let s=Array(y+1),o=0;for(n=1;n<=y;n++)o=o+i[n-1]<<1,s[n]=o;for(r=0;r<=t;r++){let t=e[2*r+1];0!==t&&(e[2*r]=W(s[t]++,t))}},q=()=>{let e,r,s,o,a;let l=Array(y+1);for(o=0,s=0;o<p-1;o++)for(e=0,F[o]=s;e<1<<E[o];e++)L[s++]=o;for(L[s-1]=o,a=0,o=0;o<16;o++)for(e=0,B[o]=a;e<1<<M[o];e++)D[a++]=o;for(a>>=7;o<v;o++)for(e=0,B[o]=a<<7;e<1<<M[o]-7;e++)D[256+a++]=o;for(r=0;r<=y;r++)l[r]=0;for(e=0;e<=143;)x[2*e+1]=8,e++,l[8]++;for(;e<=255;)x[2*e+1]=9,e++,l[9]++;for(;e<=279;)x[2*e+1]=7,e++,l[7]++;for(;e<=287;)x[2*e+1]=8,e++,l[8]++;for(G(x,g+1,l),e=0;e<v;e++)O[2*e+1]=5,O[2*e]=W(e,5);t=new N(x,E,m+1,g,y),i=new N(O,M,0,v,y),n=new N([],I,0,b,C)},Q=e=>{let t;for(t=0;t<g;t++)e.dyn_ltree[2*t]=0;for(t=0;t<v;t++)e.dyn_dtree[2*t]=0;for(t=0;t<b;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*_]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},Z=e=>{e.bi_valid>8?z(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},Y=(e,t,i,n)=>{let r=2*t,s=2*i;return e[r]<e[s]||e[r]===e[s]&&n[t]<=n[i]},J=(e,t,i)=>{let n=e.heap[i],r=i<<1;for(;r<=e.heap_len&&(r<e.heap_len&&Y(t,e.heap[r+1],e.heap[r],e.depth)&&r++,!Y(t,n,e.heap[r],e.depth));)e.heap[i]=e.heap[r],i=r,r<<=1;e.heap[i]=n},X=(e,t,i)=>{let n,r,s,o;let a=0;if(0!==e.sym_next)do n=(255&e.pending_buf[e.sym_buf+a++])+((255&e.pending_buf[e.sym_buf+a++])<<8),r=e.pending_buf[e.sym_buf+a++],0===n?$(e,r,t):($(e,(s=L[r])+m+1,t),0!==(o=E[s])&&j(e,r-=F[s],o),$(e,s=U(--n),i),0!==(o=M[s])&&j(e,n-=B[s],o));while(a<e.sym_next);$(e,_,t)},ee=(e,t)=>{let i,n,r;let s=t.dyn_tree,o=t.stat_desc.static_tree,a=t.stat_desc.has_stree,l=t.stat_desc.elems,d=-1;for(i=0,e.heap_len=0,e.heap_max=S;i<l;i++)0!==s[2*i]?(e.heap[++e.heap_len]=d=i,e.depth[i]=0):s[2*i+1]=0;for(;e.heap_len<2;)s[2*(r=e.heap[++e.heap_len]=d<2?++d:0)]=1,e.depth[r]=0,e.opt_len--,a&&(e.static_len-=o[2*r+1]);for(t.max_code=d,i=e.heap_len>>1;i>=1;i--)J(e,s,i);r=l;do i=e.heap[1],e.heap[1]=e.heap[e.heap_len--],J(e,s,1),n=e.heap[1],e.heap[--e.heap_max]=i,e.heap[--e.heap_max]=n,s[2*r]=s[2*i]+s[2*n],e.depth[r]=(e.depth[i]>=e.depth[n]?e.depth[i]:e.depth[n])+1,s[2*i+1]=s[2*n+1]=r,e.heap[1]=r++,J(e,s,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],K(e,t),G(s,d,e.bl_count)},et=(e,t,i)=>{let n,r;let s=-1,o=t[1],a=0,l=7,d=4;for(0===o&&(l=138,d=3),t[(i+1)*2+1]=65535,n=0;n<=i;n++)r=o,o=t[(n+1)*2+1],++a<l&&r===o||(a<d?e.bl_tree[2*r]+=a:0!==r?(r!==s&&e.bl_tree[2*r]++,e.bl_tree[2*k]++):a<=10?e.bl_tree[2*T]++:e.bl_tree[2*P]++,a=0,s=r,0===o?(l=138,d=3):r===o?(l=6,d=3):(l=7,d=4))},ei=(e,t,i)=>{let n,r;let s=-1,o=t[1],a=0,l=7,d=4;for(0===o&&(l=138,d=3),n=0;n<=i;n++)if(r=o,o=t[(n+1)*2+1],!(++a<l)||r!==o){if(a<d)do $(e,r,e.bl_tree);while(0!=--a);else 0!==r?(r!==s&&($(e,r,e.bl_tree),a--),$(e,k,e.bl_tree),j(e,a-3,2)):a<=10?($(e,T,e.bl_tree),j(e,a-3,3)):($(e,P,e.bl_tree),j(e,a-11,7));a=0,s=r,0===o?(l=138,d=3):r===o?(l=6,d=3):(l=7,d=4)}},en=e=>{let t;for(et(e,e.dyn_ltree,e.l_desc.max_code),et(e,e.dyn_dtree,e.d_desc.max_code),ee(e,e.bl_desc),t=b-1;t>=3&&0===e.bl_tree[2*A[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t},er=(e,t,i,n)=>{let r;for(j(e,t-257,5),j(e,i-1,5),j(e,n-4,4),r=0;r<n;r++)j(e,e.bl_tree[2*A[r]+1],3);ei(e,e.dyn_ltree,t-1),ei(e,e.dyn_dtree,i-1)},es=e=>{let t,i=4093624447;for(t=0;t<=31;t++,i>>>=1)if(1&i&&0!==e.dyn_ltree[2*t])return s;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return o;for(t=32;t<m;t++)if(0!==e.dyn_ltree[2*t])return o;return s},eo=!1,ea=e=>{eo||(q(),eo=!0),e.l_desc=new V(e.dyn_ltree,t),e.d_desc=new V(e.dyn_dtree,i),e.bl_desc=new V(e.bl_tree,n),e.bi_buf=0,e.bi_valid=0,Q(e)},el=(e,t,i,n)=>{j(e,(d<<1)+(n?1:0),3),Z(e),z(e,i),z(e,~i),i&&e.pending_buf.set(e.window.subarray(t,t+i),e.pending),e.pending+=i},ed=e=>{j(e,u<<1,3),$(e,_,x),H(e)},eu=(e,t,i,n)=>{let s,o;let l=0;e.level>0?(e.strm.data_type===a&&(e.strm.data_type=es(e)),ee(e,e.l_desc),ee(e,e.d_desc),l=en(e),s=e.opt_len+3+7>>>3,(o=e.static_len+3+7>>>3)<=s&&(s=o)):s=o=i+5,i+4<=s&&-1!==t?el(e,t,i,n):e.strategy===r||o===s?(j(e,(u<<1)+(n?1:0),3),X(e,x,O)):(j(e,(c<<1)+(n?1:0),3),er(e,e.l_desc.max_code+1,e.d_desc.max_code+1,l+1),X(e,e.dyn_ltree,e.dyn_dtree)),Q(e),n&&Z(e)},ec=(e,t,i)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=i,0===t?e.dyn_ltree[2*i]++:(e.matches++,t--,e.dyn_ltree[(L[i]+m+1)*2]++,e.dyn_dtree[2*U(t)]++),e.sym_next===e.sym_end);e.exports._tr_init=ea,e.exports._tr_stored_block=el,e.exports._tr_flush_block=eu,e.exports._tr_tally=ec,e.exports._tr_align=ed},45274:function(e){"use strict";function t(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}e.exports=t},57233:function(e,t,i){"use strict";e.exports=i(57673)},57673:function(e,t,i){"use strict";var n=t;function r(){n.util._configure(),n.Writer._configure(n.BufferWriter),n.Reader._configure(n.BufferReader)}n.build="minimal",n.Writer=i(27269),n.BufferWriter=i(51394),n.Reader=i(89991),n.BufferReader=i(57251),n.util=i(57917),n.rpc=i(57082),n.roots=i(10108),n.configure=r,r()},89991:function(e,t,i){"use strict";e.exports=l;var n,r=i(57917),s=r.LongBits,o=r.utf8;function a(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function l(e){this.buf=e,this.pos=0,this.len=e.length}var d="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new l(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new l(e);throw Error("illegal buffer")},u=function(){return r.Buffer?function(e){return(l.create=function(e){return r.Buffer.isBuffer(e)?new n(e):d(e)})(e)}:d};function c(){var e=new s(0,0),t=0;if(this.len-this.pos>4){for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;t=0}else{for(;t<3;++t){if(this.pos>=this.len)throw a(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}if(this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw a(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function h(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function f(){if(this.pos+8>this.len)throw a(this,8);return new s(h(this.buf,this.pos+=4),h(this.buf,this.pos+=4))}l.create=u(),l.prototype._slice=r.Array.prototype.subarray||r.Array.prototype.slice,l.prototype.uint32=function(){var e=4294967295;return function(){if(e=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128||(e=(e|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,a(this,10);return e}}(),l.prototype.int32=function(){return 0|this.uint32()},l.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},l.prototype.bool=function(){return 0!==this.uint32()},l.prototype.fixed32=function(){if(this.pos+4>this.len)throw a(this,4);return h(this.buf,this.pos+=4)},l.prototype.sfixed32=function(){if(this.pos+4>this.len)throw a(this,4);return 0|h(this.buf,this.pos+=4)},l.prototype.float=function(){if(this.pos+4>this.len)throw a(this,4);var e=r.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},l.prototype.double=function(){if(this.pos+8>this.len)throw a(this,4);var e=r.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},l.prototype.bytes=function(){var e=this.uint32(),t=this.pos,i=this.pos+e;if(i>this.len)throw a(this,e);if(this.pos+=e,Array.isArray(this.buf))return this.buf.slice(t,i);if(t===i){var n=r.Buffer;return n?n.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,t,i)},l.prototype.string=function(){var e=this.bytes();return o.read(e,0,e.length)},l.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw a(this,e);this.pos+=e}else do if(this.pos>=this.len)throw a(this);while(128&this.buf[this.pos++]);return this},l.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},l._configure=function(e){n=e,l.create=u(),n._configure();var t=r.Long?"toLong":"toNumber";r.merge(l.prototype,{int64:function(){return c.call(this)[t](!1)},uint64:function(){return c.call(this)[t](!0)},sint64:function(){return c.call(this).zzDecode()[t](!1)},fixed64:function(){return f.call(this)[t](!0)},sfixed64:function(){return f.call(this)[t](!1)}})}},57251:function(e,t,i){"use strict";e.exports=s;var n=i(89991);(s.prototype=Object.create(n.prototype)).constructor=s;var r=i(57917);function s(e){n.call(this,e)}s._configure=function(){r.Buffer&&(s.prototype._slice=r.Buffer.prototype.slice)},s.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},s._configure()},10108:function(e){"use strict";e.exports={}},57082:function(e,t,i){"use strict";t.Service=i(35820)},35820:function(e,t,i){"use strict";e.exports=r;var n=i(57917);function r(e,t,i){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");n.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=!!t,this.responseDelimited=!!i}(r.prototype=Object.create(n.EventEmitter.prototype)).constructor=r,r.prototype.rpcCall=function e(t,i,r,s,o){if(!s)throw TypeError("request must be specified");var a=this;if(!o)return n.asPromise(e,a,t,i,r,s);if(!a.rpcImpl){setTimeout(function(){o(Error("already ended"))},0);return}try{return a.rpcImpl(t,i[a.requestDelimited?"encodeDelimited":"encode"](s).finish(),function(e,i){if(e)return a.emit("error",e,t),o(e);if(null===i){a.end(!0);return}if(!(i instanceof r))try{i=r[a.responseDelimited?"decodeDelimited":"decode"](i)}catch(e){return a.emit("error",e,t),o(e)}return a.emit("data",i,t),o(null,i)})}catch(e){a.emit("error",e,t),setTimeout(function(){o(e)},0);return}},r.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},65229:function(e,t,i){"use strict";e.exports=r;var n=i(57917);function r(e,t){this.lo=e>>>0,this.hi=t>>>0}var s=r.zero=new r(0,0);s.toNumber=function(){return 0},s.zzEncode=s.zzDecode=function(){return this},s.length=function(){return 1};var o=r.zeroHash="\0\0\0\0\0\0\0\0";r.fromNumber=function(e){if(0===e)return s;var t=e<0;t&&(e=-e);var i=e>>>0,n=(e-i)/4294967296>>>0;return t&&(n=~n>>>0,i=~i>>>0,++i>4294967295&&(i=0,++n>4294967295&&(n=0))),new r(i,n)},r.from=function(e){if("number"==typeof e)return r.fromNumber(e);if(n.isString(e)){if(!n.Long)return r.fromNumber(parseInt(e,10));e=n.Long.fromString(e)}return e.low||e.high?new r(e.low>>>0,e.high>>>0):s},r.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=~this.lo+1>>>0,i=~this.hi>>>0;return t||(i=i+1>>>0),-(t+4294967296*i)}return this.lo+4294967296*this.hi},r.prototype.toLong=function(e){return n.Long?new n.Long(0|this.lo,0|this.hi,!!e):{low:0|this.lo,high:0|this.hi,unsigned:!!e}};var a=String.prototype.charCodeAt;r.fromHash=function(e){return e===o?s:new r((a.call(e,0)|a.call(e,1)<<8|a.call(e,2)<<16|a.call(e,3)<<24)>>>0,(a.call(e,4)|a.call(e,5)<<8|a.call(e,6)<<16|a.call(e,7)<<24)>>>0)},r.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},r.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},r.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},r.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,i=this.hi>>>24;return 0===i?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:i<128?9:10}},57917:function(e,t,i){"use strict";var n=t;function r(e,t,i){for(var n=Object.keys(t),r=0;r<n.length;++r)void 0!==e[n[r]]&&i||(e[n[r]]=t[n[r]]);return e}function s(e){function t(e,i){if(!(this instanceof t))return new t(e,i);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:Error().stack||""}),i&&r(this,i)}return t.prototype=Object.create(Error.prototype,{constructor:{value:t,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return e},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),t}n.asPromise=i(69059),n.base64=i(95920),n.EventEmitter=i(95986),n.float=i(46958),n.inquire=i(37079),n.utf8=i(30783),n.pool=i(77587),n.LongBits=i(65229),n.isNode=!!(void 0!==i.g&&i.g&&i.g.process&&i.g.process.versions&&i.g.process.versions.node),n.global=n.isNode&&i.g||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||this,n.emptyArray=Object.freeze?Object.freeze([]):[],n.emptyObject=Object.freeze?Object.freeze({}):{},n.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},n.isString=function(e){return"string"==typeof e||e instanceof String},n.isObject=function(e){return e&&"object"==typeof e},n.isset=n.isSet=function(e,t){var i=e[t];return!!(null!=i&&e.hasOwnProperty(t))&&("object"!=typeof i||(Array.isArray(i)?i.length:Object.keys(i).length)>0)},n.Buffer=function(){try{var e=n.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),n._Buffer_from=null,n._Buffer_allocUnsafe=null,n.newBuffer=function(e){return"number"==typeof e?n.Buffer?n._Buffer_allocUnsafe(e):new n.Array(e):n.Buffer?n._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},n.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,n.Long=n.global.dcodeIO&&n.global.dcodeIO.Long||n.global.Long||n.inquire("long"),n.key2Re=/^true|false|0|1$/,n.key32Re=/^-?(?:0|[1-9][0-9]*)$/,n.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,n.longToHash=function(e){return e?n.LongBits.from(e).toHash():n.LongBits.zeroHash},n.longFromHash=function(e,t){var i=n.LongBits.fromHash(e);return n.Long?n.Long.fromBits(i.lo,i.hi,t):i.toNumber(!!t)},n.merge=r,n.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},n.newError=s,n.ProtocolError=s("ProtocolError"),n.oneOfGetter=function(e){for(var t={},i=0;i<e.length;++i)t[e[i]]=1;return function(){for(var e=Object.keys(this),i=e.length-1;i>-1;--i)if(1===t[e[i]]&&void 0!==this[e[i]]&&null!==this[e[i]])return e[i]}},n.oneOfSetter=function(e){return function(t){for(var i=0;i<e.length;++i)e[i]!==t&&delete this[e[i]]}},n.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},n._configure=function(){var e=n.Buffer;if(!e){n._Buffer_from=n._Buffer_allocUnsafe=null;return}n._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,i){return new e(t,i)},n._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}}},27269:function(e,t,i){"use strict";e.exports=c;var n,r=i(57917),s=r.LongBits,o=r.base64,a=r.utf8;function l(e,t,i){this.fn=e,this.len=t,this.next=void 0,this.val=i}function d(){}function u(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function c(){this.len=0,this.head=new l(d,0,0),this.tail=this.head,this.states=null}var h=function(){return r.Buffer?function(){return(c.create=function(){return new n})()}:function(){return new c}};function f(e,t,i){t[i]=255&e}function p(e,t,i){for(;e>127;)t[i++]=127&e|128,e>>>=7;t[i]=e}function m(e,t){this.len=e,this.next=void 0,this.val=t}function g(e,t,i){for(;e.hi;)t[i++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[i++]=127&e.lo|128,e.lo=e.lo>>>7;t[i++]=e.lo}function v(e,t,i){t[i]=255&e,t[i+1]=e>>>8&255,t[i+2]=e>>>16&255,t[i+3]=e>>>24}c.create=h(),c.alloc=function(e){return new r.Array(e)},r.Array!==Array&&(c.alloc=r.pool(c.alloc,r.Array.prototype.subarray)),c.prototype._push=function(e,t,i){return this.tail=this.tail.next=new l(e,t,i),this.len+=t,this},m.prototype=Object.create(l.prototype),m.prototype.fn=p,c.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new m((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},c.prototype.int32=function(e){return e<0?this._push(g,10,s.fromNumber(e)):this.uint32(e)},c.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},c.prototype.uint64=function(e){var t=s.from(e);return this._push(g,t.length(),t)},c.prototype.int64=c.prototype.uint64,c.prototype.sint64=function(e){var t=s.from(e).zzEncode();return this._push(g,t.length(),t)},c.prototype.bool=function(e){return this._push(f,1,e?1:0)},c.prototype.fixed32=function(e){return this._push(v,4,e>>>0)},c.prototype.sfixed32=c.prototype.fixed32,c.prototype.fixed64=function(e){var t=s.from(e);return this._push(v,4,t.lo)._push(v,4,t.hi)},c.prototype.sfixed64=c.prototype.fixed64,c.prototype.float=function(e){return this._push(r.float.writeFloatLE,4,e)},c.prototype.double=function(e){return this._push(r.float.writeDoubleLE,8,e)};var b=r.Array.prototype.set?function(e,t,i){t.set(e,i)}:function(e,t,i){for(var n=0;n<e.length;++n)t[i+n]=e[n]};c.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(f,1,0);if(r.isString(e)){var i=c.alloc(t=o.length(e));o.decode(e,i,0),e=i}return this.uint32(t)._push(b,t,e)},c.prototype.string=function(e){var t=a.length(e);return t?this.uint32(t)._push(a.write,t,e):this._push(f,1,0)},c.prototype.fork=function(){return this.states=new u(this),this.head=this.tail=new l(d,0,0),this.len=0,this},c.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new l(d,0,0),this.len=0),this},c.prototype.ldelim=function(){var e=this.head,t=this.tail,i=this.len;return this.reset().uint32(i),i&&(this.tail.next=e.next,this.tail=t,this.len+=i),this},c.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),i=0;e;)e.fn(e.val,t,i),i+=e.len,e=e.next;return t},c._configure=function(e){n=e,c.create=h(),n._configure()}},51394:function(e,t,i){"use strict";e.exports=s;var n=i(27269);(s.prototype=Object.create(n.prototype)).constructor=s;var r=i(57917);function s(){n.call(this)}function o(e,t,i){e.length<40?r.utf8.write(e,t,i):t.utf8Write?t.utf8Write(e,i):t.write(e,i)}s._configure=function(){s.alloc=r._Buffer_allocUnsafe,s.writeBytesBuffer=r.Buffer&&r.Buffer.prototype instanceof Uint8Array&&"set"===r.Buffer.prototype.set.name?function(e,t,i){t.set(e,i)}:function(e,t,i){if(e.copy)e.copy(t,i,0,e.length);else for(var n=0;n<e.length;)t[i++]=e[n++]}},s.prototype.bytes=function(e){r.isString(e)&&(e=r._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(s.writeBytesBuffer,t,e),this},s.prototype.string=function(e){var t=r.Buffer.byteLength(e);return this.uint32(t),t&&this._push(o,t,e),this},s._configure()},70972:function(e,t){"use strict";/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var i=function(e,t){return(i=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)};function n(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function r(e){var t="function"==typeof Symbol&&e[Symbol.iterator],i=0;return t?t.call(e):{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}}}function s(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var n,r,s=i.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(e){r={error:e}}finally{try{n&&!n.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}return o}function o(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(s(arguments[t]));return e}var a=function(){return function(e,t){this.target=t,this.type=e}}(),l=function(e){function t(t,i){var n=e.call(this,"error",i)||this;return n.message=t.message,n.error=t,n}return n(t,e),t}(a),d=function(e){function t(t,i,n){void 0===t&&(t=1e3),void 0===i&&(i="");var r=e.call(this,"close",n)||this;return r.wasClean=!0,r.code=t,r.reason=i,r}return n(t,e),t}(a),u=function(){if("undefined"!=typeof WebSocket)return WebSocket},c=function(e){return void 0!==e&&!!e&&2===e.CLOSING},h={maxReconnectionDelay:1e4,minReconnectionDelay:1e3+4e3*Math.random(),minUptime:5e3,reconnectionDelayGrowFactor:1.3,connectionTimeout:4e3,maxRetries:1/0,maxEnqueuedMessages:1/0},f=function(){function e(e,t,i){var n=this;void 0===i&&(i={}),this._listeners={error:[],message:[],open:[],close:[]},this._retryCount=-1,this._shouldReconnect=!0,this._connectLock=!1,this._binaryType="blob",this._closeCalled=!1,this._messageQueue=[],this.onclose=null,this.onerror=null,this.onmessage=null,this.onopen=null,this._handleOpen=function(e){n._debug("open event");var t=n._options.minUptime,i=void 0===t?h.minUptime:t;clearTimeout(n._connectTimeout),n._uptimeTimeout=setTimeout(function(){return n._acceptOpen()},i),n._ws.binaryType=n._binaryType,n._messageQueue.forEach(function(e){return n._ws.send(e)}),n._messageQueue=[],n.onopen&&n.onopen(e),n._listeners.open.forEach(function(t){return n._callEventListener(e,t)})},this._handleMessage=function(e){n._debug("message event"),n.onmessage&&n.onmessage(e),n._listeners.message.forEach(function(t){return n._callEventListener(e,t)})},this._handleError=function(e){n._debug("error event",e.message),n._disconnect(void 0,"TIMEOUT"===e.message?"timeout":void 0),n.onerror&&n.onerror(e),n._debug("exec error listeners"),n._listeners.error.forEach(function(t){return n._callEventListener(e,t)}),n._connect()},this._handleClose=function(e){n._debug("close event"),n._clearTimeouts(),n._shouldReconnect&&n._connect(),n.onclose&&n.onclose(e),n._listeners.close.forEach(function(t){return n._callEventListener(e,t)})},this._url=e,this._protocols=t,this._options=i,this._options.startClosed&&(this._shouldReconnect=!1),this._connect()}return Object.defineProperty(e,"CONNECTING",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(e,"OPEN",{get:function(){return 1},enumerable:!0,configurable:!0}),Object.defineProperty(e,"CLOSING",{get:function(){return 2},enumerable:!0,configurable:!0}),Object.defineProperty(e,"CLOSED",{get:function(){return 3},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CONNECTING",{get:function(){return e.CONNECTING},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"OPEN",{get:function(){return e.OPEN},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CLOSING",{get:function(){return e.CLOSING},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CLOSED",{get:function(){return e.CLOSED},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"binaryType",{get:function(){return this._ws?this._ws.binaryType:this._binaryType},set:function(e){this._binaryType=e,this._ws&&(this._ws.binaryType=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"retryCount",{get:function(){return Math.max(this._retryCount,0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bufferedAmount",{get:function(){return this._messageQueue.reduce(function(e,t){return"string"==typeof t?e+=t.length:t instanceof Blob?e+=t.size:e+=t.byteLength,e},0)+(this._ws?this._ws.bufferedAmount:0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"extensions",{get:function(){return this._ws?this._ws.extensions:""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"protocol",{get:function(){return this._ws?this._ws.protocol:""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"readyState",{get:function(){return this._ws?this._ws.readyState:this._options.startClosed?e.CLOSED:e.CONNECTING},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"url",{get:function(){return this._ws?this._ws.url:""},enumerable:!0,configurable:!0}),e.prototype.close=function(e,t){if(void 0===e&&(e=1e3),this._closeCalled=!0,this._shouldReconnect=!1,this._clearTimeouts(),!this._ws){this._debug("close enqueued: no ws instance");return}if(this._ws.readyState===this.CLOSED){this._debug("close: already closed");return}this._ws.close(e,t)},e.prototype.reconnect=function(e,t){this._shouldReconnect=!0,this._closeCalled=!1,this._retryCount=-1,this._ws&&this._ws.readyState!==this.CLOSED&&this._disconnect(e,t),this._connect()},e.prototype.send=function(e){if(this._ws&&this._ws.readyState===this.OPEN)this._debug("send",e),this._ws.send(e);else{var t=this._options.maxEnqueuedMessages,i=void 0===t?h.maxEnqueuedMessages:t;this._messageQueue.length<i&&(this._debug("enqueue",e),this._messageQueue.push(e))}},e.prototype.addEventListener=function(e,t){this._listeners[e]&&this._listeners[e].push(t)},e.prototype.dispatchEvent=function(e){var t,i,n=this._listeners[e.type];if(n)try{for(var s=r(n),o=s.next();!o.done;o=s.next()){var a=o.value;this._callEventListener(e,a)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(i=s.return)&&i.call(s)}finally{if(t)throw t.error}}return!0},e.prototype.removeEventListener=function(e,t){this._listeners[e]&&(this._listeners[e]=this._listeners[e].filter(function(e){return e!==t}))},e.prototype._debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._options.debug&&console.log.apply(console,o(["RWS>"],e))},e.prototype._getNextDelay=function(){var e=this._options,t=e.reconnectionDelayGrowFactor,i=void 0===t?h.reconnectionDelayGrowFactor:t,n=e.minReconnectionDelay,r=void 0===n?h.minReconnectionDelay:n,s=e.maxReconnectionDelay,o=void 0===s?h.maxReconnectionDelay:s,a=0;return this._retryCount>0&&(a=r*Math.pow(i,this._retryCount-1))>o&&(a=o),this._debug("next delay",a),a},e.prototype._wait=function(){var e=this;return new Promise(function(t){setTimeout(t,e._getNextDelay())})},e.prototype._getNextUrl=function(e){if("string"==typeof e)return Promise.resolve(e);if("function"==typeof e){var t=e();if("string"==typeof t)return Promise.resolve(t);if(t.then)return t}throw Error("Invalid URL")},e.prototype._connect=function(){var e=this;if(!this._connectLock&&this._shouldReconnect){this._connectLock=!0;var t=this._options,i=t.maxRetries,n=void 0===i?h.maxRetries:i,r=t.connectionTimeout,s=void 0===r?h.connectionTimeout:r,o=t.WebSocket,a=void 0===o?u():o;if(this._retryCount>=n){this._debug("max retries reached",this._retryCount,">=",n);return}if(this._retryCount++,this._debug("connect",this._retryCount),this._removeListeners(),!c(a))throw Error("No valid WebSocket class provided");this._wait().then(function(){return e._getNextUrl(e._url)}).then(function(t){e._closeCalled||(e._debug("connect",{url:t,protocols:e._protocols}),e._ws=e._protocols?new a(t,e._protocols):new a(t),e._ws.binaryType=e._binaryType,e._connectLock=!1,e._addListeners(),e._connectTimeout=setTimeout(function(){return e._handleTimeout()},s))})}},e.prototype._handleTimeout=function(){this._debug("timeout event"),this._handleError(new l(Error("TIMEOUT"),this))},e.prototype._disconnect=function(e,t){if(void 0===e&&(e=1e3),this._clearTimeouts(),this._ws){this._removeListeners();try{this._ws.close(e,t),this._handleClose(new d(e,t,this))}catch(e){}}},e.prototype._acceptOpen=function(){this._debug("accept open"),this._retryCount=0},e.prototype._callEventListener=function(e,t){"handleEvent"in t?t.handleEvent(e):t(e)},e.prototype._removeListeners=function(){this._ws&&(this._debug("removeListeners"),this._ws.removeEventListener("open",this._handleOpen),this._ws.removeEventListener("close",this._handleClose),this._ws.removeEventListener("message",this._handleMessage),this._ws.removeEventListener("error",this._handleError))},e.prototype._addListeners=function(){this._ws&&(this._debug("addListeners"),this._ws.addEventListener("open",this._handleOpen),this._ws.addEventListener("close",this._handleClose),this._ws.addEventListener("message",this._handleMessage),this._ws.addEventListener("error",this._handleError))},e.prototype._clearTimeouts=function(){clearTimeout(this._connectTimeout),clearTimeout(this._uptimeTimeout)},e}();t.Z=f},6889:function(e){e.exports=function(e,t,i,n){var r=i?i.call(n,e,t):void 0;if(void 0!==r)return!!r;if(e===t)return!0;if("object"!=typeof e||!e||"object"!=typeof t||!t)return!1;var s=Object.keys(e),o=Object.keys(t);if(s.length!==o.length)return!1;for(var a=Object.prototype.hasOwnProperty.bind(t),l=0;l<s.length;l++){var d=s[l];if(!a(d))return!1;var u=e[d],c=t[d];if(!1===(r=i?i.call(n,u,c,d):void 0)||void 0===r&&u!==c)return!1}return!0}},11707:function(e,t,i){"use strict";i.d(t,{f6:function(){return eA},vJ:function(){return eL},iv:function(){return eb},ZP:function(){return eB},F4:function(){return eF}});var n=i(12659),r=i(2265),s=i(6889),o=i.n(s),a=function(e){function t(e,n,l,d,u){for(var f,p,m,g,v,w=0,_=0,k=0,T=0,P=0,E=0,O=m=f=0,L=0,B=0,N=0,V=0,U=l.length,z=U-1,j="",$="",W="",H="";L<U;){if(p=l.charCodeAt(L),L===z&&0!==_+T+k+w&&(0!==_&&(p=47===_?10:47),T=k=w=0,U++,z++),0===_+T+k+w){if(L===z&&(0<B&&(j=j.replace(h,"")),0<j.trim().length)){switch(p){case 32:case 9:case 59:case 13:case 10:break;default:j+=l.charAt(L)}p=59}switch(p){case 123:for(f=(j=j.trim()).charCodeAt(0),m=1,V=++L;L<U;){switch(p=l.charCodeAt(L)){case 123:m++;break;case 125:m--;break;case 47:switch(p=l.charCodeAt(L+1)){case 42:case 47:i:{for(O=L+1;O<z;++O)switch(l.charCodeAt(O)){case 47:if(42===p&&42===l.charCodeAt(O-1)&&L+2!==O){L=O+1;break i}break;case 10:if(47===p){L=O+1;break i}}L=O}}break;case 91:p++;case 40:p++;case 34:case 39:for(;L++<z&&l.charCodeAt(L)!==p;);}if(0===m)break;L++}if(m=l.substring(V,L),0===f&&(f=(j=j.replace(c,"").trim()).charCodeAt(0)),64===f){switch(0<B&&(j=j.replace(h,"")),p=j.charCodeAt(1)){case 100:case 109:case 115:case 45:B=n;break;default:B=x}if(V=(m=t(n,B,m,p,u+1)).length,0<D&&(v=a(3,m,B=i(x,j,N),n,I,M,V,p,u,d),j=B.join(""),void 0!==v&&0===(V=(m=v.trim()).length)&&(p=0,m="")),0<V)switch(p){case 115:j=j.replace(C,o);case 100:case 109:case 45:m=j+"{"+m+"}";break;case 107:m=(j=j.replace(b,"$1 $2"))+"{"+m+"}",m=1===R||2===R&&s("@"+m,3)?"@-webkit-"+m+"@"+m:"@"+m;break;default:m=j+m,112===d&&($+=m,m="")}else m=""}else m=t(n,i(n,j,N),m,d,u+1);W+=m,m=N=B=O=f=0,j="",p=l.charCodeAt(++L);break;case 125:case 59:if(1<(V=(j=(0<B?j.replace(h,""):j).trim()).length))switch(0===O&&(45===(f=j.charCodeAt(0))||96<f&&123>f)&&(V=(j=j.replace(" ",":")).length),0<D&&void 0!==(v=a(1,j,n,e,I,M,$.length,d,u,d))&&0===(V=(j=v.trim()).length)&&(j="\0\0"),f=j.charCodeAt(0),p=j.charCodeAt(1),f){case 0:break;case 64:if(105===p||99===p){H+=j+l.charAt(L);break}default:58!==j.charCodeAt(V-1)&&($+=r(j,f,p,j.charCodeAt(2)))}N=B=O=f=0,j="",p=l.charCodeAt(++L)}}switch(p){case 13:case 10:47===_?_=0:0===1+f&&107!==d&&0<j.length&&(B=1,j+="\0"),0<D*F&&a(0,j,n,e,I,M,$.length,d,u,d),M=1,I++;break;case 59:case 125:if(0===_+T+k+w){M++;break}default:switch(M++,g=l.charAt(L),p){case 9:case 32:if(0===T+w+_)switch(P){case 44:case 58:case 9:case 32:g="";break;default:32!==p&&(g=" ")}break;case 0:g="\\0";break;case 12:g="\\f";break;case 11:g="\\v";break;case 38:0===T+_+w&&(B=N=1,g="\f"+g);break;case 108:if(0===T+_+w+A&&0<O)switch(L-O){case 2:112===P&&58===l.charCodeAt(L-3)&&(A=P);case 8:111===E&&(A=E)}break;case 58:0===T+_+w&&(O=L);break;case 44:0===_+k+T+w&&(B=1,g+="\r");break;case 34:case 39:0===_&&(T=T===p?0:0===T?p:T);break;case 91:0===T+_+k&&w++;break;case 93:0===T+_+k&&w--;break;case 41:0===T+_+w&&k--;break;case 40:0===T+_+w&&(0===f&&(2*P+3*E==533||(f=1)),k++);break;case 64:0===_+k+T+w+O+m&&(m=1);break;case 42:case 47:if(!(0<T+w+k))switch(_){case 0:switch(2*p+3*l.charCodeAt(L+1)){case 235:_=47;break;case 220:V=L,_=42}break;case 42:47===p&&42===P&&V+2!==L&&(33===l.charCodeAt(V+2)&&($+=l.substring(V,L+1)),g="",_=0)}}0===_&&(j+=g)}E=P,P=p,L++}if(0<(V=$.length)){if(B=n,0<D&&void 0!==(v=a(2,$,B,e,I,M,V,d,u,d))&&0===($=v).length)return H+$+W;if($=B.join(",")+"{"+$+"}",0!=R*A){switch(2!==R||s($,2)||(A=0),A){case 111:$=$.replace(y,":-moz-$1")+$;break;case 112:$=$.replace(S,"::-webkit-input-$1")+$.replace(S,"::-moz-$1")+$.replace(S,":-ms-input-$1")+$}A=0}}return H+$+W}function i(e,t,i){var r=t.trim().split(g);t=r;var s=r.length,o=e.length;switch(o){case 0:case 1:var a=0;for(e=0===o?"":e[0]+" ";a<s;++a)t[a]=n(e,t[a],i).trim();break;default:var l=a=0;for(t=[];a<s;++a)for(var d=0;d<o;++d)t[l++]=n(e[d]+" ",r[a],i).trim()}return t}function n(e,t,i){var n=t.charCodeAt(0);switch(33>n&&(n=(t=t.trim()).charCodeAt(0)),n){case 38:return t.replace(v,"$1"+e.trim());case 58:return e.trim()+t.replace(v,"$1"+e.trim());default:if(0<1*i&&0<t.indexOf("\f"))return t.replace(v,(58===e.charCodeAt(0)?"":"$1")+e.trim())}return e+t}function r(e,t,i,n){var o=e+";",a=2*t+3*i+4*n;if(944===a){e=o.indexOf(":",9)+1;var l=o.substring(e,o.length-1).trim();return l=o.substring(0,e).trim()+l+";",1===R||2===R&&s(l,1)?"-webkit-"+l+l:l}if(0===R||2===R&&!s(o,1))return o;switch(a){case 1015:return 97===o.charCodeAt(10)?"-webkit-"+o+o:o;case 951:return 116===o.charCodeAt(3)?"-webkit-"+o+o:o;case 963:return 110===o.charCodeAt(5)?"-webkit-"+o+o:o;case 1009:if(100!==o.charCodeAt(4))break;case 969:case 942:return"-webkit-"+o+o;case 978:return"-webkit-"+o+"-moz-"+o+o;case 1019:case 983:return"-webkit-"+o+"-moz-"+o+"-ms-"+o+o;case 883:if(45===o.charCodeAt(8))return"-webkit-"+o+o;if(0<o.indexOf("image-set(",11))return o.replace(E,"$1-webkit-$2")+o;break;case 932:if(45===o.charCodeAt(4))switch(o.charCodeAt(5)){case 103:return"-webkit-box-"+o.replace("-grow","")+"-webkit-"+o+"-ms-"+o.replace("grow","positive")+o;case 115:return"-webkit-"+o+"-ms-"+o.replace("shrink","negative")+o;case 98:return"-webkit-"+o+"-ms-"+o.replace("basis","preferred-size")+o}return"-webkit-"+o+"-ms-"+o+o;case 964:return"-webkit-"+o+"-ms-flex-"+o+o;case 1023:if(99!==o.charCodeAt(8))break;return"-webkit-box-pack"+(l=o.substring(o.indexOf(":",15)).replace("flex-","").replace("space-between","justify"))+"-webkit-"+o+"-ms-flex-pack"+l+o;case 1005:return p.test(o)?o.replace(f,":-webkit-")+o.replace(f,":-moz-")+o:o;case 1e3:switch(t=(l=o.substring(13).trim()).indexOf("-")+1,l.charCodeAt(0)+l.charCodeAt(t)){case 226:l=o.replace(w,"tb");break;case 232:l=o.replace(w,"tb-rl");break;case 220:l=o.replace(w,"lr");break;default:return o}return"-webkit-"+o+"-ms-"+l+o;case 1017:if(-1===o.indexOf("sticky",9))break;case 975:switch(t=(o=e).length-10,a=(l=(33===o.charCodeAt(t)?o.substring(0,t):o).substring(e.indexOf(":",7)+1).trim()).charCodeAt(0)+(0|l.charCodeAt(7))){case 203:if(111>l.charCodeAt(8))break;case 115:o=o.replace(l,"-webkit-"+l)+";"+o;break;case 207:case 102:o=o.replace(l,"-webkit-"+(102<a?"inline-":"")+"box")+";"+o.replace(l,"-webkit-"+l)+";"+o.replace(l,"-ms-"+l+"box")+";"+o}return o+";";case 938:if(45===o.charCodeAt(5))switch(o.charCodeAt(6)){case 105:return l=o.replace("-items",""),"-webkit-"+o+"-webkit-box-"+l+"-ms-flex-"+l+o;case 115:return"-webkit-"+o+"-ms-flex-item-"+o.replace(k,"")+o;default:return"-webkit-"+o+"-ms-flex-line-pack"+o.replace("align-content","").replace(k,"")+o}break;case 973:case 989:if(45!==o.charCodeAt(3)||122===o.charCodeAt(4))break;case 931:case 953:if(!0===P.test(e))return 115===(l=e.substring(e.indexOf(":")+1)).charCodeAt(0)?r(e.replace("stretch","fill-available"),t,i,n).replace(":fill-available",":stretch"):o.replace(l,"-webkit-"+l)+o.replace(l,"-moz-"+l.replace("fill-",""))+o;break;case 962:if(o="-webkit-"+o+(102===o.charCodeAt(5)?"-ms-"+o:"")+o,211===i+n&&105===o.charCodeAt(13)&&0<o.indexOf("transform",10))return o.substring(0,o.indexOf(";",27)+1).replace(m,"$1-webkit-$2")+o}return o}function s(e,t){var i=e.indexOf(1===t?":":"{"),n=e.substring(0,3!==t?i:10);return i=e.substring(i+1,e.length-1),L(2!==t?n:n.replace(T,"$1"),i,t)}function o(e,t){var i=r(t,t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2));return i!==t+";"?i.replace(_," or ($1)").substring(4):"("+t+")"}function a(e,t,i,n,r,s,o,a,l,d){for(var c,h=0,f=t;h<D;++h)switch(c=O[h].call(u,e,f,i,n,r,s,o,a,l,d)){case void 0:case!1:case!0:case null:break;default:f=c}if(f!==t)return f}function l(e){switch(e){case void 0:case null:D=O.length=0;break;default:if("function"==typeof e)O[D++]=e;else if("object"==typeof e)for(var t=0,i=e.length;t<i;++t)l(e[t]);else F=0|!!e}return l}function d(e){return void 0!==(e=e.prefix)&&(L=null,e?"function"!=typeof e?R=1:(R=2,L=e):R=0),d}function u(e,i){var n=e;if(33>n.charCodeAt(0)&&(n=n.trim()),n=[B=n],0<D){var r=a(-1,i,n,n,I,M,0,0,0,0);void 0!==r&&"string"==typeof r&&(i=r)}var s=t(x,n,i,0,0);return 0<D&&void 0!==(r=a(-2,s,n,n,I,M,s.length,0,0,0))&&(s=r),B="",A=0,M=I=1,s}var c=/^\0+/g,h=/[\0\r\f]/g,f=/: */g,p=/zoo|gra/,m=/([,: ])(transform)/g,g=/,\r+?/g,v=/([\t\r\n ])*\f?&/g,b=/@(k\w+)\s*(\S*)\s*/,S=/::(place)/g,y=/:(read-only)/g,w=/[svh]\w+-[tblr]{2}/,C=/\(\s*(.*)\s*\)/g,_=/([\s\S]*?);/g,k=/-self|flex-/g,T=/[^]*?(:[rp][el]a[\w-]+)[^]*/,P=/stretch|:\s*\w+\-(?:conte|avail)/,E=/([^-])(image-set\()/,M=1,I=1,A=0,R=1,x=[],O=[],D=0,L=null,F=0,B="";return u.use=l,u.set=d,void 0!==e&&d(e),u},l={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},d=i(963),u=i(46451),c=i.n(u),h=i(25566);function f(){return(f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}).apply(this,arguments)}var p=function(e,t){for(var i=[e[0]],n=0,r=t.length;n<r;n+=1)i.push(t[n],e[n+1]);return i},m=function(e){return null!==e&&"object"==typeof e&&"[object Object]"===(e.toString?e.toString():Object.prototype.toString.call(e))&&!(0,n.typeOf)(e)},g=Object.freeze([]),v=Object.freeze({});function b(e){return"function"==typeof e}function S(e){return e.displayName||e.name||"Component"}function y(e){return e&&"string"==typeof e.styledComponentId}var w=void 0!==h&&void 0!==h.env&&(h.env.REACT_APP_SC_ATTR||h.env.SC_ATTR)||"data-styled",C="undefined"!=typeof window&&"HTMLElement"in window,_=!!("boolean"==typeof SC_DISABLE_SPEEDY?SC_DISABLE_SPEEDY:void 0!==h&&void 0!==h.env&&(void 0!==h.env.REACT_APP_SC_DISABLE_SPEEDY&&""!==h.env.REACT_APP_SC_DISABLE_SPEEDY?"false"!==h.env.REACT_APP_SC_DISABLE_SPEEDY&&h.env.REACT_APP_SC_DISABLE_SPEEDY:void 0!==h.env.SC_DISABLE_SPEEDY&&""!==h.env.SC_DISABLE_SPEEDY&&"false"!==h.env.SC_DISABLE_SPEEDY&&h.env.SC_DISABLE_SPEEDY)),k={};function T(e){for(var t=arguments.length,i=Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];throw Error("An error occurred. See https://git.io/JUIaE#"+e+" for more information."+(i.length>0?" Args: "+i.join(", "):""))}var P=function(){function e(e){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=e}var t=e.prototype;return t.indexOfGroup=function(e){for(var t=0,i=0;i<e;i++)t+=this.groupSizes[i];return t},t.insertRules=function(e,t){if(e>=this.groupSizes.length){for(var i=this.groupSizes,n=i.length,r=n;e>=r;)(r<<=1)<0&&T(16,""+e);this.groupSizes=new Uint32Array(r),this.groupSizes.set(i),this.length=r;for(var s=n;s<r;s++)this.groupSizes[s]=0}for(var o=this.indexOfGroup(e+1),a=0,l=t.length;a<l;a++)this.tag.insertRule(o,t[a])&&(this.groupSizes[e]++,o++)},t.clearGroup=function(e){if(e<this.length){var t=this.groupSizes[e],i=this.indexOfGroup(e),n=i+t;this.groupSizes[e]=0;for(var r=i;r<n;r++)this.tag.deleteRule(i)}},t.getGroup=function(e){var t="";if(e>=this.length||0===this.groupSizes[e])return t;for(var i=this.groupSizes[e],n=this.indexOfGroup(e),r=n+i,s=n;s<r;s++)t+=this.tag.getRule(s)+"/*!sc*/\n";return t},e}(),E=new Map,M=new Map,I=1,A=function(e){if(E.has(e))return E.get(e);for(;M.has(I);)I++;var t=I++;return E.set(e,t),M.set(t,e),t},R=function(e){return M.get(e)},x=function(e,t){t>=I&&(I=t+1),E.set(e,t),M.set(t,e)},O="style["+w+'][data-styled-version="5.3.11"]',D=RegExp("^"+w+'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)'),L=function(e,t,i){for(var n,r=i.split(","),s=0,o=r.length;s<o;s++)(n=r[s])&&e.registerName(t,n)},F=function(e,t){for(var i=(t.textContent||"").split("/*!sc*/\n"),n=[],r=0,s=i.length;r<s;r++){var o=i[r].trim();if(o){var a=o.match(D);if(a){var l=0|parseInt(a[1],10),d=a[2];0!==l&&(x(d,l),L(e,d,a[3]),e.getTag().insertRules(l,n)),n.length=0}else n.push(o)}}},B=function(){return i.nc},N=function(e){var t=document.head,i=e||t,n=document.createElement("style"),r=function(e){for(var t=e.childNodes,i=t.length;i>=0;i--){var n=t[i];if(n&&1===n.nodeType&&n.hasAttribute(w))return n}}(i),s=void 0!==r?r.nextSibling:null;n.setAttribute(w,"active"),n.setAttribute("data-styled-version","5.3.11");var o=B();return o&&n.setAttribute("nonce",o),i.insertBefore(n,s),n},V=function(){function e(e){var t=this.element=N(e);t.appendChild(document.createTextNode("")),this.sheet=function(e){if(e.sheet)return e.sheet;for(var t=document.styleSheets,i=0,n=t.length;i<n;i++){var r=t[i];if(r.ownerNode===e)return r}T(17)}(t),this.length=0}var t=e.prototype;return t.insertRule=function(e,t){try{return this.sheet.insertRule(t,e),this.length++,!0}catch(e){return!1}},t.deleteRule=function(e){this.sheet.deleteRule(e),this.length--},t.getRule=function(e){var t=this.sheet.cssRules[e];return void 0!==t&&"string"==typeof t.cssText?t.cssText:""},e}(),U=function(){function e(e){var t=this.element=N(e);this.nodes=t.childNodes,this.length=0}var t=e.prototype;return t.insertRule=function(e,t){if(e<=this.length&&e>=0){var i=document.createTextNode(t),n=this.nodes[e];return this.element.insertBefore(i,n||null),this.length++,!0}return!1},t.deleteRule=function(e){this.element.removeChild(this.nodes[e]),this.length--},t.getRule=function(e){return e<this.length?this.nodes[e].textContent:""},e}(),z=function(){function e(e){this.rules=[],this.length=0}var t=e.prototype;return t.insertRule=function(e,t){return e<=this.length&&(this.rules.splice(e,0,t),this.length++,!0)},t.deleteRule=function(e){this.rules.splice(e,1),this.length--},t.getRule=function(e){return e<this.length?this.rules[e]:""},e}(),j=C,$={isServer:!C,useCSSOMInjection:!_},W=function(){function e(e,t,i){void 0===e&&(e=v),void 0===t&&(t={}),this.options=f({},$,{},e),this.gs=t,this.names=new Map(i),this.server=!!e.isServer,!this.server&&C&&j&&(j=!1,function(e){for(var t=document.querySelectorAll(O),i=0,n=t.length;i<n;i++){var r=t[i];r&&"active"!==r.getAttribute(w)&&(F(e,r),r.parentNode&&r.parentNode.removeChild(r))}}(this))}e.registerId=function(e){return A(e)};var t=e.prototype;return t.reconstructWithOptions=function(t,i){return void 0===i&&(i=!0),new e(f({},this.options,{},t),this.gs,i&&this.names||void 0)},t.allocateGSInstance=function(e){return this.gs[e]=(this.gs[e]||0)+1},t.getTag=function(){var e,t,i,n;return this.tag||(this.tag=(t=(e=this.options).isServer,i=e.useCSSOMInjection,n=e.target,new P(t?new z(n):i?new V(n):new U(n))))},t.hasNameForId=function(e,t){return this.names.has(e)&&this.names.get(e).has(t)},t.registerName=function(e,t){if(A(e),this.names.has(e))this.names.get(e).add(t);else{var i=new Set;i.add(t),this.names.set(e,i)}},t.insertRules=function(e,t,i){this.registerName(e,t),this.getTag().insertRules(A(e),i)},t.clearNames=function(e){this.names.has(e)&&this.names.get(e).clear()},t.clearRules=function(e){this.getTag().clearGroup(A(e)),this.clearNames(e)},t.clearTag=function(){this.tag=void 0},t.toString=function(){return function(e){for(var t=e.getTag(),i=t.length,n="",r=0;r<i;r++){var s=R(r);if(void 0!==s){var o=e.names.get(s),a=t.getGroup(r);if(o&&a&&o.size){var l=w+".g"+r+'[id="'+s+'"]',d="";void 0!==o&&o.forEach(function(e){e.length>0&&(d+=e+",")}),n+=""+a+l+'{content:"'+d+'"}/*!sc*/\n'}}}return n}(this)},e}(),H=/(a)(d)/gi,K=function(e){return String.fromCharCode(e+(e>25?39:97))};function G(e){var t,i="";for(t=Math.abs(e);t>52;t=t/52|0)i=K(t%52)+i;return(K(t%52)+i).replace(H,"$1-$2")}var q=function(e,t){for(var i=t.length;i;)e=33*e^t.charCodeAt(--i);return e},Q=function(e){return q(5381,e)};function Z(e){for(var t=0;t<e.length;t+=1){var i=e[t];if(b(i)&&!y(i))return!1}return!0}var Y=Q("5.3.11"),J=function(){function e(e,t,i){this.rules=e,this.staticRulesId="",this.isStatic=(void 0===i||i.isStatic)&&Z(e),this.componentId=t,this.baseHash=q(Y,t),this.baseStyle=i,W.registerId(t)}return e.prototype.generateAndInjectStyles=function(e,t,i){var n=this.componentId,r=[];if(this.baseStyle&&r.push(this.baseStyle.generateAndInjectStyles(e,t,i)),this.isStatic&&!i.hash){if(this.staticRulesId&&t.hasNameForId(n,this.staticRulesId))r.push(this.staticRulesId);else{var s=eg(this.rules,e,t,i).join(""),o=G(q(this.baseHash,s)>>>0);if(!t.hasNameForId(n,o)){var a=i(s,"."+o,void 0,n);t.insertRules(n,o,a)}r.push(o),this.staticRulesId=o}}else{for(var l=this.rules.length,d=q(this.baseHash,i.hash),u="",c=0;c<l;c++){var h=this.rules[c];if("string"==typeof h)u+=h;else if(h){var f=eg(h,e,t,i),p=Array.isArray(f)?f.join(""):f;d=q(d,p+c),u+=p}}if(u){var m=G(d>>>0);if(!t.hasNameForId(n,m)){var g=i(u,"."+m,void 0,n);t.insertRules(n,m,g)}r.push(m)}}return r.join(" ")},e}(),X=/^\s*\/\/.*$/gm,ee=[":","[",".","#"];function et(e){var t,i,n,r,s=void 0===e?v:e,o=s.options,l=void 0===o?v:o,d=s.plugins,u=void 0===d?g:d,c=new a(l),h=[],f=function(e){function t(t){if(t)try{e(t+"}")}catch(e){}}return function(i,n,r,s,o,a,l,d,u,c){switch(i){case 1:if(0===u&&64===n.charCodeAt(0))return e(n+";"),"";break;case 2:if(0===d)return n+"/*|*/";break;case 3:switch(d){case 102:case 112:return e(r[0]+n),"";default:return n+(0===c?"/*|*/":"")}case -2:n.split("/*|*/}").forEach(t)}}}(function(e){h.push(e)}),p=function(e,n,s){return 0===n&&-1!==ee.indexOf(s[i.length])||s.match(r)?e:"."+t};function m(e,s,o,a){void 0===a&&(a="&");var l=e.replace(X,""),d=s&&o?o+" "+s+" { "+l+" }":l;return t=a,n=RegExp("\\"+(i=s)+"\\b","g"),r=RegExp("(\\"+i+"\\b){2,}"),c(o||!s?"":s,d)}return c.use([].concat(u,[function(e,t,r){2===e&&r.length&&r[0].lastIndexOf(i)>0&&(r[0]=r[0].replace(n,p))},f,function(e){if(-2===e){var t=h;return h=[],t}}])),m.hash=u.length?u.reduce(function(e,t){return t.name||T(15),q(e,t.name)},5381).toString():"",m}var ei=r.createContext(),en=(ei.Consumer,r.createContext()),er=(en.Consumer,new W),es=et();function eo(){return(0,r.useContext)(ei)||er}function ea(){return(0,r.useContext)(en)||es}function el(e){var t=(0,r.useState)(e.stylisPlugins),i=t[0],n=t[1],s=eo(),a=(0,r.useMemo)(function(){var t=s;return e.sheet?t=e.sheet:e.target&&(t=t.reconstructWithOptions({target:e.target},!1)),e.disableCSSOMInjection&&(t=t.reconstructWithOptions({useCSSOMInjection:!1})),t},[e.disableCSSOMInjection,e.sheet,e.target]),l=(0,r.useMemo)(function(){return et({options:{prefix:!e.disableVendorPrefixes},plugins:i})},[e.disableVendorPrefixes,i]);return(0,r.useEffect)(function(){o()(i,e.stylisPlugins)||n(e.stylisPlugins)},[e.stylisPlugins]),r.createElement(ei.Provider,{value:a},r.createElement(en.Provider,{value:l},e.children))}var ed=function(){function e(e,t){var i=this;this.inject=function(e,t){void 0===t&&(t=es);var n=i.name+t.hash;e.hasNameForId(i.id,n)||e.insertRules(i.id,n,t(i.rules,n,"@keyframes"))},this.toString=function(){return T(12,String(i.name))},this.name=e,this.id="sc-keyframes-"+e,this.rules=t}return e.prototype.getName=function(e){return void 0===e&&(e=es),this.name+e.hash},e}(),eu=/([A-Z])/,ec=/([A-Z])/g,eh=/^ms-/,ef=function(e){return"-"+e.toLowerCase()};function ep(e){return eu.test(e)?e.replace(ec,ef).replace(eh,"-ms-"):e}var em=function(e){return null==e||!1===e||""===e};function eg(e,t,i,n){if(Array.isArray(e)){for(var r,s,o=[],a=0,d=e.length;a<d;a+=1)""!==(s=eg(e[a],t,i,n))&&(Array.isArray(s)?o.push.apply(o,s):o.push(s));return o}return em(e)?"":y(e)?"."+e.styledComponentId:b(e)?"function"!=typeof(r=e)||r.prototype&&r.prototype.isReactComponent||!t?e:eg(e(t),t,i,n):e instanceof ed?i?(e.inject(i,n),e.getName(n)):e:m(e)?function e(t,i){var n,r,s=[];for(var o in t)t.hasOwnProperty(o)&&!em(t[o])&&(Array.isArray(t[o])&&t[o].isCss||b(t[o])?s.push(ep(o)+":",t[o],";"):m(t[o])?s.push.apply(s,e(t[o],o)):s.push(ep(o)+": "+(n=o,null==(r=t[o])||"boolean"==typeof r||""===r?"":"number"!=typeof r||0===r||n in l||n.startsWith("--")?String(r).trim():r+"px")+";"));return i?[i+" {"].concat(s,["}"]):s}(e):e.toString()}var ev=function(e){return Array.isArray(e)&&(e.isCss=!0),e};function eb(e){for(var t=arguments.length,i=Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return b(e)||m(e)?ev(eg(p(g,[e].concat(i)))):0===i.length&&1===e.length&&"string"==typeof e[0]?e:ev(eg(p(e,i)))}var eS=function(e,t,i){return void 0===i&&(i=v),e.theme!==i.theme&&e.theme||t||i.theme},ey=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,ew=/(^-|-$)/g;function eC(e){return e.replace(ey,"-").replace(ew,"")}var e_=function(e){return G(Q(e)>>>0)};function ek(e){return"string"==typeof e}var eT=function(e){return"function"==typeof e||"object"==typeof e&&null!==e&&!Array.isArray(e)},eP=function(e){return"__proto__"!==e&&"constructor"!==e&&"prototype"!==e};function eE(e,t,i){var n=e[i];eT(t)&&eT(n)?eM(n,t):e[i]=t}function eM(e){for(var t=arguments.length,i=Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];for(var r=0,s=i;r<s.length;r++){var o=s[r];if(eT(o))for(var a in o)eP(a)&&eE(e,o[a],a)}return e}var eI=r.createContext();function eA(e){var t=(0,r.useContext)(eI),i=(0,r.useMemo)(function(){return function(e,t){return e?b(e)?e(t):Array.isArray(e)||"object"!=typeof e?T(8):t?f({},t,{},e):e:T(14)}(e.theme,t)},[e.theme,t]);return e.children?r.createElement(eI.Provider,{value:i},e.children):null}eI.Consumer;var eR={};function ex(e,t,i){var n=y(e),s=!ek(e),o=t.attrs,a=void 0===o?g:o,l=t.componentId,u=void 0===l?function(e,t){var i="string"!=typeof e?"sc":eC(e);eR[i]=(eR[i]||0)+1;var n=i+"-"+e_("5.3.11"+i+eR[i]);return t?t+"-"+n:n}(t.displayName,t.parentComponentId):l,h=t.displayName,p=void 0===h?function(e){return ek(e)?"styled."+e:"Styled("+S(e)+")"}(e):h,m=t.displayName&&t.componentId?eC(t.displayName)+"-"+t.componentId:t.componentId||u,w=n&&e.attrs?Array.prototype.concat(e.attrs,a).filter(Boolean):a,C=t.shouldForwardProp;n&&e.shouldForwardProp&&(C=t.shouldForwardProp?function(i,n,r){return e.shouldForwardProp(i,n,r)&&t.shouldForwardProp(i,n,r)}:e.shouldForwardProp);var _,k=new J(i,m,n?e.componentStyle:void 0),T=k.isStatic&&0===a.length,P=function(e,t){return function(e,t,i,n){var s=e.attrs,o=e.componentStyle,a=e.defaultProps,l=e.foldedComponentIds,u=e.shouldForwardProp,c=e.styledComponentId,h=e.target,p=function(e,t,i){void 0===e&&(e=v);var n=f({},t,{theme:e}),r={};return i.forEach(function(e){var t,i,s,o=e;for(t in b(o)&&(o=o(n)),o)n[t]=r[t]="className"===t?(i=r[t],s=o[t],i&&s?i+" "+s:i||s):o[t]}),[n,r]}(eS(t,(0,r.useContext)(eI),a)||v,t,s),m=p[0],g=p[1],S=function(e,t,i,n){var r=eo(),s=ea();return t?e.generateAndInjectStyles(v,r,s):e.generateAndInjectStyles(i,r,s)}(o,n,m,0),y=i,w=g.$as||t.$as||g.as||t.as||h,C=ek(w),_=g!==t?f({},t,{},g):t,k={};for(var T in _)"$"!==T[0]&&"as"!==T&&("forwardedAs"===T?k.as=_[T]:(u?u(T,d.Z,w):!C||(0,d.Z)(T))&&(k[T]=_[T]));return t.style&&g.style!==t.style&&(k.style=f({},t.style,{},g.style)),k.className=Array.prototype.concat(l,c,S!==c?S:null,t.className,g.className).filter(Boolean).join(" "),k.ref=y,(0,r.createElement)(w,k)}(_,e,t,T)};return P.displayName=p,(_=r.forwardRef(P)).attrs=w,_.componentStyle=k,_.displayName=p,_.shouldForwardProp=C,_.foldedComponentIds=n?Array.prototype.concat(e.foldedComponentIds,e.styledComponentId):g,_.styledComponentId=m,_.target=n?e.target:e,_.withComponent=function(e){var n=t.componentId,r=function(e,t){if(null==e)return{};var i,n,r={},s=Object.keys(e);for(n=0;n<s.length;n++)t.indexOf(i=s[n])>=0||(r[i]=e[i]);return r}(t,["componentId"]),s=n&&n+"-"+(ek(e)?e:eC(S(e)));return ex(e,f({},r,{attrs:w,componentId:s}),i)},Object.defineProperty(_,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(t){this._foldedDefaultProps=n?eM({},e.defaultProps,t):t}}),Object.defineProperty(_,"toString",{value:function(){return"."+_.styledComponentId}}),s&&c()(_,e,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0,withComponent:!0}),_}var eO=function(e){return function e(t,i,r){if(void 0===r&&(r=v),!(0,n.isValidElementType)(i))return T(1,String(i));var s=function(){return t(i,r,eb.apply(void 0,arguments))};return s.withConfig=function(n){return e(t,i,f({},r,{},n))},s.attrs=function(n){return e(t,i,f({},r,{attrs:Array.prototype.concat(r.attrs,n).filter(Boolean)}))},s}(ex,e)};["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","textPath","tspan"].forEach(function(e){eO[e]=eO(e)});var eD=function(){function e(e,t){this.rules=e,this.componentId=t,this.isStatic=Z(e),W.registerId(this.componentId+1)}var t=e.prototype;return t.createStyles=function(e,t,i,n){var r=n(eg(this.rules,t,i,n).join(""),""),s=this.componentId+e;i.insertRules(s,s,r)},t.removeStyles=function(e,t){t.clearRules(this.componentId+e)},t.renderStyles=function(e,t,i,n){e>2&&W.registerId(this.componentId+e),this.removeStyles(e,i),this.createStyles(e,t,i,n)},e}();function eL(e){for(var t=arguments.length,i=Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];var s=eb.apply(void 0,[e].concat(i)),o="sc-global-"+e_(JSON.stringify(s)),a=new eD(s,o);function l(e){var t=eo(),i=ea(),n=(0,r.useContext)(eI),s=(0,r.useRef)(t.allocateGSInstance(o)).current;return t.server&&d(s,e,t,n,i),(0,r.useLayoutEffect)(function(){if(!t.server)return d(s,e,t,n,i),function(){return a.removeStyles(s,t)}},[s,e,t,n,i]),null}function d(e,t,i,n,r){if(a.isStatic)a.renderStyles(e,k,i,r);else{var s=f({},t,{theme:eS(t,n,l.defaultProps)});a.renderStyles(e,s,i,r)}}return r.memo(l)}function eF(e){for(var t=arguments.length,i=Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];var r=eb.apply(void 0,[e].concat(i)).join("");return new ed(e_(r),r)}!function(){var e=(function(){var e=this;this._emitSheetCSS=function(){var t=e.instance.toString();if(!t)return"";var i=B();return"<style "+[i&&'nonce="'+i+'"',w+'="true"','data-styled-version="5.3.11"'].filter(Boolean).join(" ")+">"+t+"</style>"},this.getStyleTags=function(){return e.sealed?T(2):e._emitSheetCSS()},this.getStyleElement=function(){if(e.sealed)return T(2);var t,i=((t={})[w]="",t["data-styled-version"]="5.3.11",t.dangerouslySetInnerHTML={__html:e.instance.toString()},t),n=B();return n&&(i.nonce=n),[r.createElement("style",f({},i,{key:"sc-0-0"}))]},this.seal=function(){e.sealed=!0},this.instance=new W({isServer:!0}),this.sealed=!1}).prototype;e.collectStyles=function(e){return this.sealed?T(2):r.createElement(el,{sheet:this.instance},e)},e.interleaveWithNodeStream=function(e){return T(3)}}();var eB=eO},18025:function(e,t,i){"use strict";i.d(t,{eC:function(){return k},Dh:function(){return F}});var n=i(24580),r=i.n(n),s=function(e,t){var i,n=r()({},e,t);for(var s in e)e[s]&&"object"==typeof t[s]&&r()(n,((i={})[s]=r()(e[s],t[s]),i));return n},o=function(e){var t={};return Object.keys(e).sort(function(e,t){return e.localeCompare(t,void 0,{numeric:!0,sensitivity:"base"})}).forEach(function(i){t[i]=e[i]}),t},a={breakpoints:[40,52,64].map(function(e){return e+"em"})},l=function(e){return"@media screen and (min-width: "+e+")"},d=function(e,t){return u(t,e,e)},u=function(e,t,i,n,r){for(n=0,t=t&&t.split?t.split("."):[t];n<t.length;n++)e=e?e[t[n]]:r;return e===r?i:e},c=function e(t){var i={},n=function(e){var n={},d=!1,c=e.theme&&e.theme.disableStyledSystemCache;for(var p in e)if(t[p]){var m=t[p],g=e[p],v=u(e.theme,m.scale,m.defaults);if("object"==typeof g){if(i.breakpoints=!c&&i.breakpoints||u(e.theme,"breakpoints",a.breakpoints),Array.isArray(g)){i.media=!c&&i.media||[null].concat(i.breakpoints.map(l)),n=s(n,h(i.media,m,v,g,e));continue}null!==g&&(n=s(n,f(i.breakpoints,m,v,g,e)),d=!0);continue}r()(n,m(g,v,e))}return d&&(n=o(n)),n};n.config=t,n.propNames=Object.keys(t),n.cache=i;var d=Object.keys(t).filter(function(e){return"config"!==e});return d.length>1&&d.forEach(function(i){var r;n[i]=e(((r={})[i]=t[i],r))}),n},h=function(e,t,i,n,s){var o={};return n.slice(0,e.length).forEach(function(n,a){var l,d=e[a],u=t(n,i,s);d?r()(o,((l={})[d]=r()({},o[d],u),l)):r()(o,u)}),o},f=function(e,t,i,n,s){var o={};for(var a in n){var d=e[a],u=t(n[a],i,s);if(d){var c,h=l(d);r()(o,((c={})[h]=r()({},o[h],u),c))}else r()(o,u)}return o},p=function(e){var t=e.properties,i=e.property,n=e.scale,r=e.transform,s=void 0===r?d:r,o=e.defaultScale;t=t||[i];var a=function(e,i,n){var r={},o=s(e,i,n);if(null!==o)return t.forEach(function(e){r[e]=o}),r};return a.scale=n,a.defaults=o,a},m=function(e){void 0===e&&(e={});var t={};return Object.keys(e).forEach(function(i){var n=e[i];if(!0===n){t[i]=p({property:i,scale:i});return}if("function"==typeof n){t[i]=n;return}t[i]=p(n)}),c(t)},g=function(){for(var e={},t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];return i.forEach(function(t){t&&t.config&&r()(e,t.config)}),c(e)},v=function(e){return"number"==typeof e&&!isNaN(e)},b=m({width:{property:"width",scale:"sizes",transform:function(e,t){return u(t,e,!v(e)||e>1?e:100*e+"%")}},height:{property:"height",scale:"sizes"},minWidth:{property:"minWidth",scale:"sizes"},minHeight:{property:"minHeight",scale:"sizes"},maxWidth:{property:"maxWidth",scale:"sizes"},maxHeight:{property:"maxHeight",scale:"sizes"},size:{properties:["width","height"],scale:"sizes"},overflow:!0,overflowX:!0,overflowY:!0,display:!0,verticalAlign:!0}),S={color:{property:"color",scale:"colors"},backgroundColor:{property:"backgroundColor",scale:"colors"},opacity:!0};S.bg=S.backgroundColor;var y=m(S),w=m({fontFamily:{property:"fontFamily",scale:"fonts"},fontSize:{property:"fontSize",scale:"fontSizes",defaultScale:[12,14,16,20,24,32,48,64,72]},fontWeight:{property:"fontWeight",scale:"fontWeights"},lineHeight:{property:"lineHeight",scale:"lineHeights"},letterSpacing:{property:"letterSpacing",scale:"letterSpacings"},textAlign:!0,fontStyle:!0}),C=m({alignItems:!0,alignContent:!0,justifyItems:!0,justifyContent:!0,flexWrap:!0,flexDirection:!0,flex:!0,flexGrow:!0,flexShrink:!0,flexBasis:!0,justifySelf:!0,alignSelf:!0,order:!0}),_=[0,4,8,16,32,64,128,256,512],k=m({gridGap:{property:"gridGap",scale:"space",defaultScale:_},gridColumnGap:{property:"gridColumnGap",scale:"space",defaultScale:_},gridRowGap:{property:"gridRowGap",scale:"space",defaultScale:_},gridColumn:!0,gridRow:!0,gridAutoFlow:!0,gridAutoColumns:!0,gridAutoRows:!0,gridTemplateColumns:!0,gridTemplateRows:!0,gridTemplateAreas:!0,gridArea:!0}),T=k,P={border:{property:"border",scale:"borders"},borderWidth:{property:"borderWidth",scale:"borderWidths"},borderStyle:{property:"borderStyle",scale:"borderStyles"},borderColor:{property:"borderColor",scale:"colors"},borderRadius:{property:"borderRadius",scale:"radii"},borderTop:{property:"borderTop",scale:"borders"},borderTopLeftRadius:{property:"borderTopLeftRadius",scale:"radii"},borderTopRightRadius:{property:"borderTopRightRadius",scale:"radii"},borderRight:{property:"borderRight",scale:"borders"},borderBottom:{property:"borderBottom",scale:"borders"},borderBottomLeftRadius:{property:"borderBottomLeftRadius",scale:"radii"},borderBottomRightRadius:{property:"borderBottomRightRadius",scale:"radii"},borderLeft:{property:"borderLeft",scale:"borders"},borderX:{properties:["borderLeft","borderRight"],scale:"borders"},borderY:{properties:["borderTop","borderBottom"],scale:"borders"}};P.borderTopWidth={property:"borderTopWidth",scale:"borderWidths"},P.borderTopColor={property:"borderTopColor",scale:"colors"},P.borderTopStyle={property:"borderTopStyle",scale:"borderStyles"},P.borderTopLeftRadius={property:"borderTopLeftRadius",scale:"radii"},P.borderTopRightRadius={property:"borderTopRightRadius",scale:"radii"},P.borderBottomWidth={property:"borderBottomWidth",scale:"borderWidths"},P.borderBottomColor={property:"borderBottomColor",scale:"colors"},P.borderBottomStyle={property:"borderBottomStyle",scale:"borderStyles"},P.borderBottomLeftRadius={property:"borderBottomLeftRadius",scale:"radii"},P.borderBottomRightRadius={property:"borderBottomRightRadius",scale:"radii"},P.borderLeftWidth={property:"borderLeftWidth",scale:"borderWidths"},P.borderLeftColor={property:"borderLeftColor",scale:"colors"},P.borderLeftStyle={property:"borderLeftStyle",scale:"borderStyles"},P.borderRightWidth={property:"borderRightWidth",scale:"borderWidths"},P.borderRightColor={property:"borderRightColor",scale:"colors"},P.borderRightStyle={property:"borderRightStyle",scale:"borderStyles"};var E=m(P),M={background:!0,backgroundImage:!0,backgroundSize:!0,backgroundPosition:!0,backgroundRepeat:!0};M.bgImage=M.backgroundImage,M.bgSize=M.backgroundSize,M.bgPosition=M.backgroundPosition,M.bgRepeat=M.backgroundRepeat;var I=m(M),A=[0,4,8,16,32,64,128,256,512],R=m({position:!0,zIndex:{property:"zIndex",scale:"zIndices"},top:{property:"top",scale:"space",defaultScale:A},right:{property:"right",scale:"space",defaultScale:A},bottom:{property:"bottom",scale:"space",defaultScale:A},left:{property:"left",scale:"space",defaultScale:A}}),x=[0,4,8,16,32,64,128,256,512],O=function(e){return"number"==typeof e&&!isNaN(e)},D=function(e,t){if(!O(e))return u(t,e,e);var i=e<0,n=Math.abs(e),r=u(t,n,n);return O(r)?r*(i?-1:1):i?"-"+r:r},L={};L.margin={margin:{property:"margin",scale:"space",transform:D,defaultScale:x},marginTop:{property:"marginTop",scale:"space",transform:D,defaultScale:x},marginRight:{property:"marginRight",scale:"space",transform:D,defaultScale:x},marginBottom:{property:"marginBottom",scale:"space",transform:D,defaultScale:x},marginLeft:{property:"marginLeft",scale:"space",transform:D,defaultScale:x},marginX:{properties:["marginLeft","marginRight"],scale:"space",transform:D,defaultScale:x},marginY:{properties:["marginTop","marginBottom"],scale:"space",transform:D,defaultScale:x}},L.margin.m=L.margin.margin,L.margin.mt=L.margin.marginTop,L.margin.mr=L.margin.marginRight,L.margin.mb=L.margin.marginBottom,L.margin.ml=L.margin.marginLeft,L.margin.mx=L.margin.marginX,L.margin.my=L.margin.marginY,L.padding={padding:{property:"padding",scale:"space",defaultScale:x},paddingTop:{property:"paddingTop",scale:"space",defaultScale:x},paddingRight:{property:"paddingRight",scale:"space",defaultScale:x},paddingBottom:{property:"paddingBottom",scale:"space",defaultScale:x},paddingLeft:{property:"paddingLeft",scale:"space",defaultScale:x},paddingX:{properties:["paddingLeft","paddingRight"],scale:"space",defaultScale:x},paddingY:{properties:["paddingTop","paddingBottom"],scale:"space",defaultScale:x}},L.padding.p=L.padding.padding,L.padding.pt=L.padding.paddingTop,L.padding.pr=L.padding.paddingRight,L.padding.pb=L.padding.paddingBottom,L.padding.pl=L.padding.paddingLeft,L.padding.px=L.padding.paddingX,L.padding.py=L.padding.paddingY;var F=g(m(L.margin),m(L.padding));function B(){return(B=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}).apply(this,arguments)}m({boxShadow:{property:"boxShadow",scale:"shadows"},textShadow:{property:"textShadow",scale:"shadows"}});var N=function(e,t,i,n,r){for(n=0,t=t&&t.split?t.split("."):[t];n<t.length;n++)e=e?e[t[n]]:r;return e===r?i:e},V=[40,52,64].map(function(e){return e+"em"}),U={space:[0,4,8,16,32,64,128,256,512],fontSizes:[12,14,16,20,24,32,48,64,72]},z={bg:"backgroundColor",m:"margin",mt:"marginTop",mr:"marginRight",mb:"marginBottom",ml:"marginLeft",mx:"marginX",my:"marginY",p:"padding",pt:"paddingTop",pr:"paddingRight",pb:"paddingBottom",pl:"paddingLeft",px:"paddingX",py:"paddingY"},j={marginX:["marginLeft","marginRight"],marginY:["marginTop","marginBottom"],paddingX:["paddingLeft","paddingRight"],paddingY:["paddingTop","paddingBottom"],size:["width","height"]},$={color:"colors",backgroundColor:"colors",borderColor:"colors",margin:"space",marginTop:"space",marginRight:"space",marginBottom:"space",marginLeft:"space",marginX:"space",marginY:"space",padding:"space",paddingTop:"space",paddingRight:"space",paddingBottom:"space",paddingLeft:"space",paddingX:"space",paddingY:"space",top:"space",right:"space",bottom:"space",left:"space",gridGap:"space",gridColumnGap:"space",gridRowGap:"space",gap:"space",columnGap:"space",rowGap:"space",fontFamily:"fonts",fontSize:"fontSizes",fontWeight:"fontWeights",lineHeight:"lineHeights",letterSpacing:"letterSpacings",border:"borders",borderTop:"borders",borderRight:"borders",borderBottom:"borders",borderLeft:"borders",borderWidth:"borderWidths",borderStyle:"borderStyles",borderRadius:"radii",borderTopRightRadius:"radii",borderTopLeftRadius:"radii",borderBottomRightRadius:"radii",borderBottomLeftRadius:"radii",borderTopWidth:"borderWidths",borderTopColor:"colors",borderTopStyle:"borderStyles",borderBottomWidth:"borderWidths",borderBottomColor:"colors",borderBottomStyle:"borderStyles",borderLeftWidth:"borderWidths",borderLeftColor:"colors",borderLeftStyle:"borderStyles",borderRightWidth:"borderWidths",borderRightColor:"colors",borderRightStyle:"borderStyles",outlineColor:"colors",boxShadow:"shadows",textShadow:"shadows",zIndex:"zIndices",width:"sizes",minWidth:"sizes",maxWidth:"sizes",height:"sizes",minHeight:"sizes",maxHeight:"sizes",flexBasis:"sizes",size:"sizes",fill:"colors",stroke:"colors"},W=function(e,t){if("number"!=typeof t||t>=0)return N(e,t,t);var i=Math.abs(t),n=N(e,i,i);return"string"==typeof n?"-"+n:-1*n},H=["margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","top","bottom","left","right"].reduce(function(e,t){var i;return B({},e,((i={})[t]=W,i))},{}),K=function(e){return function(t){var i={},n=[null].concat(N(t,"breakpoints",V).map(function(e){return"@media screen and (min-width: "+e+")"}));for(var r in e){var s="function"==typeof e[r]?e[r](t):e[r];if(null!=s){if(!Array.isArray(s)){i[r]=s;continue}for(var o=0;o<s.slice(0,n.length).length;o++){var a=n[o];if(!a){i[r]=s[o];continue}i[a]=i[a]||{},null!=s[o]&&(i[a][r]=s[o])}}}return i}},G=function e(t){return function(i){void 0===i&&(i={});var n=B({},U,{},i.theme||i),r={},s=K("function"==typeof t?t(n):t)(n);for(var o in s){var a=s[o],l="function"==typeof a?a(n):a;if("variant"===o){var d=e(N(n,l))(n);r=B({},r,{},d);continue}if(l&&"object"==typeof l){r[o]=e(l)(n);continue}var u=N(z,o,o),c=N($,u),h=N(n,c,N(n,u,{})),f=N(H,u,N)(h,l,l);if(j[u])for(var p=j[u],m=0;m<p.length;m++)r[p[m]]=f;else r[u]=f}return r}},q=function(e){var t,i,n=e.scale,r=e.prop,s=void 0===r?"variant":r,o=e.variants,a=void 0===o?{}:o,l=e.key;return(i=Object.keys(a).length?function(e,t,i){return G(u(t,e,null))(i.theme)}:function(e,t){return u(t,e,null)}).scale=n||l,i.defaults=a,c(((t={})[s]=i,t))};q({key:"buttons"}),q({key:"textStyles",prop:"textStyle"}),q({key:"colorStyles",prop:"colors"}),b.width,b.height,b.minWidth,b.minHeight,b.maxWidth,b.maxHeight,b.size,b.verticalAlign,b.display,b.overflow,b.overflowX,b.overflowY,y.opacity,w.fontSize,w.fontFamily,w.fontWeight,w.lineHeight,w.textAlign,w.fontStyle,w.letterSpacing,C.alignItems,C.alignContent,C.justifyItems,C.justifyContent,C.flexWrap,C.flexDirection,C.flex,C.flexGrow,C.flexShrink,C.flexBasis,C.justifySelf,C.alignSelf,C.order,T.gridGap,T.gridColumnGap,T.gridRowGap,T.gridColumn,T.gridRow,T.gridAutoFlow,T.gridAutoColumns,T.gridAutoRows,T.gridTemplateColumns,T.gridTemplateRows,T.gridTemplateAreas,T.gridArea,E.borderWidth,E.borderStyle,E.borderColor,E.borderTop,E.borderRight,E.borderBottom,E.borderLeft,E.borderRadius,I.backgroundImage,I.backgroundSize,I.backgroundPosition,I.backgroundRepeat,R.zIndex,R.top,R.right,R.bottom,R.left},25825:function(e,t,i){"use strict";i.r(t),i.d(t,{__assign:function(){return s},__asyncDelegator:function(){return y},__asyncGenerator:function(){return S},__asyncValues:function(){return w},__await:function(){return b},__awaiter:function(){return u},__classPrivateFieldGet:function(){return T},__classPrivateFieldSet:function(){return P},__createBinding:function(){return h},__decorate:function(){return a},__exportStar:function(){return f},__extends:function(){return r},__generator:function(){return c},__importDefault:function(){return k},__importStar:function(){return _},__makeTemplateObject:function(){return C},__metadata:function(){return d},__param:function(){return l},__read:function(){return m},__rest:function(){return o},__spread:function(){return g},__spreadArrays:function(){return v},__values:function(){return p}});/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var n=function(e,t){return(n=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)};function r(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}var s=function(){return(s=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function o(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(e);r<n.length;r++)0>t.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]]);return i}function a(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o}function l(e,t){return function(i,n){t(i,n,e)}}function d(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function u(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})}function c(e,t){var i,n,r,s,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(e){return function(t){return l([e,t])}}function l(s){if(i)throw TypeError("Generator is already executing.");for(;o;)try{if(i=1,n&&(r=2&s[0]?n.return:s[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,s[1])).done)return r;switch(n=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],n=0}finally{i=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}function h(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}function f(e,t){for(var i in e)"default"===i||t.hasOwnProperty(i)||(t[i]=e[i])}function p(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],n=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function m(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var n,r,s=i.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(e){r={error:e}}finally{try{n&&!n.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}return o}function g(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(m(arguments[t]));return e}function v(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;for(var n=Array(e),r=0,t=0;t<i;t++)for(var s=arguments[t],o=0,a=s.length;o<a;o++,r++)n[r]=s[o];return n}function b(e){return this instanceof b?(this.v=e,this):new b(e)}function S(e,t,i){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var n,r=i.apply(e,t||[]),s=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(e){r[e]&&(n[e]=function(t){return new Promise(function(i,n){s.push([e,t,i,n])>1||a(e,t)})})}function a(e,t){try{l(r[e](t))}catch(e){c(s[0][3],e)}}function l(e){e.value instanceof b?Promise.resolve(e.value.v).then(d,u):c(s[0][2],e)}function d(e){a("next",e)}function u(e){a("throw",e)}function c(e,t){e(t),s.shift(),s.length&&a(s[0][0],s[0][1])}}function y(e){var t,i;return t={},n("next"),n("throw",function(e){throw e}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,r){t[n]=e[n]?function(t){return(i=!i)?{value:b(e[n](t)),done:"return"===n}:r?r(t):t}:r}}function w(e){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var t,i=e[Symbol.asyncIterator];return i?i.call(e):(e=p(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(i){t[i]=e[i]&&function(t){return new Promise(function(n,s){r(n,s,(t=e[i](t)).done,t.value)})}}function r(e,t,i,n){Promise.resolve(n).then(function(t){e({value:t,done:i})},t)}}function C(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function _(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function k(e){return e&&e.__esModule?e:{default:e}}function T(e,t){if(!t.has(e))throw TypeError("attempted to get private field on non-instance");return t.get(e)}function P(e,t,i){if(!t.has(e))throw TypeError("attempted to set private field on non-instance");return t.set(e,i),i}},26088:function(e,t,i){var n;!function(r,s){"use strict";var o="1.0.37",a="",l="?",d="function",u="undefined",c="object",h="string",f="major",p="model",m="name",g="type",v="vendor",b="version",S="architecture",y="console",w="mobile",C="tablet",_="smarttv",k="wearable",T="embedded",P=500,E="Amazon",M="Apple",I="ASUS",A="BlackBerry",R="Browser",x="Chrome",O="Firefox",D="Google",L="Huawei",F="LG",B="Microsoft",N="Motorola",V="Opera",U="Samsung",z="Sharp",j="Sony",$="Xiaomi",W="Zebra",H="Facebook",K="Chromium OS",G="Mac OS",q=function(e,t){var i={};for(var n in e)t[n]&&t[n].length%2==0?i[n]=t[n].concat(e[n]):i[n]=e[n];return i},Q=function(e){for(var t={},i=0;i<e.length;i++)t[e[i].toUpperCase()]=e[i];return t},Z=function(e,t){return typeof e===h&&-1!==Y(t).indexOf(Y(e))},Y=function(e){return e.toLowerCase()},J=function(e){return typeof e===h?e.replace(/[^\d\.]/g,a).split(".")[0]:void 0},X=function(e,t){if(typeof e===h)return e=e.replace(/^\s\s*/,a),typeof t===u?e:e.substring(0,P)},ee=function(e,t){for(var i,n,r,o,a,l,u=0;u<t.length&&!a;){var h=t[u],f=t[u+1];for(i=n=0;i<h.length&&!a&&h[i];)if(a=h[i++].exec(e))for(r=0;r<f.length;r++)l=a[++n],typeof(o=f[r])===c&&o.length>0?2===o.length?typeof o[1]==d?this[o[0]]=o[1].call(this,l):this[o[0]]=o[1]:3===o.length?typeof o[1]!==d||o[1].exec&&o[1].test?this[o[0]]=l?l.replace(o[1],o[2]):void 0:this[o[0]]=l?o[1].call(this,l,o[2]):void 0:4===o.length&&(this[o[0]]=l?o[3].call(this,l.replace(o[1],o[2])):s):this[o]=l||s;u+=2}},et=function(e,t){for(var i in t)if(typeof t[i]===c&&t[i].length>0){for(var n=0;n<t[i].length;n++)if(Z(t[i][n],e))return i===l?s:i}else if(Z(t[i],e))return i===l?s:i;return e},ei={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2","8.1":"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},en={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[b,[m,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[b,[m,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[m,b],[/opios[\/ ]+([\w\.]+)/i],[b,[m,V+" Mini"]],[/\bopr\/([\w\.]+)/i],[b,[m,V]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[b,[m,"Baidu"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim)\s?(?:browser)?[\/ ]?([\w\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(heytap|ovi)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[m,b],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[b,[m,"UC"+R]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[b,[m,"WeChat"]],[/konqueror\/([\w\.]+)/i],[b,[m,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[b,[m,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[b,[m,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[b,[m,"Smart Lenovo "+R]],[/(avast|avg)\/([\w\.]+)/i],[[m,/(.+)/,"$1 Secure "+R],b],[/\bfocus\/([\w\.]+)/i],[b,[m,O+" Focus"]],[/\bopt\/([\w\.]+)/i],[b,[m,V+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[b,[m,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[b,[m,"Dolphin"]],[/coast\/([\w\.]+)/i],[b,[m,V+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[b,[m,"MIUI "+R]],[/fxios\/([-\w\.]+)/i],[b,[m,O]],[/\bqihu|(qi?ho?o?|360)browser/i],[[m,"360 "+R]],[/(oculus|sailfish|huawei|vivo)browser\/([\w\.]+)/i],[[m,/(.+)/,"$1 "+R],b],[/samsungbrowser\/([\w\.]+)/i],[b,[m,U+" Internet"]],[/(comodo_dragon)\/([\w\.]+)/i],[[m,/_/g," "],b],[/metasr[\/ ]?([\d\.]+)/i],[b,[m,"Sogou Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[m,"Sogou Mobile"],b],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345Explorer)[\/ ]?([\w\.]+)/i],[m,b],[/(lbbrowser)/i,/\[(linkedin)app\]/i],[m],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[m,H],b],[/(Klarna)\/([\w\.]+)/i,/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(chromium|instagram|snapchat)[\/ ]([-\w\.]+)/i],[m,b],[/\bgsa\/([\w\.]+) .*safari\//i],[b,[m,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[b,[m,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[b,[m,x+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[m,x+" WebView"],b],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[b,[m,"Android "+R]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[m,b],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[b,[m,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[b,m],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[m,[b,et,{"1.0":"/8","1.2":"/1","1.3":"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[m,b],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[m,"Netscape"],b],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[b,[m,O+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[m,b],[/(cobalt)\/([\w\.]+)/i],[m,[b,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[S,"amd64"]],[/(ia32(?=;))/i],[[S,Y]],[/((?:i[346]|x)86)[;\)]/i],[[S,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[S,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[S,"armhf"]],[/windows (ce|mobile); ppc;/i],[[S,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[S,/ower/,a,Y]],[/(sun4\w)[;\)]/i],[[S,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[S,Y]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[p,[v,U],[g,C]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[p,[v,U],[g,w]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[p,[v,M],[g,w]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[p,[v,M],[g,C]],[/(macintosh);/i],[p,[v,M]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[p,[v,z],[g,w]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[p,[v,L],[g,C]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[p,[v,L],[g,w]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/oid[^\)]+; (m?[12][0-389][01]\w{3,6}[c-y])( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[p,/_/g," "],[v,$],[g,w]],[/oid[^\)]+; (2\d{4}(283|rpbf)[cgl])( bui|\))/i,/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[p,/_/g," "],[v,$],[g,C]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[p,[v,"OPPO"],[g,w]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[p,[v,"Vivo"],[g,w]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[p,[v,"Realme"],[g,w]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[p,[v,N],[g,w]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[p,[v,N],[g,C]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[p,[v,F],[g,C]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[p,[v,F],[g,w]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[p,[v,"Lenovo"],[g,C]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[p,/_/g," "],[v,"Nokia"],[g,w]],[/(pixel c)\b/i],[p,[v,D],[g,C]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[p,[v,D],[g,w]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[p,[v,j],[g,w]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[p,"Xperia Tablet"],[v,j],[g,C]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[p,[v,"OnePlus"],[g,w]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[p,[v,E],[g,C]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[p,/(.+)/g,"Fire Phone $1"],[v,E],[g,w]],[/(playbook);[-\w\),; ]+(rim)/i],[p,v,[g,C]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[p,[v,A],[g,w]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[p,[v,I],[g,C]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[p,[v,I],[g,w]],[/(nexus 9)/i],[p,[v,"HTC"],[g,C]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[v,[p,/_/g," "],[g,w]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[p,[v,"Acer"],[g,C]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[p,[v,"Meizu"],[g,w]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[p,[v,"Ulefone"],[g,w]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron|infinix|tecno)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[v,p,[g,w]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[v,p,[g,C]],[/(surface duo)/i],[p,[v,B],[g,C]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[p,[v,"Fairphone"],[g,w]],[/(u304aa)/i],[p,[v,"AT&T"],[g,w]],[/\bsie-(\w*)/i],[p,[v,"Siemens"],[g,w]],[/\b(rct\w+) b/i],[p,[v,"RCA"],[g,C]],[/\b(venue[\d ]{2,7}) b/i],[p,[v,"Dell"],[g,C]],[/\b(q(?:mv|ta)\w+) b/i],[p,[v,"Verizon"],[g,C]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[p,[v,"Barnes & Noble"],[g,C]],[/\b(tm\d{3}\w+) b/i],[p,[v,"NuVision"],[g,C]],[/\b(k88) b/i],[p,[v,"ZTE"],[g,C]],[/\b(nx\d{3}j) b/i],[p,[v,"ZTE"],[g,w]],[/\b(gen\d{3}) b.+49h/i],[p,[v,"Swiss"],[g,w]],[/\b(zur\d{3}) b/i],[p,[v,"Swiss"],[g,C]],[/\b((zeki)?tb.*\b) b/i],[p,[v,"Zeki"],[g,C]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[v,"Dragon Touch"],p,[g,C]],[/\b(ns-?\w{0,9}) b/i],[p,[v,"Insignia"],[g,C]],[/\b((nxa|next)-?\w{0,9}) b/i],[p,[v,"NextBook"],[g,C]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[v,"Voice"],p,[g,w]],[/\b(lvtel\-)?(v1[12]) b/i],[[v,"LvTel"],p,[g,w]],[/\b(ph-1) /i],[p,[v,"Essential"],[g,w]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[p,[v,"Envizen"],[g,C]],[/\b(trio[-\w\. ]+) b/i],[p,[v,"MachSpeed"],[g,C]],[/\btu_(1491) b/i],[p,[v,"Rotor"],[g,C]],[/(shield[\w ]+) b/i],[p,[v,"Nvidia"],[g,C]],[/(sprint) (\w+)/i],[v,p,[g,w]],[/(kin\.[onetw]{3})/i],[[p,/\./g," "],[v,B],[g,w]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[p,[v,W],[g,C]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[p,[v,W],[g,w]],[/smart-tv.+(samsung)/i],[v,[g,_]],[/hbbtv.+maple;(\d+)/i],[[p,/^/,"SmartTV"],[v,U],[g,_]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[v,F],[g,_]],[/(apple) ?tv/i],[v,[p,M+" TV"],[g,_]],[/crkey/i],[[p,x+"cast"],[v,D],[g,_]],[/droid.+aft(\w+)( bui|\))/i],[p,[v,E],[g,_]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[p,[v,z],[g,_]],[/(bravia[\w ]+)( bui|\))/i],[p,[v,j],[g,_]],[/(mitv-\w{5}) bui/i],[p,[v,$],[g,_]],[/Hbbtv.*(technisat) (.*);/i],[v,p,[g,_]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[v,X],[p,X],[g,_]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[g,_]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[v,p,[g,y]],[/droid.+; (shield) bui/i],[p,[v,"Nvidia"],[g,y]],[/(playstation [345portablevi]+)/i],[p,[v,j],[g,y]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[p,[v,B],[g,y]],[/((pebble))app/i],[v,p,[g,k]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[p,[v,M],[g,k]],[/droid.+; (glass) \d/i],[p,[v,D],[g,k]],[/droid.+; (wt63?0{2,3})\)/i],[p,[v,W],[g,k]],[/(quest( 2| pro)?)/i],[p,[v,H],[g,k]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[v,[g,T]],[/(aeobc)\b/i],[p,[v,E],[g,T]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew).+? mobile safari/i],[p,[g,w]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[p,[g,C]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[g,C]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[g,w]],[/(android[-\w\. ]{0,9});.+buil/i],[p,[v,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[b,[m,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[b,[m,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[m,b],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[b,m]],os:[[/microsoft (windows) (vista|xp)/i],[m,b],[/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i],[m,[b,et,ei]],[/windows nt 6\.2; (arm)/i,/windows[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i,/(?:win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[b,et,ei],[m,"Windows"]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[b,/_/g,"."],[m,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[m,G],[b,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[b,m],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[m,b],[/\(bb(10);/i],[b,[m,A]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[b,[m,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[b,[m,O+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[b,[m,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[b,[m,"watchOS"]],[/crkey\/([\d\.]+)/i],[b,[m,x+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[m,K],b],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[m,b],[/(sunos) ?([\w\.\d]*)/i],[[m,"Solaris"],b],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[m,b]]},er=function(e,t){if(typeof e===c&&(t=e,e=s),!(this instanceof er))return new er(e,t).getResult();var i=typeof r!==u&&r.navigator?r.navigator:s,n=e||(i&&i.userAgent?i.userAgent:a),o=i&&i.userAgentData?i.userAgentData:s,l=t?q(en,t):en,y=i&&i.userAgent==n;return this.getBrowser=function(){var e={};return e[m]=s,e[b]=s,ee.call(e,n,l.browser),e[f]=J(e[b]),y&&i&&i.brave&&typeof i.brave.isBrave==d&&(e[m]="Brave"),e},this.getCPU=function(){var e={};return e[S]=s,ee.call(e,n,l.cpu),e},this.getDevice=function(){var e={};return e[v]=s,e[p]=s,e[g]=s,ee.call(e,n,l.device),y&&!e[g]&&o&&o.mobile&&(e[g]=w),y&&"Macintosh"==e[p]&&i&&typeof i.standalone!==u&&i.maxTouchPoints&&i.maxTouchPoints>2&&(e[p]="iPad",e[g]=C),e},this.getEngine=function(){var e={};return e[m]=s,e[b]=s,ee.call(e,n,l.engine),e},this.getOS=function(){var e={};return e[m]=s,e[b]=s,ee.call(e,n,l.os),y&&!e[m]&&o&&"Unknown"!=o.platform&&(e[m]=o.platform.replace(/chrome os/i,K).replace(/macos/i,G)),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return n},this.setUA=function(e){return n=typeof e===h&&e.length>P?X(e,P):e,this},this.setUA(n),this};er.VERSION=o,er.BROWSER=Q([m,b,f]),er.CPU=Q([S]),er.DEVICE=Q([p,v,g,y,w,_,C,k,T]),er.ENGINE=er.OS=Q([m,b]),typeof t!==u?("object"!==u&&e.exports&&(t=e.exports=er),t.UAParser=er):"function"===d&&i.amdO?s!==(n=(function(){return er}).call(t,i,t,e))&&(e.exports=n):typeof r!==u&&(r.UAParser=er);var es=typeof r!==u&&(r.jQuery||r.Zepto);if(es&&!es.ua){var eo=new er;es.ua=eo.getResult(),es.ua.get=function(){return eo.getUA()},es.ua.set=function(e){eo.setUA(e);var t=eo.getResult();for(var i in t)es.ua[i]=t[i]}}}("object"==typeof window?window:this)},25566:function(e){var t,i,n,r=e.exports={};function s(){throw Error("setTimeout has not been defined")}function o(){throw Error("clearTimeout has not been defined")}function a(e){if(t===setTimeout)return setTimeout(e,0);if((t===s||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(i){try{return t.call(null,e,0)}catch(i){return t.call(this,e,0)}}}function l(e){if(i===clearTimeout)return clearTimeout(e);if((i===o||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{return i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:s}catch(e){t=s}try{i="function"==typeof clearTimeout?clearTimeout:o}catch(e){i=o}}();var d=[],u=!1,c=-1;function h(){u&&n&&(u=!1,n.length?d=n.concat(d):c=-1,d.length&&f())}function f(){if(!u){var e=a(h);u=!0;for(var t=d.length;t;){for(n=d,d=[];++c<t;)n&&n[c].run();c=-1,t=d.length}n=null,u=!1,l(e)}}function p(e,t){this.fun=e,this.array=t}function m(){}r.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)t[i-1]=arguments[i];d.push(new p(e,t)),1!==d.length||u||a(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=m,r.addListener=m,r.once=m,r.off=m,r.removeListener=m,r.removeAllListeners=m,r.emit=m,r.prependListener=m,r.prependOnceListener=m,r.listeners=function(e){return[]},r.binding=function(e){throw Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw Error("process.chdir is not supported")},r.umask=function(){return 0}},40772:function(e,t,i){"use strict";let n,r,s;i.d(t,{u:function(){return q}});var o=i(2265);let a=new Set,l=new WeakMap,d=new WeakMap,u=new WeakMap,c=new WeakMap,h=new WeakMap,f=new WeakMap,p=new WeakMap,m=new WeakSet,g=0,v=0,b="__aa_tgt",S="__aa_del",y="__aa_new",w=e=>{let t=M(e);t&&t.forEach(e=>A(e))},C=e=>{e.forEach(e=>{e.target===n&&T(),l.has(e.target)&&k(e.target)})};function _(e){let t=c.get(e);null==t||t.disconnect();let i=l.get(e),r=0,s=5;i||(i=O(e),l.set(e,i));let{offsetWidth:o,offsetHeight:a}=n,d=[i.top-s,o-(i.left+s+i.width),a-(i.top+s+i.height),i.left-s].map(e=>`${-1*Math.floor(e)}px`).join(" "),u=new IntersectionObserver(()=>{++r>1&&k(e)},{root:n,threshold:1,rootMargin:d});u.observe(e),c.set(e,u)}function k(e){clearTimeout(p.get(e));let t=L(e),i=U(t)?500:t.duration;p.set(e,setTimeout(async()=>{let t=u.get(e);try{await (null==t?void 0:t.finished),l.set(e,O(e)),_(e)}catch{}},i))}function T(){clearTimeout(p.get(n)),p.set(n,setTimeout(()=>{a.forEach(e=>N(e,e=>E(()=>k(e))))},100))}function P(e){setTimeout(()=>{h.set(e,setInterval(()=>E(k.bind(null,e)),2e3))},Math.round(2e3*Math.random()))}function E(e){"function"==typeof requestIdleCallback?requestIdleCallback(()=>e()):requestAnimationFrame(()=>e())}function M(e){return!e.reduce((e,t)=>[...e,...Array.from(t.addedNodes),...Array.from(t.removedNodes)],[]).every(e=>"#comment"===e.nodeName)&&e.reduce((e,t)=>{if(!1===e)return!1;if(t.target instanceof Element){if(I(t.target),!e.has(t.target)){e.add(t.target);for(let i=0;i<t.target.children.length;i++){let n=t.target.children.item(i);if(n){if(S in n)return!1;I(t.target,n),e.add(n)}}}if(t.removedNodes.length)for(let i=0;i<t.removedNodes.length;i++){let n=t.removedNodes[i];if(S in n)return!1;n instanceof Element&&(e.add(n),I(t.target,n),d.set(n,[t.previousSibling,t.nextSibling]))}}return e},new Set)}function I(e,t){t||b in e?!t||b in t||Object.defineProperty(t,b,{value:e}):Object.defineProperty(e,b,{value:e})}function A(e){var t;let i=e.isConnected,n=l.has(e);i&&d.has(e)&&d.delete(e),u.has(e)&&(null===(t=u.get(e))||void 0===t||t.cancel()),y in e?j(e):n&&i?z(e):n&&!i?W(e):j(e)}function R(e){return Number(e.replace(/[^0-9.\-]/g,""))}function x(e){let t=e.parentElement;for(;t;){if(t.scrollLeft||t.scrollTop)return{x:t.scrollLeft,y:t.scrollTop};t=t.parentElement}return{x:0,y:0}}function O(e){let t=e.getBoundingClientRect(),{x:i,y:n}=x(e);return{top:t.top+n,left:t.left+i,width:t.width,height:t.height}}function D(e,t,i){let n=t.width,r=t.height,s=i.width,o=i.height,a=getComputedStyle(e);if("content-box"===a.getPropertyValue("box-sizing")){let e=R(a.paddingTop)+R(a.paddingBottom)+R(a.borderTopWidth)+R(a.borderBottomWidth),t=R(a.paddingLeft)+R(a.paddingRight)+R(a.borderRightWidth)+R(a.borderLeftWidth);n-=t,s-=t,r-=e,o-=e}return[n,s,r,o].map(Math.round)}function L(e){return b in e&&f.has(e[b])?f.get(e[b]):{duration:250,easing:"ease-in-out"}}function F(e){if(b in e)return e[b]}function B(e){let t=F(e);return!!t&&m.has(t)}function N(e,...t){t.forEach(t=>t(e,f.has(e)));for(let i=0;i<e.children.length;i++){let n=e.children.item(i);n&&t.forEach(e=>e(n,f.has(n)))}}function V(e){return Array.isArray(e)?e:[e]}function U(e){return"function"==typeof e}function z(e){let t;let i=l.get(e),n=O(e);if(!B(e))return l.set(e,n);if(!i)return;let r=L(e);if("function"!=typeof r){let s=i.left-n.left,o=i.top-n.top,[a,l,d,u]=D(e,i,n),c={transform:`translate(${s}px, ${o}px)`},h={transform:"translate(0, 0)"};a!==l&&(c.width=`${a}px`,h.width=`${l}px`),d!==u&&(c.height=`${d}px`,h.height=`${u}px`),t=e.animate([c,h],{duration:r.duration,easing:r.easing})}else{let[s]=V(r(e,"remain",i,n));(t=new Animation(s)).play()}u.set(e,t),l.set(e,n),t.addEventListener("finish",k.bind(null,e))}function j(e){let t;y in e&&delete e[y];let i=O(e);l.set(e,i);let n=L(e);if(B(e)){if("function"!=typeof n)t=e.animate([{transform:"scale(.98)",opacity:0},{transform:"scale(0.98)",opacity:0,offset:.5},{transform:"scale(1)",opacity:1}],{duration:1.5*n.duration,easing:"ease-in"});else{let[r]=V(n(e,"add",i));(t=new Animation(r)).play()}u.set(e,t),t.addEventListener("finish",k.bind(null,e))}}function $(e,t){var i;e.remove(),l.delete(e),d.delete(e),u.delete(e),null===(i=c.get(e))||void 0===i||i.disconnect(),setTimeout(()=>{if(S in e&&delete e[S],Object.defineProperty(e,y,{value:!0,configurable:!0}),t&&e instanceof HTMLElement)for(let i in t)e.style[i]=""},0)}function W(e){var t;let i;if(!d.has(e)||!l.has(e))return;let[n,r]=d.get(e);Object.defineProperty(e,S,{value:!0,configurable:!0});let s=window.scrollX,o=window.scrollY;if(r&&r.parentNode&&r.parentNode instanceof Element?r.parentNode.insertBefore(e,r):n&&n.parentNode?n.parentNode.appendChild(e):null===(t=F(e))||void 0===t||t.appendChild(e),!B(e))return $(e);let[a,c,h,f]=K(e),p=L(e),m=l.get(e);(s!==g||o!==v)&&H(e,s,o,p);let b={position:"absolute",top:`${a}px`,left:`${c}px`,width:`${h}px`,height:`${f}px`,margin:"0",pointerEvents:"none",transformOrigin:"center",zIndex:"100"};if(U(p)){let[t,n]=V(p(e,"remove",m));(null==n?void 0:n.styleReset)!==!1&&(b=(null==n?void 0:n.styleReset)||b,Object.assign(e.style,b)),(i=new Animation(t)).play()}else Object.assign(e.style,b),i=e.animate([{transform:"scale(1)",opacity:1},{transform:"scale(.98)",opacity:0}],{duration:p.duration,easing:"ease-out"});u.set(e,i),i.addEventListener("finish",$.bind(null,e,b))}function H(e,t,i,r){let s=g-t,o=v-i,a=document.documentElement.style.scrollBehavior;if("smooth"===getComputedStyle(n).scrollBehavior&&(document.documentElement.style.scrollBehavior="auto"),window.scrollTo(window.scrollX+s,window.scrollY+o),!e.parentElement)return;let l=e.parentElement,d=l.clientHeight,u=l.clientWidth,c=performance.now();function h(){requestAnimationFrame(()=>{if(!U(r)){let e=d-l.clientHeight,t=u-l.clientWidth;c+r.duration>performance.now()?(window.scrollTo({left:window.scrollX-t,top:window.scrollY-e}),d=l.clientHeight,u=l.clientWidth,h()):document.documentElement.style.scrollBehavior=a}})}h()}function K(e){let t=l.get(e),[i,,n]=D(e,t,O(e)),r=e.parentElement;for(;r&&("static"===getComputedStyle(r).position||r instanceof HTMLBodyElement);)r=r.parentElement;r||(r=document.body);let s=getComputedStyle(r),o=l.get(r)||O(r);return[Math.round(t.top-o.top)-R(s.borderTopWidth),Math.round(t.left-o.left)-R(s.borderLeftWidth),i,n]}function G(e,t={}){return r&&s&&!(window.matchMedia("(prefers-reduced-motion: reduce)").matches&&!U(t)&&!t.disrespectUserMotionPreference)&&(m.add(e),"static"===getComputedStyle(e).position&&Object.assign(e.style,{position:"relative"}),N(e,k,P,e=>null==s?void 0:s.observe(e)),U(t)?f.set(e,t):f.set(e,{duration:250,easing:"ease-in-out",...t}),r.observe(e,{childList:!0}),a.add(e)),Object.freeze({parent:e,enable:()=>{m.add(e)},disable:()=>{m.delete(e)},isEnabled:()=>m.has(e)})}function q(e){let[t,i]=(0,o.useState)(),n=(0,o.useMemo)(()=>e,[]);return[(0,o.useCallback)(e=>{e instanceof HTMLElement?i(G(e,n)):i(void 0)},[n]),(0,o.useCallback)(e=>{t&&(e?t.enable():t.disable())},[t])]}"undefined"!=typeof window&&"ResizeObserver"in window&&(n=document.documentElement,r=new MutationObserver(w),s=new ResizeObserver(C),window.addEventListener("scroll",()=>{v=window.scrollY,g=window.scrollX}),s.observe(n))},48474:function(e,t,i){"use strict";i.d(t,{OH:function(){return l},q:function(){return ij},LI:function(){return eZ},q_:function(){return ib},Yz:function(){return iS}});var n,r,s,o=i(2265),a=Object.defineProperty,l={};((e,t)=>{for(var i in t)a(e,i,{get:t[i],enumerable:!0})})(l,{assign:()=>z,colors:()=>N,createStringInterpolator:()=>n,skipAnimation:()=>V,to:()=>r,willAdvance:()=>U});var d=P(),u=e=>w(e,d),c=P();u.write=e=>w(e,c);var h=P();u.onStart=e=>w(e,h);var f=P();u.onFrame=e=>w(e,f);var p=P();u.onFinish=e=>w(e,p);var m=[];u.setTimeout=(e,t)=>{let i=u.now()+t,n=()=>{let e=m.findIndex(e=>e.cancel==n);~e&&m.splice(e,1),S-=~e?1:0},r={time:i,handler:e,cancel:n};return m.splice(g(i),0,r),S+=1,C(),r};var g=e=>~(~m.findIndex(t=>t.time>e)||~m.length);u.cancel=e=>{h.delete(e),f.delete(e),p.delete(e),d.delete(e),c.delete(e)},u.sync=e=>{y=!0,u.batchedUpdates(e),y=!1},u.throttle=e=>{let t;function i(){try{e(...t)}finally{t=null}}function n(...e){t=e,u.onStart(i)}return n.handler=e,n.cancel=()=>{h.delete(i),t=null},n};var v="undefined"!=typeof window?window.requestAnimationFrame:()=>{};u.use=e=>v=e,u.now="undefined"!=typeof performance?()=>performance.now():Date.now,u.batchedUpdates=e=>e(),u.catch=console.error,u.frameLoop="always",u.advance=()=>{"demand"!==u.frameLoop?console.warn("Cannot call the manual advancement of rafz whilst frameLoop is not set as demand"):T()};var b=-1,S=0,y=!1;function w(e,t){y?(t.delete(e),e(0)):(t.add(e),C())}function C(){b<0&&(b=0,"demand"!==u.frameLoop&&v(k))}function _(){b=-1}function k(){~b&&(v(k),u.batchedUpdates(T))}function T(){let e=b,t=g(b=u.now());if(t&&(E(m.splice(0,t),e=>e.handler()),S-=t),!S){_();return}h.flush(),d.flush(e?Math.min(64,b-e):16.667),f.flush(),c.flush(),p.flush()}function P(){let e=new Set,t=e;return{add(i){S+=t!=e||e.has(i)?0:1,e.add(i)},delete:i=>(S-=t==e&&e.has(i)?1:0,e.delete(i)),flush(i){t.size&&(e=new Set,S-=t.size,E(t,t=>t(i)&&e.add(t)),S+=e.size,t=e)}}}function E(e,t){e.forEach(e=>{try{t(e)}catch(e){u.catch(e)}})}function M(){}var I=(e,t,i)=>Object.defineProperty(e,t,{value:i,writable:!0,configurable:!0}),A={arr:Array.isArray,obj:e=>!!e&&"Object"===e.constructor.name,fun:e=>"function"==typeof e,str:e=>"string"==typeof e,num:e=>"number"==typeof e,und:e=>void 0===e};function R(e,t){if(A.arr(e)){if(!A.arr(t)||e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0}return e===t}var x=(e,t)=>e.forEach(t);function O(e,t,i){if(A.arr(e)){for(let n=0;n<e.length;n++)t.call(i,e[n],`${n}`);return}for(let n in e)e.hasOwnProperty(n)&&t.call(i,e[n],n)}var D=e=>A.und(e)?[]:A.arr(e)?e:[e];function L(e,t){if(e.size){let i=Array.from(e);e.clear(),x(i,t)}}var F=(e,...t)=>L(e,e=>e(...t)),B=()=>"undefined"==typeof window||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),N=null,V=!1,U=M,z=e=>{e.to&&(r=e.to),e.now&&(u.now=e.now),void 0!==e.colors&&(N=e.colors),null!=e.skipAnimation&&(V=e.skipAnimation),e.createStringInterpolator&&(n=e.createStringInterpolator),e.requestAnimationFrame&&u.use(e.requestAnimationFrame),e.batchedUpdates&&(u.batchedUpdates=e.batchedUpdates),e.willAdvance&&(U=e.willAdvance),e.frameLoop&&(u.frameLoop=e.frameLoop)},j=new Set,$=[],W=[],H=0,K={get idle(){return!j.size&&!$.length},start(e){H>e.priority?(j.add(e),u.onStart(G)):(q(e),u(Z))},advance:Z,sort(e){if(H)u.onFrame(()=>K.sort(e));else{let t=$.indexOf(e);~t&&($.splice(t,1),Q(e))}},clear(){$=[],j.clear()}};function G(){j.forEach(q),j.clear(),u(Z)}function q(e){$.includes(e)||Q(e)}function Q(e){$.splice(Y($,t=>t.priority>e.priority),0,e)}function Z(e){let t=W;for(let i=0;i<$.length;i++){let n=$[i];H=n.priority,n.idle||(U(n),n.advance(e),n.idle||t.push(n))}return H=0,(W=$).length=0,($=t).length>0}function Y(e,t){let i=e.findIndex(t);return i<0?e.length:i}var J={transparent:0,aliceblue:4042850303,antiquewhite:4209760255,aqua:16777215,aquamarine:2147472639,azure:4043309055,beige:4126530815,bisque:4293182719,black:255,blanchedalmond:4293643775,blue:65535,blueviolet:2318131967,brown:2771004159,burlywood:3736635391,burntsienna:3934150143,cadetblue:1604231423,chartreuse:2147418367,chocolate:3530104575,coral:4286533887,cornflowerblue:1687547391,cornsilk:4294499583,crimson:3692313855,cyan:16777215,darkblue:35839,darkcyan:9145343,darkgoldenrod:3095792639,darkgray:2846468607,darkgreen:6553855,darkgrey:2846468607,darkkhaki:3182914559,darkmagenta:2332068863,darkolivegreen:1433087999,darkorange:4287365375,darkorchid:2570243327,darkred:2332033279,darksalmon:3918953215,darkseagreen:2411499519,darkslateblue:1211993087,darkslategray:793726975,darkslategrey:793726975,darkturquoise:13554175,darkviolet:2483082239,deeppink:4279538687,deepskyblue:12582911,dimgray:1768516095,dimgrey:1768516095,dodgerblue:512819199,firebrick:2988581631,floralwhite:4294635775,forestgreen:579543807,fuchsia:4278255615,gainsboro:3705462015,ghostwhite:4177068031,gold:4292280575,goldenrod:3668254975,gray:2155905279,green:8388863,greenyellow:2919182335,grey:2155905279,honeydew:4043305215,hotpink:4285117695,indianred:3445382399,indigo:1258324735,ivory:4294963455,khaki:4041641215,lavender:3873897215,lavenderblush:4293981695,lawngreen:2096890111,lemonchiffon:4294626815,lightblue:2916673279,lightcoral:4034953471,lightcyan:3774873599,lightgoldenrodyellow:4210742015,lightgray:3553874943,lightgreen:2431553791,lightgrey:3553874943,lightpink:4290167295,lightsalmon:4288707327,lightseagreen:548580095,lightskyblue:2278488831,lightslategray:2005441023,lightslategrey:2005441023,lightsteelblue:2965692159,lightyellow:4294959359,lime:16711935,limegreen:852308735,linen:4210091775,magenta:4278255615,maroon:2147483903,mediumaquamarine:1724754687,mediumblue:52735,mediumorchid:3126187007,mediumpurple:2473647103,mediumseagreen:1018393087,mediumslateblue:2070474495,mediumspringgreen:16423679,mediumturquoise:1221709055,mediumvioletred:3340076543,midnightblue:421097727,mintcream:4127193855,mistyrose:4293190143,moccasin:4293178879,navajowhite:4292783615,navy:33023,oldlace:4260751103,olive:2155872511,olivedrab:1804477439,orange:4289003775,orangered:4282712319,orchid:3664828159,palegoldenrod:4008225535,palegreen:2566625535,paleturquoise:2951671551,palevioletred:3681588223,papayawhip:4293907967,peachpuff:4292524543,peru:3448061951,pink:4290825215,plum:3718307327,powderblue:2967529215,purple:2147516671,rebeccapurple:1714657791,red:4278190335,rosybrown:3163525119,royalblue:1097458175,saddlebrown:2336560127,salmon:4202722047,sandybrown:4104413439,seagreen:780883967,seashell:4294307583,sienna:2689740287,silver:3233857791,skyblue:2278484991,slateblue:1784335871,slategray:1887473919,slategrey:1887473919,snow:4294638335,springgreen:16744447,steelblue:1182971135,tan:3535047935,teal:8421631,thistle:3636451583,tomato:4284696575,turquoise:1088475391,violet:4001558271,wheat:4125012991,white:4294967295,whitesmoke:4126537215,yellow:4294902015,yellowgreen:2597139199},X="[-+]?\\d*\\.?\\d+",ee=X+"%";function et(...e){return"\\(\\s*("+e.join(")\\s*,\\s*(")+")\\s*\\)"}var ei=RegExp("rgb"+et(X,X,X)),en=RegExp("rgba"+et(X,X,X,X)),er=RegExp("hsl"+et(X,ee,ee)),es=RegExp("hsla"+et(X,ee,ee,X)),eo=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,ea=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,el=/^#([0-9a-fA-F]{6})$/,ed=/^#([0-9a-fA-F]{8})$/;function eu(e){let t;return"number"==typeof e?e>>>0===e&&e>=0&&e<=4294967295?e:null:(t=el.exec(e))?parseInt(t[1]+"ff",16)>>>0:N&&void 0!==N[e]?N[e]:(t=ei.exec(e))?(ef(t[1])<<24|ef(t[2])<<16|ef(t[3])<<8|255)>>>0:(t=en.exec(e))?(ef(t[1])<<24|ef(t[2])<<16|ef(t[3])<<8|em(t[4]))>>>0:(t=eo.exec(e))?parseInt(t[1]+t[1]+t[2]+t[2]+t[3]+t[3]+"ff",16)>>>0:(t=ed.exec(e))?parseInt(t[1],16)>>>0:(t=ea.exec(e))?parseInt(t[1]+t[1]+t[2]+t[2]+t[3]+t[3]+t[4]+t[4],16)>>>0:(t=er.exec(e))?(255|eh(ep(t[1]),eg(t[2]),eg(t[3])))>>>0:(t=es.exec(e))?(eh(ep(t[1]),eg(t[2]),eg(t[3]))|em(t[4]))>>>0:null}function ec(e,t,i){return(i<0&&(i+=1),i>1&&(i-=1),i<1/6)?e+(t-e)*6*i:i<.5?t:i<2/3?e+(t-e)*(2/3-i)*6:e}function eh(e,t,i){let n=i<.5?i*(1+t):i+t-i*t,r=2*i-n;return Math.round(255*ec(r,n,e+1/3))<<24|Math.round(255*ec(r,n,e))<<16|Math.round(255*ec(r,n,e-1/3))<<8}function ef(e){let t=parseInt(e,10);return t<0?0:t>255?255:t}function ep(e){return(parseFloat(e)%360+360)%360/360}function em(e){let t=parseFloat(e);return t<0?0:t>1?255:Math.round(255*t)}function eg(e){let t=parseFloat(e);return t<0?0:t>100?1:t/100}function ev(e){let t=eu(e);if(null===t)return e;let i=(4278190080&(t=t||0))>>>24,n=(16711680&t)>>>16,r=(65280&t)>>>8,s=(255&t)/255;return`rgba(${i}, ${n}, ${r}, ${s})`}var eb=(e,t,i)=>{if(A.fun(e))return e;if(A.arr(e))return eb({range:e,output:t,extrapolate:i});if(A.str(e.output[0]))return n(e);let r=e,s=r.output,o=r.range||[0,1],a=r.extrapolateLeft||r.extrapolate||"extend",l=r.extrapolateRight||r.extrapolate||"extend",d=r.easing||(e=>e);return e=>{let t=ey(e,o);return eS(e,o[t],o[t+1],s[t],s[t+1],d,a,l,r.map)}};function eS(e,t,i,n,r,s,o,a,l){let d=l?l(e):e;if(d<t){if("identity"===o)return d;"clamp"===o&&(d=t)}if(d>i){if("identity"===a)return d;"clamp"===a&&(d=i)}return n===r?n:t===i?e<=t?n:r:(t===-1/0?d=-d:i===1/0?d-=t:d=(d-t)/(i-t),d=s(d),n===-1/0?d=-d:r===1/0?d+=n:d=d*(r-n)+n,d)}function ey(e,t){for(var i=1;i<t.length-1&&!(t[i]>=e);++i);return i-1}var ew=e=>e,eC=Symbol.for("FluidValue.get"),e_=Symbol.for("FluidValue.observers"),ek=e=>!!(e&&e[eC]),eT=e=>e&&e[eC]?e[eC]():e,eP=e=>e[e_]||null;function eE(e,t){e.eventObserved?e.eventObserved(t):e(t)}function eM(e,t){let i=e[e_];i&&i.forEach(e=>{eE(e,t)})}var eI=class{constructor(e){if(!e&&!(e=this.get))throw Error("Unknown getter");eA(this,e)}},eA=(e,t)=>eO(e,eC,t);function eR(e,t){if(e[eC]){let i=e[e_];i||eO(e,e_,i=new Set),!i.has(t)&&(i.add(t),e.observerAdded&&e.observerAdded(i.size,t))}return t}function ex(e,t){let i=e[e_];if(i&&i.has(t)){let n=i.size-1;n?i.delete(t):e[e_]=null,e.observerRemoved&&e.observerRemoved(n,t)}}var eO=(e,t,i)=>Object.defineProperty(e,t,{value:i,writable:!0,configurable:!0}),eD=/[+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,eL=/(#(?:[0-9a-f]{2}){2,4}|(#[0-9a-f]{3})|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d\.]+%?\))/gi,eF=RegExp(`(${eD.source})(%|[a-z]+)`,"i"),eB=/rgba\(([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+)\)/gi,eN=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/,eV=e=>{let[t,i]=eU(e);if(!t||B())return e;let n=window.getComputedStyle(document.documentElement).getPropertyValue(t);if(n)return n.trim();if(i&&i.startsWith("--")){let e=window.getComputedStyle(document.documentElement).getPropertyValue(i);if(e)return e}else if(i&&eN.test(i))return eV(i);else if(i)return i;return e},eU=e=>{let t=eN.exec(e);if(!t)return[,];let[,i,n]=t;return[i,n]},ez=(e,t,i,n,r)=>`rgba(${Math.round(t)}, ${Math.round(i)}, ${Math.round(n)}, ${r})`,ej=e=>{s||(s=N?RegExp(`(${Object.keys(N).join("|")})(?!\\w)`,"g"):/^\b$/);let t=e.output.map(e=>eT(e).replace(eN,eV).replace(eL,ev).replace(s,ev)),i=t.map(e=>e.match(eD).map(Number)),n=i[0].map((e,t)=>i.map(e=>{if(!(t in e))throw Error('The arity of each "output" value must be equal');return e[t]})).map(t=>eb({...e,output:t}));return e=>{let i=!eF.test(t[0])&&t.find(e=>eF.test(e))?.replace(eD,""),r=0;return t[0].replace(eD,()=>`${n[r++](e)}${i||""}`).replace(eB,ez)}},e$="react-spring: ",eW=e=>{let t=e,i=!1;if("function"!=typeof t)throw TypeError(`${e$}once requires a function parameter`);return(...e)=>{i||(t(...e),i=!0)}},eH=eW(console.warn);function eK(){eH(`${e$}The "interpolate" function is deprecated in v9 (use "to" instead)`)}var eG=eW(console.warn);function eq(){eG(`${e$}Directly calling start instead of using the api object is deprecated in v9 (use ".start" instead), this will be removed in later 0.X.0 versions`)}function eQ(e){return A.str(e)&&("#"==e[0]||/\d/.test(e)||!B()&&eN.test(e)||e in(N||{}))}var eZ=B()?o.useEffect:o.useLayoutEffect,eY=()=>{let e=(0,o.useRef)(!1);return eZ(()=>(e.current=!0,()=>{e.current=!1}),[]),e};function eJ(){let e=(0,o.useState)()[1],t=eY();return()=>{t.current&&e(Math.random())}}function eX(e,t){let[i]=(0,o.useState)(()=>({inputs:t,result:e()})),n=(0,o.useRef)(),r=n.current,s=r;return s?t&&s.inputs&&e0(t,s.inputs)||(s={inputs:t,result:e()}):s=i,(0,o.useEffect)(()=>{n.current=s,r==i&&(i.inputs=i.result=void 0)},[s]),s.result}function e0(e,t){if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0}var e1=e=>(0,o.useEffect)(e,e2),e2=[];function e3(e){let t=(0,o.useRef)();return(0,o.useEffect)(()=>{t.current=e}),t.current}var e5=Symbol.for("Animated:node"),e4=e=>!!e&&e[e5]===e,e6=e=>e&&e[e5],e8=(e,t)=>I(e,e5,t),e9=e=>e&&e[e5]&&e[e5].getPayload(),e7=class{constructor(){e8(this,this)}getPayload(){return this.payload||[]}},te=class extends e7{constructor(e){super(),this._value=e,this.done=!0,this.durationProgress=0,A.num(this._value)&&(this.lastPosition=this._value)}static create(e){return new te(e)}getPayload(){return[this]}getValue(){return this._value}setValue(e,t){return A.num(e)&&(this.lastPosition=e,t&&(e=Math.round(e/t)*t,this.done&&(this.lastPosition=e))),this._value!==e&&(this._value=e,!0)}reset(){let{done:e}=this;this.done=!1,A.num(this._value)&&(this.elapsedTime=0,this.durationProgress=0,this.lastPosition=this._value,e&&(this.lastVelocity=null),this.v0=null)}},tt=class extends te{constructor(e){super(0),this._string=null,this._toString=eb({output:[e,e]})}static create(e){return new tt(e)}getValue(){let e=this._string;return null==e?this._string=this._toString(this._value):e}setValue(e){if(A.str(e)){if(e==this._string)return!1;this._string=e,this._value=1}else{if(!super.setValue(e))return!1;this._string=null}return!0}reset(e){e&&(this._toString=eb({output:[this.getValue(),e]})),this._value=0,super.reset()}},ti={dependencies:null},tn=class extends e7{constructor(e){super(),this.source=e,this.setValue(e)}getValue(e){let t={};return O(this.source,(i,n)=>{e4(i)?t[n]=i.getValue(e):ek(i)?t[n]=eT(i):e||(t[n]=i)}),t}setValue(e){this.source=e,this.payload=this._makePayload(e)}reset(){this.payload&&x(this.payload,e=>e.reset())}_makePayload(e){if(e){let t=new Set;return O(e,this._addToPayload,t),Array.from(t)}}_addToPayload(e){ti.dependencies&&ek(e)&&ti.dependencies.add(e);let t=e9(e);t&&x(t,e=>this.add(e))}},tr=class extends tn{constructor(e){super(e)}static create(e){return new tr(e)}getValue(){return this.source.map(e=>e.getValue())}setValue(e){let t=this.getPayload();return e.length==t.length?t.map((t,i)=>t.setValue(e[i])).some(Boolean):(super.setValue(e.map(ts)),!0)}};function ts(e){return(eQ(e)?tt:te).create(e)}function to(e){let t=e6(e);return t?t.constructor:A.arr(e)?tr:eQ(e)?tt:te}var ta=(e,t)=>{let i=!A.fun(e)||e.prototype&&e.prototype.isReactComponent;return(0,o.forwardRef)((n,r)=>{let s=(0,o.useRef)(null),a=i&&(0,o.useCallback)(e=>{s.current=tu(r,e)},[r]),[l,d]=td(n,t),c=eJ(),h=()=>{let e=s.current;(!i||e)&&!1===(!!e&&t.applyAnimatedValues(e,l.getValue(!0)))&&c()},f=new tl(h,d),p=(0,o.useRef)();eZ(()=>(p.current=f,x(d,e=>eR(e,f)),()=>{p.current&&(x(p.current.deps,e=>ex(e,p.current)),u.cancel(p.current.update))})),(0,o.useEffect)(h,[]),e1(()=>()=>{let e=p.current;x(e.deps,t=>ex(t,e))});let m=t.getComponentProps(l.getValue());return o.createElement(e,{...m,ref:a})})},tl=class{constructor(e,t){this.update=e,this.deps=t}eventObserved(e){"change"==e.type&&u.write(this.update)}};function td(e,t){let i=new Set;return ti.dependencies=i,e.style&&(e={...e,style:t.createAnimatedStyle(e.style)}),e=new tn(e),ti.dependencies=null,[e,i]}function tu(e,t){return e&&(A.fun(e)?e(t):e.current=t),t}var tc=Symbol.for("AnimatedComponent"),th=(e,{applyAnimatedValues:t=()=>!1,createAnimatedStyle:i=e=>new tn(e),getComponentProps:n=e=>e}={})=>{let r={applyAnimatedValues:t,createAnimatedStyle:i,getComponentProps:n},s=e=>{let t=tf(e)||"Anonymous";return(e=A.str(e)?s[e]||(s[e]=ta(e,r)):e[tc]||(e[tc]=ta(e,r))).displayName=`Animated(${t})`,e};return O(e,(t,i)=>{A.arr(e)&&(i=tf(t)),s[i]=s(t)}),{animated:s}},tf=e=>A.str(e)?e:e&&A.str(e.displayName)?e.displayName:A.fun(e)&&e.name||null;function tp(e,...t){return A.fun(e)?e(...t):e}var tm=(e,t)=>!0===e||!!(t&&e&&(A.fun(e)?e(t):D(e).includes(t))),tg=(e,t)=>A.obj(e)?t&&e[t]:e,tv=(e,t)=>!0===e.default?e[t]:e.default?e.default[t]:void 0,tb=e=>e,tS=(e,t=tb)=>{let i=ty;e.default&&!0!==e.default&&(i=Object.keys(e=e.default));let n={};for(let r of i){let i=t(e[r],r);A.und(i)||(n[r]=i)}return n},ty=["config","onProps","onStart","onChange","onPause","onResume","onRest"],tw={config:1,from:1,to:1,ref:1,loop:1,reset:1,pause:1,cancel:1,reverse:1,immediate:1,default:1,delay:1,onProps:1,onStart:1,onChange:1,onPause:1,onResume:1,onRest:1,onResolve:1,items:1,trail:1,sort:1,expires:1,initial:1,enter:1,update:1,leave:1,children:1,onDestroyed:1,keys:1,callId:1,parentId:1};function tC(e){let t={},i=0;if(O(e,(e,n)=>{!tw[n]&&(t[n]=e,i++)}),i)return t}function t_(e){let t=tC(e);if(t){let i={to:t};return O(e,(e,n)=>n in t||(i[n]=e)),i}return{...e}}function tk(e){return e=eT(e),A.arr(e)?e.map(tk):eQ(e)?l.createStringInterpolator({range:[0,1],output:[e,e]})(1):e}function tT(e){for(let t in e)return!0;return!1}function tP(e){return A.fun(e)||A.arr(e)&&A.obj(e[0])}function tE(e,t){e.ref?.delete(e),t?.delete(e)}function tM(e,t){t&&e.ref!==t&&(e.ref?.delete(e),t.add(e),e.ref=t)}var tI={tension:170,friction:26,mass:1,damping:1,easing:ew,clamp:!1},tA=class{constructor(){this.velocity=0,Object.assign(this,tI)}};function tR(e,t,i){for(let n in i&&(tx(i={...i},t),t={...i,...t}),tx(e,t),Object.assign(e,t),tI)null==e[n]&&(e[n]=tI[n]);let{frequency:n,damping:r}=e,{mass:s}=e;return A.und(n)||(n<.01&&(n=.01),r<0&&(r=0),e.tension=Math.pow(2*Math.PI/n,2)*s,e.friction=4*Math.PI*r*s/n),e}function tx(e,t){if(A.und(t.decay)){let i=!A.und(t.tension)||!A.und(t.friction);!i&&A.und(t.frequency)&&A.und(t.damping)&&A.und(t.mass)||(e.duration=void 0,e.decay=void 0),i&&(e.frequency=void 0)}else e.duration=void 0}var tO=[],tD=class{constructor(){this.changed=!1,this.values=tO,this.toValues=null,this.fromValues=tO,this.config=new tA,this.immediate=!1}};function tL(e,{key:t,props:i,defaultProps:n,state:r,actions:s}){return new Promise((o,a)=>{let d,c;let h=tm(i.cancel??n?.cancel,t);if(h)m();else{A.und(i.pause)||(r.paused=tm(i.pause,t));let e=n?.pause;!0!==e&&(e=r.paused||tm(e,t)),d=tp(i.delay||0,t),e?(r.resumeQueue.add(p),s.pause()):(s.resume(),p())}function f(){r.resumeQueue.add(p),r.timeouts.delete(c),c.cancel(),d=c.time-u.now()}function p(){d>0&&!l.skipAnimation?(r.delayed=!0,c=u.setTimeout(m,d),r.pauseQueue.add(f),r.timeouts.add(c)):m()}function m(){r.delayed&&(r.delayed=!1),r.pauseQueue.delete(f),r.timeouts.delete(c),e<=(r.cancelId||0)&&(h=!0);try{s.start({...i,callId:e,cancel:h},o)}catch(e){a(e)}}})}var tF=(e,t)=>1==t.length?t[0]:t.some(e=>e.cancelled)?tV(e.get()):t.every(e=>e.noop)?tB(e.get()):tN(e.get(),t.every(e=>e.finished)),tB=e=>({value:e,noop:!0,finished:!0,cancelled:!1}),tN=(e,t,i=!1)=>({value:e,finished:t,cancelled:i}),tV=e=>({value:e,cancelled:!0,finished:!1});function tU(e,t,i,n){let{callId:r,parentId:s,onRest:o}=t,{asyncTo:a,promise:d}=i;return s||e!==a||t.reset?i.promise=(async()=>{let c,h,f;i.asyncId=r,i.asyncTo=e;let p=tS(t,(e,t)=>"onRest"===t?void 0:e),m=new Promise((e,t)=>(c=e,h=t)),g=e=>{let t=r<=(i.cancelId||0)&&tV(n)||r!==i.asyncId&&tN(n,!1);if(t)throw e.result=t,h(e),e},v=(e,t)=>{let s=new tj,o=new t$;return(async()=>{if(l.skipAnimation)throw tz(i),o.result=tN(n,!1),h(o),o;g(s);let a=A.obj(e)?{...e}:{...t,to:e};a.parentId=r,O(p,(e,t)=>{A.und(a[t])&&(a[t]=e)});let d=await n.start(a);return g(s),i.paused&&await new Promise(e=>{i.resumeQueue.add(e)}),d})()};if(l.skipAnimation)return tz(i),tN(n,!1);try{let t;t=A.arr(e)?(async e=>{for(let t of e)await v(t)})(e):Promise.resolve(e(v,n.stop.bind(n))),await Promise.all([t.then(c),m]),f=tN(n.get(),!0,!1)}catch(e){if(e instanceof tj)f=e.result;else if(e instanceof t$)f=e.result;else throw e}finally{r==i.asyncId&&(i.asyncId=s,i.asyncTo=s?a:void 0,i.promise=s?d:void 0)}return A.fun(o)&&u.batchedUpdates(()=>{o(f,n,n.item)}),f})():d}function tz(e,t){L(e.timeouts,e=>e.cancel()),e.pauseQueue.clear(),e.resumeQueue.clear(),e.asyncId=e.asyncTo=e.promise=void 0,t&&(e.cancelId=t)}var tj=class extends Error{constructor(){super("An async animation has been interrupted. You see this error because you forgot to use `await` or `.catch(...)` on its returned promise.")}},t$=class extends Error{constructor(){super("SkipAnimationSignal")}},tW=e=>e instanceof tK,tH=1,tK=class extends eI{constructor(){super(...arguments),this.id=tH++,this._priority=0}get priority(){return this._priority}set priority(e){this._priority!=e&&(this._priority=e,this._onPriorityChange(e))}get(){let e=e6(this);return e&&e.getValue()}to(...e){return l.to(this,e)}interpolate(...e){return eK(),l.to(this,e)}toJSON(){return this.get()}observerAdded(e){1==e&&this._attach()}observerRemoved(e){0==e&&this._detach()}_attach(){}_detach(){}_onChange(e,t=!1){eM(this,{type:"change",parent:this,value:e,idle:t})}_onPriorityChange(e){this.idle||K.sort(this),eM(this,{type:"priority",parent:this,priority:e})}},tG=Symbol.for("SpringPhase"),tq=1,tQ=2,tZ=4,tY=e=>(e[tG]&tq)>0,tJ=e=>(e[tG]&tQ)>0,tX=e=>(e[tG]&tZ)>0,t0=(e,t)=>t?e[tG]|=tQ|tq:e[tG]&=~tQ,t1=(e,t)=>t?e[tG]|=tZ:e[tG]&=~tZ,t2=class extends tK{constructor(e,t){if(super(),this.animation=new tD,this.defaultProps={},this._state={paused:!1,delayed:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._pendingCalls=new Set,this._lastCallId=0,this._lastToId=0,this._memoizedDuration=0,!A.und(e)||!A.und(t)){let i=A.obj(e)?{...e}:{...t,from:e};A.und(i.default)&&(i.default=!0),this.start(i)}}get idle(){return!(tJ(this)||this._state.asyncTo)||tX(this)}get goal(){return eT(this.animation.to)}get velocity(){let e=e6(this);return e instanceof te?e.lastVelocity||0:e.getPayload().map(e=>e.lastVelocity||0)}get hasAnimated(){return tY(this)}get isAnimating(){return tJ(this)}get isPaused(){return tX(this)}get isDelayed(){return this._state.delayed}advance(e){let t=!0,i=!1,n=this.animation,{toValues:r}=n,{config:s}=n,o=e9(n.to);!o&&ek(n.to)&&(r=D(eT(n.to))),n.values.forEach((a,l)=>{if(a.done)return;let d=a.constructor==tt?1:o?o[l].lastPosition:r[l],u=n.immediate,c=d;if(!u){let t;if(c=a.lastPosition,s.tension<=0){a.done=!0;return}let i=a.elapsedTime+=e,r=n.fromValues[l],o=null!=a.v0?a.v0:a.v0=A.arr(s.velocity)?s.velocity[l]:s.velocity,h=s.precision||(r==d?.005:Math.min(1,.001*Math.abs(d-r)));if(A.und(s.duration)){if(s.decay){let e=!0===s.decay?.998:s.decay,n=Math.exp(-(1-e)*i);c=r+o/(1-e)*(1-n),u=Math.abs(a.lastPosition-c)<=h,t=o*n}else{t=null==a.lastVelocity?o:a.lastVelocity;let i=s.restVelocity||h/10,n=s.clamp?0:s.bounce,l=!A.und(n),f=r==d?a.v0>0:r<d,p=!1,m=1,g=Math.ceil(e/1);for(let e=0;e<g&&!(!(Math.abs(t)>i)&&(u=Math.abs(d-c)<=h));++e){l&&(p=c==d||c>d==f)&&(t=-t*n,c=d);let e=(-(1e-6*s.tension)*(c-d)+-(.001*s.friction)*t)/s.mass;t+=e*m,c+=t*m}}}else{let n=1;s.duration>0&&(this._memoizedDuration!==s.duration&&(this._memoizedDuration=s.duration,a.durationProgress>0&&(a.elapsedTime=s.duration*a.durationProgress,i=a.elapsedTime+=e)),n=(n=(s.progress||0)+i/this._memoizedDuration)>1?1:n<0?0:n,a.durationProgress=n),t=((c=r+s.easing(n)*(d-r))-a.lastPosition)/e,u=1==n}a.lastVelocity=t,Number.isNaN(c)&&(console.warn("Got NaN while animating:",this),u=!0)}o&&!o[l].done&&(u=!1),u?a.done=!0:t=!1,a.setValue(c,s.round)&&(i=!0)});let a=e6(this),l=a.getValue();if(t){let e=eT(n.to);(l!==e||i)&&!s.decay?(a.setValue(e),this._onChange(e)):i&&s.decay&&this._onChange(l),this._stop()}else i&&this._onChange(l)}set(e){return u.batchedUpdates(()=>{this._stop(),this._focus(e),this._set(e)}),this}pause(){this._update({pause:!0})}resume(){this._update({pause:!1})}finish(){if(tJ(this)){let{to:e,config:t}=this.animation;u.batchedUpdates(()=>{this._onStart(),t.decay||this._set(e,!1),this._stop()})}return this}update(e){return(this.queue||(this.queue=[])).push(e),this}start(e,t){let i;return A.und(e)?(i=this.queue||[],this.queue=[]):i=[A.obj(e)?e:{...t,to:e}],Promise.all(i.map(e=>this._update(e))).then(e=>tF(this,e))}stop(e){let{to:t}=this.animation;return this._focus(this.get()),tz(this._state,e&&this._lastCallId),u.batchedUpdates(()=>this._stop(t,e)),this}reset(){this._update({reset:!0})}eventObserved(e){"change"==e.type?this._start():"priority"==e.type&&(this.priority=e.priority+1)}_prepareNode(e){let t=this.key||"",{to:i,from:n}=e;(null==(i=A.obj(i)?i[t]:i)||tP(i))&&(i=void 0),null==(n=A.obj(n)?n[t]:n)&&(n=void 0);let r={to:i,from:n};return tY(this)||(e.reverse&&([i,n]=[n,i]),n=eT(n),A.und(n)?e6(this)||this._set(i):this._set(n)),r}_update({...e},t){let{key:i,defaultProps:n}=this;e.default&&Object.assign(n,tS(e,(e,t)=>/^on/.test(t)?tg(e,i):e)),t7(this,e,"onProps"),ie(this,"onProps",e,this);let r=this._prepareNode(e);if(Object.isFrozen(this))throw Error("Cannot animate a `SpringValue` object that is frozen. Did you forget to pass your component to `animated(...)` before animating its props?");let s=this._state;return tL(++this._lastCallId,{key:i,props:e,defaultProps:n,state:s,actions:{pause:()=>{tX(this)||(t1(this,!0),F(s.pauseQueue),ie(this,"onPause",tN(this,t3(this,this.animation.to)),this))},resume:()=>{tX(this)&&(t1(this,!1),tJ(this)&&this._resume(),F(s.resumeQueue),ie(this,"onResume",tN(this,t3(this,this.animation.to)),this))},start:this._merge.bind(this,r)}}).then(i=>{if(e.loop&&i.finished&&!(t&&i.noop)){let t=t5(e);if(t)return this._update(t,!0)}return i})}_merge(e,t,i){if(t.cancel)return this.stop(!0),i(tV(this));let n=!A.und(e.to),r=!A.und(e.from);if(n||r){if(!(t.callId>this._lastToId))return i(tV(this));this._lastToId=t.callId}let{key:s,defaultProps:o,animation:a}=this,{to:l,from:d}=a,{to:c=l,from:h=d}=e;r&&!n&&(!t.default||A.und(c))&&(c=h),t.reverse&&([c,h]=[h,c]);let f=!R(h,d);f&&(a.from=h),h=eT(h);let p=!R(c,l);p&&this._focus(c);let m=tP(t.to),{config:g}=a,{decay:v,velocity:b}=g;(n||r)&&(g.velocity=0),t.config&&!m&&tR(g,tp(t.config,s),t.config!==o.config?tp(o.config,s):void 0);let S=e6(this);if(!S||A.und(c))return i(tN(this,!0));let y=A.und(t.reset)?r&&!t.default:!A.und(h)&&tm(t.reset,s),w=y?h:this.get(),C=tk(c),_=A.num(C)||A.arr(C)||eQ(C),k=!m&&(!_||tm(o.immediate||t.immediate,s));if(p){let e=to(c);if(e!==S.constructor){if(k)S=this._set(C);else throw Error(`Cannot animate between ${S.constructor.name} and ${e.name}, as the "to" prop suggests`)}}let T=S.constructor,P=ek(c),E=!1;if(!P){let e=y||!tY(this)&&f;(p||e)&&(P=!(E=R(tk(w),C))),(R(a.immediate,k)||k)&&R(g.decay,v)&&R(g.velocity,b)||(P=!0)}if(E&&tJ(this)&&(a.changed&&!y?P=!0:P||this._stop(l)),!m&&((P||ek(l))&&(a.values=S.getPayload(),a.toValues=ek(c)?null:T==tt?[1]:D(C)),a.immediate==k||(a.immediate=k,k||y||this._set(l)),P)){let{onRest:e}=a;x(t9,e=>t7(this,t,e));let n=tN(this,t3(this,l));F(this._pendingCalls,n),this._pendingCalls.add(i),a.changed&&u.batchedUpdates(()=>{a.changed=!y,e?.(n,this),y?tp(o.onRest,n):a.onStart?.(n,this)})}y&&this._set(w),m?i(tU(t.to,t,this._state,this)):P?this._start():tJ(this)&&!p?this._pendingCalls.add(i):i(tB(w))}_focus(e){let t=this.animation;e!==t.to&&(eP(this)&&this._detach(),t.to=e,eP(this)&&this._attach())}_attach(){let e=0,{to:t}=this.animation;ek(t)&&(eR(t,this),tW(t)&&(e=t.priority+1)),this.priority=e}_detach(){let{to:e}=this.animation;ek(e)&&ex(e,this)}_set(e,t=!0){let i=eT(e);if(!A.und(i)){let e=e6(this);if(!e||!R(i,e.getValue())){let n=to(i);e&&e.constructor==n?e.setValue(i):e8(this,n.create(i)),e&&u.batchedUpdates(()=>{this._onChange(i,t)})}}return e6(this)}_onStart(){let e=this.animation;e.changed||(e.changed=!0,ie(this,"onStart",tN(this,t3(this,e.to)),this))}_onChange(e,t){t||(this._onStart(),tp(this.animation.onChange,e,this)),tp(this.defaultProps.onChange,e,this),super._onChange(e,t)}_start(){let e=this.animation;e6(this).reset(eT(e.to)),e.immediate||(e.fromValues=e.values.map(e=>e.lastPosition)),tJ(this)||(t0(this,!0),tX(this)||this._resume())}_resume(){l.skipAnimation?this.finish():K.start(this)}_stop(e,t){if(tJ(this)){t0(this,!1);let i=this.animation;x(i.values,e=>{e.done=!0}),i.toValues&&(i.onChange=i.onPause=i.onResume=void 0),eM(this,{type:"idle",parent:this});let n=t?tV(this.get()):tN(this.get(),t3(this,e??i.to));F(this._pendingCalls,n),i.changed&&(i.changed=!1,ie(this,"onRest",n,this))}}};function t3(e,t){let i=tk(t);return R(tk(e.get()),i)}function t5(e,t=e.loop,i=e.to){let n=tp(t);if(n){let r=!0!==n&&t_(n),s=(r||e).reverse,o=!r||r.reset;return t4({...e,loop:t,default:!1,pause:void 0,to:!s||tP(i)?i:void 0,from:o?e.from:void 0,reset:o,...r})}}function t4(e){let{to:t,from:i}=e=t_(e),n=new Set;return A.obj(t)&&t8(t,n),A.obj(i)&&t8(i,n),e.keys=n.size?Array.from(n):null,e}function t6(e){let t=t4(e);return A.und(t.default)&&(t.default=tS(t)),t}function t8(e,t){O(e,(e,i)=>null!=e&&t.add(i))}var t9=["onStart","onRest","onChange","onPause","onResume"];function t7(e,t,i){e.animation[i]=t[i]!==tv(t,i)?tg(t[i],e.key):void 0}function ie(e,t,...i){e.animation[t]?.(...i),e.defaultProps[t]?.(...i)}var it=["onStart","onChange","onRest"],ii=1,ir=class{constructor(e,t){this.id=ii++,this.springs={},this.queue=[],this._lastAsyncId=0,this._active=new Set,this._changed=new Set,this._started=!1,this._state={paused:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._events={onStart:new Map,onChange:new Map,onRest:new Map},this._onFrame=this._onFrame.bind(this),t&&(this._flush=t),e&&this.start({default:!0,...e})}get idle(){return!this._state.asyncTo&&Object.values(this.springs).every(e=>e.idle&&!e.isDelayed&&!e.isPaused)}get item(){return this._item}set item(e){this._item=e}get(){let e={};return this.each((t,i)=>e[i]=t.get()),e}set(e){for(let t in e){let i=e[t];A.und(i)||this.springs[t].set(i)}}update(e){return e&&this.queue.push(t4(e)),this}start(e){let{queue:t}=this;return(e?t=D(e).map(t4):this.queue=[],this._flush)?this._flush(this,t):(ic(this,t),is(this,t))}stop(e,t){if(!!e!==e&&(t=e),t){let i=this.springs;x(D(t),t=>i[t].stop(!!e))}else tz(this._state,this._lastAsyncId),this.each(t=>t.stop(!!e));return this}pause(e){if(A.und(e))this.start({pause:!0});else{let t=this.springs;x(D(e),e=>t[e].pause())}return this}resume(e){if(A.und(e))this.start({pause:!1});else{let t=this.springs;x(D(e),e=>t[e].resume())}return this}each(e){O(this.springs,e)}_onFrame(){let{onStart:e,onChange:t,onRest:i}=this._events,n=this._active.size>0,r=this._changed.size>0;(n&&!this._started||r&&!this._started)&&(this._started=!0,L(e,([e,t])=>{t.value=this.get(),e(t,this,this._item)}));let s=!n&&this._started,o=r||s&&i.size?this.get():null;r&&t.size&&L(t,([e,t])=>{t.value=o,e(t,this,this._item)}),s&&(this._started=!1,L(i,([e,t])=>{t.value=o,e(t,this,this._item)}))}eventObserved(e){if("change"==e.type)this._changed.add(e.parent),e.idle||this._active.add(e.parent);else{if("idle"!=e.type)return;this._active.delete(e.parent)}u.onFrame(this._onFrame)}};function is(e,t){return Promise.all(t.map(t=>io(e,t))).then(t=>tF(e,t))}async function io(e,t,i){let{keys:n,to:r,from:s,loop:o,onRest:a,onResolve:l}=t,d=A.obj(t.default)&&t.default;o&&(t.loop=!1),!1===r&&(t.to=null),!1===s&&(t.from=null);let c=A.arr(r)||A.fun(r)?r:void 0;c?(t.to=void 0,t.onRest=void 0,d&&(d.onRest=void 0)):x(it,i=>{let n=t[i];if(A.fun(n)){let r=e._events[i];t[i]=({finished:e,cancelled:t})=>{let i=r.get(n);i?(e||(i.finished=!1),t&&(i.cancelled=!0)):r.set(n,{value:null,finished:e||!1,cancelled:t||!1})},d&&(d[i]=t[i])}});let h=e._state;!h.paused===t.pause?(h.paused=t.pause,F(t.pause?h.pauseQueue:h.resumeQueue)):h.paused&&(t.pause=!0);let f=(n||Object.keys(e.springs)).map(i=>e.springs[i].start(t)),p=!0===t.cancel||!0===tv(t,"cancel");(c||p&&h.asyncId)&&f.push(tL(++e._lastAsyncId,{props:t,state:h,actions:{pause:M,resume:M,start(t,i){p?(tz(h,e._lastAsyncId),i(tV(e))):(t.onRest=a,i(tU(c,t,h,e)))}}})),h.paused&&await new Promise(e=>{h.resumeQueue.add(e)});let m=tF(e,await Promise.all(f));if(o&&m.finished&&!(i&&m.noop)){let i=t5(t,o,r);if(i)return ic(e,[i]),io(e,i,!0)}return l&&u.batchedUpdates(()=>l(m,e,e.item)),m}function ia(e,t){let i={...e.springs};return t&&x(D(t),e=>{A.und(e.keys)&&(e=t4(e)),A.obj(e.to)||(e={...e,to:void 0}),iu(i,e,e=>id(e))}),il(e,i),i}function il(e,t){O(t,(t,i)=>{e.springs[i]||(e.springs[i]=t,eR(t,e))})}function id(e,t){let i=new t2;return i.key=e,t&&eR(i,t),i}function iu(e,t,i){t.keys&&x(t.keys,n=>{(e[n]||(e[n]=i(n)))._prepareNode(t)})}function ic(e,t){x(t,t=>{iu(e.springs,t,t=>id(t,e))})}var ih=({children:e,...t})=>{let i=(0,o.useContext)(ip),n=t.pause||!!i.pause,r=t.immediate||!!i.immediate;t=eX(()=>({pause:n,immediate:r}),[n,r]);let{Provider:s}=ip;return o.createElement(s,{value:t},e)},ip=im(ih,{});function im(e,t){return Object.assign(e,o.createContext(t)),e.Provider._context=e,e.Consumer._context=e,e}ih.Provider=ip.Provider,ih.Consumer=ip.Consumer;var ig=()=>{let e=[],t=function(t){eq();let n=[];return x(e,(e,r)=>{if(A.und(t))n.push(e.start());else{let s=i(t,e,r);s&&n.push(e.start(s))}}),n};t.current=e,t.add=function(t){e.includes(t)||e.push(t)},t.delete=function(t){let i=e.indexOf(t);~i&&e.splice(i,1)},t.pause=function(){return x(e,e=>e.pause(...arguments)),this},t.resume=function(){return x(e,e=>e.resume(...arguments)),this},t.set=function(t){x(e,(e,i)=>{let n=A.fun(t)?t(i,e):t;n&&e.set(n)})},t.start=function(t){let i=[];return x(e,(e,n)=>{if(A.und(t))i.push(e.start());else{let r=this._getProps(t,e,n);r&&i.push(e.start(r))}}),i},t.stop=function(){return x(e,e=>e.stop(...arguments)),this},t.update=function(t){return x(e,(e,i)=>e.update(this._getProps(t,e,i))),this};let i=function(e,t,i){return A.fun(e)?e(i,t):e};return t._getProps=i,t};function iv(e,t,i){let n=A.fun(t)&&t;n&&!i&&(i=[]);let r=(0,o.useMemo)(()=>n||3==arguments.length?ig():void 0,[]),s=(0,o.useRef)(0),a=eJ(),l=(0,o.useMemo)(()=>({ctrls:[],queue:[],flush(e,t){let i=ia(e,t);return!(s.current>0)||l.queue.length||Object.keys(i).some(t=>!e.springs[t])?new Promise(n=>{il(e,i),l.queue.push(()=>{n(is(e,t))}),a()}):is(e,t)}}),[]),d=(0,o.useRef)([...l.ctrls]),u=[],c=e3(e)||0;function h(e,i){for(let r=e;r<i;r++){let e=d.current[r]||(d.current[r]=new ir(null,l.flush)),i=n?n(r,e):t[r];i&&(u[r]=t6(i))}}(0,o.useMemo)(()=>{x(d.current.slice(e,c),e=>{tE(e,r),e.stop(!0)}),d.current.length=e,h(c,e)},[e]),(0,o.useMemo)(()=>{h(0,Math.min(c,e))},i);let f=d.current.map((e,t)=>ia(e,u[t])),p=(0,o.useContext)(ih),m=e3(p),g=p!==m&&tT(p);eZ(()=>{s.current++,l.ctrls=d.current;let{queue:e}=l;e.length&&(l.queue=[],x(e,e=>e())),x(d.current,(e,t)=>{r?.add(e),g&&e.start({default:p});let i=u[t];i&&(tM(e,i.ref),e.ref?e.queue.push(i):e.start(i))})}),e1(()=>()=>{x(l.ctrls,e=>e.stop(!0))});let v=f.map(e=>({...e}));return r?[v,r]:v}function ib(e,t){let i=A.fun(e),[[n],r]=iv(1,i?e:[e],i?t||[]:t);return i||2==arguments.length?[n,r]:n}function iS(e,t,i){let n=A.fun(t)&&t,{reset:r,sort:s,trail:a=0,expires:l=!0,exitBeforeEnter:d=!1,onDestroyed:u,ref:c,config:h}=n?n():t,f=(0,o.useMemo)(()=>n||3==arguments.length?ig():void 0,[]),p=D(e),m=[],g=(0,o.useRef)(null),v=r?null:g.current;eZ(()=>{g.current=m}),e1(()=>(x(m,e=>{f?.add(e.ctrl),e.ctrl.ref=f}),()=>{x(g.current,e=>{e.expired&&clearTimeout(e.expirationId),tE(e.ctrl,f),e.ctrl.stop(!0)})}));let b=iw(p,n?n():t,v),S=r&&g.current||[];eZ(()=>x(S,({ctrl:e,item:t,key:i})=>{tE(e,f),tp(u,t,i)}));let y=[];if(v&&x(v,(e,t)=>{e.expired?(clearTimeout(e.expirationId),S.push(e)):~(t=y[t]=b.indexOf(e.key))&&(m[t]=e)}),x(p,(e,t)=>{m[t]||(m[t]={key:b[t],item:e,phase:"mount",ctrl:new ir},m[t].ctrl.item=e)}),y.length){let e=-1,{leave:i}=n?n():t;x(y,(t,n)=>{let r=v[n];~t?(e=m.indexOf(r),m[e]={...r,item:p[t]}):i&&m.splice(++e,0,r)})}A.fun(s)&&m.sort((e,t)=>s(e.item,t.item));let w=-a,C=eJ(),_=tS(t),k=new Map,T=(0,o.useRef)(new Map),P=(0,o.useRef)(!1);x(m,(e,i)=>{let r,s;let o=e.key,u=e.phase,f=n?n():t,p=tp(f.delay||0,o);if("mount"==u)r=f.enter,s="enter";else{let e=0>b.indexOf(o);if("leave"!=u){if(e)r=f.leave,s="leave";else{if(!(r=f.update))return;s="update"}}else{if(e)return;r=f.enter,s="enter"}}if(r=tp(r,e.item,i),!(r=A.obj(r)?t_(r):{to:r}).config){let t=h||_.config;r.config=tp(t,e.item,i,s)}w+=a;let m={..._,delay:p+w,ref:c,immediate:f.immediate,reset:!1,...r};if("enter"==s&&A.und(m.from)){let r=n?n():t,s=A.und(r.initial)||v?r.from:r.initial;m.from=tp(s,e.item,i)}let{onResolve:S}=m;m.onResolve=e=>{tp(S,e);let t=g.current,i=t.find(e=>e.key===o);if(i){if(e.cancelled&&"update"!=i.phase)return;if(i.ctrl.idle){let e=t.every(e=>e.ctrl.idle);if("leave"==i.phase){let t=tp(l,i.item);if(!1!==t){let n=!0===t?0:t;if(i.expired=!0,!e&&n>0){n<=2147483647&&(i.expirationId=setTimeout(C,n));return}}}e&&t.some(e=>e.expired)&&(T.current.delete(i),d&&(P.current=!0),C())}}};let y=ia(e.ctrl,m);"leave"===s&&d?T.current.set(e,{phase:s,springs:y,payload:m}):k.set(e,{phase:s,springs:y,payload:m})});let E=(0,o.useContext)(ih),M=e3(E),I=E!==M&&tT(E);eZ(()=>{I&&x(m,e=>{e.ctrl.start({default:E})})},[E]),x(k,(e,t)=>{if(T.current.size){let e=m.findIndex(e=>e.key===t.key);m.splice(e,1)}}),eZ(()=>{x(T.current.size?T.current:k,({phase:e,payload:t},i)=>{let{ctrl:n}=i;i.phase=e,f?.add(n),I&&"enter"==e&&n.start({default:E}),t&&(tM(n,t.ref),(n.ref||f)&&!P.current?n.update(t):(n.start(t),P.current&&(P.current=!1)))})},r?void 0:i);let R=e=>o.createElement(o.Fragment,null,m.map((t,i)=>{let{springs:n}=k.get(t)||t.ctrl,r=e({...n},t.item,t,i);return r&&r.type?o.createElement(r.type,{...r.props,key:A.str(t.key)||A.num(t.key)?t.key:t.ctrl.id,ref:r.ref}):r}));return f?[R,f]:R}var iy=1;function iw(e,{key:t,keys:i=t},n){if(null===i){let t=new Set;return e.map(e=>{let i=n&&n.find(i=>i.item===e&&"leave"!==i.phase&&!t.has(i));return i?(t.add(i),i.key):iy++})}return A.und(i)?e:A.fun(i)?e.map(i):D(i)}var iC=class extends tK{constructor(e,t){super(),this.source=e,this.idle=!0,this._active=new Set,this.calc=eb(...t);let i=this._get();e8(this,to(i).create(i))}advance(e){let t=this._get();R(t,this.get())||(e6(this).setValue(t),this._onChange(t,this.idle)),!this.idle&&ik(this._active)&&iT(this)}_get(){let e=A.arr(this.source)?this.source.map(eT):D(eT(this.source));return this.calc(...e)}_start(){this.idle&&!ik(this._active)&&(this.idle=!1,x(e9(this),e=>{e.done=!1}),l.skipAnimation?(u.batchedUpdates(()=>this.advance()),iT(this)):K.start(this))}_attach(){let e=1;x(D(this.source),t=>{ek(t)&&eR(t,this),tW(t)&&(t.idle||this._active.add(t),e=Math.max(e,t.priority+1))}),this.priority=e,this._start()}_detach(){x(D(this.source),e=>{ek(e)&&ex(e,this)}),this._active.clear(),iT(this)}eventObserved(e){"change"==e.type?e.idle?this.advance():(this._active.add(e.parent),this._start()):"idle"==e.type?this._active.delete(e.parent):"priority"==e.type&&(this.priority=D(this.source).reduce((e,t)=>Math.max(e,(tW(t)?t.priority:0)+1),0))}};function i_(e){return!1!==e.idle}function ik(e){return!e.size||Array.from(e).every(i_)}function iT(e){e.idle||(e.idle=!0,x(e9(e),e=>{e.done=!0}),eM(e,{type:"idle",parent:e}))}l.assign({createStringInterpolator:ej,to:(e,t)=>new iC(e,t)}),K.advance;var iP=i(54887),iE=/^--/;function iM(e,t){return null==t||"boolean"==typeof t||""===t?"":"number"!=typeof t||0===t||iE.test(e)||iR.hasOwnProperty(e)&&iR[e]?(""+t).trim():t+"px"}var iI={};function iA(e,t){if(!e.nodeType||!e.setAttribute)return!1;let i="filter"===e.nodeName||e.parentNode&&"filter"===e.parentNode.nodeName,{style:n,children:r,scrollTop:s,scrollLeft:o,viewBox:a,...l}=t,d=Object.values(l),u=Object.keys(l).map(t=>i||e.hasAttribute(t)?t:iI[t]||(iI[t]=t.replace(/([A-Z])/g,e=>"-"+e.toLowerCase())));for(let t in void 0!==r&&(e.textContent=r),n)if(n.hasOwnProperty(t)){let i=iM(t,n[t]);iE.test(t)?e.style.setProperty(t,i):e.style[t]=i}u.forEach((t,i)=>{e.setAttribute(t,d[i])}),void 0!==s&&(e.scrollTop=s),void 0!==o&&(e.scrollLeft=o),void 0!==a&&e.setAttribute("viewBox",a)}var iR={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ix=(e,t)=>e+t.charAt(0).toUpperCase()+t.substring(1),iO=["Webkit","Ms","Moz","O"];iR=Object.keys(iR).reduce((e,t)=>(iO.forEach(i=>e[ix(i,t)]=e[t]),e),iR);var iD=/^(matrix|translate|scale|rotate|skew)/,iL=/^(translate)/,iF=/^(rotate|skew)/,iB=(e,t)=>A.num(e)&&0!==e?e+t:e,iN=(e,t)=>A.arr(e)?e.every(e=>iN(e,t)):A.num(e)?e===t:parseFloat(e)===t,iV=class extends tn{constructor({x:e,y:t,z:i,...n}){let r=[],s=[];(e||t||i)&&(r.push([e||0,t||0,i||0]),s.push(e=>[`translate3d(${e.map(e=>iB(e,"px")).join(",")})`,iN(e,0)])),O(n,(e,t)=>{if("transform"===t)r.push([e||""]),s.push(e=>[e,""===e]);else if(iD.test(t)){if(delete n[t],A.und(e))return;let i=iL.test(t)?"px":iF.test(t)?"deg":"";r.push(D(e)),s.push("rotate3d"===t?([e,t,n,r])=>[`rotate3d(${e},${t},${n},${iB(r,i)})`,iN(r,0)]:e=>[`${t}(${e.map(e=>iB(e,i)).join(",")})`,iN(e,t.startsWith("scale")?1:0)])}}),r.length&&(n.transform=new iU(r,s)),super(n)}},iU=class extends eI{constructor(e,t){super(),this.inputs=e,this.transforms=t,this._value=null}get(){return this._value||(this._value=this._get())}_get(){let e="",t=!0;return x(this.inputs,(i,n)=>{let r=eT(i[0]),[s,o]=this.transforms[n](A.arr(r)?r:i.map(eT));e+=" "+s,t=t&&o}),t?"none":e}observerAdded(e){1==e&&x(this.inputs,e=>x(e,e=>ek(e)&&eR(e,this)))}observerRemoved(e){0==e&&x(this.inputs,e=>x(e,e=>ek(e)&&ex(e,this)))}eventObserved(e){"change"==e.type&&(this._value=null),eM(this,e)}},iz=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"];l.assign({batchedUpdates:iP.unstable_batchedUpdates,createStringInterpolator:ej,colors:J});var ij=th(iz,{applyAnimatedValues:iA,createAnimatedStyle:e=>new iV(e),getComponentProps:({scrollTop:e,scrollLeft:t,...i})=>i}).animated}}]);