"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7610],{79418:function(e,t,n){function i(e){if(null!=e)return parseInt(e)}function o(e){return!0===e||!1===e?e:"true"===e||"false"===e?"true"===e:"t"===e||"f"===e?"t"===e:(1===e||0===e)&&1===e}n.d(t,{LC:function(){return i},gx:function(){return o},zW:function(){return function e(t){if(t instanceof Array)return t.map(function(t){return"object"==typeof t&&(t=e(t)),t});{let n={};for(let i in t)if(t.hasOwnProperty(i)){let o=(i.charAt(0).toLowerCase()+i.slice(1)||i).toString(),r=t[i];(r instanceof Array||null!==r&&r.constructor===Object)&&(r=e(r)),n[o]=r}return n}}}})},11144:function(e,t,n){n.d(t,{Z:function(){return f},z:function(){return u}});var i=n(57437),o=n(2265),r=n(79418),s=n(94547),a=n(83593),c=n(5085),d=n(37570),l=n(23447);let u=(0,o.createContext)({});function f(e){let t=(0,o.useContext)(d.H),[n,f]=(0,o.useState)(t.session),[v,h]=(0,o.useState)(t.graphic),{api:m,start:b}=(0,o.useContext)(l.E),g=(0,o.useContext)(c.rZ),p=async()=>{console.debug("Refresh session...");try{g.role===s._b.Controller?f(await b(m.getDeliberationSessionAdmin(t.sid,g.user.access_token,"live-session-refresh"))):f(await b(m.getDeliberationSession(t.sid,"live-session-refresh")))}catch(e){console.error("Error fetching session data.",e)}},[S,x]=(0,o.useState)();(0,o.useEffect)(()=>(a.Z.on(a.M.WSS_Distribute_Message,x),a.Z.on(a.M.WSS_Update_ConnectionState,x),()=>{a.Z.off(a.M.WSS_Distribute_Message,x),a.Z.off(a.M.WSS_Update_ConnectionState,x)}),[]),(0,o.useEffect)(()=>{if(void 0!==S)switch(S.type){case a.M.WSS_Update_ConnectionState:w(S.data);break;case a.M.WSS_Distribute_Message:C(S.data)}},[S]);let w=e=>{console.debug("Connection state detected: ".concat(s.um[e])),e===s.um.Joined&&p()},C=e=>{if("send"===e.action&&"session-update"===e.type){var t;let i=(0,r.zW)(e.data.session);f({...i,joinCode:null!==(t=i.joinCode)&&void 0!==t?t:n.joinCode})}if("send"===e.action&&"answer-summary-update"===e.type){let t=e.data.questionId,i=(0,r.zW)(e.data.answers);f({...n,answers:[...n.answers.filter(e=>e.questionId!==t),...i]})}};return(0,i.jsx)(u.Provider,{value:{session:n,graphic:v},children:e.children})}},37471:function(e,t,n){n.d(t,{C:function(){return h},Z:function(){return f}});var i=n(57437),o=n(2265),r=n(70972),s=n(94547),a=n(83593),c=n(89005),d=n(5085);let l={debug:!1,connectionTimeout:3e3,maxReconnectionDelay:1e4,minReconnectionDelay:100,reconnectionDelayGrowFactor:1.3,maxRetries:1/0},u=(e,t,n)=>({deviceId:e.deviceId,sessionId:n,sessionToken:e.sessionToken,role:e.role,deviceName:void 0,participantName:t.participantName}),f=(0,o.createContext)({}),v=[s.um.Online,s.um.Connecting,s.um.Connected,s.um.Joining];function h(e){var t;let n=null!==(t=e.endpoint)&&void 0!==t?t:"wss://uw4rr0lqvg.execute-api.eu-west-2.amazonaws.com/prod";if(!n)throw"No endpoint found for Zeitgeist WSS";let h=(0,o.useContext)(d.rZ),m=(0,o.useContext)(c.K),b=(0,o.useRef)(null),[g,p]=(0,o.useState)(s.um.Offline),[S,x]=(0,o.useState)(!1),[w,C]=(0,o.useState)(!1),[I,y]=(0,o.useState)(),E=(0,o.useCallback)(e=>{try{return b.current.send(JSON.stringify(e)),!0}catch(e){return console.error(e),!1}},[b]),[_,j]=(0,o.useState)({state:g,isError:w,joinedOnce:S,sendMessage:E});(0,o.useEffect)(()=>{if(void 0===window||void 0===window.navigator)throw"Window undefined.";window.addEventListener("online",()=>{g===s.um.Offline&&p(s.um.Online)}),window.addEventListener("offline",()=>{p(s.um.Offline)}),p(window.navigator.onLine?s.um.Online:s.um.Offline)},[]),(0,o.useEffect)(()=>{y(u(h,m,e.sid))},[h.deviceId,e.sid,h.sessionToken,h.role,m.participantName]),(0,o.useEffect)(()=>{j({state:g,isError:w,joinedOnce:S,sendMessage:E})},[b,g,w,S,E]),(0,o.useEffect)(()=>{switch(console.debug("WSS state change",s.um[g]),a.Z.emit({type:a.M.WSS_Update_ConnectionState,data:g}),g){case s.um.Offline:try{var e;null===(e=b.current)||void 0===e||e.close()}catch(e){console.warn(e)}break;case s.um.Online:k(),p(s.um.Connecting);break;case s.um.Connecting:Z();break;case s.um.Connected:p(s.um.Joining);break;case s.um.Joining:N();break;case s.um.Joined:x(!0);break;case s.um.Error:Z()}C(g===s.um.Error)},[g]);let Z=()=>{setTimeout(()=>{[r.Z.CLOSING,r.Z.CLOSED].includes(b.current.readyState)&&(console.debug("Recreating socket..."),k())},1e3)},k=()=>{if(null!==b.current){try{b.current.close()}catch(e){console.warn(e)}b.current.onopen=null,b.current.onclose=null,b.current.onerror=null,b.current.onmessage=null,b.current=null}b.current=D()},D=()=>{let e=new r.Z(n,[],l);return e.onopen=e=>{console.debug("WSS open",e),p(s.um.Connected)},e.onclose=e=>{console.warn("WSS close",e),p(s.um.Disconnected)},e.onerror=e=>{console.error("WSS error",e),p(s.um.Error)},e.onmessage=async e=>{await A(e)},e},N=()=>{var e,t;console.debug("Joining session...");let n={action:"join",deviceId:I.deviceId,sessionId:I.sessionId,sessionToken:I.sessionToken,deviceName:null!==(e=I.deviceName)&&void 0!==e?e:null,participantName:null!==(t=I.participantName)&&void 0!==t?t:null,role:I.role};b.current.send(JSON.stringify(n))},A=e=>{if(null==e?void 0:e.data){let t=JSON.parse(e.data);t&&("send"===t.action&&"remote-log"===t.type&&R(t),"send"===t.action&&"join-confirmation"===t.type&&T(t),a.Z.emit({type:a.M.WSS_Distribute_Message,data:t}))}},R=e=>{switch(e.data.severity){case"debug":console.debug("Remote debug log",e.data.message);break;case"info":console.info("Remote info log",e.data.message);break;case"warn":console.warn("Remote warn log",e.data.message);break;case"error":console.error("Remote error log",e.data.message);break;default:console.log("Remote log",e.data.message)}},T=e=>{console.debug("Join confirmation"),p(s.um.Joined)};return(0,i.jsxs)(i.Fragment,{children:[w&&!S&&e.error,!w&&!S&&v.includes(g)&&e.load,S&&(0,i.jsx)(f.Provider,{value:_,children:e.children})]})}},70883:function(e,t,n){n.d(t,{Z:function(){return d},l:function(){return c}});var i=n(57437),o=n(2265),r=n(83593),s=n(37471),a=n(5085);let c=(0,o.createContext)({});function d(e){let t=(0,o.useContext)(a.rZ),[n,d]=(0,o.useState)([]),[l,u]=(0,o.useState)(n.find(e=>e.deviceId===t.deviceId)),f=(0,o.useContext)(s.Z);(0,o.useEffect)(()=>{f.sendMessage({action:"request",type:"subscription-update",sessionId:e.sid})},[]);let[v,h]=(0,o.useState)();(0,o.useEffect)(()=>(r.Z.on(r.M.WSS_Distribute_Message,h),()=>{r.Z.off(r.M.WSS_Distribute_Message,h)}),[]),(0,o.useEffect)(()=>{void 0!==v&&v.type===r.M.WSS_Distribute_Message&&m(v.data)},[v]);let m=e=>{if("send"===e.action&&"subscription-update"===e.type){var t;d(null!==(t=e.data.subscriptions)&&void 0!==t?t:[])}};return(0,o.useEffect)(()=>{u(n.find(e=>e.deviceId===t.deviceId))},[n,t]),(0,i.jsx)(c.Provider,{value:{subscriptions:n,thisUser:l},children:e.children})}},5085:function(e,t,n){n.d(t,{ZP:function(){return f},rZ:function(){return u}});var i,o,r=n(57437),s=n(2265),a=n(67022),c=n(20920),d=n(94547),l=n(23447);(i=o||(o={}))[i.Init=0]="Init",i[i.Authenticating=1]="Authenticating",i[i.AuthError=2]="AuthError",i[i.AuthNotRequired=3]="AuthNotRequired",i[i.Authenticated=4]="Authenticated",i[i.ExchangingJoinCode=5]="ExchangingJoinCode",i[i.JoinCodeError=6]="JoinCodeError",i[i.JoinCodeAccepted=7]="JoinCodeAccepted",i[i.Ready=8]="Ready";let u=(0,s.createContext)({});function f(e){var t;let[n,i]=(0,s.useState)((null===(t=window)||void 0===t?void 0:t.localStorage.getItem("DeviceId"))||(0,c.Z)());(0,s.useEffect)(()=>{window&&window.localStorage.setItem("DeviceId",n)},[n]);let[f,v]=(0,s.useState)(0),[h,m]=(0,s.useState)(void 0),[b,g]=(0,s.useState)(e.role),[p,S]=(0,s.useState)(),[x,w]=(0,s.useState)(!1),[C,I]=(0,s.useState)(!1),[y,E]=(0,s.useState)({deviceId:n,role:b,state:f,user:h,sessionToken:p,noUserWarning:C});(0,s.useEffect)(()=>{E({...y,state:f})},[f]),(0,s.useEffect)(()=>{E({...y,user:h})},[h]),(0,s.useEffect)(()=>{E({...y,role:b})},[b]),(0,s.useEffect)(()=>{E({...y,sessionToken:p})},[p]),(0,s.useEffect)(()=>{E({...y,noUserWarning:C})},[C]);let _=(0,a.aC)(),{api:j,start:Z}=(0,s.useContext)(l.E);return(0,s.useEffect)(()=>_.events.addAccessTokenExpiring(async()=>{console.debug("Access token renewal with auth.signinSilent()...");let e=await _.signinSilent();console.debug("User renewal: ".concat(e?"found":"not found")),m(e)}),[_.events,_.signinSilent]),(0,s.useEffect)(()=>{switch(console.debug("User state",o[f]),f){case 0:switch(b){case d._b.Controller:v(1);break;case d._b.Client:v(3),m(null);break;default:throw"Unsupported role: ".concat(d._b[b])}break;case 1:_.signinSilent().then(e=>{null!==e?(console.info("User found",e.profile.email),m(e),v(4)):(console.debug("Not authenticated"),m(void 0),v(2))}).catch(e=>{console.error(e),m(void 0),v(2)});break;case 2:case 6:break;case 4:case 3:v(5);break;case 5:let t={deviceId:n,role:b,joinCode:e.joinCode,sessionId:e.sid};Z(j.exchangeJoinCodeForSessionToken(t)).then(e=>{S(e.sessionToken),v(7)}).catch(e=>{console.error(e),v(6)});break;case 7:v(8)}w(!![2,6].find(e=>e===f))},[f]),(0,s.useEffect)(()=>{I(null===h),null===h&&8===f&&console.error("No user found through Auth. The facilitator will not be able to manage the session.")},[h]),(0,r.jsxs)(r.Fragment,{children:[x&&e.err,8!==f&&!x&&e.load,8===f&&!x&&(0,r.jsx)(u.Provider,{value:y,children:e.children})]})}},37570:function(e,t,n){n.d(t,{H:function(){return h},Z:function(){return m}});var i,o,r=n(57437),s=n(2265),a=n(94547),c=n(20909),d=n(5085),l=n(23447);(i=o||(o={}))[i.Init=0]="Init",i[i.RetrievingSession=1]="RetrievingSession",i[i.RetrievingGraphic=2]="RetrievingGraphic",i[i.SessionError=3]="SessionError",i[i.Ready=4]="Ready";let u=[3],f=[0],v=[1,2],h=(0,s.createContext)({});function m(e){let{api:t,start:n}=(0,s.useContext)(l.E),i=(0,s.useContext)(d.rZ),[m,b]=(0,s.useState)(0),[g,p]=(0,s.useState)(),[S,x]=(0,s.useState)(),[w,C]=(0,s.useState)(!0),[I,y]=(0,s.useState)(!1),[E,_]=(0,s.useState)(!1);(0,s.useEffect)(()=>{switch(console.debug("Static data state",o[m]),m){case 0:b(1);break;case 1:j().then(e=>{p(e),b(2)}).catch(e=>{console.error(e),b(3)});break;case 2:Z().then(e=>{x(e),b(4)}).catch(e=>{console.error(e),b(3)})}y(void 0!==v.find(e=>e===m)),_(void 0!==u.find(e=>e===m)),C(void 0!==f.find(e=>e===m))},[m]);let j=async()=>i.role===a._b.Controller?await n(t.getDeliberationSessionAdmin(e.sid,i.user.access_token,void 0)):await n(t.getDeliberationSession(e.sid,void 0)),Z=async()=>{let e={workshopDirectory:(0,c.X)(g.sessionPresentationUris[0])};return await n(t.postPublicContentAccessRequest(g.id,e))};return(0,r.jsxs)(r.Fragment,{children:[w&&e.init,I&&e.load,E&&e.err,4===m&&(0,r.jsx)(h.Provider,{value:{sid:g.id,session:g,graphic:S},children:e.children})]})}},83593:function(e,t,n){n.d(t,{M:function(){return o}});var i,o,r=n(37836),s=n.n(r);(i=o||(o={})).Request_SlideRefresh="REQUEST_SLIDE_REFRESH",i.WSS_Update_ConnectionState="WSS_UPDATE_CONNECTION_STATE",i.WSS_Distribute_Message="WSS_DISTRIBUTE_MESSAGE",i.Content_Progress_Update="CONTENT_PROGRESS_UPDATE",i.Media_Playback_Update="MEDIA_PLAYBACK_UPDATE";let a=new(s()),c={on:(e,t)=>a.on(e,t),once:(e,t)=>a.once(e,t),off:(e,t)=>a.off(e,t),emit:e=>a.emit(e.type,e)};Object.freeze(c),t.Z=c},66097:function(e,t,n){var i=n(57437),o=n(70883),r=n(80511),s=n(40468),a=n(33351),c=n(6722),d=n(2265);let l=(e,t)=>{var n;return null===(n=Object.entries(t).find(t=>t[1].externalUserId===e))||void 0===n?void 0:n[1]};t.ZP=(0,d.memo)(function(e){let{tiles:t,attendeeIdToTileId:n}=(0,c.akC)(),{tileId:u,isVideoEnabled:f}=(0,c.Onx)(),{thisUser:v}=(0,d.useContext)(o.l),{roster:h}=(0,c.dJs)(),[m,b]=(0,d.useState)();(0,d.useEffect)(()=>{let i=l(e.subscription.deviceId,h);if(i){var o;let r=e.subscription.deviceId===(null==v?void 0:v.deviceId);b({subscription:e.subscription,attendee:i,isLocal:r,hasVideo:r?f:!!i&&t.some(e=>e===n[i.chimeAttendeeId]),tileId:null!==(o=r?u:i?n[i.chimeAttendeeId]:void 0)&&void 0!==o?o:void 0})}},[e.subscription.subscriptionId,f,t,v,h]);let g=(0,d.memo)(function(e){let{render:t}=e,{muted:n}=(0,c.zDY)(t.attendee.chimeAttendeeId);return(0,i.jsxs)(a.Z,{className:"shadow",sx:{borderRadius:"0.5rem",overflow:"hidden",background:"gray",height:"100%",width:"100%",position:"relative"},children:[t.hasVideo&&!t.isLocal&&(0,i.jsx)(c.ZzX,{name:t.subscription.participantName,tileId:t.tileId}),t.hasVideo&&t.isLocal&&(0,i.jsx)(c.OuP,{nameplate:t.subscription.participantName}),!t.hasVideo&&(0,i.jsx)(a.Z,{sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:(0,i.jsx)(r.Z,{variant:"body2",color:"white",children:t.subscription.participantName})}),n&&(0,i.jsx)(a.Z,{sx:{position:"absolute",left:"1rem",top:"1rem"},children:(0,i.jsx)("img",{src:"/icons/av/mic-disabled.svg",style:{width:"2rem",height:"2rem"}})}),!n&&(0,i.jsx)(a.Z,{sx:{position:"absolute",left:"1rem",top:"1rem"},children:(0,i.jsx)("img",{src:"/icons/av/mic-enabled.svg",style:{width:"2rem",height:"2rem"}})})]})},(e,t)=>{var n,i;return e.render.tileId===t.render.tileId&&e.render.isLocal===t.render.isLocal&&e.render.hasVideo===t.render.hasVideo&&e.render.subscription.participantName===t.render.subscription.participantName&&(null===(n=e.render.attendee)||void 0===n?void 0:n.chimeAttendeeId)===(null===(i=t.render.attendee)||void 0===i?void 0:i.chimeAttendeeId)});return(0,i.jsxs)(i.Fragment,{children:[m&&(0,i.jsx)(g,{render:m},"video-call-tile-".concat(m.tileId)),!m&&(0,i.jsx)(a.Z,{sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:(0,i.jsx)(s.Z,{})})]})},(e,t)=>e.subscription.subscriptionId===t.subscription.subscriptionId)},2215:function(e,t,n){n.d(t,{ZP:function(){return u},fp:function(){return d}});var i=n(57437),o=n(11144),r=n(94547),s=n(6722),a=n(2265),c=n(70883);let d=(0,a.createContext)({}),l=(e,t)=>{if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n].subscriptionId!=e[n].subscriptionId)return!1;return!0};function u(e){let{roster:t}=(0,s.dJs)(),{session:n}=(0,a.useContext)(o.z),{subscriptions:u,thisUser:f}=(0,a.useContext)(c.l),[v,h]=(0,a.useState)({subscriptions:[]});return(0,a.useEffect)(()=>{let t=u.filter(e=>{var t;return(null===(t=n.deviceIdBanList)||void 0===t?void 0:t.find(t=>e.deviceId===t))===void 0}),i=t.filter(e=>e.deviceId!==(null==f?void 0:f.deviceId)&&e.role===r._b.Controller).toSorted((e,t)=>e.deviceId.localeCompare(t.deviceId)),o=t.filter(e=>e.deviceId!==(null==f?void 0:f.deviceId)&&e.role===r._b.Client).toSorted((e,t)=>e.deviceId.localeCompare(t.deviceId)),s=e.role===r._b.Client?[...i,...f?[f]:[],...o]:[...f?[f]:[],...i,...o];l(s,v.subscriptions)||h({subscriptions:s})},[t,u]),(0,i.jsx)(d.Provider,{value:v,children:e.children})}},18010:function(e,t,n){n.d(t,{Z:function(){return r}});var i=n(57437),o=n(31193);function r(e){var t;let n=null===(t=e.background)||void 0===t||t;return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(o.Z,{sx:{width:"100%",height:"100%",backgroundImage:n?"url(/images/zg-poster.png)":void 0,backgroundSize:"cover",backgroundPosition:"center",position:"relative",overflow:"hidden"},children:[(0,i.jsx)(o.Z,{sx:{position:"absolute",left:0,top:0,width:"50%",bottom:0,backgroundColor:"#3E7075CC"}}),(0,i.jsx)(o.Z,{sx:{position:"absolute",left:"5%",right:"5%",top:0,bottom:0,display:"flex",flexDirection:"column",justifyContent:"center",overflowY:"auto"},children:(0,i.jsxs)(o.Z,{sx:{display:"flex",flexDirection:"row",alignItems:"start"},children:[(0,i.jsx)(o.Z,{sx:{flexGrow:1,flexBasis:0,p:2,pr:"10%"},children:e.children}),(0,i.jsx)(o.Z,{sx:{flexGrow:1,flexBasis:0,p:2},children:e.rightPanel})]})})]})})}},89005:function(e,t,n){n.d(t,{K:function(){return l},Z:function(){return u}});var i=n(57437),o=n(9646),r=n(31193),s=n(80511),a=n(66858),c=n(2265),d=n(18010);let l=(0,c.createContext)({});function u(e){let[t,n]=(0,c.useState)(""),[u,f]=(0,c.useState)(!1),[v,h]=(0,c.useState)(!1),m=u&&0===t.trim().length,b=!m&&t.trim().length>0,g=n=>{b&&(e.submitName(t),h(!0))};return(0,i.jsxs)(i.Fragment,{children:[!v&&(0,i.jsx)(d.Z,{children:(0,i.jsxs)(r.Z,{sx:{display:"flex",flexDirection:"column",alignItems:"start",gap:2},children:[(0,i.jsx)(s.Z,{variant:"h4",component:"h2",color:"white",children:"Please enter your name"}),(0,i.jsx)(s.Z,{variant:"body1",color:"white",children:"This is so we know what to call you during the session, your name will not be saved or stored"}),(0,i.jsxs)("form",{onSubmit:e=>{e.preventDefault(),g()},style:{alignSelf:"stretch"},children:[(0,i.jsx)(a.Z,{sx:{mb:4,input:{background:"#ffffffcc"}},fullWidth:!0,style:{flexGrow:1},label:"Your name",variant:"outlined",value:t,autoComplete:"off",autoFocus:!0,onChange:e=>{n(e.target.value),f(!0)},error:m,color:"buttonStandard"}),(0,i.jsx)(o.Z,{color:"buttonReverse",btnKey:"submit",busy:!1,disabled:!b,onClick:g,btnText:"CONTINUE"})]})]})}),v&&(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(l.Provider,{value:{participantName:t},children:e.children})})]})}},15785:function(e,t,n){var i,o;n.d(t,{I:function(){return r},S:function(){return i}}),(o=i||(i={}))[o.default=0]="default",o[o.deliberation=1]="deliberation";let r={activity:0,recordingId:void 0,notes:"",qids:[],secs:void 0}},9646:function(e,t,n){n.d(t,{Z:function(){return s}});var i=n(57437),o=n(42555),r=n(80511);function s(e){var t,n,s;return(0,i.jsx)(o.Z,{type:"submit",variant:null!==(t=e.variant)&&void 0!==t?t:"contained",size:e.size,color:null!==(n=e.color)&&void 0!==n?n:"buttonStandard",onClick:()=>{e.onClick(e.btnKey)},loading:e.busy,disabled:e.disabled||e.busy,startIcon:e.startIcon,endIcon:e.endIcon,sx:e.sx,children:(0,i.jsx)(r.Z,{variant:"submitButton",children:null!==(s=e.btnText)&&void 0!==s?s:"Submit"})})}},20909:function(e,t,n){n.d(t,{X:function(){return i}});let i=e=>e.split("/").at(-2)}}]);